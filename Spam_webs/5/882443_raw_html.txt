<!DOCTYPE html>
<html data-cast-api-enabled="true" lang="en" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# profile: http://ogp.me/ns/profile# music: http://ogp.me/ns/music#">
 <head>
  <link href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700" rel="stylesheet" type="text/css"/>
  <title>
   In Memory of Joe Cocker - Rest in Peace
  </title>
  <meta charset="utf-8"/>
  <script type="text/javascript">
   window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"fae66bfe69","applicationID":"499717","transactionName":"Jw0MR0JZWA8ERRcTWQUbERxDXlsU","queueTime":6,"applicationTime":35,"agent":"js-agent.newrelic.com/nr-632.min.js"}
  </script>
  <script type="text/javascript">
   window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o?o:n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o&lt;t.length;o++)r(t[o]);return r}({QJf3ax:[function(e,n){function t(e){function n(n,t,a){e&amp;&amp;e(n,t,a),a||(a={});for(var u=c(n),f=u.length,s=i(a,o,r),p=0;f&gt;p;p++)u[p].apply(s,t);return s}function a(e,n){f[e]=c(e).concat(n)}function c(e){return f[e]||[]}function u(){return t(n)}var f={};return{on:a,emit:n,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=e("gos");n.exports=t()},{gos:"7eSDFh"}],ee:[function(e,n){n.exports=e("QJf3ax")},{}],3:[function(e,n){function t(e){return function(){r(e,[(new Date).getTime()].concat(i(arguments)))}}var r=e("handle"),o=e(1),i=e(2);"undefined"==typeof window.newrelic&amp;&amp;(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(e,n){window.NREUM[n]=t("api-"+n)}),n.exports=window.NREUM},{1:12,2:13,handle:"D5DuLP"}],"7eSDFh":[function(e,n){function t(e,n,t){if(r.call(e,n))return e[n];var o=t();if(Object.defineProperty&amp;&amp;Object.keys)try{return Object.defineProperty(e,n,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return e[n]=o,o}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],gos:[function(e,n){n.exports=e("7eSDFh")},{}],handle:[function(e,n){n.exports=e("D5DuLP")},{}],D5DuLP:[function(e,n){function t(e,n,t){return r.listeners(e).length?r.emit(e,n,t):(o[e]||(o[e]=[]),void o[e].push(n))}var r=e("ee").create(),o={};n.exports=t,t.ee=r,r.q=o},{ee:"QJf3ax"}],id:[function(e,n){n.exports=e("XL7HBI")},{}],XL7HBI:[function(e,n){function t(e){var n=typeof e;return!e||"object"!==n&amp;&amp;"function"!==n?-1:e===window?0:i(e,o,function(){return r++})}var r=1,o="nr@id",i=e("gos");n.exports=t},{gos:"7eSDFh"}],G9z0Bl:[function(e,n){function t(){var e=d.info=NREUM.info,n=f.getElementsByTagName("script")[0];if(e&amp;&amp;e.licenseKey&amp;&amp;e.applicationID&amp;&amp;n){c(p,function(n,t){n in e||(e[n]=t)});var t="https"===s.split(":")[0]||e.sslForHttp;d.proto=t?"https://":"http://",a("mark",["onload",i()]);var r=f.createElement("script");r.src=d.proto+e.agent,n.parentNode.insertBefore(r,n)}}function r(){"complete"===f.readyState&amp;&amp;o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=e("handle"),c=e(1),u=(e(2),window),f=u.document,s=(""+location).split("?")[0],p={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-632.min.js"},d=n.exports={offset:i(),origin:s,features:{}};f.addEventListener?(f.addEventListener("DOMContentLoaded",o,!1),u.addEventListener("load",t,!1)):(f.attachEvent("onreadystatechange",r),u.attachEvent("onload",t)),a("mark",["firstbyte",i()])},{1:12,2:3,handle:"D5DuLP"}],loader:[function(e,n){n.exports=e("G9z0Bl")},{}],12:[function(e,n){function t(e,n){var t=[],o="",i=0;for(o in e)r.call(e,o)&amp;&amp;(t[i]=n(o,e[o]),i+=1);return t}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],13:[function(e,n){function t(e,n,t){n||(n=0),"undefined"==typeof t&amp;&amp;(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(0&gt;o?0:o);++r&lt;o;)i[r]=e[n+r];return i}n.exports=t},{}]},{},["G9z0Bl"]);
  </script>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="322554644500214" property="fb:app_id"/>
  <meta content="SongCrate" property="og:site_name"/>
  <meta content="video.other" property="og:type"/>
  <meta content="http://www.songcrate.com/songs/3225322/play" property="og:url"/>
  <meta content="In Memory of Joe Cocker - Rest in Peace" property="og:title"/>
  <meta content="http://i.ytimg.com/vi/NR-H2uFCQls/hqdefault.jpg" property="og:image"/>
  <meta content="authenticity_token" name="csrf-param"/>
  <meta content="7za6Ut4IWAYGkDWgPkS+igsET20wMv4XURVoapqUoVw=" name="csrf-token"/>
  <link href="/assets/plays-9d8ab6a2f7ac338caaee8cf52fde4e67.css" media="all" rel="stylesheet"/>
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]&gt;
&lt;script src="http://html5shim.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;
&lt;![endif]-->
  <!-- Le fav and touch icons -->
  <link href="http://www.songcrate.com/assets/favicon-71d9fb2b8e6f29758e307e04c8f2bed6.ico" rel="shortcut icon"/>
  <link href="http://www.songcrate.com/assets/apple-touch-icon-aafe682ce317be9d0e0326a8e4e97b0a.png" rel="apple-touch-icon"/>
  <link href="http://www.songcrate.com/assets/apple-touch-icon-72x72-8eea442509443ec7ae109b0072b2abab.png" rel="apple-touch-icon" sizes="72x72"/>
  <link href="http://www.songcrate.com/assets/apple-touch-icon-114x114-897afddea00cfbc8e420d36518f52879.png" rel="apple-touch-icon" sizes="114x114"/>
 </head>
 <body class="plays-show">
  <div id="fb-root">
  </div>
  <div class="navbar navbar-inverse navbar-fixed-top">
   <div class="navbar-inner">
    <div class="container">
     <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
     </a>
     <a class="brand bottom" href="/">
      SongCrate
      <small>
       make &amp; share music crates
      </small>
      <image alt="beta" class="beta" src="/assets/beta-7ab11dd3d747aebcb07e31af293ab79b.png">
      </image>
     </a>
     <form accept-charset="UTF-8" action="http://www.songcrate.com/search" class="bottom pull-left search-form" method="get">
      <div style="margin:0;padding:0;display:inline">
       <input name="utf8" type="hidden" value=""/>
      </div>
      <div class="controls">
       <div class="input-append bottom">
        <input class="bottom span4" id="q" name="q" placeholder="Search Artist, Song, or Artist and Song" type="text" value=""/>
        <button class="btn btn-warning" type="submit">
         <i class="icon-search">
         </i>
        </button>
       </div>
      </div>
     </form>
     <div class="nav-collapse">
      <ul class="nav pull-right">
       <li>
        <a href="http://www.songcrate.com/account/sign_up" style="font-weight:bold;">
         <span class="badge badge-success">
          JOIN
         </span>
        </a>
       </li>
       <li>
        <a href="http://www.songcrate.com/account/sign_in">
         Sign in
        </a>
       </li>
       <li class="devider-vertical">
       </li>
       <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
         About
         <i class="icon-chevron-down">
         </i>
        </a>
        <ul class="dropdown-menu">
         <li>
          <a href="http://www.songcrate.com/term">
           ToS
          </a>
         </li>
         <li>
          <a href="http://www.songcrate.com/about">
           About Us
          </a>
         </li>
         <li>
          <a href="http://www.songcrate.com/privacy">
           Privacy Policy
          </a>
         </li>
         <li class="divider">
         </li>
        </ul>
       </li>
       <li>
        <a href="http://www.songcrate.com/contact-us">
         Contact Us
        </a>
       </li>
      </ul>
     </div>
     <!-- %a.btn.btn-navbar{"data-target" =&gt; ".nav-collapse", "data-toggle" =&gt; "collapse"} -->
     <!-- %span.icon-bar -->
     <!-- %span.icon-bar -->
     <!-- %span.icon-bar -->
     <!-- .container.nav-collapse -->
     <!-- %form.navbar-search -->
     <!-- %input.search-query.span2{:type =&gt; "text", :placeholder =&gt; "Enter Food Name"} -->
    </div>
   </div>
  </div>
  <div class="container">
   <div class="content">
    <div class="row" id="titleDiv">
     <div class="span9">
     </div>
     <div class="span3">
      <p class="hide form-inline tac" id="fb-play">
       <label>
        Social:
       </label>
       <button class="btn btn-mini" data-toggle="button" id="fb-play-switch">
       </button>
       <br/>
       <small id="fb-play-status">
       </small>
      </p>
     </div>
    </div>
    <div class="row">
     <div class="span9">
      <div id="playerDiv">
       <div class="player" data-id="3225322" style="background: #000 url(http://i.ytimg.com/vi/NR-H2uFCQls/hqdefault.jpg) center center no-repeat;background-size: 100% auto;">
        <button class="btn btn-danger btn-heart btn-hover" title="Sign in to like/un-like">
         <i class="icon-heart">
         </i>
        </button>
        <button class="btn btn-success btn-plus btn-hover" title="Sign in to save song">
         <i class="icon-plus">
         </i>
        </button>
        <button class="btn btn-info btn-share btn-hover" data-media="http://i.ytimg.com/vi/NR-H2uFCQls/hqdefault.jpg" data-title="In Memory of Joe Cocker - Rest in Peace" data-url="http://www.songcrate.com/songs/3225322/play" title="Share this song">
         <i class="icon-share">
         </i>
        </button>
        <button class="btn btn-fullscreen btn-hover">
         <i class="icon-arrow-up">
         </i>
         fullscreen
        </button>
        <div class="hide" id="youtubePlayer">
        </div>
        <div class="tac" id="replaySong" style="display:none">
         <div class="row">
          <div class="innerBox span5 offset2">
           <p>
            <button class="close btn-closeReplay" title="close">
             
            </button>
            <br/>
            <a class="btn btn-replay" href="http://www.songcrate.com/songs/3225322/play">
             <i class="icon-repeat">
             </i>
             Re-Play!
            </a>
            <br/>
            (In Memory of Joe Cocker - Rest in Peace)
           </p>
           <div class="labeled-divider">
            <hr class="soften"/>
            <h4>
             <span>
              OR
             </span>
            </h4>
           </div>
           <p>
            Search for another song
           </p>
           <div class="search-form">
            <form accept-charset="UTF-8" action="http://www.songcrate.com/search" class="bottom pull-left search-form" method="get">
             <div style="margin:0;padding:0;display:inline">
              <input name="utf8" type="hidden" value=""/>
             </div>
             <div class="controls">
              <div class="input-append bottom">
               <input class="bottom span4" id="q" name="q" placeholder="Search Artist, Song, or Artist and Song" type="text" value=""/>
               <button class="btn btn-warning" type="submit">
                <i class="icon-search">
                </i>
               </button>
              </div>
             </div>
            </form>
           </div>
          </div>
         </div>
        </div>
       </div>
       <br/>
       <div id="recently_likes">
       </div>
       <br/>
       <hr class="short"/>
       <div id="commentsDiv">
        <div class="row">
         <div class="span6">
          <h3>
           What do you think about this song?
           <span class="comments-stats">
           </span>
          </h3>
          <div class="comments">
           <div class="widget-comment">
            <hr class="short"/>
            <ul class="comments comments-desc media-list">
            </ul>
           </div>
          </div>
         </div>
         <br/>
        </div>
       </div>
      </div>
     </div>
     <div class="span3">
      <div class="sidebar" id="sidebar">
       <div class="well">
        <div id="sidebar">
         <h2 class="tac" id="song" itemscope="" itemtype="http://schema.org/music">
          <span itemprop="artist">
           In Memory of Joe Cocker
          </span>
          
          <span itemprop="name">
           Rest in Peace
          </span>
         </h2>
         <p align="center" class="stats" data-id="3225322">
          <small>
           <span class="stats-plays">
            <a href="http://www.songcrate.com/songs/3225322/play" title="Plays">
             <i class="icon-play">
             </i>
             17
            </a>
           </span>
           <span class="stats-saves">
            <a href="http://www.songcrate.com/crates?song_id=3225322" title="Crates">
             <i class="icon-th">
             </i>
             0
            </a>
           </span>
           <span class="stats-likes">
            <a href="http://www.songcrate.com/songs/3225322/play#!likes" title="Likes">
             <i class="icon-heart">
             </i>
             0
            </a>
           </span>
          </small>
         </p>
         <hr class="hr-group"/>
         <div class="tac" id="tabs">
          <img alt="Ontour" id="ontour" src="/assets/ontour-c63b6e6b2be9bd5e48e52cdfa6f46716.png"/>
          <div class="btn-group">
           <button class="btn btn-small" data-toggle="related" title="Related Songs">
            <i class="icon-forward">
            </i>
           </button>
           <button class="btn btn-small" data-toggle="likes" title="Likes">
            <i class="icon-heart">
            </i>
           </button>
           <button class="btn btn-small" data-toggle="info" title="Info">
            <i class="icon-file">
            </i>
           </button>
           <button class="btn btn-small" data-toggle="qrCode" title="QR Code">
            <i class="icon-qrcode">
            </i>
           </button>
           <button class="btn btn-small" data-toggle="shops" title="Buy Songs">
            <i class="icon-shopping-cart">
            </i>
           </button>
           <button class="btn btn-small" data-toggle="shows" id="btnShows" title="Shows">
            <img alt="show" src="/assets/ticket-e17fe1875345d2aa7b533d1df074a4b6.png"/>
           </button>
          </div>
         </div>
         <div class="fragment hide" id="related">
          <ul class="nav nav-tabs" id="relatedTab">
           <li class="active">
            <a href="#relatedSong">
             Related
            </a>
           </li>
           <li>
            <a href="#relatedSearch">
             Search
            </a>
           </li>
          </ul>
          <div class="tab-content">
           <div class="tab-pane active" id="relatedSong">
           </div>
           <div class="tab-pane" id="relatedSearch">
            <form accept-charset="UTF-8" action="http://www.songcrate.com/search" class="bottom search-form" data-remote="true" method="get">
             <div style="margin:0;padding:0;display:inline">
              <input name="utf8" type="hidden" value=""/>
             </div>
             <div class="controls">
              <div class="input-append bottom">
               <input class="bottom span2" id="q" name="q" placeholder="Search Artist, Song, or Artist and Song" type="text" value=""/>
               <input id="view" name="view" type="hidden" value="list"/>
               <input id="per_page" name="per_page" type="hidden" value="7"/>
               <input id="more" name="more" type="hidden" value="true"/>
               <button class="btn btn-warning" type="submit">
                <i class="icon-search">
                </i>
               </button>
              </div>
              <p class="tac loading" style="display:none;">
              </p>
             </div>
            </form>
            <br/>
            <ul class="images images-list" id="results">
            </ul>
           </div>
          </div>
         </div>
         <div class="fragment hide" id="likes">
          <ul class="images images-grid">
           <p class="tac hide">
            <small>
             Be the first to like this song.
            </small>
           </p>
          </ul>
         </div>
         <div class="fragment hide" id="tweets">
          <ul class="images images-list" id="twitterResults">
          </ul>
         </div>
         <div class="fragment hide" id="info">
          <legend>
           Lyrics
          </legend>
          <ul class="images images-list" id="lyricsResult">
          </ul>
          <legend>
           Artist Info
          </legend>
          <ul class="images images-list" id="bioResult">
          </ul>
          <legend>
           In Memory of Joe Cocker's Discography
          </legend>
          <ul class="images images-list accordion" id="discographyResult">
          </ul>
          <legend>
           In Memory of Joe Cocker's Top Tracks
          </legend>
          <ul class="images images-list" id="topTracksResult">
          </ul>
          <div class="logo tar">
           <p>
            <small>
             Powered by
            </small>
            <img alt="Lastfm" src="/assets/lastfm-33fa6f17d5229fbe1251b5f60ad05da7.png"/>
           </p>
          </div>
         </div>
         <div class="fragment hide" id="qrCode">
          <img alt="Chart?cht=qr&amp;chs=200x200&amp;chl=http%3a%2f%2fwww.songcrate" src="https://chart.googleapis.com/chart?cht=qr&amp;chs=200x200&amp;chl=http%3A%2F%2Fwww.songcrate.com%2Fsongs%2F3225322%2Fplay"/>
          <br/>
          <p class="tac">
           <small>
            Scan the QR code to grab this song/crate
           </small>
          </p>
         </div>
         <div class="fragment hide" id="shops">
          <legend>
           iTunes Store
          </legend>
          <ul class="hide images images-list" id="itunes">
          </ul>
          <legend>
           Amazon MP3 Downloads
          </legend>
          <ul class="hide images images-list" id="amazon">
          </ul>
          <legend>
           Amazon Vinyl Records
          </legend>
          <ul class="hide images images-list" id="vinyl">
          </ul>
         </div>
         <div class="fragment hide" id="shows">
          <legend>
           In Memory of Joe Cocker's Shows
          </legend>
         </div>
        </div>
        <script>
         $('#relatedTab a[href="#relatedSearch"]').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  })
  $('#relatedTab a[href="#relatedSong"]').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  })
        </script>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <div class="modal" style="display:none">
   <div class="modal-header">
    <button class="close" data-dismiss="modal">
     
    </button>
    <h3>
    </h3>
   </div>
   <div class="modal-body">
   </div>
   <div class="modal-footer hide">
   </div>
  </div>
  <!--
Le javascript
==================================================
-->
  <!-- Placed at the end of the document so the pages load faster -->
  <div id="fb-root">
  </div>
  <script src="/assets/application-4b82d22458a86fff80aef6e788cb4156.js">
  </script>
  <script>
   $(function() {
    $.getScript('/songs/3225322/comments');
  });
  </script>
  <script src="http://connect.soundcloud.com/sdk.js" type="text/javascript">
  </script>
  <script src="http://w.soundcloud.com/player/api.js" type="text/javascript">
  </script>
  <script>
   SC.initialize({
    client_id: '5de38999c67daed348120010630698ce'
  });
  </script>
  <script>
   var searching = false;
  </script>
  <script>
   var source_id = 'NR-H2uFCQls',
      source    = 'youtube';
  
  $('#playerDiv .playlist').on('click', '#playlist li a', function() {
    if ("undefined" == typeof(history.pushState)) return true; // IE? use redirection
  
    // update player id
    $('.player').attr('data-id', $(this).parent().attr('data-id'));
  
    // move playlist cursor
    $('#thumbsWindow').animate({scrollLeft: $(this).parent().index() * 88 - $('#thumbsWindow').width() / 2 + 44});
    $('#playlist li.active').removeClass('active');
    $(this).parent().addClass('active');
    $('#playIndex').html(($('#playlist li.active').index() + 1) + '/' + $('#playlist li').length);
  
    // pause song
    if (ytplayer) ytplayer.pauseVideo();
    if (scPlayer) scPlayer.pause();
  
    // refresh video+sidebar
    $.getScript(this.href);
    $('title').text(this.title); // FF reads this
    history.pushState(null, "", this.href);
    return false;
  });
  
  $('.sidebar').on('click', '#relatedSong li a.btn-play', function() {
    // refresh video+sidebar
    $('title').text(this.title); // FF reads this
    document.title = this.title; // Chrome
    $.getScript(this.href);
    return false;
  });
  
  $('.sidebar').on('click', '#relatedSearch li a.btn-play', function() {
    // refresh video+sidebar
    $.getScript(this.href);
    $('title').text(this.title); // FF reads this
    document.title = this.title; // Chrome
    return false;
  });
  
  $('.sidebar').on('click', '#searches li a.btn-play', function() {
    // refresh video+sidebar
    $.getScript(this.href + '?from-crate=1');
    $('title').text(this.title); // FF reads this
    document.title = this.title; // Chrome
    return false;
  });
  
  $(window).bind("popstate", function () {
    // refresh only for non-tab navigation
    if (location.hash.match(/#!!?(.*)/)) {
      current = $('.sidebar .btn-group &gt; .active').attr('data-toggle');
      $('.sidebar .btn-group &gt; .active').removeClass('active');
      $('.sidebar #' + current).hide();
      active = location.hash.replace(/#!/, '');
      if (active.match(/\//)) {
        active = active.replace(/\//, '');
        location.hash = '#!' + active;
      }
      $('.sidebar .btn-group &gt; .btn[data-toggle="' + active + '"]').addClass('active');
      $('.sidebar #' + active).show();
  
      // run google analytics
      var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33379933-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  
  
    } else if (location.hash !== '#') {
      if (ytplayer) ytplayer.pauseVideo();
      if (scPlayer) scPlayer.pause();
      $.getScript(location.href);
    }
    if (searching) {
      $.getScript(location.href);
    }
  });
  
  $('.btn-closeReplay').click(function() {
    $('#replaySong').hide();
  });
  
  $("body").click(function(event){
    if ($(event.target).closest('.innerBox').length === 0) {
      $('#replaySong').hide();
    }
  });
  
  $('.btn-copy').click(function() {
    parent_id = $(this).attr('data-id');
    $(this).html('saving').addClass('disabled');
    $.post('/crates', {parent_id: parent_id});
  });
  
  function prev() {
    var prevSong = null;
  
    // find prev song
    if (shuffleIds.length &gt; 0) {
      currentIdx = shuffleIds.indexOf(+$('#playlist li.active').attr('data-id')); // + converts string to integer
      prevId = shuffleIds[currentIdx - 1];
      prevSong = $('#playlist li[data-id="' + prevId + '"] a');
    } else {
      prevSong = $('#playlist li.active').prev().find('a');
    }           
    if (prevSong.length &gt; 0) {
      "undefined" === typeof(history.pushState) ? document.location = prevSong.attr('href') : prevSong.trigger('click');
    } else {
      alert('You are at the beginning of the playlist!');
    }
  }
  
  function next() {
    var nextSong = null;
  
    // find next song
    if (shuffleIds.length &gt; 0) {
      currentIdx = shuffleIds.indexOf($('#playlist li.active').attr('data-id')); // + converts string to integer
      nextId = shuffleIds[currentIdx + 1];
      nextSong = $('#playlist li[data-id="' + nextId + '"] a');
    } else  {
      nextSong = $('#playlist li.active').next().find('a');
    }           
  
    // play next or popup replay
    if (nextSong.length &gt; 0) {
      "undefined" === typeof(history.pushState) ? document.location = nextSong.attr('href') : nextSong.trigger('click');
    } else {
      showReplayPopup();
    }
  }
  
  function onPlayerReady(event) {      
    //$(window).resize(function() {
    //  if (ytplayer) {
    //    ytplayer.height = getPlayerHeight();
    //    $('#thumbsWindow').width($('.player').width() - 2 * ($('#thumbsLeft').width() + 22));
    //  }
    //});
  }
  
  function onPlayerStateChange(event) {
    // auto play next
    if (('undefined' !== typeof(event.data) &amp;&amp; event.data == 0) || ('undefined' !== typeof(event.relativePosition) &amp;&amp; event.relativePosition &gt; 0.9)) {
      if (searching) {
        history.go(-1);
      } else if ($('#replaySong').exists()){
        $('#replaySong').show();
        $('#replaySong').css('z-index', 5);
        $('.btn-hover').css('z-index', 5);
        $('.innerBox #q').focus();
      } else {
        next();
      }
    }
  }
  
  function getPlayerHeight() {
    if ($('.player').parent().width() &gt; 700) {
      return 480;
    } else {
      return 360;
    }
  }
  
  // fb hooks
  fbSendWatch = function() {
    $('#fb-play-status').text('sending to facebook...');
    FB.api('/me/video.watches', 'post', {
      video: document.location.toString(),
      access_token: fbAuth.accessToken,
    }, function(response) {
      if (!response || response.error) {
        $('#fb-play-status').text('failed');
        notify('SongCrate can post to your Facebook timeline for you. &lt;a href="#" class="btn btn-mini btn-info btn-fb-login" data-fb-login-scope="publish_actions"&gt;Grant Permission&lt;/a&gt; &ndash; &lt;a href="#" data-dissmiss="alert"&gt;No Thanks&lt;/a&gt;', {kind: "error", autoHide: false});
      } else {
        $('#fb-play-status').text('');
        $('#fb-play-status').append(
          '&lt;a class="fb-play-cancel" data-ogid="'+response.id+'" href="#"&gt;remove just this video from my timeline&lt;/a&gt;'
        );
      }
    });
  }
  
  fbConnected = function(fbAuth) {
    $.getScript('/play_sharing?provider=facebook&amp;uid='+fbAuth.userID);
    // send watch to facebook after 15s
    setTimeout(function() {
      if ('ON' == $('#fb-play-switch').text()) {
        fbSendWatch();
      }
    }, 15000);
  }
  
  fbLoginCallback = function(response) {
    $('.alert').alert('close');
    fbSendWatch();
  }
  
  afterLoad = function() {
    // main afterloads
  
    $('.mobile .player .btn-heart').removeClass('btn-hover');
    $('.mobile .player .btn-plus').removeClass('btn-hover');
    $('.mobile .player .btn-share').removeClass('btn-hover');
    $('.mobile .player .btn-heart').show();
    $('.mobile .player .btn-plus').show();
    $('.mobile .player .btn-share').show();
    $('.mobile .player .btn').css('z-index', 5);
  
    // sidebar afterloads
    if ($('#likes li').length == 0) $('#likes p').show();
  
    // activate tab
    if (location.hash &amp;&amp; location.hash.match(/#!(.*)/)) {
      active = location.hash.replace(/#!/, '');
      if (active.match(/\//)) {
        active = active.replace(/\//, '');
        location.hash = '#!' + active
      }
    } else {
      active = $('.sidebar .btn-group .btn[data-toggle="related"]').length &gt; 0 ? 'related' : 'likes';
    }
    $('.sidebar .btn-group &gt; .btn[data-toggle="'+active+'"]').addClass('active');
    $('.sidebar #'+active).show();
  
    $('.sidebar').on('click', '.btn-group &gt; .btn', function() {
      $('.sidebar .btn-group &gt; .btn').removeClass('active');
      $('.fragment').hide();
      $(this).addClass('active');
      $('.sidebar #' + $(this).attr('data-toggle')).show();
      location.hash = '#!' + $(this).attr('data-toggle');
    });
  
    $('#sidebar').on('click', '.playlist', function() {
      id = $(this).attr('data-id');
      TRACK.init(id);
    });
  
    $('#sidebar').on('click', '.track-search a', function(){
      q = $(this).attr('data-id');
      $('.modal-header h3').text('Search: "' + q + '"');
      $('.modal-body').html('&lt;form accept-charset=\"UTF-8\" action=\"http://www.songcrate.com/search\" class=\"bottom pull-left search-form\" data-remote=\"true\" method=\"get\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&#x2713;\" /&gt;&lt;\/div&gt;\n&lt;div class=\'controls\'&gt;\n&lt;div class=\'input-append bottom\'&gt;\n&lt;input class=\"bottom span4\" id=\"q\" name=\"q\" placeholder=\"Search Artist, Song, or Artist and Song\" type=\"text\" value=\"\" /&gt;\n&lt;input id=\"view\" name=\"view\" type=\"hidden\" value=\"list\" /&gt;\n&lt;input id=\"per_page\" name=\"per_page\" type=\"hidden\" value=\"7\" /&gt;\n&lt;button class=\'btn btn-warning\' type=\'submit\'&gt;\n&lt;i class=\'icon-search\'&gt;&lt;\/i&gt;\n&lt;\/button&gt;\n&lt;\/div&gt;\n&lt;p class=\'tac loading\' style=\'display:none;\'&gt;&lt;\/p&gt;\n&lt;\/div&gt;\n&lt;\/form&gt;\n\n &lt;br/&gt; &lt;ul id="results" class="images images-list" style="max-height:300px;overflow-y:auto;"&gt;&lt;/ul&gt;');
      $('.modal-footer').html('&lt;p class="small tac"&gt;&lt;a href="/search?q='+ q +'"&gt;more &rarr;&lt;/a&gt;&lt;/p&gt;');
      $('.modal .loading').show();
      $('.modal #q').val(q);
      $('.modal .search-form').submit();
      $('.modal .search-form .input-append').hide();
      $('.modal').modal();
      return false;
    });
    // related
    RELATED.init(); 
  
    // start searches
    LNM.init();
    iTS.init();
    AS.init();
    BIO.init();
    DISC.init();
    TT.init();
    AV.init();
    SK.init();
  }
  
  // when page loaded
  $(document).ready(function() {
    afterLoad();
  
    // resize playlist
    $('#thumbsWindow').animate({
      width: $('.player').width() - 2 * ($('#thumbsLeft').width() + 22)
    }, function() {
      $('#thumbsWindow').animate({scrollLeft: $('#playlist li[data-id="3225322"]').index() * 88 - $('#thumbsWindow').width() / 2 + 44});
    });
  
    $('#fb-play-switch').click(function() {
      $.post('/play_sharing', {
        play_sharing: {provider: 'facebook', uid: fbAuth.userID}});
    });
    $('#fb-play-status').on('click', '.fb-play-cancel', function() {
      $('#fb-play-status').text('deleting from facebook timeline...');
      FB.api($(this).attr('data-ogid'), 'delete', {
          accessToken: fbAuth.accessToken}, function(response) {
        if (!response || response.error) {
          alert('Error occured');
        } else {
          $('#fb-play-status').text('Successfully deleted from facebook timeline.');
        }
      });
      return(false);
    });
  
    // playlist
    $('#playerDiv').on('click', '#thumbsRight', function() {
      var scroll = $('#thumbsWindow').scrollLeft() + 5 * 88;
      if (scroll &gt; $('#thumbsWindow &gt; div').width()) {
        scroll = $('#thumbsWindow &gt; div').width();
      }
      $('#thumbsWindow').animate({scrollLeft: scroll});
    });
    $('#playerDiv').on('click', '#thumbsLeft', function() {
      var scroll = $('#thumbsWindow').scrollLeft() - 5 * 88;
      if (scroll &lt; 0) {
        scroll = 0;
      }
      $('#thumbsWindow').animate({scrollLeft: scroll});
    });
  });
  
  // related song modules
  var RELATED =
  {
    init: function () {
      RELATED.yt_url     = "https://gdata.youtube.com/feeds/api/videos"; 
      RELATED.sc_url     = "http://api.soundcloud.com/tracks.json?client_id=5de38999c67daed348120010630698ce&amp;licence=cc-by-sa&amp;filter=public,streamable&amp;limit=4";
      RELATED.r          = $('#relatedSong');
      RELATED.source     = source;
      RELATED.song_id    = source_id;
      RELATED.artist     = escape($('#song span[itemprop="artist"]').text());
      RELATED.title      = escape($('#song span[itemprop="name"]').text());
      RELATED.pingSearch();           
    }, 
    pingSearch: function (){
      if ($('#username').exists()) {
        var btn_heart_title = 'Like/un-like',
            btn_plus_title  = 'Save song to a crate'
      } else {
        var btn_heart_title = 'Sign in to like/un-like',
            btn_plus_title  = 'Sign in to save song'
      }
      if ('youtube' == RELATED.source) {
        var ytr_url = RELATED.yt_url + "/" + RELATED.song_id + "/related?v=2&amp;alt=json&amp;max-results=7";
      } else {
        var ytr_url = RELATED.yt_url + "?q=" + RELATED.artist + " - " + RELATED.title + "&amp;category=Music&amp;alt=json&amp;max-results=7&amp;v=2";
      }
      var scr_url = RELATED.sc_url + "&amp;q=" + RELATED.artist;
      var related_html = '&lt;ul class="images images-list"&gt;';
      var rel_empty = true;
      RELATED.r.html('');
      $.getJSON(ytr_url,function(video){
        if (video.feed.openSearch$totalResults.$t &gt; 0 ) {
          rel_empty = false;
          $.each(video.feed.entry, function(i, result) {
            var title = result.title.$t;
            var id    = "youtube:" + result.media$group.yt$videoid.$t + ":" + title;
            var rel_url = "http://www.songcrate.com/" + "songs/" + id + "/play"
            related_html += '&lt;li class="media youtube"&gt;';
            related_html += '&lt;div class="image image-medium media-object pull-left" "data-id"="'+ id +'"&gt;';
            related_html += '&lt;img src="' + result.media$group.media$thumbnail[0].url + '" /&gt;';
            related_html += '&lt;a class="btn btn-play" href="'+ rel_url +'" rel="nofollow" ';
            related_html += 'title="' + title + '"&gt;&lt;i class="icon-play"&gt;&lt;/i&gt;&lt;/a&gt;';
            related_html += '&lt;a class="btn btn-small btn-heart btn-danger btn-hover" ';
            related_html += 'href="#" title="'+ btn_heart_title +'"&gt;&lt;i class="icon-heart"&gt;&lt;/i&gt;&lt;/a&gt;';
            related_html += '&lt;a class="btn btn-small btn-plus btn-succes btn-hover" ';
            related_html += 'href="#" title="'+ btn_plus_title +'"&gt;&lt;i class="icon-plus"&gt;&lt;/i&gt;';
            related_html += '&lt;/a&gt;&lt;/div&gt;&lt;p class="media-body" "data-id"="'+ id +'"&gt;';
            related_html += '&lt;a class="btn-play" href="'+ rel_url +'" rel="nofollow"';
            related_html += ' title="' + title +'"&gt;&lt;small&gt;' + title + '&lt;/small&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;';
          });
        } else {
          rel_empty = true;
        }
        $.getJSON(scr_url, function(music){
          if (music.length &gt; 0) {
            $.each(music, function(i, result) {
              if ('all' == result.embeddable_by) {
                var sc_title = result.title;
                var sc_id    = "soundcloud:" + result.id + ":" + sc_title;
                var screl_url = "http://www.songcrate.com/" + "songs/" + sc_id + "/play"
                related_html += '&lt;li class="media soundcloud_li"&gt;';
                related_html += '&lt;div class="image image-medium media-object pull-left" "data-id"="'+ sc_id +'" style= "background: #000 url('+ result.waveform_url + ') top center no-repeat;"&gt;';
                related_html += '&lt;a class="btn btn-play" href="'+ screl_url +'" rel="nofollow" ';
                related_html += 'title="' + sc_title + '"&gt;&lt;i class="icon-play"&gt;&lt;/i&gt;&lt;/a&gt;';
                related_html += '&lt;a class="btn btn-small btn-heart btn-danger btn-hover" ';
                related_html += 'href="#" title="'+ btn_heart_title +'"&gt;&lt;i class="icon-heart"&gt;&lt;/i&gt;&lt;/a&gt;';
                related_html += '&lt;a class="btn btn-small btn-plus btn-succes btn-hover" ';
                related_html += 'href="#" title="'+ btn_plus_title +'"&gt;&lt;i class="icon-plus"&gt;&lt;/i&gt;';
                related_html += '&lt;/a&gt;&lt;/div&gt;&lt;p class="media-body" "data-id"="'+ sc_id +'"&gt;';
                related_html += '&lt;a class="btn-play" href="'+ screl_url +'" rel="nofollow"';
                related_html += ' title="' + sc_title +'"&gt;&lt;small&gt;' + sc_title + '&lt;/small&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;';
              }
            });
          } else {
            rel_empty = true;
          }
          if (rel_empty){
            RELATED.r.html('');
          } else {
            related_html += '&lt;/ul&gt;';
            RELATED.r.append(related_html);
          }
        });
      });
    }
  }
  
  
  // search modules
  var LNM =
  {
    init: function () {
      LNM.url    = "http://api.lyricsnmusic.com/songs?callback=?"; 
      LNM.artist = escape($('#song span[itemprop="artist"]').text());
      LNM.title  = escape($('#song span[itemprop="name"]').text());
      LNM.r      = $('#lyricsResult');
      LNM.pingSearch();           
    }, 
    pingSearch: function (){
      if (LNM.artist &amp;&amp; LNM.title) {
        var lyricurl = LNM.url + '&amp;artist=' +  LNM.artist + '&amp;track=' + LNM.title;
      } else {
        var lyricurl = LNM.url + '&amp;q=' + escape($('title').text());
      }
      $.getJSON(lyricurl,function(lyric){
        LNM.r.html('');          
        if (lyric.data.length &gt; 0 ) {
          var lyrics_html = '&lt;li&gt;&lt;h5&gt;&lt;a href="' + lyric.data[0].url;
             lyrics_html += '" target="_blank"&gt;'+lyric.data[0].artist.name;
             lyrics_html += ' &ndash; ' + lyric.data[0].title + '&lt;/a&gt;&lt;/h5&gt;&lt;p&gt;&lt;small&gt;';
             lyrics_html += '&lt;i&gt;' + lyric.data[0].snippet.replace(/\n/g, '&ndash;');
             lyrics_html += '&lt;/i&gt;&lt;/small&gt;&lt;br/&gt;&lt;a class="more btn btn-mini btn-info pull-right" href="'
             lyrics_html += lyric.data[0].url + '" target="_blank"&gt;MORE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;';
          LNM.r.append(lyrics_html);
        } else {
          LNM.r.append('&lt;p&gt;&lt;small&gt;Sorry we can\'t find the lyrics. You can add them here:&lt;/small&gt;&lt;/p&gt;&lt;p&gt;&lt;a class="btn btn-mini btn-primary" href="http://www.lyricsnmusic.com" target="_blank"&gt;LYRICSnMUSIC&lt;i class="icon-share"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/p&gt;');
        }
      });
    }
  }
  
  var iTS = {
    init: function() {
      iTS.q = $('#song span[itemprop="artist"]').text()
            + ' - '
            + $('#song span[itemprop="name"]').text();
      iTS.r = $('#itunes');
      iTS.pingSearch();
    },
    pingSearch: function() {
      if (iTS.q) {
        iTS.src = 'http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/wa/wsSearch?limit=4'
            + '&amp;media=music'
            + '&amp;entity=musicTrack'
            + '&amp;term=' + escape(iTS.q)
            + '&amp;callback=iTS.pongSearch';
        $('head').append('&lt;script type="text/javascript" src="' + iTS.src +'" /&gt;');
      }
    },
    pongSearch: function(data) {
      iTS.r.html('');
      var output = '';
      if (data.resultCount &gt; 0) {
        $.each(data.results, function(i, result) {
          url = result.trackViewUrl + '&amp;at=11lqfm';
          var image_html = '&lt;li&gt;&lt;div class="image image-small-square pull-left"&gt;';
            image_html += '&lt;img src = "' + result.artworkUrl100;
            image_html += '" class="image-small-square"&gt;&lt;/div&gt;';
            image_html += '&lt;div class="image-info" style="padding-left: 55px;"&gt;';
            image_html += '&lt;p class="bottom"&gt;&lt;small&gt;&lt;a target="_blank" href="' + url;
            image_html += '" class="btn btn-mini btn-success pull-right"&gt;BUY&lt;/a&gt;&lt;a href="' + url;
            image_html += '" target="_blank"&gt;'+ result.trackName + (result.kind == 'music-video' ? '&lt;span class="play"&gt;&lt;/span&gt;' : '') + '&lt;/a&gt; ';
            if (result.collectionName) {
              image_html += '&lt;br /&gt;&lt;em&gt;from&lt;/em&gt; ' + result.collectionName;
            }
            image_html += '&lt;/small&gt;&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;';
          output = output + image_html;
        });
      } else {
        output = '&lt;p&gt;&lt;small&gt;No items found on iTunes Store.&lt;/small&gt;&lt;/p&gt;';
      }
      iTS.r.html(output).show();
    }
  }
  
  var AS = {
    init: function() {
      AS.url = "/amazon_search";
      AS.q = $('#song span[itemprop="artist"]').text()
            + ' - '
            + $('#song span[itemprop="name"]').text();
      AS.r = $('#amazon');
      AS.pingSearch();
    },
    pingSearch: function() {
      AS.r.html('');
      var output = '';
      if (AS.q) {
        as_url = AS.url
          + '?q=' +  encodeURIComponent(AS.q)
          + "&amp;callback=?";
        $.getJSON(as_url, {}, function(items) {
          if (items.length &gt; 0) {
            $.each(items, function(i, item) {
              if (i &lt; 4) {
                var image_html = '&lt;li&gt;&lt;div class="image image-small-square pull-left"&gt;';
                  image_html += '&lt;img src = "' + item.image;
                  image_html += '" class="image-small-square"&gt;&lt;/div&gt;';
                  image_html += '&lt;div class="image-info" style="padding-left: 55px;"&gt;';
                  image_html += '&lt;p class="bottom"&gt;&lt;small&gt;&lt;a target="_blank" href="' + item.url;
                  image_html += '" class="btn btn-mini btn-success pull-right"&gt;BUY&lt;/a&gt;&lt;a href="' + item.url;
                  image_html += '" target="_blank"&gt;'+ item.title + '&lt;/a&gt; ';
                  image_html += '&lt;/small&gt;&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;';
                output = output + image_html;
              }
            });
          } else {
            output = '&lt;p&gt;&lt;small&gt;No items found.&lt;/small&gt;&lt;/p&gt;';
          }
          AS.r.html(output).show();
        });
      }
    }
  }
  
  var AV = {
    init: function() {
      AV.url = "/amazon_search";
      AV.q = $('#song span[itemprop="artist"]').text()
            + ' - '
            + $('#song span[itemprop="name"]').text();
      AV.r = $('#vinyl');
      AV.pingSearch();
    },
    pingSearch: function() {
      AV.r.html('');
      var output = '';
      if (AV.q) {
        as_url = AV.url
          + '?q=' +  encodeURIComponent(AV.q)
          + "&amp;search_index=Music"
          + "&amp;format=Vinyl"
          + "&amp;callback=?";
        $.getJSON(as_url, {}, function(items) {
          if (items.length &gt; 0) {
            $.each(items, function(i, item) {
              if (i &lt; 4) {
                var image_html = '&lt;li&gt;&lt;div class="image image-small-square pull-left"&gt;';
                  image_html += '&lt;img src = "' + item.image;
                  image_html += '" class="image-small-square"&gt;&lt;/div&gt;';
                  image_html += '&lt;div class="image-info" style="padding-left: 55px;"&gt;';
                  image_html += '&lt;p class="bottom"&gt;&lt;small&gt;&lt;a target="_blank" href="' + item.url;
                  image_html += '" class="btn btn-mini btn-success pull-right"&gt;BUY&lt;/a&gt;&lt;a href="' + item.url;
                  image_html += '" target="_blank"&gt;'+ item.title + '&lt;/a&gt; ';
                  image_html += '&lt;/small&gt;&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;';
                output = output + image_html;
              }
            });
          } else {
            output = '&lt;p&gt;&lt;small&gt;No items found.&lt;/small&gt;&lt;/p&gt;';
          }
          AV.r.html(output).show();
        });
      }
    }
  }
  var ip = "199.30.80.107";
  var SK =
  {
    init : function () {
      SK.q = $('#song span[itemprop="artist"]').text();
      SK.r = $('#shows');
      SK.pingSearch();      
    },
    pingSearch : function (pg){
      if (pg) { SK.p = pg }
        start = (SK.p - 1) * 10;
      if (SK.q) {          
        SK.src = "http://api.songkick.com/api/3.0/events.json?"
                  + "artist_name=" + (SK.q).replace(' ', '+')
                  + "&amp;apikey=aut5f7ZxE6Y970VP"
                  + "&amp;page=1"
                  + "&amp;jsoncallback=?";
        var url = SK.src + '&amp;location=ip:' + ip;
        var ids = new Array();
        $.getJSON(url, {},       
          function(data){  
            if (data.resultsPage.totalEntries &gt; 0) {
              $('#btnShows').addClass('btn-city-tour');
              $('img#ontour').show();
              $.each(data.resultsPage.results.event, function(i,result){   
                var eventMonth = monthNames[Number(result.start.date.substr(5, 2)) - 1];
                var eventDate  = result.start.date.substr(8, 2);
                var str = '&lt;p&gt;&lt;small&gt;' + eventMonth + ' ' + eventDate + ', &lt;span class="muted"&gt;' + result.venue.metroArea.displayName + ', ' + result.venue.metroArea.country.displayName;
                str    += '&lt;/span&gt;&lt;/small&gt;&lt;a class="more btn btn-mini btn-info pull-right" href="' + result.uri + '" target="_blank"&gt;INFO&lt;/a&gt;&lt;br/&gt;&lt;strong&gt;&lt;a href="' + result.uri + '" target="_blank"&gt;' + result.displayName.replace(/\(.*\)$/, '') + '&lt;/a&gt;&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;';
                if (i != (data.resultsPage.totalEntries - 1)) {
                  str += '&lt;hr /&gt;';
                } else {
                  str += '&lt;div class="clear"&gt;&lt;/div&gt;';
                }                 
                ids.push(result.id);
                SK.r.append(str);
              });
            }
        });
        $.getJSON(SK.src, {},
          function(data){  
            if (data.resultsPage.totalEntries &gt; 0) {
              if (ids.length === 0) {
                $('#btnShows').addClass('btn-world-tour');
                $('img#ontour').show();
              }
              $.each(data.resultsPage.results.event, function(i,result){
                if ($.inArray(result.id, ids) == -1 ){
                  var eventMonth = monthNames[Number(result.start.date.substr(5, 2)) - 1];
                  var eventDate  = result.start.date.substr(8, 2);
                  var str = '&lt;p&gt;&lt;small&gt;' + eventMonth + ' ' + eventDate + ', &lt;span class="muted"&gt;' + result.venue.metroArea.displayName + ', ' + result.venue.metroArea.country.displayName;
                  str    += '&lt;/span&gt;&lt;/small&gt;&lt;a class="more btn btn-mini btn-info pull-right" href="' + result.uri + '" target="_blank"&gt;INFO&lt;/a&gt;&lt;br/&gt;&lt;strong&gt;&lt;a href="' + result.uri + '" target="_blank"&gt;' + result.displayName.replace(/\(.*\)$/, '') + '&lt;/a&gt;&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;';
                  if (i != (data.resultsPage.totalEntries - 1)) {
                    str += '&lt;hr /&gt;';
                  } else {
                    str += '&lt;div class="clear"&gt;&lt;/div&gt;';
                  }                                     
                  SK.r.append(str);
                }
              });
              SK.r.append('&lt;div class="logo tar"&gt;&lt;p&gt;&lt;img src="/assets/songkick-2c90f36d0c8044307e4006ebc392204b.png"&gt;&lt;/p&gt;&lt;/div&gt;');
              SK.r.append('');
            }  else {
              var event_search_url = "http://api.songkick.com/api/3.0/events.json?" 
                                     + "location=ip:" + ip 
                                     + "&amp;apikey=aut5f7ZxE6Y970VP"
                                     + "&amp;jsoncallback=?"
              $.getJSON(event_search_url, {}, 
                function(data){
                  SK.r.html('');
                  if (data.resultsPage.totalEntries &gt; 0){
                    SK.r.append('&lt;p&gt;&lt;small&gt;We could not find any shows for ' + SK.q + '. Here are some upcoming shows near you.&lt;/small&gt;&lt;/p&gt;');
                    $.each(data.resultsPage.results.event, function(i,result){
                      if (i &lt; 7) {
                        var eventMonth = monthNames[Number(result.start.date.substr(5, 2)) - 1];
                        var eventDate  = result.start.date.substr(8, 2);
                        var str        = '&lt;p&gt;&lt;small&gt;';
                        if ('undefined' !== typeof(result.end)) {
                          var endMonth = monthNames[Number(result.end.date.substr(5, 2)) - 1];
                          var endDate  = result.end.date.substr(8, 2);
                          if (endMonth == eventMonth &amp;&amp; endDate !== eventDate) {
                            str        += eventMonth + ' ' + eventDate + ' - ' + endDate + ' '
                          }
                          else if (endMonth == eventMonth &amp;&amp; endDate == eventDate) {
                            str        += eventMonth + ' ' + eventDate 
                          }
                          else {
                            str        += eventMonth + ' ' + eventDate + ' - ' + endMonth + ' ' + endDate
                          }
                        } else {
                          str         +=  eventMonth + ' ' + eventDate
                        }
                        str           += ', &lt;span class="muted"&gt;' + result.location.city;
                        str           += '&lt;/span&gt;&lt;/small&gt;&lt;a class="more btn btn-mini btn-info pull-right" href="' + result.uri + '" target="_blank"&gt;INFO&lt;/a&gt;&lt;br/&gt;&lt;strong&gt;';
                        str           += result.displayName + '&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;';
                        if (i != (data.resultsPage.totalEntries - 1)) {
                          str += '&lt;hr /&gt;';
                        } else {
                          str += '&lt;div class="clear"&gt;&lt;/div&gt;';
                        }                                     
                        SK.r.append(str);
                      }
                    });
                    SK.r.append('&lt;div class="logo tar"&gt;&lt;p&gt;&lt;img src="/assets/songkick-2c90f36d0c8044307e4006ebc392204b.png"&gt;&lt;/p&gt;&lt;/div&gt;');
                  } else {
                    SK.r.append('&lt;p&gt;&lt;small&gt;It does not appear there are any upcoming shows.&lt;/small&gt;&lt;/p&gt;');
                  }
                  SK.r.append('');
              });
            }
        });
      }
    }
  }
  
  var BIO =
  {
    init : function () {
      BIO.p = 1;
      BIO.url = "http://ws.audioscrobbler.com/2.0/?api_key=73581584905631c5fc15720f03b0b9c8&amp;format=json&amp;callback=?"; 
      BIO.q = $('#song span[itemprop="artist"]').text();
      BIO.r = $('#bioResult');
      BIO.pingSearch(); 
    }, 
    pingSearch : function (pg){
      if (pg) { BIO.p = pg }
        start = (BIO.p - 1) * 15;            
      if (BIO.q) {
        bio_url = BIO.url + '&amp;method=artist.getInfo&amp;page=1&amp;limit=1&amp;artist=' +  BIO.q;
        BIO.r.html(''); 
        $.getJSON(bio_url, {}, function(data){  
          if (typeof(data) !== 'undefined') {
            var bio_html = '&lt;li&gt;&lt;h5&gt;&lt;a href="' + data.artist.url;
            bio_html += '" target="_blank"&gt;'+ data.artist.name;
            bio_html += '\'s Bio&lt;/a&gt;&lt;/h5&gt;&lt;div class="image image-small-square pull-left"&gt;&lt;img src="';
            bio_html += data.artist.image[1]["#text"] +'" class="image-small-square"&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;';
            bio_html += data.artist.bio.summary + '&lt;/small&gt;&lt;br/&gt;&lt;a class="more btn btn-mini btn-info pull-right" href="' + data.artist.url + '" target="_blank"&gt;MORE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;';
            BIO.r.append(bio_html);
          } else {
            BIO.r.append('&lt;li&gt;&lt;p&gt;&lt;small&gt;No info available.&lt;/small&gt;&lt;/p&gt;&lt;/li&gt;');
          }
        });
      }
    }
  }
  
  var DISC =
  {
    init : function () {
      DISC.p = 1;
      DISC.url = "http://ws.audioscrobbler.com/2.0/?api_key=73581584905631c5fc15720f03b0b9c8&amp;format=json&amp;callback=?"; 
      DISC.q = $('#song span[itemprop="artist"]').text();
      DISC.r = $('#discographyResult');
      DISC.pingSearch(); 
    }, 
    pingSearch : function (pg){
      if (pg) { DISC.p = pg }
        start = (DISC.p - 1) * 15;            
      if (DISC.q) {
        disc_url = DISC.url + '&amp;method=artist.getTopAlbums&amp;page=1&amp;limit=10&amp;artist=' +  DISC.q;
        DISC.r.html(''); 
        $.getJSON(disc_url, {}, function(data){  
          if (typeof(data) !== 'undefined') {         
            $.each(data.topalbums.album, function(i, album) {
              if ('' != album.mbid) {
                var disc_html = '&lt;li class="accordion-group"&gt;&lt;h5 class="accordion-heading"&gt;';
                disc_html += '&lt;a class="playlist" data-toggle="collapse" data-parent="#discographyResult" href="#'+ album.mbid +'" data-id="'+ album.mbid + '"&gt;&lt;i class="icon-chevron-down pull-right"&gt;&lt;/i&gt;&lt;div class="image image-small-square pull-left"&gt;&lt;img src="' + album.image[1]["#text"] +'" class="image-small-square"&gt;';
                disc_html += '&lt;/div&gt;' + album.name + '&lt;/a&gt;&lt;/h5&gt;&lt;ul id="' + album.mbid + '" class="images image-list track accordion-body collapse"&gt;&lt;/ul&gt;&lt;div class="clear"&gt;&lt;/div&gt;&lt;/li&gt;';
                DISC.r.append(disc_html);
              }
            });
          } else {
            DISC.r.append('&lt;li&gt;&lt;p&gt;&lt;small&gt;No albums available.&lt;/small&gt;&lt;/p&gt;&lt;/li&gt;');
          }
        });
      }
    }
  }
  
  var TRACK =
  {
    init : function (id) {
      TRACK.p = 1;
      TRACK.url = "http://ws.audioscrobbler.com/2.0/?api_key=73581584905631c5fc15720f03b0b9c8&amp;format=json&amp;callback=?"; 
      TRACK.q = id;
      TRACK.r = $('#' + id);
      TRACK.pingSearch(); 
    }, 
    pingSearch : function (pg){
      if (pg) { TRACK.p = pg }
        start = (TRACK.p - 1) * 15;            
      if (TRACK.q) {
        disc_url = TRACK.url + '&amp;method=album.getInfo&amp;page=1&amp;mbid=' +  TRACK.q;
        TRACK.r.html('');           
        $.getJSON(disc_url, {}, function(data){              
          if (typeof(data) !== 'undefined') {
            if (data.album.tracks.track.length &gt; 0) {
              $.each(data.album.tracks.track, function(i, track) {
                var disc_html = '&lt;li class="track-search"&gt;&lt;small&gt;&lt;i class="icon-music"&gt;&lt;/i&gt;&nbsp;&lt;a href="javascript:void(0);" data-id="' + track.artist.name + ' - ' + track.name + '"&gt;';
                disc_html += track.name + '&lt;/small&gt;&lt;/a&gt;&lt;/h5&gt;&lt;div class="clear"&gt;&lt;/div&gt;&lt;/small&gt;&lt;/li&gt;';
                TRACK.r.append(disc_html);
              });
            } else {
              TRACK.r.append('&lt;li&gt;&lt;p&gt;No tracks available.&lt;/p&gt;&lt;/li&gt;');
            }
          } else {
            TRACK.r.append('&lt;li&gt;&lt;p&gt;No tracks available.&lt;/p&gt;&lt;/li&gt;');
          }
        });
      }
    }
  }
  
  var TT =
  {
    init : function () {
      TT.p = 1;
      TT.url = "http://ws.audioscrobbler.com/2.0/?api_key=73581584905631c5fc15720f03b0b9c8&amp;format=json&amp;callback=?"; 
      TT.q = $('#song span[itemprop="artist"]').text();
      TT.r = $('#topTracksResult');
      TT.pingSearch(); 
    }, 
    pingSearch : function (pg){
      if (pg) { TT.p = pg }
        start = (TT.p - 1) * 15;            
      if (TT.q) {
        TT_url = TT.url + '&amp;method=artist.getTopTracks&amp;page=1&amp;limit=7&amp;artist=' +  TT.q;
        TT.r.html(''); 
        $.getJSON(TT_url, {}, function(data){              
          if (data.toptracks["@attr"]["total"] &gt; 0) {
            $.each(data.toptracks.track, function(i, track) {
              var tt_html = '&lt;li class="track-search"&gt;&lt;h5&gt;&lt;div class="image image-small-square pull-left"&gt;&lt;img src="' + track.image[1]["#text"] +'" class="image-small-square"&gt;&lt;/div&gt;&lt;a href="javascript:void(0);" data-id="'+ TT.q + '-' +track.name + '"&gt;' + track.name;
              tt_html += '&lt;/a&gt;&lt;/h5&gt;&lt;div class="clear"&gt;&lt;/div&gt;&lt;/li&gt;';
              TT.r.append(tt_html);
            });
          } else {
            TT.r.append('&lt;li&gt;&lt;p&gt;No tracks available.&lt;/p&gt;&lt;/li&gt;');
          }
        });
      }
    }
  }
  
  // youtube callbacks
  var ytplayer = null,
      ytid     = null,
      scPlayer = null,
      fbAuth   = null;
  
  function loadYoutubePlayer(id) {
    if (!$('.player').hasClass('player-youtube')) {
      $('.player').removeClass('player-soundcloud').addClass('player-youtube');
      $('#sc-widget').hide();
      if (scPlayer) scPlayer.pause();
      $('#youtubePlayer').show();
    }
  
    if (ytplayer) {
      ytplayer.loadVideoById(id);
      ytplayer.playVideo();
    } else {
      ytid = id;
      var tag = document.createElement('script');
      tag.src = "//www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    }
  }
  
  function onYouTubeIframeAPIReady() {
    ytplayer = new YT.Player('youtubePlayer', {
      height: '480',
      width: '640',
      videoId: ytid,
      playerVars: {
        enablejsapi: 1,
        origin: 'http://www.songcrate.com/',
        wmode: 'opaque',
        autoplay: 1,
        cc_load_policy: 0,
        iv_load_policy: 3,
        rel: 0,
        modestbranding: 1,
        theme: 'dark'
      },
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }
  
  function loadSoundcloudPlayer(id) {
    if (!$('.player').hasClass('player-soundcloud')) {
      $('.player').removeClass('player-youtube').addClass('player-soundcloud');
      $('#youtubePlayer').hide();
      if (ytplayer) ytplayer.pauseVideo();
    }
  
    var track_url = 'http://api.soundcloud.com/tracks/' + id,
        play_options = {
          auto_play: true,
          buying: false,
          liking: false,
          download: false,
          sharing: false,
          show_artwork: false,
          show_comments: false,
          show_playcount: false};
    if (scPlayer) {
      $('#sc-widget').show();
      scPlayer.load(track_url, play_options);
    } else {
      SC.oEmbed(track_url, play_options, function(oEmbed) {
        $(oEmbed.html).attr('id', 'sc-widget').prependTo('.player');
        scPlayer = SC.Widget('sc-widget');
        //scPlayer.bind(SC.Widget.Events.READY, onPlayerReady);
        scPlayer.bind(SC.Widget.Events.FINISH, onPlayerStateChange);
      });
    }
  }
  </script>
  <script>
   window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '322554644500214', // App ID from the App Dashboard
      channelUrl : 'http://www.songcrate.com/channel', // Channel File for x-domain communication
      status     : true, // check the login status upon init?
      cookie     : true, // set sessions cookies to allow your server to access the session?
      xfbml      : true  // parse XFBML tags on this page?
    });
  
    // Additional initialization code such as adding Event Listeners goes here
    FB.getLoginStatus(function(response) {
      if (response &amp;&amp; 'connected' == response.status) {
        fbAuth = response.authResponse;
  
        $.getScript('/play_sharing?provider=facebook&amp;uid='+fbAuth.userID);
        // send watch to facebook after 15s
        setTimeout(function() {
          if ('ON' == $('#fb-play-switch').text()) {
            $('#fb-play-status').text('sending to facebook...');
            FB.api('/me/video.watches', 'post', {
              video: document.location.toString(),
              access_token: fbAuth.accessToken,
            }, function(response) {
              if (response &amp;&amp; response.id) {
                $('#fb-play-status').text('');
                $('#fb-play-status').append(
                  '&lt;a class="fb-play-cancel" data-fbid="'+response.id+'" href="#"&gt;remove just this video from my timeline&lt;/a&gt;'
                );
              }
            });
          }
        }, 15000);
      }
    });
  };
  
  $(document).ready(function() {
    loadYoutubePlayer('NR-H2uFCQls');
  
    // Load the SDK's source Asynchronously
    (function(d, debug){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
       ref.parentNode.insertBefore(js, ref);
     }(document, /*debug*/ false));
  
    $('#fb-play-switch').popover({
      placement: 'bottom',
      content: '&lt;p align="center"&gt;This means that you\'re sharing the videos you watch with your friends. Change this at any time by clicking above button.&lt;/p&gt;&lt;br /&gt;&lt;p align="center"&gt;&lt;a class="btn btn-small btn-success" onclick="javascript:$(\'#fb-play-switch\').popover(\'hide\');$(\'#youtubePlayer\').css(\'visibility\',\'visible\');"&gt;Okay, Got It!&lt;/a&gt;&lt;/p&gt;',
      html: true,
      title: 'Social sharing is on',
      trigger: 'manual'
    });
  
    $('#fb-play-switch').click(function() {
      $.post('/play_sharing', {
        play_sharing: {provider: 'facebook', uid: fbAuth.userID}});
    });
    $('#fb-play-status').on('click', '.fb-play-cancel', function() {
      $('#fb-play-status').text('deleting from facebook timeline...');
      FB.api($(this).attr('data-fbid'), 'delete', {
          accessToken: fbAuth.accessToken}, function(response) {
        if (!response || response.error) {
          alert('Error occured');
        } else {
          $('#fb-play-status').text('Successfully deleted from facebook timeline.');
        }
      });
      return(false);
    });
  });
  </script>
  <script>
   var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33379933-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
  <div id="fb-root">
  </div>
  <script>
   var fbAuth;
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '322554644500214', // App ID from the App Dashboard
      channelUrl : 'http://www.songcrate.com/channel', // Channel File for x-domain communication
      status     : true, // check the login status upon init?
      cookie     : true, // set sessions cookies to allow your server to access the session?
      xfbml      : true  // parse XFBML tags on this page?
    });
  };
  
  // Load the SDK's source Asynchronously
  (function(d, debug) {
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) { return; }
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
     ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  </script>
 </body>
</html>