<!DOCTYPE html>
<html xmlns:cc="http://creativecommons.org/ns#">
 <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport" user-scalable="no"/>
  <title>
   On Taxis and Rainbows  Medium
  </title>
  <link href="https://medium.com/@vijayp/of-taxis-and-rainbows-f6bc289679a1" rel="canonical"/>
  <meta content="On Taxis and Rainbows" name="title"/>
  <meta content="always" name="referrer"/>
  <meta content="Lessons from NYCs improperly anonymized taxi logs" name="description"/>
  <meta content="Medium" property="og:site_name"/>
  <meta content="On Taxis and Rainbows" property="og:title"/>
  <meta content="https://medium.com/@vijayp/of-taxis-and-rainbows-f6bc289679a1" property="og:url"/>
  <meta content="https://d262ilb51hltx0.cloudfront.net/max/800/1*kIavzAnNLDGeOHUlYF1Hww.jpeg" property="og:image"/>
  <meta content="542599432471018" property="fb:app_id"/>
  <meta content="Lessons from NYCs improperly anonymized taxi logs" property="og:description"/>
  <meta content="@Medium" name="twitter:site"/>
  <meta content="https://d262ilb51hltx0.cloudfront.net/max/800/1*kIavzAnNLDGeOHUlYF1Hww.jpeg" name="twitter:image:src"/>
  <link href="https://plus.google.com/103654360130207659246" rel="publisher"/>
  <link href="https://medium.com/@vijayp" rel="author"/>
  <meta content="Vijay Pandurangan" name="author"/>
  <meta content="article" property="og:type"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="https://www.facebook.com/medium" property="article:publisher"/>
  <meta content="https://medium.com/@vijayp" property="article:author"/>
  <meta content="noauto" property="fb:smart_publish:robots"/>
  <meta content="2014-06-21T22:31:50.890Z" property="article:published_time"/>
  <meta content="@vijayp" name="twitter:creator"/>
  <meta content="Medium" name="twitter:app:name:iphone"/>
  <meta content="828256236" name="twitter:app:id:iphone"/>
  <meta content="medium:/p/f6bc289679a1" name="twitter:app:url:iphone"/>
  <meta content="Medium" property="al:ios:app_name"/>
  <meta content="828256236" property="al:ios:app_store_id"/>
  <meta content="medium:/p/f6bc289679a1" property="al:ios:url"/>
  <meta content="https://medium.com/@vijayp/of-taxis-and-rainbows-f6bc289679a1" property="al:web:url"/>
  <meta content="#000000" name="theme-color"/>
  <link href="https://dnqgz544uhbo8.cloudfront.net/_/fp/css/main-base.z6B00ig_91n1ztoWRcwpGw.css" rel="stylesheet"/>
  <script>
   if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_fontLoaded = 0; var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}var _gaq = _gaq || []; _gaq.push(["_setAccount", "UA-24232453-2"]); _gaq.push(["_setDomainName", window.location.hostname]); _gaq.push(["_setAllowLinker", true]); _gaq.push(["_trackPageview"]); _asyncScript(("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js");(new Image()).src = "/_/stat?event=pixel.load&amp;origin=" + encodeURIComponent(location.origin);
  </script>
  <script>
   _asyncStyles('https:\/\/dnqgz544uhbo8.cloudfront.net\/_\/fp\/css\/main-sprites.1B2M2Y8AsgTpgAmY7PhCfg.css')
  </script>
  <link href="/manifest.json" rel="manifest"/>
  <script>
   (function () {var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight; document.write("&lt;style&gt;section.section-image--fullBleed {padding-top: " + Math.round(1.1 * height) + "px;}section.section-image--fullScreen, section.section-image--coverFade {min-height: " + height + "px; padding-top: " + Math.round(0.5 * height) + "px;}.u-sizeViewHeight100 {height: " + height + "px !important;}.u-sizeViewHeightMin100 {min-height: " + height + "px !important;}section.section-image--coverFade, .section-image--fullScreen &gt; .section-background, .section-image--coverFade &gt; .section-background, .section-image--fullBleed .section-backgroundImage, .section-image--fullScreen .section-backgroundImage, .section-image--coverFade .section-backgroundImage {height: " + height + "px;}.section-image--content &gt; .section-background, .section-image--content .section-backgroundImage, .section-aspectRatioViewportPlaceholder, .section-aspectRatioViewportCropPlaceholder {max-height: " + height + "px;}.section-image--fullBleed &gt; .section-background {height: " + Math.round(1.1 * height) + "px;}.section-aspectRatioViewportBottomSpacer, .section-aspectRatioViewportBottomPlaceholder {max-height: " + Math.round(0.5 * height) + "px;}&lt;/style&gt;");})()&lt;/script&gt;&lt;!--[if lt IE 9]&gt;&lt;script charset="UTF-8" src="https://dnqgz544uhbo8.cloudfront.net/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"&gt;
  </script>
  <link href="https://dnqgz544uhbo8.cloudfront.net/_/fp/icons/favicon.n7eHNqdWyHhbTLN2-3a-6g.ico" rel="shortcut icon"/>
  <link href="/apple-touch-icon-precomposed-152.png" rel="apple-touch-icon-precomposed" sizes="152x152"/>
  <link href="/apple-touch-icon-precomposed-120.png" rel="apple-touch-icon-precomposed" sizes="120x120"/>
  <link href="/apple-touch-icon-precomposed-76.png" rel="apple-touch-icon-precomposed" sizes="76x76"/>
  <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed"/>
 </head>
 <body class=" template-flex-article js-loading " itemscope="" itemtype="http://schema.org/Article">
  <div class="site-main" id="container">
   <div class="butterBar butterBar--error">
   </div>
   <div class="surface">
    <div class="screenContent" id="prerendered">
     <canvas class="canvas-renderer">
     </canvas>
     <nav class="metabar u-clearfix js-metabar metabar--top metabar--postArticle ">
      <div class="metabar-block metabar-left u-floatLeft">
       <a class="siteNav-logo" data-log-event="home" href="https://medium.com/">
        <span class="icon icon--logoM">
        </span>
        <span class="u-textScreenReader">
         Homepage
        </span>
       </a>
      </div>
      <div class="metabar-block metabar-center">
       <span class="postCollectionManagement js-postCollectionManagement postMetaInline u-hide u-xs-hide">
        <button class="button button--withChrome button--withIcon button--withIconAndLabel button--withIconRight" data-action="show-editor-request-to-add-panel">
         <span class="button-label ">
          Request story
         </span>
         <span class="icon is-pulledRight icon--arrowDownThin">
         </span>
        </button>
       </span>
      </div>
      <div class="metabar-block metabar-right u-floatRight">
       <div class="buttonSet">
       </div>
       <div class="inputGroup u-xs-hide metabar-predictiveSearch">
        <button aria-label="Click to start typing a search term" class="button button--chromeless button--inline button--withIcon is-inSiteNavBar button--withSvgIcon" data-action="focus-search-input" title="Click to start typing a search term">
         <svg class="svgIcon svgIcon--search svgIcon-size--25px" height="25" viewbox="0 0 25 25" width="25">
          <use xlink:href="#svg-search25px">
          </use>
         </svg>
        </button>
        <input class="js-predictiveSearchInput textInput textInput--rounded textInput--dark" placeholder="Search Medium" type="search"/>
       </div>
       <div class="buttonSet">
        <button aria-label="Search" class="button button--circle button--withChrome button--withIcon is-inSiteNavBar u-showOnMobile button--withSvgIcon" data-action="open-search" title="Search">
         <svg class="svgIcon svgIcon--search svgIcon-size--25px" height="25" viewbox="0 0 25 25" width="25">
          <use xlink:href="#svg-search25px">
          </use>
         </svg>
        </button>
        <a class="button button--primary button--withChrome" data-action="sign-in-prompt" data-action-source="nav_signup" data-redirect="https://medium.com:443/@vijayp/of-taxis-and-rainbows-f6bc289679a1" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%3A443%2F%40vijayp%2Fof-taxis-and-rainbows-f6bc289679a1">
         Sign in / Sign up
        </a>
       </div>
      </div>
     </nav>
     <div class="metabar u-clearfix metabar--bottom metabar--bordered metabar--social metabar--postSecondaryBar js-postSecondaryBar">
      <div class="metabar-block metabar-left u-floatLeft">
       <span class="postMetaInline postMetaInline--avatar">
        <a aria-label="Go to the profile of Vijay Pandurangan" class="link link--secondary avatar" dir="auto" href="https://medium.com/@vijayp" title="Go to the profile of Vijay Pandurangan">
         <img alt="Go to the profile of Vijay Pandurangan" class="avatar-image avatar-image--icon" src="https://d262ilb51hltx0.cloudfront.net/fit/c/32/32/0*MqVkP4Yu0E0GNrCh.jpeg"/>
        </a>
       </span>
       <span class="postMetaInline postMetaInline--authorDateline">
        <a aria-label="Go to the profile of Vijay Pandurangan" class="link link--secondary" dir="auto" href="https://medium.com/@vijayp" title="Go to the profile of Vijay Pandurangan">
         Vijay Pandurangan
        </a>
        <span class="u-showOnTabletMini">
         <br/>
        </span>
        <span class="u-noWrap" data-tooltip="Updated Jun 27, 2014">
         <span class="u-xs-hide">
          on
         </span>
         <time class="post-date">
          Jun 21, 2014
         </time>
         <span class="middotDivider">
         </span>
         5 min
        </span>
       </span>
      </div>
      <div class="metabar-block metabar-right u-floatRight">
       <div class="voteWidget voteWidget--secondaryBar js-voteWidgetSecondaryBar is-iconVisible">
       </div>
       <div class="metabar-shareActions">
        <button aria-label="Recommend to share this article with your followers and let the author know you liked it" class="button button--chromeless button--social button--recommend js-recommendButton" data-action="sign-in-prompt" data-action-source="metabar_recommend" data-redirect="https://medium.com/_/vote/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="upvote" title="Recommend to share this article with your followers and let the author know you liked it">
         <span class="icon icon--heart2Outline">
         </span>
         <span class="icon icon--heart2">
         </span>
        </button>
        <button aria-label="Bookmark this story to read later" class="button button--chromeless button--social js-bookmarkButton" data-action="sign-in-prompt" data-action-source="metabar_bookmark" data-redirect="https://medium.com/_/bookmark/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="add-to-bookmarks" title="Bookmark this story to read later">
         <span class="icon icon--readingList2outline">
         </span>
         <span class="icon icon--readingList2">
         </span>
        </button>
        <button aria-label="Share this story on Twitter, Facebook, or email" class="button button--chromeless u-showOnMobile button--withIcon button--social" data-action="toggle-share-drawer" data-action-source="metabar_share_mobile" data-action-value="f6bc289679a1" title="Share this story on Twitter, Facebook, or email">
         <span class="icon icon--share2Outline">
         </span>
        </button>
        <button aria-label="Share this story on Twitter, Facebook, or email" class="button button--chromeless u-xs-hide button--withIcon button--social" data-action="show-share-popover" data-action-source="metabar_share" data-action-value="f6bc289679a1" title="Share this story on Twitter, Facebook, or email">
         <span class="icon icon--share2Outline">
         </span>
        </button>
       </div>
       <div class="metabar-readNext js-metabarReadNext">
        <button class="button button--chromeless">
         Next story
        </button>
       </div>
      </div>
     </div>
     <div class="metabar u-clearfix metabar--bottom metabar--social metabar--peekaboo js-persistentShareFooter">
      <div class="metabar-block metabar-left u-floatLeft">
      </div>
      <div class="metabar-block metabar-center">
       <div class="metabar-readNext metabar-readNext--bottom js-metabarReadNextMobile">
        <button class="button button--chromeless">
         Next story
        </button>
       </div>
       <div class="metabar-shareActions">
        <button aria-label="Recommend to share this article with your followers and let the author know you liked it" class="button button--chromeless button--social button--recommend js-recommendButton" data-action="sign-in-prompt" data-action-source="metabar_recommend" data-redirect="https://medium.com/_/vote/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="upvote" title="Recommend to share this article with your followers and let the author know you liked it">
         <span class="icon icon--heart2Outline">
         </span>
         <span class="icon icon--heart2">
         </span>
        </button>
        <button aria-label="Bookmark this story to read later" class="button button--chromeless button--social js-bookmarkButton" data-action="sign-in-prompt" data-action-source="metabar_bookmark" data-redirect="https://medium.com/_/bookmark/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="add-to-bookmarks" title="Bookmark this story to read later">
         <span class="icon icon--readingList2outline">
         </span>
         <span class="icon icon--readingList2">
         </span>
        </button>
        <button aria-label="Share this story on Twitter, Facebook, or email" class="button button--chromeless u-showOnMobile button--withIcon button--social" data-action="toggle-share-drawer" data-action-source="metabar_share_mobile" data-action-value="f6bc289679a1" title="Share this story on Twitter, Facebook, or email">
         <span class="icon icon--share2Outline">
         </span>
        </button>
        <button aria-label="Share this story on Twitter, Facebook, or email" class="button button--chromeless u-xs-hide button--withIcon button--social" data-action="show-share-popover" data-action-source="metabar_share" data-action-value="f6bc289679a1" title="Share this story on Twitter, Facebook, or email">
         <span class="icon icon--share2Outline">
         </span>
        </button>
       </div>
       <div class="metabar-drawer">
        <div class="metabar-drawerWarning">
         The author chose to make this story unlisted, which means only people with a link can see it. Are you sure you want to share it?
         <button class="button button--chromeless" data-action="ignore-share-drawer-warning">
          Yes, show me sharing options
         </button>
        </div>
        <div class="metabar-drawerContent">
         <h4 class="metabar-drawerTitle">
          On Taxis and Rainbows
         </h4>
         <ul class="list">
          <li>
           <button class="button button--chromeless" data-action="share-on-twitter" data-action-source="metabar_mobile" data-action-value="f6bc289679a1">
            <span class="icon icon--twitter">
            </span>
            Share on Twitter
           </button>
          </li>
          <li>
           <button class="button button--chromeless" data-action="share-on-facebook" data-action-source="metabar_mobile" data-action-value="f6bc289679a1">
            <span class="icon icon--facebook">
            </span>
            Share on Facebook
           </button>
          </li>
         </ul>
        </div>
       </div>
      </div>
     </div>
     <div class="logo-container">
     </div>
     <article class="u-sizeViewHeightMin100 postArticle postArticle--full is-languageTier1" data-allow-notes="true" lang="en">
      <header class="postArticle-header container u-size740">
      </header>
      <div class="postArticle-content js-postField js-notesSource" role="main">
       <section class=" section--body section--bottomCenter section-image--coverFade is-imageBackgrounded is-backgrounded is-darkBackgrounded section--first is-aboveSectionCaption">
        <div class="section-background" contenteditable="false" data-height="1088" data-image-id="1*kIavzAnNLDGeOHUlYF1Hww.jpeg" data-width="2048">
         <div class="section-backgroundImage" style="background-image: url(https://d262ilb51hltx0.cloudfront.net/fit/t/1200/960/gradv/29/81/55/1*kIavzAnNLDGeOHUlYF1Hww.jpeg);">
         </div>
         <br/>
        </div>
        <div class="section-coverFadePadding u-ignoreBlock">
         <div class="section-content" data-scroll="cover-fade">
          <div class="section-inner layoutSingleColumn">
           <h2 class="graf--h2 graf--first" id="title" name="title">
            On Taxis and Rainbows
           </h2>
           <h4 class="graf--h4" id="subtitle" name="subtitle">
            Lessons from NYCs improperly anonymized taxi logs
           </h4>
          </div>
         </div>
        </div>
        <div class="section-captionContent u-ignoreBlock">
         <div class="section-inner sectionLayout--caption">
          <label class="graf--sectionCaption graf--last" data-default-value="Type caption for image (optional)" id="coverCaption" name="coverCaption">
           Photo by @vijayp
          </label>
         </div>
        </div>
       </section>
       <section class=" section--body" name="4100">
        <div class="section-divider layoutSingleColumn">
         <hr class="section-divider"/>
        </div>
        <div class="section-content">
         <div class="section-inner layoutSingleColumn">
          <p class="graf--p graf--first" id="a83b" name="a83b">
           Recently, thanks to a Freedom of Information request,
           <a class="markup--anchor markup--p-anchor" data-href="https://twitter.com/@chris_whong" href="https://twitter.com/@chris_whong" rel="nofollow">
            Chris Whong
           </a>
           received and made public a
           <a class="markup--anchor markup--p-anchor" data-href="http://chriswhong.com/open-data/foil_nyc_taxi/" href="http://chriswhong.com/open-data/foil_nyc_taxi/" rel="nofollow">
            complete dump of historical trip and fare logs from NYC taxis
           </a>
           . Its pretty incredible: there are over 20GB of uncompressed data comprising more than
           <strong class="markup--strong markup--p-strong">
            173 million
           </strong>
           individual trips. Each trip record includes the pickup and dropoff location and time, anonymized hack licence number and medallion number (i.e. the taxis unique id number, 3F38, in my photo above), and other metadata.
          </p>
          <p class="graf--p graf--last" id="d763" name="d763">
           These data are a veritable trove for people who love cities, transit, and data visualization. But theres a big problem: the personally identifiable information (the drivers licence number and taxi number) hasnt been anonymized properlywhats worse, its trivial to undo, and with other publicly available data, one can even figure out which person drove each trip. In the rest of this post, Ill describe the structure of the data, what the person/people who released the data did wrong, how easy it is to deanonymize, and the lessons other agencies should learn from this. (And yes, Ill also explain how rainbows fit in).
          </p>
         </div>
        </div>
       </section>
       <section class=" section--body" name="e2d7">
        <div class="section-divider layoutSingleColumn">
         <hr class="section-divider"/>
        </div>
        <div class="section-content">
         <div class="section-inner layoutSingleColumn">
          <p class="graf--p graf--first" id="4e34" name="4e34">
           The NYC taxi data consist of a number of
           <a class="markup--anchor markup--p-anchor" data-href="https://en.wikipedia.org/wiki/Comma-separated_values" href="https://en.wikipedia.org/wiki/Comma-separated_values" rel="nofollow">
            CSV
           </a>
           -files, each with lines that look like this:
          </p>
          <pre class="graf--pre" id="1b4a" name="1b4a">
           6B111958A39B24140C973B262EA9FEA5,D3B035A03C8A34DA17488129DA581EE7,VTS,5,,2013-12-03 15:46:00,2013-12-03 16:47:00,1,3660,22.71,-73.813927,40.698135,-74.093307,40.829346
          </pre>
          <p class="graf--p" id="2f5a" name="2f5a">
           Each of these columns correspond to the following fields:
          </p>
          <pre class="graf--pre" id="122c" name="122c">
           medallion,hack_license,vendor_id,rate_code,store_and_fwd_flag,pickup_datetime,dropoff_datetime,passenger_count,trip_time_in_secs
          </pre>
          <p class="graf--p" id="742c" name="742c">
           Its pretty obvious what format most of the fields are in (lon/lat, timestamp) but the first two columns demonstrate that the government folks clearly intended to anonymize the medallion and licence numbers. Its obvious that the alphanumeric codes are not purely random, the same taxi and same driver always has the same code throughout the data. This isnt necessarily a problemin fact, preserving this property is often of critical importance when anonymizing data. Imagine a search engine engineer who wants to analyse user behaviour in aggregate: its important that the same user has the same code throughout the set of logs that are being analysed, so that you can see what a user does over time. Its obviously also critical that its not possible to go backwards from the code to the users name.
          </p>
          <p class="graf--p" id="8b2f" name="8b2f">
           Someone on Reddit pointed out that one
           <a class="markup--anchor markup--p-anchor" data-href="http://www.reddit.com/r/bigquery/comments/28ialf/173_million_2013_nyc_taxi_rides_shared_on_bigquery/cicr3n2" href="http://www.reddit.com/r/bigquery/comments/28ialf/173_million_2013_nyc_taxi_rides_shared_on_bigquery/cicr3n2" rel="nofollow">
            specific driver seemed to be doing an incredible amount of business
           </a>
           . When faced with anomalous data like that, its good practice to weed out data error before jumping to conclusions about cheating taxi drivers. Also, I couldnt shake the feeling that there was something about that encoded id number: CFCD208495D565EF66E7DFF9F98764DA. After a little bit of poking around, I realised that that code is actually the MD5 hash of the character 0. This proved my suspicion that this was actually a data collection error, but also made me immediately realise that the entire anonymization process was flawed and could easily be reversed.
          </p>
          <p class="graf--p" id="5bc6" name="5bc6">
           A
           <a class="markup--anchor markup--p-anchor" data-href="https://en.wikipedia.org/wiki/Cryptographic_hash_function" href="https://en.wikipedia.org/wiki/Cryptographic_hash_function" rel="nofollow">
            cryptographically secure hashing function
           </a>
           , like MD5 is a one-way function: it always turns the same input to the same output, but given the output, its pretty hard to figure out what the input was
           <em class="markup--em markup--p-em">
            as long as you dont know anything about what the input might look like
           </em>
           . This is mostly what youd like out of an anonymization function. The problem, however, is that in this case we know a
           <em class="markup--em markup--p-em">
            lot
           </em>
           about what the inputs look like.
          </p>
          <p class="graf--p" id="9324" name="9324">
           In NYC, taxi licence numbers are 6-digit
           <em class="markup--em markup--p-em">
            [Edit: (6-digit numbers may start with any digit and are sometimes zero-padded)]
           </em>
           , or 7-digit numbers starting with a 5. That means that there are only about 3M possible taxi licence numbers. Similarly, medallion numbers conform to a very specific pattern:
          </p>
          <pre class="graf--pre" id="c185" name="c185">
           one number, one letter, two numbers. For example: 5X55
           <br/>
           two letters, three numbers. For example: XX555
           <br/>
           three letters, three numbers. For example: XXX555
          </pre>
          <p class="graf--p" id="f514" name="f514">
           <em class="markup--em markup--p-em">
            [Edit: I fixed my math thanks (thanks
           </em>
           <a class="markup--anchor markup--p-anchor" data-href="https://twitter.com/duckblog" href="https://twitter.com/duckblog" rel="nofollow">
            <em class="markup--em markup--p-em">
             Paul
            </em>
           </a>
           <em class="markup--em markup--p-em">
            )]
           </em>
           There are about 1000*27*26 = 18954000 or ~19M possible medallion numbers. So, by calculating the md5 hashes of all these numbers (only 22M!), one can completely deanonymise the entire data. Modern computers are fast: so fast that
           <a class="markup--anchor markup--p-anchor" data-href="https://github.com/vijayp/nyc-taxi/blob/master/create_hashes.py" href="https://github.com/vijayp/nyc-taxi/blob/master/create_hashes.py" rel="nofollow">
            computing the 22M hashes
           </a>
           took less than 2 minutes. The resulting table of hashed-data to input data is called a
           <strong class="markup--strong markup--p-strong">
            <em class="markup--em markup--p-em">
             Rainbow Table.
            </em>
           </strong>
           <em class="markup--em markup--p-em">
            [Edit: people have pointed out that this may not meet the exact requirements to be called a rainbow table]
           </em>
          </p>
          <p class="graf--p" id="86e1" name="86e1">
           It took a while longer to
           <a class="markup--anchor markup--p-anchor" data-href="https://github.com/vijayp/nyc-taxi/blob/master/deanonymise.py" href="https://github.com/vijayp/nyc-taxi/blob/master/deanonymise.py" rel="nofollow">
            de-anonymize the entire dataset
           </a>
           , but thanks to Yelps
           <a class="markup--anchor markup--p-anchor" data-href="https://github.com/Yelp/mrjob" href="https://github.com/Yelp/mrjob" rel="nofollow">
            MRJob
           </a>
           , I ran a map-reduce over about 10 computers on
           <a class="markup--anchor markup--p-anchor" data-href="https://aws.amazon.com/elasticmapreduce/" href="https://aws.amazon.com/elasticmapreduce/" rel="nofollow">
            EMR
           </a>
           and had it done within an hour. Theres a ton of resources on NYC Taxi and Limousine commission, including a mapping from licence number to driver name, and a way to look up owners of medallions. I havent linked them here but its easy to find using a quick Google search.
          </p>
          <p class="graf--p" id="6fe0" name="6fe0">
           Here are a few de-anonymized lines I picked at random:
          </p>
          <pre class="graf--pre" id="8561" name="8561">
           9Y99,5296319,VTS,1,,2013-12-06 00:07:00,2013-12-06 00:16:00,5,540,1.85,-73.97953,40.776447,-73.982254,40.754925
          </pre>
          <pre class="graf--pre" id="11c9" name="11c9">
           9Y99,5296319,VTS,1,,2013-12-06 00:20:00,2013-12-06 00:46:00,5,1560,6.58,-73.985779,40.757317,-73.984543,40.681244
          </pre>
          <pre class="graf--pre" id="42bd" name="42bd">
           DIP1,111333,VTS,1,,2013-12-03 12:10:00,2013-12-03 12:24:00,5,840,.00,0,0,0,0
          </pre>
          <pre class="graf--pre graf--last" id="26fa" name="26fa">
           SBV106,429925,VTS,1,,2013-12-05 23:04:00,2013-12-05 23:16:00,6,720,2.86,-73.988197,40.731232,-73.96199,40.764343
          </pre>
         </div>
        </div>
       </section>
       <section class=" section--body section--last" name="7085">
        <div class="section-divider layoutSingleColumn">
         <hr class="section-divider"/>
        </div>
        <div class="section-content">
         <div class="section-inner layoutSingleColumn">
          <p class="graf--p graf--first" id="a995" name="a995">
           Security researchers have been warning for a while that
           <a class="markup--anchor markup--p-anchor" data-href="https://www.truste.com/blog/2013/04/16/data-anonymization/" href="https://www.truste.com/blog/2013/04/16/data-anonymization/" rel="nofollow">
            simply using hash functions is an ineffective way to anonymize data
           </a>
           . In this case, its substantially worse because of the structured format of the input data. This anonymization is so poor that anyone could, with less then 2 hours work, figure which driver drove every single trip in this entire dataset. It would be even be easy to calculate drivers gross income, or infer where they live.
          </p>
          <p class="graf--p" id="9a5b" name="9a5b">
           There are a number of ways these data could have been better anonymized. Two good ones include:
          </p>
          <ul class="postList">
           <li class="graf--li" id="ccb4" name="ccb4">
            assigning a totally random number to each hack licence number and medallion number once, and re-using it throughout the dump file
           </li>
           <li class="graf--li" id="ad08" name="ad08">
            creating a secret AES key, and encrypting each value individually
           </li>
          </ul>
          <p class="graf--p" id="011c" name="011c">
           <em class="markup--em markup--p-em">
            [Edit: As always, things are more complicated than they seem at first. The strategies described above will anonymise the numbers of the licences and taxicabs, but
           </em>
           <a class="markup--anchor markup--p-anchor" data-href="https://news.ycombinator.com/item?id=7927025" href="https://news.ycombinator.com/item?id=7927025" rel="nofollow">
            <em class="markup--em markup--p-em">
             commenters have pointed out
            </em>
           </a>
           <em class="markup--em markup--p-em">
            that there are a number of other ways in whch PII may be reconstructed. The most interesting is
           </em>
           <a class="markup--anchor markup--p-anchor" data-href="https://www.cs.utexas.edu/~shmat/shmat_oak08netflix.pdf" href="https://www.cs.utexas.edu/~shmat/shmat_oak08netflix.pdf" rel="nofollow">
            <em class="markup--em markup--p-em">
             Narayanan and Shmatikovs algorithm
            </em>
           </a>
           <em class="markup--em markup--p-em">
            . NYC is dense enough that it may be much more challenging to target specific passengers using these data, however. Anonymizing data is really hard.]
           </em>
          </p>
          <p class="graf--p" id="68bf" name="68bf">
           The cat is already out of the bag in this case, but hopefully in the future, agencies will think carefully about the method they use to anonymize data before releasing it to the public.
          </p>
          <p class="graf--p graf--last" id="32c7" name="32c7">
           Edit: this is up on
           <a class="markup--anchor markup--p-anchor" data-href="https://news.ycombinator.com/item?id=7926358" href="https://news.ycombinator.com/item?id=7926358" rel="nofollow">
            hackernews
           </a>
           . Please feel free to comment there
          </p>
         </div>
        </div>
       </section>
      </div>
      <footer class="postArticle-footer">
       <div class="postFooter--simple2 supplementalPostContent js-postFooter">
        <div class="container u-size740">
         <div class="row">
          <div class="col u-xs-size12of12">
           <div class="u-clearfix postFooter-actions--simple2">
            <div class="u-floatLeft">
             <button aria-label="Recommend to share this article with your followers and let the author know you liked it" class="button button--primary button--withChrome button--withIcon button--withIconAndLabel button--recommend js-recommendButton" data-action="sign-in-prompt" data-action-source="footer_recommend" data-redirect="https://medium.com/_/vote/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="upvote" title="Recommend to share this article with your followers and let the author know you liked it">
              <span class="icon icon--heart2Outline75 button-defaultState">
              </span>
              <span class="icon icon--heart2 button-activeState">
              </span>
              <span class="button-label button-defaultState">
               Recommend
              </span>
              <span class="button-label button-activeState">
               Recommended
              </span>
             </button>
             <div class="voteWidget voteWidget--footer js-voteWidget">
             </div>
            </div>
            <div class="u-floatRight">
             <div class="buttonSet">
              <button aria-label="Bookmark this story to read later" class="button button--vertical button--withChrome button--withIcon button--withIconAndLabel button--bookmark js-bookmarkButton" data-action="sign-in-prompt" data-action-source="footer_bookmark" data-redirect="/_/bookmark/p/f6bc289679a1" data-requires-token="true" data-sign-in-action="add-to-bookmarks" title="Bookmark this story to read later">
               <span class="icon icon--readingList2outline button-defaultState">
               </span>
               <span class="icon icon--readingList2 button-activeState">
               </span>
               <span class="button-label button-defaultState">
                Bookmark
               </span>
               <span class="button-label button-activeState">
                Bookmarked
               </span>
              </button>
              <button aria-label="Share this story on Twitter, Facebook, or email" class="button button--vertical button--withChrome button--withIcon button--withIconAndLabel button--share" data-action="show-share-popover" data-action-source="footer_share" data-action-value="f6bc289679a1" title="Share this story on Twitter, Facebook, or email">
               <span class="icon icon--share2Outline">
               </span>
               <span class="button-label ">
                Share
               </span>
              </button>
              <button aria-label="More actions" class="button button--vertical u-xs-hide button--withChrome button--withIcon button--withIconAndLabel button--more" data-action="more-actions" title="More actions">
               <span class="icon icon--arrowDownThin">
               </span>
               <span class="button-label ">
                More
               </span>
              </button>
             </div>
            </div>
           </div>
           <div class="postFooter-mobileRecommendNote u-showOnMobile js-recommendNote">
           </div>
          </div>
         </div>
         <div class="row">
          <div class="col u-xs-size12of12 postFooter-tags infoCard js-postTags">
          </div>
         </div>
        </div>
        <div class="container u-size740">
         <div class="row postFooter-info2">
          <div class="col u-xs-size12of12">
           <hr class="postFooter-infoDivider"/>
          </div>
         </div>
         <div class="row js-postFooterInfo">
          <div class="col u-xs-size12of12">
           <li class="card card-user">
            <div class="u-floatRight">
             <span class="followState buttonSet-inner js-followState" data-user-id="b5a0e3e26699">
              <button class="button button--small u-noUserSelect button--withChrome button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-action-source="footer_card" data-requires-token="true" data-sign-in-action="toggle-block-user">
               <span class="button-label button-defaultState">
                Blocked
               </span>
               <span class="button-label button-hoverState">
                Unblock
               </span>
              </button>
              <button class="button button--primary button--small u-noUserSelect button--withChrome button--follow js-followButton" data-action="sign-in-prompt" data-action-source="footer_card_follow" data-redirect="https://medium.com/_/subscribe/user/b5a0e3e26699" data-requires-token="true" data-sign-in-action="toggle-subscribe-user">
               <span class="button-label button-defaultState">
                Follow
               </span>
               <span class="button-label button-activeState">
                Following
               </span>
              </button>
             </span>
            </div>
            <div class="card-imageWrapper ">
             <a aria-label="Go to the profile of Vijay Pandurangan" class="link avatar" data-action-source="footer_card" dir="auto" href="https://medium.com/@vijayp?source=footer_card" title="Go to the profile of Vijay Pandurangan">
              <img alt="Go to the profile of Vijay Pandurangan" class="avatar-image avatar-image--small" src="https://d262ilb51hltx0.cloudfront.net/fit/c/60/60/0*MqVkP4Yu0E0GNrCh.jpeg"/>
             </a>
            </div>
            <div class="card-content">
             <h3 class="card-name">
              <a aria-label="Go to the profile of Vijay Pandurangan" class="link link--primary" dir="auto" href="https://medium.com/@vijayp" property="cc:attributionName" rel="author cc:attributionUrl" title="Go to the profile of Vijay Pandurangan">
               Vijay Pandurangan
              </a>
             </h3>
             <p class="card-description">
              Founder and CEO of
              <a href="http://www.mitro.co" rel="nofollow">
               www.mitro.co
              </a>
              . I write software and love photography. Also, I'm trying to learn to swim better. Twitter:
              <a href="http://twitter.com/vijayp" target="_blank" title="Twitter profile for @vijayp">
               @vijayp
              </a>
              Web:
              <a href="http://www.vijayp.ca" rel="nofollow">
               www.vijayp.ca
              </a>
             </p>
            </div>
           </li>
          </div>
         </div>
         <div class="row">
          <div class="col u-xs-size12of12">
           <div class="postFooter-additionalPostInfo postFooter-additionalPostInfo--light">
            <div class="postMeta-acknowledgments">
             Published
             <span class="u-noWrap" data-tooltip="Updated Jun 27, 2014">
              <span class="u-xs-hide">
               on
              </span>
              <time class="post-date">
               Jun 21, 2014
              </time>
             </span>
             .
             <a class="link" data-tooltip="Except where otherwise noted, all rights to this work are reserved by the author." href="//medium.com/policy/9db0094a1e0f" rel="license" target="_blank">
              All rights reserved
             </a>
             by the author.
             <span class="postMeta-licenseIcons">
             </span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
       <div class="responsesWrapper supplementalPostContent js-responsesWrapper">
       </div>
       <div class="post-footer supplementalPostContent js-readNext">
       </div>
      </footer>
     </article>
    </div>
   </div>
  </div>
  <div class="loadingBar">
  </div>
  <script>
   // &lt;![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","bestOfFirstSlug":"may-2013","bestOfLatestSlug":"june-2015","buildLabel":"16390-100e96d","currentUser":{"userId":"lo_c45253e0b04d","isVerified":"","subscriberEmail":""},"currentUserHasUnverifiedEmail":false,"defaultPreviewImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/default-preview-image.IsBK38jFAJBlWifMLO4z9g.png","defaultUserImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/default-avatar.dmbNkD5D-u45r44go_cf0g.png","editorTipsAddCoverImage":"/img/help/add-cover.gif","editorTipsAddMediaImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/add-media.SZH2LBmkwVExuhozFfVvYg.gif","editorTipsAddMediaImageStatic":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/add-media-start.GXmqQ2Svt1WfZGIZSM93tg.gif","editorTipsEmbedImageStatic":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/embed-start.EBJ2PcWFJuYopsQV4wwklA.gif","editorTipsShareDraftImage":"/img/help/share-draft.gif","editorTipsTextHighlightImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/text-highlight.XVChoKYZ1-s3gJgHm9-7Yg.gif","editorTipsTextHighlightImageStatic":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/text-highlight-start.AvTbakaFuUCd05YoMECoMQ.gif","facebookKey":"542599432471018","facebookScope":["public_profile","email","user_friends"],"homeImageId":"1*4ncz3hLxmL8E_bUh-0z62w.jpeg","importHighlightMenuImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/import/highlight-menu.kzoaVM8mJJ-Hu9m9uo3Omg.png","importImageHighlightMenuImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/import/image-highlight-menu.q43-H2dl0JvBS_5znQCW8A.png","importPublishImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/import/publish-metabar.YbEX1a2Pu0rAR_LuKeg8JA.png","isAuthenticated":false,"isCurrentUserVerified":"","language":null,"loadingPlaceholderImg":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/media-loading-placeholder.b31hiO4ynbDLRrXWEFF4aQ.png","mediumTwitterScreenName":"medium","miroUrl":"https://d262ilb51hltx0.cloudfront.net","moduleUrls":{"base":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-base.bundle.SO0b8-B90xgkH1YjzY9GdQ.js","notes":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-notes.bundle.F_ofR6LrqpRN2x6brxymJw.js","posters":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-posters.bundle.Ban40iZ8EPMOm3N7-JzhdA.js","common-async":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-common-async.bundle.2ywVFxvb2VL_xytV7Hxmqw.js","stats":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-stats.bundle.VGxP3K3PTDgSfHjaf-KhJA.js","misc-screens":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-misc-screens.bundle.sKZulHznjyVwiBsCSqmbhQ.js"},"onboardingLandscapeFooterImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/logged-out-footer/landscape-bg.W4fnHJbJjHt0fgxh7ssrvQ.jpg","postColumnWidth":700,"previewConfig":{"weightThreshold":1,"weightEmptyParagraph":0,"weightIframeParagraph":0.8,"weightImageParagraph":0.51,"weightTextParagraph":0.05,"weightBq":0.003,"weightH":0.003,"weightP":0.0025,"minPTextLength":40,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15,"experimentImagesInsetCenter":false,"previewConfigVariantA":{"experimentImagesInsetCenter":true},"previewConfigVariantB":{"weightThreshold":10,"detectTitle":false}},"productName":"Medium","responsesRecommendationThreshold":5,"supportsEdit":false,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1436856389012:71c733277414","useragent":{"browser":"other","family":"","os":"","version":0,"supportsDesktopEdit":false,"supportsMobileEdit":false,"supportsInteract":false,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":false,"isTier1":false,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":false,"supportsVhUnits":false,"ruinsViewportSections":false,"supportsHtml5Video":false,"supportsMagicUnderlines":false,"isFacebook":false},"variants":{"can_vote":true,"can_update_settings":true,"can_send_push_notifications":true,"can_export_data":true,"enable_notes":true,"allow_test_auth":"disallow","enable_email_login":true,"enable_email_registration":true,"enable_post_licensing":true,"filter_other_languages":true,"use_experimental_css":true,"can_resume_from_last_read_location":true,"can_report_bad_posts":true,"enable_embeds":true,"enable_recommend_notes":true,"enable_recommend_notes_composition":true,"use_full_width_images":true,"upload_multiple_files":true,"can_follow_users":true,"can_block_users":true,"filter_posts_from_blocked_users":true,"filter_posts_from_blocking_users":true,"filter_notes_from_blocked_users":true,"filter_notes_from_blocking_users":true,"hide_blocker_profile_from_blockee":true,"hide_blocker_post_page_from_blockee":true,"prevent_interactions_from_blockee":true,"enable_custom_push_notification_prompts_ios":true,"onboarding_connect_addtional_social_accounts_enabled_ios":true,"allow_request_account_deletion":true,"enable_bookmarks_list_ios":true,"see_featured_post_tab":true,"receive_rec_note_pushes":true,"receive_post_published_pushes":true,"enable_account_conversion":true,"use_new_scheduled_delivery_flow":true,"feed_homepage":true,"enable_collection_subscription_fanout":true,"welcome_post_url":"https://medium.com/@Medium/medium-connects-the-people-stories-and-ideas-that-matter-to-you-495655fb8459","google_search":true,"signin_services":"twitter,facebook,google","signup_services":"twitter,facebook,google","enable_homepage_promos":true,"promo_stream_signup":true,"promo_stream_feature_following":true,"promo_stream_why_write":true,"promo_stream_feature_responses":true,"promo_stream_onboarding":true,"promo_sidebar_start_writing":true,"promo_sidebar_writing_prompt":true,"promo_sidebar_feature_unlisted":true,"sidebar_connect_other_service_promo":true,"mobile_app_promotion":"dialog","enable_bing_search":true,"enable_algolia_search":true,"show_tagged_posts_in_search":true,"enable_textshots":true,"enable_respond_to_web":true,"drafts_unauth":true,"enable_quotes":true,"enable_profile_quotes":true,"combined_margin_quotes":true,"friends_only_quotes":true,"enable_quotes_emails":true,"enable_search_ios":true,"enable_connect_social_accounts_from_settings_ios":true,"enable_new_cover_flow_ios":true,"enable_rating_prompt":true,"enable_post_show_refactor":true,"enable_your_stories_more_actions":true,"enable_user_search_with_bing":true,"show_related_tags":true,"restrict_set_visibility":true,"enable_post_top_quotes":true,"min_quoters_top_quotes":2,"max_quotes_top_quotes":1,"enable_session_cookie_encryption":true,"enable_follow_tags":true,"enable_tabbed_homepage_ios":true,"enable_editors_can_pull_stories":true,"enable_email_capture_flow_ios":true,"enable_send_pub_newsletters":true,"enable_receive_pub_newsletters":true,"enable_new_onboarding_flow_ios":true,"enable_follow_tags_from_post_list_ios":true,"enable_embedded_onboarding_education_and_login_ios":true,"enable_contextual_recommend_education_ios":true,"enable_simple_reach":true,"enable_tag_follow_onboarding":true,"your_top_stories_source":"similar-posts","follower_suggestion_source":"friends-of-friends","enable_follow_tags_stream":true,"enable_query_by_in_response_to_post_id":true,"enable_gif_to_video_ios":true,"enable_international_typographic_quotes_through_icu_ios":true,"enable_service_worker":true,"android_quotes":true,"android_rating_prompt_recommend_threshold":5,"enable_promo_post_header_ios":true,"enable_promo_post_header_android":true,"reengagement_notification_duration":3,"logged_out_writing_responses":true,"enable_view_all_responses":true,"enable_promo_sign_in_wall":true,"onboarding_tag_stream_experiment":"control","google_sign_in_backend":true,"google_sign_in_android":true,"enable_quote_feed_write":true,"footer_promo_bucket":"control","footer_promo_title":"Dont stop now, the next great story is waiting in the app","footer_promo_subtitle":"Read the best stories and tell your own","post_header_promo_bucket":"control","post_header_promo_title":"Change your mind, among others. Use our free app to read, respond, and follow.","homepage_promo_bucket":"control","homepage_promo_title":"Welcome to Medium","homepage_promo_subtitle":"Sign in to read, write, and interact with millions of ideas and stories from around the world.","enable_onboarding_tags_search":true,"enable_friends_recommends_plugin":true,"enable_write_stats_cache":true,"send_using_sendgrid":true,"top_stories_for_you_title":"control","no_push_notification_for_responses":true},"xsrfToken":"","useDynamicScripts":false,"canonicalBaseUrl":"https://medium.com","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","teamName":"Team Medium","fp":{"/img/email/check1.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/check1.0DM77li7vZhq5o2V9cVYLQ.png","/img/email/check2.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/check2.GLlNusQmn1hwo9WDN-gE1w.png","/img/email/check3.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/check3.7VxOUVMXAVbHRRnzMrJ_5A.png","/img/email/fb_logo.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/fb_logo.Q0M98YwNTu77gLWTK6-RyQ.png","/img/email/heart1.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/heart1.rnGEmSwcGUhztl_zSU7l6Q.png","/img/email/heart2.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/heart2.HBiLu3koIYsKjjKroohgbA.png","/img/email/heart3.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/heart3.AIJBOHw11HuhdClVJNtmtg.png","/img/email/logo.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/logo.dPr5ZCzgKMooKYKJwnKarQ.png","/img/email/twitter_logo.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/twitter_logo.Pz4a3o9WMU5QioxLKcyFhQ.png","/img/email/unlisted.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/unlisted.ikh8R2LElOz_1YM8A2Db4g.png","/img/email/follow.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/follow.-VSXwmQhfi2entHPht8l2g.png","/img/email/recommend.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/recommend.scZJ6ysjDBJYd-K3wFK2Hg.png","/img/email/write.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/write.wWIWbAqfZUqn1JD4YSJYNw.png","/img/email/large.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/large.4EIhZbIk5sgqYSoB4YPmUA.png","/img/email/app_store_badge@2x.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/app_store_badge@2x.8bDQGNMm-Xs7Hz6WA2XquQ.png","/img/email/google_play_badge@2x.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/google_play_badge@2x.iWEWlt5_Qj20rr79-IGEBQ.png","/img/email/app-devices@2x.png":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/email/app-devices@2x.Ewl5-si-nhkLKZFIFSgrOw.png"},"configLabel":"558de79","cssBaseUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/css/main-base.z6B00ig_91n1ztoWRcwpGw.css","cssSpriteUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/css/main-sprites.1B2M2Y8AsgTpgAmY7PhCfg.css","cssFontUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/css/fonts-base.RB0XGp9t6rSpksYHwudieQ.css","googleAnalyticsTrackingCode":"UA-24232453-2","iconsJsUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/icons.PX62l8bCrOXFl44-EauI0w.js","jsShivUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","jsUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-base.bundle.SO0b8-B90xgkH1YjzY9GdQ.js","facebookNamespace":"medium-com","highlightAnimationImg":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/highlight-educational-animation._BG4I2h0KF83wFb3fWnWbA.gif","editorTipsEmbedImage":"https://dnqgz544uhbo8.cloudfront.net/_/fp/img/help/embed.1BM0Di9vd91Kv8fLioJabw.gif","authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"favIconUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/icons/favicon.n7eHNqdWyHhbTLN2-3a-6g.ico","algoliaApiEndpoint":"https://MQ57UUUQZ2.algolia.io","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"aadabda268e3bfaffe7b287709262fec","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","cssFontHintedUrl":"https://dnqgz544uhbo8.cloudfront.net/_/fp/css/fonts-hinted-base.h1mF0S6dQagtUyBbsS0NbQ.css","embedded":{"value":{"id":"f6bc289679a1","versionId":"3e13f044a380","creatorId":"b5a0e3e26699","creator":{"userId":"b5a0e3e26699","name":"Vijay Pandurangan","username":"vijayp","createdAt":1359102473294,"lastPostCreatedAt":1403380493945,"imageId":"0*MqVkP4Yu0E0GNrCh.jpeg","backgroundImageId":"1*HS_VMCi4lFZlHUzgaSAvfA.jpeg","bio":"Founder and CEO of www.mitro.co. I write software and love photography. Also, I'm trying to learn to swim better. Twitter:@vijayp Web: www.vijayp.ca","twitterScreenName":"vijayp","social":{"userId":"lo_c45253e0b04d","targetUserId":"b5a0e3e26699","type":"Social"},"facebookAccountId":"","type":"User"},"homeCollectionId":"","title":"On Taxis and Rainbows","detectedLanguage":"en","latestVersion":"3e13f044a380","latestPublishedVersion":"3e13f044a380","hasUnpublishedEdits":false,"latestRev":907,"createdAt":1403380493945,"updatedAt":1403880977608,"acceptedAt":0,"firstPublishedAt":1403389910890,"latestPublishedAt":1403880977608,"isRead":false,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"Lessons from NYCs improperly anonymized taxi logs","caption":"Photo by @vijayp","image":{"imageId":"1*kIavzAnNLDGeOHUlYF1Hww.jpeg","backgroundSize":"full","originalWidth":2048,"originalHeight":1088,"strategy":"crop-fixed"},"bodyModel":{"paragraphs":[{"name":"a83b","type":1,"text":"Recently, thanks to a Freedom of Information request, Chris Whong received and made public a complete dump of historical trip and fare logs from NYC taxis. Its pretty incredible: there are over 20GB of uncompressed data comprising more than 173 million individual trips. Each trip record includes the pickup and dropoff location and time, anonymized hack licence number and medallion number (i.e. the taxis unique id number, 3F38, in my photo above), and other metadata.","markups":[{"type":3,"start":54,"end":65,"href":"https://twitter.com/@chris_whong","title":"","rel":""},{"type":3,"start":93,"end":154,"href":"http://chriswhong.com/open-data/foil_nyc_taxi/","title":"","rel":""},{"type":1,"start":242,"end":253}]},{"name":"d763","type":1,"text":"These data are a veritable trove for people who love cities, transit, and data visualization. But theres a big problem: the personally identifiable information (the drivers licence number and taxi number) hasnt been anonymized properly  whats worse, its trivial to undo, and with other publicly available data, one can even figure out which person drove each trip. In the rest of this post, Ill describe the structure of the data, what the person/people who released the data did wrong, how easy it is to deanonymize, and the lessons other agencies should learn from this. (And yes, Ill also explain how rainbows fit in).","markups":[]},{"name":"4e34","type":1,"text":"The NYC taxi data consist of a number of CSV-files, each with lines that look like this:","markups":[{"type":3,"start":41,"end":44,"href":"https://en.wikipedia.org/wiki/Comma-separated_values","title":"","rel":""}]},{"name":"1b4a","type":8,"text":"6B111958A39B24140C973B262EA9FEA5,D3B035A03C8A34DA17488129DA581EE7,VTS,5,,2013-12-03 15:46:00,2013-12-03 16:47:00,1,3660,22.71,-73.813927,40.698135,-74.093307,40.829346","markups":[]},{"name":"2f5a","type":1,"text":"Each of these columns correspond to the following fields:","markups":[]},{"name":"122c","type":8,"text":"medallion,hack_license,vendor_id,rate_code,store_and_fwd_flag,pickup_datetime,dropoff_datetime,passenger_count,trip_time_in_secs ","markups":[]},{"name":"742c","type":1,"text":"Its pretty obvious what format most of the fields are in (lon/lat, timestamp) but the first two columns demonstrate that the government folks clearly intended to anonymize the medallion and licence numbers. Its obvious that the alphanumeric codes are not purely random, the same taxi and same driver always has the same code throughout the data. This isnt necessarily a problem  in fact, preserving this property is often of critical importance when anonymizing data. Imagine a search engine engineer who wants to analyse user behaviour in aggregate: its important that the same user has the same code throughout the set of logs that are being analysed, so that you can see what a user does over time. Its obviously also critical that its not possible to go backwards from the code to the users name.","markups":[]},{"name":"8b2f","type":1,"text":"Someone on Reddit pointed out that one specific driver seemed to be doing an incredible amount of business. When faced with anomalous data like that, its good practice to weed out data error before jumping to conclusions about cheating taxi drivers. Also, I couldnt shake the feeling that there was something about that encoded id number: CFCD208495D565EF66E7DFF9F98764DA. After a little bit of poking around, I realised that that code is actually the MD5 hash of the character 0. This proved my suspicion that this was actually a data collection error, but also made me immediately realise that the entire anonymization process was flawed and could easily be reversed.","markups":[{"type":3,"start":39,"end":106,"href":"http://www.reddit.com/r/bigquery/comments/28ialf/173_million_2013_nyc_taxi_rides_shared_on_bigquery/cicr3n2","title":"","rel":""}]},{"name":"5bc6","type":1,"text":"A cryptographically secure hashing function, like MD5 is a one-way function: it always turns the same input to the same output, but given the output, its pretty hard to figure out what the input was as long as you dont know anything about what the input might look like. This is mostly what youd like out of an anonymization function. The problem, however, is that in this case we know a lot about what the inputs look like.","markups":[{"type":3,"start":2,"end":43,"href":"https://en.wikipedia.org/wiki/Cryptographic_hash_function","title":"","rel":""},{"type":2,"start":200,"end":271},{"type":2,"start":391,"end":394}]},{"name":"9324","type":1,"text":"In NYC, taxi licence numbers are 6-digit [Edit: (6-digit numbers may start with any digit and are sometimes zero-padded)], or 7-digit numbers starting with a 5. That means that there are only about 3M possible taxi licence numbers. Similarly, medallion numbers conform to a very specific pattern:","markups":[{"type":2,"start":41,"end":121}]},{"name":"c185","type":8,"text":"one number, one letter, two numbers. For example: 5X55\ntwo letters, three numbers. For example: XX555\nthree letters, three numbers. For example: XXX555","markups":[]},{"name":"f514","type":1,"text":"[Edit: I fixed my math thanks (thanks Paul)] There are about 1000*27*26 = 18954000 or ~19M possible medallion numbers. So, by calculating the md5 hashes of all these numbers (only 22M!), one can completely deanonymise the entire data. Modern computers are fast: so fast that computing the 22M hashes took less than 2 minutes. The resulting table of hashed-data to input data is called a Rainbow Table. [Edit: people have pointed out that this may not meet the exact requirements to be called a rainbow table]","markups":[{"type":3,"start":38,"end":42,"href":"https://twitter.com/duckblog","title":"","rel":""},{"type":3,"start":276,"end":300,"href":"https://github.com/vijayp/nyc-taxi/blob/master/create_hashes.py","title":"","rel":""},{"type":1,"start":388,"end":403},{"type":2,"start":0,"end":45},{"type":2,"start":388,"end":509}]},{"name":"86e1","type":1,"text":"It took a while longer to de-anonymize the entire dataset, but thanks to Yelps MRJob, I ran a map-reduce over about 10 computers on EMR and had it done within an hour. Theres a ton of resources on NYC Taxi and Limousine commission, including a mapping from licence number to driver name, and a way to look up owners of medallions. I havent linked them here but its easy to find using a quick Google search.","markups":[{"type":3,"start":26,"end":57,"href":"https://github.com/vijayp/nyc-taxi/blob/master/deanonymise.py","title":"","rel":""},{"type":3,"start":80,"end":85,"href":"https://github.com/Yelp/mrjob","title":"","rel":""},{"type":3,"start":133,"end":136,"href":"https://aws.amazon.com/elasticmapreduce/","title":"","rel":""}]},{"name":"6fe0","type":1,"text":"Here are a few de-anonymized lines I picked at random:","markups":[]},{"name":"8561","type":8,"text":"9Y99,5296319,VTS,1,,2013-12-06 00:07:00,2013-12-06 00:16:00,5,540,1.85,-73.97953,40.776447,-73.982254,40.754925 ","markups":[]},{"name":"11c9","type":8,"text":"9Y99,5296319,VTS,1,,2013-12-06 00:20:00,2013-12-06 00:46:00,5,1560,6.58,-73.985779,40.757317,-73.984543,40.681244 ","markups":[]},{"name":"42bd","type":8,"text":"DIP1,111333,VTS,1,,2013-12-03 12:10:00,2013-12-03 12:24:00,5,840,.00,0,0,0,0 ","markups":[]},{"name":"26fa","type":8,"text":"SBV106,429925,VTS,1,,2013-12-05 23:04:00,2013-12-05 23:16:00,6,720,2.86,-73.988197,40.731232,-73.96199,40.764343 ","markups":[]},{"name":"a995","type":1,"text":"Security researchers have been warning for a while that simply using hash functions is an ineffective way to anonymize data. In this case, its substantially worse because of the structured format of the input data. This anonymization is so poor that anyone could, with less then 2 hours work, figure which driver drove every single trip in this entire dataset. It would be even be easy to calculate drivers gross income, or infer where they live.","markups":[{"type":3,"start":56,"end":123,"href":"https://www.truste.com/blog/2013/04/16/data-anonymization/","title":"","rel":""}]},{"name":"9a5b","type":1,"text":"There are a number of ways these data could have been better anonymized. Two good ones include:","markups":[]},{"name":"ccb4","type":9,"text":"assigning a totally random number to each hack licence number and medallion number once, and re-using it throughout the dump file","markups":[]},{"name":"ad08","type":9,"text":"creating a secret AES key, and encrypting each value individually","markups":[]},{"name":"011c","type":1,"text":"[Edit: As always, things are more complicated than they seem at first. The strategies described above will anonymise the numbers of the licences and taxicabs, but commenters have pointed out that there are a number of other ways in whch PII may be reconstructed. The most interesting is Narayanan and Shmatikovs algorithm. NYC is dense enough that it may be much more challenging to target specific passengers using these data, however. Anonymizing data is really hard.]","markups":[{"type":3,"start":163,"end":190,"href":"https://news.ycombinator.com/item?id=7927025","title":"","rel":""},{"type":3,"start":287,"end":322,"href":"https://www.cs.utexas.edu/~shmat/shmat_oak08netflix.pdf","title":"","rel":""},{"type":2,"start":0,"end":471}]},{"name":"68bf","type":1,"text":"The cat is already out of the bag in this case, but hopefully in the future, agencies will think carefully about the method they use to anonymize data before releasing it to the public.","markups":[]},{"name":"32c7","type":1,"text":"Edit: this is up on hackernews. Please feel free to comment there","markups":[{"type":3,"start":20,"end":30,"href":"https://news.ycombinator.com/item?id=7926358","title":"","rel":""}]}],"sections":[{"name":"4100","startIndex":0},{"name":"e2d7","startIndex":2},{"name":"7085","startIndex":18}]},"postDisplay":{}},"media":null,"virtuals":{"statusForCollection":"","createdAtRelative":"a year ago","updatedAtRelative":"a year ago","acceptedAtRelative":"","createdAtEnglish":"June 21, 2014","updatedAtEnglish":"June 27, 2014","acceptedAtEnglish":"","firstPublishedAtEnglish":"June 21, 2014","latestPublishedAtEnglish":"June 27, 2014","allowNotes":true,"languageTier":1,"snippet":"Lessons from NYCs improperly anonymized taxi logs","previewImage":{"imageId":"1*kIavzAnNLDGeOHUlYF1Hww.jpeg","filter":"","backgroundSize":"full","originalWidth":2048,"originalHeight":1088,"strategy":"resample","height":0,"width":0},"wordCount":1070,"imageCount":1,"readingTime":4.237735849056604,"subtitle":"Lessons from NYCs improperly anonymized taxi logs","postedIn":[],"publishedInCount":0,"usersBySocialRecommends":[],"notesBySocialRecommends":[],"proposedAtRelative":"","latestPublishedAtAbbreviated":"Jun 27, 2014","firstPublishedAtAbbreviated":"Jun 21, 2014","emailSnippet":"Recently, thanks to a Freedom of Information request, Chris Whong received and made public a complete dump of historical trip and fare logs from NYC taxis. Its pretty incredible: there are over 20GB of uncompressed data comprising more than 173 million individual trips. Each trip record includes the pickup and dropoff location and time, anonymized hack licence number and medallion number (i.e. the taxis unique id number, 3F38, in my photo above), and other metadata.","recommends":0,"featuredRecommendNoteId":"","socialRecommends":[],"addedToFeedAt":0,"isBookmarked":false,"tags":[],"socialRecommendsCount":0},"coverless":false,"slug":"of-taxis-and-rainbows","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"contentType":0,"isViewed":false,"uniqueSlug":"of-taxis-and-rainbows-f6bc289679a1","previewContent":{"bodyModel":{"paragraphs":[{"name":"1*kIavzAnNLDGeOHUlYF1Hww.jpeg","type":4,"text":"","layout":10,"metadata":{"id":"1*kIavzAnNLDGeOHUlYF1Hww.jpeg","originalWidth":2048,"originalHeight":1088}},{"name":"title","type":2,"text":"On Taxis and Rainbows","alignment":1},{"name":"subtitle","type":13,"text":"Lessons from NYCs improperly anonymized taxi logs","alignment":1},{"name":"previewEmpty","type":1,"text":""},{"name":"a83b","type":1,"text":"Recently, thanks to a Freedom of Information request, Chris Whong received and made","markups":[{"type":3,"start":54,"end":65,"href":"https://twitter.com/@chris_whong","title":"","rel":""}],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@vijayp/of-taxis-and-rainbows-f6bc289679a1","approvedHomeCollectionId":"","newsletterId":"","type":"Post","_isPopulated":true},"collaborators":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"b5a0e3e26699":{"userId":"b5a0e3e26699","name":"Vijay Pandurangan","username":"vijayp","createdAt":1359102473294,"lastPostCreatedAt":1403380493945,"imageId":"0*MqVkP4Yu0E0GNrCh.jpeg","backgroundImageId":"1*HS_VMCi4lFZlHUzgaSAvfA.jpeg","bio":"Founder and CEO of www.mitro.co. I write software and love photography. Also, I'm trying to learn to swim better. Twitter:@vijayp Web: www.vijayp.ca","twitterScreenName":"vijayp","social":{"userId":"lo_c45253e0b04d","targetUserId":"b5a0e3e26699","type":"Social"},"facebookAccountId":"","type":"User"}},"Social":{"b5a0e3e26699":{"userId":"lo_c45253e0b04d","targetUserId":"b5a0e3e26699","type":"Social"}}}}}
// ]]&gt;
  </script>
  <script async="true" charset="UTF-8" src="https://dnqgz544uhbo8.cloudfront.net/_/fp/js/main-base.bundle.SO0b8-B90xgkH1YjzY9GdQ.js">
  </script>
  <script charset="UTF-8" src="https://dnqgz544uhbo8.cloudfront.net/_/fp/js/icons.PX62l8bCrOXFl44-EauI0w.js">
  </script>
 </body>
</html>