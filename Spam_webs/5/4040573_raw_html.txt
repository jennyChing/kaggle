<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta content="en-us" http-equiv="Content-Language"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="noarchive,noindex,nofollow" name="robots"/>
  <meta content="noarchive,noindex,nofollow" name="googleBOT"/>
  <style type="text/css">
   body {
            background-color:#101010;
            margin: 0;
                                          p   a   d   d   i   n   g   :       0   ;      
      
                                                   f   o   n   t   -   f   a   m   i   l   y   :       V   e   r   d   a   n   a   ,       A   r   i   a   l   ,       H   e   l   v   e   t   i   c   a   ,       s   a   n   s   -   s   e   r   i   f   ;      
                                                   c   o   l   o   r   :       #   C   C   C   C   C   C   ;      
                                                   f   o   n   t   -   s   i   z   e   :       1   0   p   t   ;      
                                   }      
      
                                   a       {       c   o   l   o   r   :       #   8   0   b   3   e   6   ;       }      
                                   p       {      
                                                   m   a   r   g   i   n   :       5   p   x   ;      
                                   }      
      
                                   .   h   e   a   d   e   r       {      
                                                   m   a   r   g   i   n   :       5   0   p   x       a   u   t   o   ;      
                                                   w   i   d   t   h   :       1   0   2   4   p   x   ;      
                                   }      
      
                                   .   e   x   t   e   r   n   a   l       {      
                                                   b   o   r   d   e   r   :       0   ;      
                                                   m   a   r   g   i   n   :       0   ;      
                                                   p   a   d   d   i   n   g   :       0   ;      
                                                   w   i   d   t   h   :       1   0   0   %   ;      
                                                   h   e   i   g   h   t   :       1   0   0   %   ;      
                                   }      
                   &lt;   /   s   t   y   l   e   &gt;      
      
   &lt;   s   c   r   i   p   t       t   y   p   e   =   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "   &gt;      
   /   *   !      
       *       j   Q   u   e   r   y       J   a   v   a   S   c   r   i   p   t       L   i   b   r   a   r   y       v   1   .   6   .   2      
       *       h   t   t   p   :   /   /   j   q   u   e   r   y   .   c   o   m   /      
       *      
       *       C   o   p   y   r   i   g   h   t       2   0   1   1   ,       J   o   h   n       R   e   s   i   g      
       *       D   u   a   l       l   i   c   e   n   s   e   d       u   n   d   e   r       t   h   e       M   I   T       o   r       G   P   L       V   e   r   s   i   o   n       2       l   i   c   e   n   s   e   s   .      
       *       h   t   t   p   :   /   /   j   q   u   e   r   y   .   o   r   g   /   l   i   c   e   n   s   e      
       *      
       *       I   n   c   l   u   d   e   s       S   i   z   z   l   e   .   j   s      
       *       h   t   t   p   :   /   /   s   i   z   z   l   e   j   s   .   c   o   m   /      
       *       C   o   p   y   r   i   g   h   t       2   0   1   1   ,       T   h   e       D   o   j   o       F   o   u   n   d   a   t   i   o   n      
       *       R   e   l   e   a   s   e   d       u   n   d   e   r       t   h   e       M   I   T   ,       B   S   D   ,       a   n   d       G   P   L       L   i   c   e   n   s   e   s   .      
       *      
       *       D   a   t   e   :       T   h   u       J   u   n       3   0       1   4   :   1   6   :   5   6       2   0   1   1       -   0   4   0   0      
       *   /      
   /   *   !       j   Q   u   e   r   y       v   1   .   7   .   1       j   q   u   e   r   y   .   c   o   m       |       j   q   u   e   r   y   .   o   r   g   /   l   i   c   e   n   s   e       *   /      
   (   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   u   n   c   t   i   o   n       c   y   (   a   )   {   r   e   t   u   r   n       f   .   i   s   W   i   n   d   o   w   (   a   )   ?   a   :   a   .   n   o   d   e   T   y   p   e   =   =   =   9   ?   a   .   d   e   f   a   u   l   t   V   i   e   w   |   |   a   .   p   a   r   e   n   t   W   i   n   d   o   w   :   !   1   }   f   u   n   c   t   i   o   n       c   v   (   a   )   {   i   f   (   !   c   k   [   a   ]   )   {   v   a   r       b   =   c   .   b   o   d   y   ,   d   =   f   (   "   &lt;   "   +   a   +   "   &gt;   "   )   .   a   p   p   e   n   d   T   o   (   b   )   ,   e   =   d   .   c   s   s   (   "   d   i   s   p   l   a   y   "   )   ;   d   .   r   e   m   o   v   e   (   )   ;   i   f   (   e   =   =   =   "   n   o   n   e   "   |   |   e   =   =   =   "   "   )   {   c   l   |   |   (   c   l   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   i   f   r   a   m   e   "   )   ,   c   l   .   f   r   a   m   e   B   o   r   d   e   r   =   c   l   .   w   i   d   t   h   =   c   l   .   h   e   i   g   h   t   =   0   )   ,   b   .   a   p   p   e   n   d   C   h   i   l   d   (   c   l   )   ;   i   f   (   !   c   m   |   |   !   c   l   .   c   r   e   a   t   e   E   l   e   m   e   n   t   )   c   m   =   (   c   l   .   c   o   n   t   e   n   t   W   i   n   d   o   w   |   |   c   l   .   c   o   n   t   e   n   t   D   o   c   u   m   e   n   t   )   .   d   o   c   u   m   e   n   t   ,   c   m   .   w   r   i   t   e   (   (   c   .   c   o   m   p   a   t   M   o   d   e   =   =   =   "   C   S   S   1   C   o   m   p   a   t   "   ?   "   &lt;   !   d   o   c   t   y   p   e       h   t   m   l   &gt;   "   :   "   "   )   +   "   &lt;   h   t   m   l   &gt;   &lt;   b   o   d   y   &gt;   "   )   ,   c   m   .   c   l   o   s   e   (   )   ;   d   =   c   m   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   a   )   ,   c   m   .   b   o   d   y   .   a   p   p   e   n   d   C   h   i   l   d   (   d   )   ,   e   =   f   .   c   s   s   (   d   ,   "   d   i   s   p   l   a   y   "   )   ,   b   .   r   e   m   o   v   e   C   h   i   l   d   (   c   l   )   }   c   k   [   a   ]   =   e   }   r   e   t   u   r   n       c   k   [   a   ]   }   f   u   n   c   t   i   o   n       c   u   (   a   ,   b   )   {   v   a   r       c   =   {   }   ;   f   .   e   a   c   h   (   c   q   .   c   o   n   c   a   t   .   a   p   p   l   y   (   [   ]   ,   c   q   .   s   l   i   c   e   (   0   ,   b   )   )   ,   f   u   n   c   t   i   o   n   (   )   {   c   [   t   h   i   s   ]   =   a   }   )   ;   r   e   t   u   r   n       c   }   f   u   n   c   t   i   o   n       c   t   (   )   {   c   r   =   b   }   f   u   n   c   t   i   o   n       c   s   (   )   {   s   e   t   T   i   m   e   o   u   t   (   c   t   ,   0   )   ;   r   e   t   u   r   n       c   r   =   f   .   n   o   w   (   )   }   f   u   n   c   t   i   o   n       c   j   (   )   {   t   r   y   {   r   e   t   u   r   n       n   e   w       a   .   A   c   t   i   v   e   X   O   b   j   e   c   t   (   "   M   i   c   r   o   s   o   f   t   .   X   M   L   H   T   T   P   "   )   }   c   a   t   c   h   (   b   )   {   }   }   f   u   n   c   t   i   o   n       c   i   (   )   {   t   r   y   {   r   e   t   u   r   n       n   e   w       a   .   X   M   L   H   t   t   p   R   e   q   u   e   s   t   }   c   a   t   c   h   (   b   )   {   }   }   f   u   n   c   t   i   o   n       c   c   (   a   ,   c   )   {   a   .   d   a   t   a   F   i   l   t   e   r   &amp;   &amp;   (   c   =   a   .   d   a   t   a   F   i   l   t   e   r   (   c   ,   a   .   d   a   t   a   T   y   p   e   )   )   ;   v   a   r       d   =   a   .   d   a   t   a   T   y   p   e   s   ,   e   =   {   }   ,   g   ,   h   ,   i   =   d   .   l   e   n   g   t   h   ,   j   ,   k   =   d   [   0   ]   ,   l   ,   m   ,   n   ,   o   ,   p   ;   f   o   r   (   g   =   1   ;   g   &lt;   i   ;   g   +   +   )   {   i   f   (   g   =   =   =   1   )   f   o   r   (   h       i   n       a   .   c   o   n   v   e   r   t   e   r   s   )   t   y   p   e   o   f       h   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   e   [   h   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   =   a   .   c   o   n   v   e   r   t   e   r   s   [   h   ]   )   ;   l   =   k   ,   k   =   d   [   g   ]   ;   i   f   (   k   =   =   =   "   *   "   )   k   =   l   ;   e   l   s   e       i   f   (   l   !   =   =   "   *   "   &amp;   &amp;   l   !   =   =   k   )   {   m   =   l   +   "       "   +   k   ,   n   =   e   [   m   ]   |   |   e   [   "   *       "   +   k   ]   ;   i   f   (   !   n   )   {   p   =   b   ;   f   o   r   (   o       i   n       e   )   {   j   =   o   .   s   p   l   i   t   (   "       "   )   ;   i   f   (   j   [   0   ]   =   =   =   l   |   |   j   [   0   ]   =   =   =   "   *   "   )   {   p   =   e   [   j   [   1   ]   +   "       "   +   k   ]   ;   i   f   (   p   )   {   o   =   e   [   o   ]   ,   o   =   =   =   !   0   ?   n   =   p   :   p   =   =   =   !   0   &amp;   &amp;   (   n   =   o   )   ;   b   r   e   a   k   }   }   }   }   !   n   &amp;   &amp;   !   p   &amp;   &amp;   f   .   e   r   r   o   r   (   "   N   o       c   o   n   v   e   r   s   i   o   n       f   r   o   m       "   +   m   .   r   e   p   l   a   c   e   (   "       "   ,   "       t   o       "   )   )   ,   n   !   =   =   !   0   &amp;   &amp;   (   c   =   n   ?   n   (   c   )   :   p   (   o   (   c   )   )   )   }   }   r   e   t   u   r   n       c   }   f   u   n   c   t   i   o   n       c   b   (   a   ,   c   ,   d   )   {   v   a   r       e   =   a   .   c   o   n   t   e   n   t   s   ,   f   =   a   .   d   a   t   a   T   y   p   e   s   ,   g   =   a   .   r   e   s   p   o   n   s   e   F   i   e   l   d   s   ,   h   ,   i   ,   j   ,   k   ;   f   o   r   (   i       i   n       g   )   i       i   n       d   &amp;   &amp;   (   c   [   g   [   i   ]   ]   =   d   [   i   ]   )   ;   w   h   i   l   e   (   f   [   0   ]   =   =   =   "   *   "   )   f   .   s   h   i   f   t   (   )   ,   h   =   =   =   b   &amp;   &amp;   (   h   =   a   .   m   i   m   e   T   y   p   e   |   |   c   .   g   e   t   R   e   s   p   o   n   s   e   H   e   a   d   e   r   (   "   c   o   n   t   e   n   t   -   t   y   p   e   "   )   )   ;   i   f   (   h   )   f   o   r   (   i       i   n       e   )   i   f   (   e   [   i   ]   &amp;   &amp;   e   [   i   ]   .   t   e   s   t   (   h   )   )   {   f   .   u   n   s   h   i   f   t   (   i   )   ;   b   r   e   a   k   }   i   f   (   f   [   0   ]   i   n       d   )   j   =   f   [   0   ]   ;   e   l   s   e   {   f   o   r   (   i       i   n       d   )   {   i   f   (   !   f   [   0   ]   |   |   a   .   c   o   n   v   e   r   t   e   r   s   [   i   +   "       "   +   f   [   0   ]   ]   )   {   j   =   i   ;   b   r   e   a   k   }   k   |   |   (   k   =   i   )   }   j   =   j   |   |   k   }   i   f   (   j   )   {   j   !   =   =   f   [   0   ]   &amp;   &amp;   f   .   u   n   s   h   i   f   t   (   j   )   ;   r   e   t   u   r   n       d   [   j   ]   }   }   f   u   n   c   t   i   o   n       c   a   (   a   ,   b   ,   c   ,   d   )   {   i   f   (   f   .   i   s   A   r   r   a   y   (   b   )   )   f   .   e   a   c   h   (   b   ,   f   u   n   c   t   i   o   n   (   b   ,   e   )   {   c   |   |   b   E   .   t   e   s   t   (   a   )   ?   d   (   a   ,   e   )   :   c   a   (   a   +   "   [   "   +   (   t   y   p   e   o   f       e   =   =   "   o   b   j   e   c   t   "   |   |   f   .   i   s   A   r   r   a   y   (   e   )   ?   b   :   "   "   )   +   "   ]   "   ,   e   ,   c   ,   d   )   }   )   ;   e   l   s   e       i   f   (   !   c   &amp;   &amp;   b   !   =   n   u   l   l   &amp;   &amp;   t   y   p   e   o   f       b   =   =   "   o   b   j   e   c   t   "   )   f   o   r   (   v   a   r       e       i   n       b   )   c   a   (   a   +   "   [   "   +   e   +   "   ]   "   ,   b   [   e   ]   ,   c   ,   d   )   ;   e   l   s   e       d   (   a   ,   b   )   }   f   u   n   c   t   i   o   n       b   _   (   a   ,   c   )   {   v   a   r       d   ,   e   ,   g   =   f   .   a   j   a   x   S   e   t   t   i   n   g   s   .   f   l   a   t   O   p   t   i   o   n   s   |   |   {   }   ;   f   o   r   (   d       i   n       c   )   c   [   d   ]   !   =   =   b   &amp;   &amp;   (   (   g   [   d   ]   ?   a   :   e   |   |   (   e   =   {   }   )   )   [   d   ]   =   c   [   d   ]   )   ;   e   &amp;   &amp;   f   .   e   x   t   e   n   d   (   !   0   ,   a   ,   e   )   }   f   u   n   c   t   i   o   n       b   $   (   a   ,   c   ,   d   ,   e   ,   f   ,   g   )   {   f   =   f   |   |   c   .   d   a   t   a   T   y   p   e   s   [   0   ]   ,   g   =   g   |   |   {   }   ,   g   [   f   ]   =   !   0   ;   v   a   r       h   =   a   [   f   ]   ,   i   =   0   ,   j   =   h   ?   h   .   l   e   n   g   t   h   :   0   ,   k   =   a   =   =   =   b   T   ,   l   ;   f   o   r   (   ;   i   &lt;   j   &amp;   &amp;   (   k   |   |   !   l   )   ;   i   +   +   )   l   =   h   [   i   ]   (   c   ,   d   ,   e   )   ,   t   y   p   e   o   f       l   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   !   k   |   |   g   [   l   ]   ?   l   =   b   :   (   c   .   d   a   t   a   T   y   p   e   s   .   u   n   s   h   i   f   t   (   l   )   ,   l   =   b   $   (   a   ,   c   ,   d   ,   e   ,   l   ,   g   )   )   )   ;   (   k   |   |   !   l   )   &amp;   &amp;   !   g   [   "   *   "   ]   &amp;   &amp;   (   l   =   b   $   (   a   ,   c   ,   d   ,   e   ,   "   *   "   ,   g   )   )   ;   r   e   t   u   r   n       l   }   f   u   n   c   t   i   o   n       b   Z   (   a   )   {   r   e   t   u   r   n       f   u   n   c   t   i   o   n   (   b   ,   c   )   {   t   y   p   e   o   f       b   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   c   =   b   ,   b   =   "   *   "   )   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   c   )   )   {   v   a   r       d   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   .   s   p   l   i   t   (   b   P   )   ,   e   =   0   ,   g   =   d   .   l   e   n   g   t   h   ,   h   ,   i   ,   j   ;   f   o   r   (   ;   e   &lt;   g   ;   e   +   +   )   h   =   d   [   e   ]   ,   j   =   /   ^   \   +   /   .   t   e   s   t   (   h   )   ,   j   &amp;   &amp;   (   h   =   h   .   s   u   b   s   t   r   (   1   )   |   |   "   *   "   )   ,   i   =   a   [   h   ]   =   a   [   h   ]   |   |   [   ]   ,   i   [   j   ?   "   u   n   s   h   i   f   t   "   :   "   p   u   s   h   "   ]   (   c   )   }   }   }   f   u   n   c   t   i   o   n       b   C   (   a   ,   b   ,   c   )   {   v   a   r       d   =   b   =   =   =   "   w   i   d   t   h   "   ?   a   .   o   f   f   s   e   t   W   i   d   t   h   :   a   .   o   f   f   s   e   t   H   e   i   g   h   t   ,   e   =   b   =   =   =   "   w   i   d   t   h   "   ?   b   x   :   b   y   ,   g   =   0   ,   h   =   e   .   l   e   n   g   t   h   ;   i   f   (   d   &gt;   0   )   {   i   f   (   c   !   =   =   "   b   o   r   d   e   r   "   )   f   o   r   (   ;   g   &lt;   h   ;   g   +   +   )   c   |   |   (   d   -   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   p   a   d   d   i   n   g   "   +   e   [   g   ]   )   )   |   |   0   )   ,   c   =   =   =   "   m   a   r   g   i   n   "   ?   d   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   c   +   e   [   g   ]   )   )   |   |   0   :   d   -   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   b   o   r   d   e   r   "   +   e   [   g   ]   +   "   W   i   d   t   h   "   )   )   |   |   0   ;   r   e   t   u   r   n       d   +   "   p   x   "   }   d   =   b   z   (   a   ,   b   ,   b   )   ;   i   f   (   d   &lt;   0   |   |   d   =   =   n   u   l   l   )   d   =   a   .   s   t   y   l   e   [   b   ]   |   |   0   ;   d   =   p   a   r   s   e   F   l   o   a   t   (   d   )   |   |   0   ;   i   f   (   c   )   f   o   r   (   ;   g   &lt;   h   ;   g   +   +   )   d   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   p   a   d   d   i   n   g   "   +   e   [   g   ]   )   )   |   |   0   ,   c   !   =   =   "   p   a   d   d   i   n   g   "   &amp;   &amp;   (   d   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   b   o   r   d   e   r   "   +   e   [   g   ]   +   "   W   i   d   t   h   "   )   )   |   |   0   )   ,   c   =   =   =   "   m   a   r   g   i   n   "   &amp;   &amp;   (   d   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   c   +   e   [   g   ]   )   )   |   |   0   )   ;   r   e   t   u   r   n       d   +   "   p   x   "   }   f   u   n   c   t   i   o   n       b   p   (   a   ,   b   )   {   b   .   s   r   c   ?   f   .   a   j   a   x   (   {   u   r   l   :   b   .   s   r   c   ,   a   s   y   n   c   :   !   1   ,   d   a   t   a   T   y   p   e   :   "   s   c   r   i   p   t   "   }   )   :   f   .   g   l   o   b   a   l   E   v   a   l   (   (   b   .   t   e   x   t   |   |   b   .   t   e   x   t   C   o   n   t   e   n   t   |   |   b   .   i   n   n   e   r   H   T   M   L   |   |   "   "   )   .   r   e   p   l   a   c   e   (   b   f   ,   "   /   *   $   0   *   /   "   )   )   ,   b   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   b   .   p   a   r   e   n   t   N   o   d   e   .   r   e   m   o   v   e   C   h   i   l   d   (   b   )   }   f   u   n   c   t   i   o   n       b   o   (   a   )   {   v   a   r       b   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ;   b   h   .   a   p   p   e   n   d   C   h   i   l   d   (   b   )   ,   b   .   i   n   n   e   r   H   T   M   L   =   a   .   o   u   t   e   r   H   T   M   L   ;   r   e   t   u   r   n       b   .   f   i   r   s   t   C   h   i   l   d   }   f   u   n   c   t   i   o   n       b   n   (   a   )   {   v   a   r       b   =   (   a   .   n   o   d   e   N   a   m   e   |   |   "   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   b   =   =   =   "   i   n   p   u   t   "   ?   b   m   (   a   )   :   b   !   =   =   "   s   c   r   i   p   t   "   &amp;   &amp;   t   y   p   e   o   f       a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   f   .   g   r   e   p   (   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   i   n   p   u   t   "   )   ,   b   m   )   }   f   u   n   c   t   i   o   n       b   m   (   a   )   {   i   f   (   a   .   t   y   p   e   =   =   =   "   c   h   e   c   k   b   o   x   "   |   |   a   .   t   y   p   e   =   =   =   "   r   a   d   i   o   "   )   a   .   d   e   f   a   u   l   t   C   h   e   c   k   e   d   =   a   .   c   h   e   c   k   e   d   }   f   u   n   c   t   i   o   n       b   l   (   a   )   {   r   e   t   u   r   n       t   y   p   e   o   f       a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   ?   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   :   t   y   p   e   o   f       a   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   !   =   "   u   n   d   e   f   i   n   e   d   "   ?   a   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   (   "   *   "   )   :   [   ]   }   f   u   n   c   t   i   o   n       b   k   (   a   ,   b   )   {   v   a   r       c   ;   i   f   (   b   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   b   .   c   l   e   a   r   A   t   t   r   i   b   u   t   e   s   &amp;   &amp;   b   .   c   l   e   a   r   A   t   t   r   i   b   u   t   e   s   (   )   ,   b   .   m   e   r   g   e   A   t   t   r   i   b   u   t   e   s   &amp;   &amp;   b   .   m   e   r   g   e   A   t   t   r   i   b   u   t   e   s   (   a   )   ,   c   =   b   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   i   f   (   c   =   =   =   "   o   b   j   e   c   t   "   )   b   .   o   u   t   e   r   H   T   M   L   =   a   .   o   u   t   e   r   H   T   M   L   ;   e   l   s   e       i   f   (   c   !   =   =   "   i   n   p   u   t   "   |   |   a   .   t   y   p   e   !   =   =   "   c   h   e   c   k   b   o   x   "   &amp;   &amp;   a   .   t   y   p   e   !   =   =   "   r   a   d   i   o   "   )   {   i   f   (   c   =   =   =   "   o   p   t   i   o   n   "   )   b   .   s   e   l   e   c   t   e   d   =   a   .   d   e   f   a   u   l   t   S   e   l   e   c   t   e   d   ;   e   l   s   e       i   f   (   c   =   =   =   "   i   n   p   u   t   "   |   |   c   =   =   =   "   t   e   x   t   a   r   e   a   "   )   b   .   d   e   f   a   u   l   t   V   a   l   u   e   =   a   .   d   e   f   a   u   l   t   V   a   l   u   e   }   e   l   s   e       a   .   c   h   e   c   k   e   d   &amp;   &amp;   (   b   .   d   e   f   a   u   l   t   C   h   e   c   k   e   d   =   b   .   c   h   e   c   k   e   d   =   a   .   c   h   e   c   k   e   d   )   ,   b   .   v   a   l   u   e   !   =   =   a   .   v   a   l   u   e   &amp;   &amp;   (   b   .   v   a   l   u   e   =   a   .   v   a   l   u   e   )   ;   b   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   f   .   e   x   p   a   n   d   o   )   }   }   f   u   n   c   t   i   o   n       b   j   (   a   ,   b   )   {   i   f   (   b   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   !   !   f   .   h   a   s   D   a   t   a   (   a   )   )   {   v   a   r       c   ,   d   ,   e   ,   g   =   f   .   _   d   a   t   a   (   a   )   ,   h   =   f   .   _   d   a   t   a   (   b   ,   g   )   ,   i   =   g   .   e   v   e   n   t   s   ;   i   f   (   i   )   {   d   e   l   e   t   e       h   .   h   a   n   d   l   e   ,   h   .   e   v   e   n   t   s   =   {   }   ;   f   o   r   (   c       i   n       i   )   f   o   r   (   d   =   0   ,   e   =   i   [   c   ]   .   l   e   n   g   t   h   ;   d   &lt;   e   ;   d   +   +   )   f   .   e   v   e   n   t   .   a   d   d   (   b   ,   c   +   (   i   [   c   ]   [   d   ]   .   n   a   m   e   s   p   a   c   e   ?   "   .   "   :   "   "   )   +   i   [   c   ]   [   d   ]   .   n   a   m   e   s   p   a   c   e   ,   i   [   c   ]   [   d   ]   ,   i   [   c   ]   [   d   ]   .   d   a   t   a   )   }   h   .   d   a   t   a   &amp;   &amp;   (   h   .   d   a   t   a   =   f   .   e   x   t   e   n   d   (   {   }   ,   h   .   d   a   t   a   )   )   }   }   f   u   n   c   t   i   o   n       b   i   (   a   ,   b   )   {   r   e   t   u   r   n       f   .   n   o   d   e   N   a   m   e   (   a   ,   "   t   a   b   l   e   "   )   ?   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   t   b   o   d   y   "   )   [   0   ]   |   |   a   .   a   p   p   e   n   d   C   h   i   l   d   (   a   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   t   b   o   d   y   "   )   )   :   a   }   f   u   n   c   t   i   o   n       U   (   a   )   {   v   a   r       b   =   V   .   s   p   l   i   t   (   "   |   "   )   ,   c   =   a   .   c   r   e   a   t   e   D   o   c   u   m   e   n   t   F   r   a   g   m   e   n   t   (   )   ;   i   f   (   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   )   w   h   i   l   e   (   b   .   l   e   n   g   t   h   )   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   b   .   p   o   p   (   )   )   ;   r   e   t   u   r   n       c   }   f   u   n   c   t   i   o   n       T   (   a   ,   b   ,   c   )   {   b   =   b   |   |   0   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   b   )   )   r   e   t   u   r   n       f   .   g   r   e   p   (   a   ,   f   u   n   c   t   i   o   n   (   a   ,   d   )   {   v   a   r       e   =   !   !   b   .   c   a   l   l   (   a   ,   d   ,   a   )   ;   r   e   t   u   r   n       e   =   =   =   c   }   )   ;   i   f   (   b   .   n   o   d   e   T   y   p   e   )   r   e   t   u   r   n       f   .   g   r   e   p   (   a   ,   f   u   n   c   t   i   o   n   (   a   ,   d   )   {   r   e   t   u   r   n       a   =   =   =   b   =   =   =   c   }   )   ;   i   f   (   t   y   p   e   o   f       b   =   =   "   s   t   r   i   n   g   "   )   {   v   a   r       d   =   f   .   g   r   e   p   (   a   ,   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   T   y   p   e   =   =   =   1   }   )   ;   i   f   (   O   .   t   e   s   t   (   b   )   )   r   e   t   u   r   n       f   .   f   i   l   t   e   r   (   b   ,   d   ,   !   c   )   ;   b   =   f   .   f   i   l   t   e   r   (   b   ,   d   )   }   r   e   t   u   r   n       f   .   g   r   e   p   (   a   ,   f   u   n   c   t   i   o   n   (   a   ,   d   )   {   r   e   t   u   r   n       f   .   i   n   A   r   r   a   y   (   a   ,   b   )   &gt;   =   0   =   =   =   c   }   )   }   f   u   n   c   t   i   o   n       S   (   a   )   {   r   e   t   u   r   n   !   a   |   |   !   a   .   p   a   r   e   n   t   N   o   d   e   |   |   a   .   p   a   r   e   n   t   N   o   d   e   .   n   o   d   e   T   y   p   e   =   =   =   1   1   }   f   u   n   c   t   i   o   n       K   (   )   {   r   e   t   u   r   n   !   0   }   f   u   n   c   t   i   o   n       J   (   )   {   r   e   t   u   r   n   !   1   }   f   u   n   c   t   i   o   n       n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   b   +   "   d   e   f   e   r   "   ,   e   =   b   +   "   q   u   e   u   e   "   ,   g   =   b   +   "   m   a   r   k   "   ,   h   =   f   .   _   d   a   t   a   (   a   ,   d   )   ;   h   &amp;   &amp;   (   c   =   =   =   "   q   u   e   u   e   "   |   |   !   f   .   _   d   a   t   a   (   a   ,   e   )   )   &amp;   &amp;   (   c   =   =   =   "   m   a   r   k   "   |   |   !   f   .   _   d   a   t   a   (   a   ,   g   )   )   &amp;   &amp;   s   e   t   T   i   m   e   o   u   t   (   f   u   n   c   t   i   o   n   (   )   {   !   f   .   _   d   a   t   a   (   a   ,   e   )   &amp;   &amp;   !   f   .   _   d   a   t   a   (   a   ,   g   )   &amp;   &amp;   (   f   .   r   e   m   o   v   e   D   a   t   a   (   a   ,   d   ,   !   0   )   ,   h   .   f   i   r   e   (   )   )   }   ,   0   )   }   f   u   n   c   t   i   o   n       m   (   a   )   {   f   o   r   (   v   a   r       b       i   n       a   )   {   i   f   (   b   =   =   =   "   d   a   t   a   "   &amp;   &amp;   f   .   i   s   E   m   p   t   y   O   b   j   e   c   t   (   a   [   b   ]   )   )   c   o   n   t   i   n   u   e   ;   i   f   (   b   !   =   =   "   t   o   J   S   O   N   "   )   r   e   t   u   r   n   !   1   }   r   e   t   u   r   n   !   0   }   f   u   n   c   t   i   o   n       l   (   a   ,   c   ,   d   )   {   i   f   (   d   =   =   =   b   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   v   a   r       e   =   "   d   a   t   a   -   "   +   c   .   r   e   p   l   a   c   e   (   k   ,   "   -   $   1   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   d   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   e   )   ;   i   f   (   t   y   p   e   o   f       d   =   =   "   s   t   r   i   n   g   "   )   {   t   r   y   {   d   =   d   =   =   =   "   t   r   u   e   "   ?   !   0   :   d   =   =   =   "   f   a   l   s   e   "   ?   !   1   :   d   =   =   =   "   n   u   l   l   "   ?   n   u   l   l   :   f   .   i   s   N   u   m   e   r   i   c   (   d   )   ?   p   a   r   s   e   F   l   o   a   t   (   d   )   :   j   .   t   e   s   t   (   d   )   ?   f   .   p   a   r   s   e   J   S   O   N   (   d   )   :   d   }   c   a   t   c   h   (   g   )   {   }   f   .   d   a   t   a   (   a   ,   c   ,   d   )   }   e   l   s   e       d   =   b   }   r   e   t   u   r   n       d   }   f   u   n   c   t   i   o   n       h   (   a   )   {   v   a   r       b   =   g   [   a   ]   =   {   }   ,   c   ,   d   ;   a   =   a   .   s   p   l   i   t   (   /   \   s   +   /   )   ;   f   o   r   (   c   =   0   ,   d   =   a   .   l   e   n   g   t   h   ;   c   &lt;   d   ;   c   +   +   )   b   [   a   [   c   ]   ]   =   !   0   ;   r   e   t   u   r   n       b   }   v   a   r       c   =   a   .   d   o   c   u   m   e   n   t   ,   d   =   a   .   n   a   v   i   g   a   t   o   r   ,   e   =   a   .   l   o   c   a   t   i   o   n   ,   f   =   f   u   n   c   t   i   o   n   (   )   {   f   u   n   c   t   i   o   n       J   (   )   {   i   f   (   !   e   .   i   s   R   e   a   d   y   )   {   t   r   y   {   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   d   o   S   c   r   o   l   l   (   "   l   e   f   t   "   )   }   c   a   t   c   h   (   a   )   {   s   e   t   T   i   m   e   o   u   t   (   J   ,   1   )   ;   r   e   t   u   r   n   }   e   .   r   e   a   d   y   (   )   }   }   v   a   r       e   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       n   e   w       e   .   f   n   .   i   n   i   t   (   a   ,   b   ,   h   )   }   ,   f   =   a   .   j   Q   u   e   r   y   ,   g   =   a   .   $   ,   h   ,   i   =   /   ^   (   ?   :   [   ^   #   &lt;   ]   *   (   &lt;   [   \   w   \   W   ]   +   &gt;   )   [   ^   &gt;   ]   *   $   |   #   (   [   \   w   \   -   ]   *   )   $   )   /   ,   j   =   /   \   S   /   ,   k   =   /   ^   \   s   +   /   ,   l   =   /   \   s   +   $   /   ,   m   =   /   ^   &lt;   (   \   w   +   )   \   s   *   \   /   ?   &gt;   (   ?   :   &lt;   \   /   \   1   &gt;   )   ?   $   /   ,   n   =   /   ^   [   \   ]   ,   :   {   }   \   s   ]   *   $   /   ,   o   =   /   \   \   (   ?   :   [   "   \   \   \   /   b   f   n   r   t   ]   |   u   [   0   -   9   a   -   f   A   -   F   ]   {   4   }   )   /   g   ,   p   =   /   "   [   ^   "   \   \   \   n   \   r   ]   *   "   |   t   r   u   e   |   f   a   l   s   e   |   n   u   l   l   |   -   ?   \   d   +   (   ?   :   \   .   \   d   *   )   ?   (   ?   :   [   e   E   ]   [   +   \   -   ]   ?   \   d   +   )   ?   /   g   ,   q   =   /   (   ?   :   ^   |   :   |   ,   )   (   ?   :   \   s   *   \   [   )   +   /   g   ,   r   =   /   (   w   e   b   k   i   t   )   [       \   /   ]   (   [   \   w   .   ]   +   )   /   ,   s   =   /   (   o   p   e   r   a   )   (   ?   :   .   *   v   e   r   s   i   o   n   )   ?   [       \   /   ]   (   [   \   w   .   ]   +   )   /   ,   t   =   /   (   m   s   i   e   )       (   [   \   w   .   ]   +   )   /   ,   u   =   /   (   m   o   z   i   l   l   a   )   (   ?   :   .   *   ?       r   v   :   (   [   \   w   .   ]   +   )   )   ?   /   ,   v   =   /   -   (   [   a   -   z   ]   |   [   0   -   9   ]   )   /   i   g   ,   w   =   /   ^   -   m   s   -   /   ,   x   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n   (   b   +   "   "   )   .   t   o   U   p   p   e   r   C   a   s   e   (   )   }   ,   y   =   d   .   u   s   e   r   A   g   e   n   t   ,   z   ,   A   ,   B   ,   C   =   O   b   j   e   c   t   .   p   r   o   t   o   t   y   p   e   .   t   o   S   t   r   i   n   g   ,   D   =   O   b   j   e   c   t   .   p   r   o   t   o   t   y   p   e   .   h   a   s   O   w   n   P   r   o   p   e   r   t   y   ,   E   =   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   p   u   s   h   ,   F   =   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   s   l   i   c   e   ,   G   =   S   t   r   i   n   g   .   p   r   o   t   o   t   y   p   e   .   t   r   i   m   ,   H   =   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   i   n   d   e   x   O   f   ,   I   =   {   }   ;   e   .   f   n   =   e   .   p   r   o   t   o   t   y   p   e   =   {   c   o   n   s   t   r   u   c   t   o   r   :   e   ,   i   n   i   t   :   f   u   n   c   t   i   o   n   (   a   ,   d   ,   f   )   {   v   a   r       g   ,   h   ,   j   ,   k   ;   i   f   (   !   a   )   r   e   t   u   r   n       t   h   i   s   ;   i   f   (   a   .   n   o   d   e   T   y   p   e   )   {   t   h   i   s   .   c   o   n   t   e   x   t   =   t   h   i   s   [   0   ]   =   a   ,   t   h   i   s   .   l   e   n   g   t   h   =   1   ;   r   e   t   u   r   n       t   h   i   s   }   i   f   (   a   =   =   =   "   b   o   d   y   "   &amp;   &amp;   !   d   &amp;   &amp;   c   .   b   o   d   y   )   {   t   h   i   s   .   c   o   n   t   e   x   t   =   c   ,   t   h   i   s   [   0   ]   =   c   .   b   o   d   y   ,   t   h   i   s   .   s   e   l   e   c   t   o   r   =   a   ,   t   h   i   s   .   l   e   n   g   t   h   =   1   ;   r   e   t   u   r   n       t   h   i   s   }   i   f   (   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   )   {   a   .   c   h   a   r   A   t   (   0   )   !   =   =   "   &lt;   "   |   |   a   .   c   h   a   r   A   t   (   a   .   l   e   n   g   t   h   -   1   )   !   =   =   "   &gt;   "   |   |   a   .   l   e   n   g   t   h   &lt;   3   ?   g   =   i   .   e   x   e   c   (   a   )   :   g   =   [   n   u   l   l   ,   a   ,   n   u   l   l   ]   ;   i   f   (   g   &amp;   &amp;   (   g   [   1   ]   |   |   !   d   )   )   {   i   f   (   g   [   1   ]   )   {   d   =   d       i   n   s   t   a   n   c   e   o   f       e   ?   d   [   0   ]   :   d   ,   k   =   d   ?   d   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   d   :   c   ,   j   =   m   .   e   x   e   c   (   a   )   ,   j   ?   e   .   i   s   P   l   a   i   n   O   b   j   e   c   t   (   d   )   ?   (   a   =   [   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   j   [   1   ]   )   ]   ,   e   .   f   n   .   a   t   t   r   .   c   a   l   l   (   a   ,   d   ,   !   0   )   )   :   a   =   [   k   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   j   [   1   ]   )   ]   :   (   j   =   e   .   b   u   i   l   d   F   r   a   g   m   e   n   t   (   [   g   [   1   ]   ]   ,   [   k   ]   )   ,   a   =   (   j   .   c   a   c   h   e   a   b   l   e   ?   e   .   c   l   o   n   e   (   j   .   f   r   a   g   m   e   n   t   )   :   j   .   f   r   a   g   m   e   n   t   )   .   c   h   i   l   d   N   o   d   e   s   )   ;   r   e   t   u   r   n       e   .   m   e   r   g   e   (   t   h   i   s   ,   a   )   }   h   =   c   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   (   g   [   2   ]   )   ;   i   f   (   h   &amp;   &amp;   h   .   p   a   r   e   n   t   N   o   d   e   )   {   i   f   (   h   .   i   d   !   =   =   g   [   2   ]   )   r   e   t   u   r   n       f   .   f   i   n   d   (   a   )   ;   t   h   i   s   .   l   e   n   g   t   h   =   1   ,   t   h   i   s   [   0   ]   =   h   }   t   h   i   s   .   c   o   n   t   e   x   t   =   c   ,   t   h   i   s   .   s   e   l   e   c   t   o   r   =   a   ;   r   e   t   u   r   n       t   h   i   s   }   r   e   t   u   r   n   !   d   |   |   d   .   j   q   u   e   r   y   ?   (   d   |   |   f   )   .   f   i   n   d   (   a   )   :   t   h   i   s   .   c   o   n   s   t   r   u   c   t   o   r   (   d   )   .   f   i   n   d   (   a   )   }   i   f   (   e   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       f   .   r   e   a   d   y   (   a   )   ;   a   .   s   e   l   e   c   t   o   r   !   =   =   b   &amp;   &amp;   (   t   h   i   s   .   s   e   l   e   c   t   o   r   =   a   .   s   e   l   e   c   t   o   r   ,   t   h   i   s   .   c   o   n   t   e   x   t   =   a   .   c   o   n   t   e   x   t   )   ;   r   e   t   u   r   n       e   .   m   a   k   e   A   r   r   a   y   (   a   ,   t   h   i   s   )   }   ,   s   e   l   e   c   t   o   r   :   "   "   ,   j   q   u   e   r   y   :   "   1   .   7   .   1   "   ,   l   e   n   g   t   h   :   0   ,   s   i   z   e   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   l   e   n   g   t   h   }   ,   t   o   A   r   r   a   y   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       F   .   c   a   l   l   (   t   h   i   s   ,   0   )   }   ,   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   t   h   i   s   .   t   o   A   r   r   a   y   (   )   :   a   &lt;   0   ?   t   h   i   s   [   t   h   i   s   .   l   e   n   g   t   h   +   a   ]   :   t   h   i   s   [   a   ]   }   ,   p   u   s   h   S   t   a   c   k   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   t   h   i   s   .   c   o   n   s   t   r   u   c   t   o   r   (   )   ;   e   .   i   s   A   r   r   a   y   (   a   )   ?   E   .   a   p   p   l   y   (   d   ,   a   )   :   e   .   m   e   r   g   e   (   d   ,   a   )   ,   d   .   p   r   e   v   O   b   j   e   c   t   =   t   h   i   s   ,   d   .   c   o   n   t   e   x   t   =   t   h   i   s   .   c   o   n   t   e   x   t   ,   b   =   =   =   "   f   i   n   d   "   ?   d   .   s   e   l   e   c   t   o   r   =   t   h   i   s   .   s   e   l   e   c   t   o   r   +   (   t   h   i   s   .   s   e   l   e   c   t   o   r   ?   "       "   :   "   "   )   +   c   :   b   &amp;   &amp;   (   d   .   s   e   l   e   c   t   o   r   =   t   h   i   s   .   s   e   l   e   c   t   o   r   +   "   .   "   +   b   +   "   (   "   +   c   +   "   )   "   )   ;   r   e   t   u   r   n       d   }   ,   e   a   c   h   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       e   .   e   a   c   h   (   t   h   i   s   ,   a   ,   b   )   }   ,   r   e   a   d   y   :   f   u   n   c   t   i   o   n   (   a   )   {   e   .   b   i   n   d   R   e   a   d   y   (   )   ,   A   .   a   d   d   (   a   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   e   q   :   f   u   n   c   t   i   o   n   (   a   )   {   a   =   +   a   ;   r   e   t   u   r   n       a   =   =   =   -   1   ?   t   h   i   s   .   s   l   i   c   e   (   a   )   :   t   h   i   s   .   s   l   i   c   e   (   a   ,   a   +   1   )   }   ,   f   i   r   s   t   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   e   q   (   0   )   }   ,   l   a   s   t   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   e   q   (   -   1   )   }   ,   s   l   i   c   e   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   F   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   ,   "   s   l   i   c   e   "   ,   F   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   )   .   j   o   i   n   (   "   ,   "   )   )   }   ,   m   a   p   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   e   .   m   a   p   (   t   h   i   s   ,   f   u   n   c   t   i   o   n   (   b   ,   c   )   {   r   e   t   u   r   n       a   .   c   a   l   l   (   b   ,   c   ,   b   )   }   )   )   }   ,   e   n   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   p   r   e   v   O   b   j   e   c   t   |   |   t   h   i   s   .   c   o   n   s   t   r   u   c   t   o   r   (   n   u   l   l   )   }   ,   p   u   s   h   :   E   ,   s   o   r   t   :   [   ]   .   s   o   r   t   ,   s   p   l   i   c   e   :   [   ]   .   s   p   l   i   c   e   }   ,   e   .   f   n   .   i   n   i   t   .   p   r   o   t   o   t   y   p   e   =   e   .   f   n   ,   e   .   e   x   t   e   n   d   =   e   .   f   n   .   e   x   t   e   n   d   =   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   ,   c   ,   d   ,   f   ,   g   ,   h   ,   i   =   a   r   g   u   m   e   n   t   s   [   0   ]   |   |   {   }   ,   j   =   1   ,   k   =   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   ,   l   =   !   1   ;   t   y   p   e   o   f       i   =   =   "   b   o   o   l   e   a   n   "   &amp;   &amp;   (   l   =   i   ,   i   =   a   r   g   u   m   e   n   t   s   [   1   ]   |   |   {   }   ,   j   =   2   )   ,   t   y   p   e   o   f       i   !   =   "   o   b   j   e   c   t   "   &amp;   &amp;   !   e   .   i   s   F   u   n   c   t   i   o   n   (   i   )   &amp;   &amp;   (   i   =   {   }   )   ,   k   =   =   =   j   &amp;   &amp;   (   i   =   t   h   i   s   ,   -   -   j   )   ;   f   o   r   (   ;   j   &lt;   k   ;   j   +   +   )   i   f   (   (   a   =   a   r   g   u   m   e   n   t   s   [   j   ]   )   !   =   n   u   l   l   )   f   o   r   (   c       i   n       a   )   {   d   =   i   [   c   ]   ,   f   =   a   [   c   ]   ;   i   f   (   i   =   =   =   f   )   c   o   n   t   i   n   u   e   ;   l   &amp;   &amp;   f   &amp;   &amp;   (   e   .   i   s   P   l   a   i   n   O   b   j   e   c   t   (   f   )   |   |   (   g   =   e   .   i   s   A   r   r   a   y   (   f   )   )   )   ?   (   g   ?   (   g   =   !   1   ,   h   =   d   &amp;   &amp;   e   .   i   s   A   r   r   a   y   (   d   )   ?   d   :   [   ]   )   :   h   =   d   &amp;   &amp;   e   .   i   s   P   l   a   i   n   O   b   j   e   c   t   (   d   )   ?   d   :   {   }   ,   i   [   c   ]   =   e   .   e   x   t   e   n   d   (   l   ,   h   ,   f   )   )   :   f   !   =   =   b   &amp;   &amp;   (   i   [   c   ]   =   f   )   }   r   e   t   u   r   n       i   }   ,   e   .   e   x   t   e   n   d   (   {   n   o   C   o   n   f   l   i   c   t   :   f   u   n   c   t   i   o   n   (   b   )   {   a   .   $   =   =   =   e   &amp;   &amp;   (   a   .   $   =   g   )   ,   b   &amp;   &amp;   a   .   j   Q   u   e   r   y   =   =   =   e   &amp;   &amp;   (   a   .   j   Q   u   e   r   y   =   f   )   ;   r   e   t   u   r   n       e   }   ,   i   s   R   e   a   d   y   :   !   1   ,   r   e   a   d   y   W   a   i   t   :   1   ,   h   o   l   d   R   e   a   d   y   :   f   u   n   c   t   i   o   n   (   a   )   {   a   ?   e   .   r   e   a   d   y   W   a   i   t   +   +   :   e   .   r   e   a   d   y   (   !   0   )   }   ,   r   e   a   d   y   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   =   =   =   !   0   &amp;   &amp;   !   -   -   e   .   r   e   a   d   y   W   a   i   t   |   |   a   !   =   =   !   0   &amp;   &amp;   !   e   .   i   s   R   e   a   d   y   )   {   i   f   (   !   c   .   b   o   d   y   )   r   e   t   u   r   n       s   e   t   T   i   m   e   o   u   t   (   e   .   r   e   a   d   y   ,   1   )   ;   e   .   i   s   R   e   a   d   y   =   !   0   ;   i   f   (   a   !   =   =   !   0   &amp;   &amp;   -   -   e   .   r   e   a   d   y   W   a   i   t   &gt;   0   )   r   e   t   u   r   n   ;   A   .   f   i   r   e   W   i   t   h   (   c   ,   [   e   ]   )   ,   e   .   f   n   .   t   r   i   g   g   e   r   &amp;   &amp;   e   (   c   )   .   t   r   i   g   g   e   r   (   "   r   e   a   d   y   "   )   .   o   f   f   (   "   r   e   a   d   y   "   )   }   }   ,   b   i   n   d   R   e   a   d   y   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   !   A   )   {   A   =   e   .   C   a   l   l   b   a   c   k   s   (   "   o   n   c   e       m   e   m   o   r   y   "   )   ;   i   f   (   c   .   r   e   a   d   y   S   t   a   t   e   =   =   =   "   c   o   m   p   l   e   t   e   "   )   r   e   t   u   r   n       s   e   t   T   i   m   e   o   u   t   (   e   .   r   e   a   d   y   ,   1   )   ;   i   f   (   c   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   )   c   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   (   "   D   O   M   C   o   n   t   e   n   t   L   o   a   d   e   d   "   ,   B   ,   !   1   )   ,   a   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   (   "   l   o   a   d   "   ,   e   .   r   e   a   d   y   ,   !   1   )   ;   e   l   s   e       i   f   (   c   .   a   t   t   a   c   h   E   v   e   n   t   )   {   c   .   a   t   t   a   c   h   E   v   e   n   t   (   "   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   "   ,   B   )   ,   a   .   a   t   t   a   c   h   E   v   e   n   t   (   "   o   n   l   o   a   d   "   ,   e   .   r   e   a   d   y   )   ;   v   a   r       b   =   !   1   ;   t   r   y   {   b   =   a   .   f   r   a   m   e   E   l   e   m   e   n   t   =   =   n   u   l   l   }   c   a   t   c   h   (   d   )   {   }   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   d   o   S   c   r   o   l   l   &amp;   &amp;   b   &amp;   &amp;   J   (   )   }   }   }   ,   i   s   F   u   n   c   t   i   o   n   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       e   .   t   y   p   e   (   a   )   =   =   =   "   f   u   n   c   t   i   o   n   "   }   ,   i   s   A   r   r   a   y   :   A   r   r   a   y   .   i   s   A   r   r   a   y   |   |   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       e   .   t   y   p   e   (   a   )   =   =   =   "   a   r   r   a   y   "   }   ,   i   s   W   i   n   d   o   w   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   &amp;   &amp;   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   &amp;   &amp;   "   s   e   t   I   n   t   e   r   v   a   l   "   i   n       a   }   ,   i   s   N   u   m   e   r   i   c   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   i   s   N   a   N   (   p   a   r   s   e   F   l   o   a   t   (   a   )   )   &amp;   &amp;   i   s   F   i   n   i   t   e   (   a   )   }   ,   t   y   p   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   S   t   r   i   n   g   (   a   )   :   I   [   C   .   c   a   l   l   (   a   )   ]   |   |   "   o   b   j   e   c   t   "   }   ,   i   s   P   l   a   i   n   O   b   j   e   c   t   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   !   a   |   |   e   .   t   y   p   e   (   a   )   !   =   =   "   o   b   j   e   c   t   "   |   |   a   .   n   o   d   e   T   y   p   e   |   |   e   .   i   s   W   i   n   d   o   w   (   a   )   )   r   e   t   u   r   n   !   1   ;   t   r   y   {   i   f   (   a   .   c   o   n   s   t   r   u   c   t   o   r   &amp;   &amp;   !   D   .   c   a   l   l   (   a   ,   "   c   o   n   s   t   r   u   c   t   o   r   "   )   &amp;   &amp;   !   D   .   c   a   l   l   (   a   .   c   o   n   s   t   r   u   c   t   o   r   .   p   r   o   t   o   t   y   p   e   ,   "   i   s   P   r   o   t   o   t   y   p   e   O   f   "   )   )   r   e   t   u   r   n   !   1   }   c   a   t   c   h   (   c   )   {   r   e   t   u   r   n   !   1   }   v   a   r       d   ;   f   o   r   (   d       i   n       a   )   ;   r   e   t   u   r   n       d   =   =   =   b   |   |   D   .   c   a   l   l   (   a   ,   d   )   }   ,   i   s   E   m   p   t   y   O   b   j   e   c   t   :   f   u   n   c   t   i   o   n   (   a   )   {   f   o   r   (   v   a   r       b       i   n       a   )   r   e   t   u   r   n   !   1   ;   r   e   t   u   r   n   !   0   }   ,   e   r   r   o   r   :   f   u   n   c   t   i   o   n   (   a   )   {   t   h   r   o   w       n   e   w       E   r   r   o   r   (   a   )   }   ,   p   a   r   s   e   J   S   O   N   :   f   u   n   c   t   i   o   n   (   b   )   {   i   f   (   t   y   p   e   o   f       b   !   =   "   s   t   r   i   n   g   "   |   |   !   b   )   r   e   t   u   r   n       n   u   l   l   ;   b   =   e   .   t   r   i   m   (   b   )   ;   i   f   (   a   .   J   S   O   N   &amp;   &amp;   a   .   J   S   O   N   .   p   a   r   s   e   )   r   e   t   u   r   n       a   .   J   S   O   N   .   p   a   r   s   e   (   b   )   ;   i   f   (   n   .   t   e   s   t   (   b   .   r   e   p   l   a   c   e   (   o   ,   "   @   "   )   .   r   e   p   l   a   c   e   (   p   ,   "   ]   "   )   .   r   e   p   l   a   c   e   (   q   ,   "   "   )   )   )   r   e   t   u   r   n   (   n   e   w       F   u   n   c   t   i   o   n   (   "   r   e   t   u   r   n       "   +   b   )   )   (   )   ;   e   .   e   r   r   o   r   (   "   I   n   v   a   l   i   d       J   S   O   N   :       "   +   b   )   }   ,   p   a   r   s   e   X   M   L   :   f   u   n   c   t   i   o   n   (   c   )   {   v   a   r       d   ,   f   ;   t   r   y   {   a   .   D   O   M   P   a   r   s   e   r   ?   (   f   =   n   e   w       D   O   M   P   a   r   s   e   r   ,   d   =   f   .   p   a   r   s   e   F   r   o   m   S   t   r   i   n   g   (   c   ,   "   t   e   x   t   /   x   m   l   "   )   )   :   (   d   =   n   e   w       A   c   t   i   v   e   X   O   b   j   e   c   t   (   "   M   i   c   r   o   s   o   f   t   .   X   M   L   D   O   M   "   )   ,   d   .   a   s   y   n   c   =   "   f   a   l   s   e   "   ,   d   .   l   o   a   d   X   M   L   (   c   )   )   }   c   a   t   c   h   (   g   )   {   d   =   b   }   (   !   d   |   |   !   d   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   |   |   d   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   p   a   r   s   e   r   e   r   r   o   r   "   )   .   l   e   n   g   t   h   )   &amp;   &amp;   e   .   e   r   r   o   r   (   "   I   n   v   a   l   i   d       X   M   L   :       "   +   c   )   ;   r   e   t   u   r   n       d   }   ,   n   o   o   p   :   f   u   n   c   t   i   o   n   (   )   {   }   ,   g   l   o   b   a   l   E   v   a   l   :   f   u   n   c   t   i   o   n   (   b   )   {   b   &amp;   &amp;   j   .   t   e   s   t   (   b   )   &amp;   &amp;   (   a   .   e   x   e   c   S   c   r   i   p   t   |   |   f   u   n   c   t   i   o   n   (   b   )   {   a   .   e   v   a   l   .   c   a   l   l   (   a   ,   b   )   }   )   (   b   )   }   ,   c   a   m   e   l   C   a   s   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   r   e   p   l   a   c   e   (   w   ,   "   m   s   -   "   )   .   r   e   p   l   a   c   e   (   v   ,   x   )   }   ,   n   o   d   e   N   a   m   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   &amp;   &amp;   a   .   n   o   d   e   N   a   m   e   .   t   o   U   p   p   e   r   C   a   s   e   (   )   =   =   =   b   .   t   o   U   p   p   e   r   C   a   s   e   (   )   }   ,   e   a   c   h   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       f   ,   g   =   0   ,   h   =   a   .   l   e   n   g   t   h   ,   i   =   h   =   =   =   b   |   |   e   .   i   s   F   u   n   c   t   i   o   n   (   a   )   ;   i   f   (   d   )   {   i   f   (   i   )   {   f   o   r   (   f       i   n       a   )   i   f   (   c   .   a   p   p   l   y   (   a   [   f   ]   ,   d   )   =   =   =   !   1   )   b   r   e   a   k   }   e   l   s   e       f   o   r   (   ;   g   &lt;   h   ;   )   i   f   (   c   .   a   p   p   l   y   (   a   [   g   +   +   ]   ,   d   )   =   =   =   !   1   )   b   r   e   a   k   }   e   l   s   e       i   f   (   i   )   {   f   o   r   (   f       i   n       a   )   i   f   (   c   .   c   a   l   l   (   a   [   f   ]   ,   f   ,   a   [   f   ]   )   =   =   =   !   1   )   b   r   e   a   k   }   e   l   s   e       f   o   r   (   ;   g   &lt;   h   ;   )   i   f   (   c   .   c   a   l   l   (   a   [   g   ]   ,   g   ,   a   [   g   +   +   ]   )   =   =   =   !   1   )   b   r   e   a   k   ;   r   e   t   u   r   n       a   }   ,   t   r   i   m   :   G   ?   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   "   "   :   G   .   c   a   l   l   (   a   )   }   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   "   "   :   (   a   +   "   "   )   .   r   e   p   l   a   c   e   (   k   ,   "   "   )   .   r   e   p   l   a   c   e   (   l   ,   "   "   )   }   ,   m   a   k   e   A   r   r   a   y   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   b   |   |   [   ]   ;   i   f   (   a   !   =   n   u   l   l   )   {   v   a   r       d   =   e   .   t   y   p   e   (   a   )   ;   a   .   l   e   n   g   t   h   =   =   n   u   l   l   |   |   d   =   =   =   "   s   t   r   i   n   g   "   |   |   d   =   =   =   "   f   u   n   c   t   i   o   n   "   |   |   d   =   =   =   "   r   e   g   e   x   p   "   |   |   e   .   i   s   W   i   n   d   o   w   (   a   )   ?   E   .   c   a   l   l   (   c   ,   a   )   :   e   .   m   e   r   g   e   (   c   ,   a   )   }   r   e   t   u   r   n       c   }   ,   i   n   A   r   r   a   y   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ;   i   f   (   b   )   {   i   f   (   H   )   r   e   t   u   r   n       H   .   c   a   l   l   (   b   ,   a   ,   c   )   ;   d   =   b   .   l   e   n   g   t   h   ,   c   =   c   ?   c   &lt;   0   ?   M   a   t   h   .   m   a   x   (   0   ,   d   +   c   )   :   c   :   0   ;   f   o   r   (   ;   c   &lt;   d   ;   c   +   +   )   i   f   (   c       i   n       b   &amp;   &amp;   b   [   c   ]   =   =   =   a   )   r   e   t   u   r   n       c   }   r   e   t   u   r   n   -   1   }   ,   m   e   r   g   e   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   =   a   .   l   e   n   g   t   h   ,   e   =   0   ;   i   f   (   t   y   p   e   o   f       c   .   l   e   n   g   t   h   =   =   "   n   u   m   b   e   r   "   )   f   o   r   (   v   a   r       f   =   c   .   l   e   n   g   t   h   ;   e   &lt;   f   ;   e   +   +   )   a   [   d   +   +   ]   =   c   [   e   ]   ;   e   l   s   e       w   h   i   l   e   (   c   [   e   ]   !   =   =   b   )   a   [   d   +   +   ]   =   c   [   e   +   +   ]   ;   a   .   l   e   n   g   t   h   =   d   ;   r   e   t   u   r   n       a   }   ,   g   r   e   p   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   [   ]   ,   e   ;   c   =   !   !   c   ;   f   o   r   (   v   a   r       f   =   0   ,   g   =   a   .   l   e   n   g   t   h   ;   f   &lt;   g   ;   f   +   +   )   e   =   !   !   b   (   a   [   f   ]   ,   f   )   ,   c   !   =   =   e   &amp;   &amp;   d   .   p   u   s   h   (   a   [   f   ]   )   ;   r   e   t   u   r   n       d   }   ,   m   a   p   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       f   ,   g   ,   h   =   [   ]   ,   i   =   0   ,   j   =   a   .   l   e   n   g   t   h   ,   k   =   a       i   n   s   t   a   n   c   e   o   f       e   |   |   j   !   =   =   b   &amp;   &amp;   t   y   p   e   o   f       j   =   =   "   n   u   m   b   e   r   "   &amp;   &amp;   (   j   &gt;   0   &amp;   &amp;   a   [   0   ]   &amp;   &amp;   a   [   j   -   1   ]   |   |   j   =   =   =   0   |   |   e   .   i   s   A   r   r   a   y   (   a   )   )   ;   i   f   (   k   )   f   o   r   (   ;   i   &lt;   j   ;   i   +   +   )   f   =   c   (   a   [   i   ]   ,   i   ,   d   )   ,   f   !   =   n   u   l   l   &amp;   &amp;   (   h   [   h   .   l   e   n   g   t   h   ]   =   f   )   ;   e   l   s   e       f   o   r   (   g       i   n       a   )   f   =   c   (   a   [   g   ]   ,   g   ,   d   )   ,   f   !   =   n   u   l   l   &amp;   &amp;   (   h   [   h   .   l   e   n   g   t   h   ]   =   f   )   ;   r   e   t   u   r   n       h   .   c   o   n   c   a   t   .   a   p   p   l   y   (   [   ]   ,   h   )   }   ,   g   u   i   d   :   1   ,   p   r   o   x   y   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   i   f   (   t   y   p   e   o   f       c   =   =   "   s   t   r   i   n   g   "   )   {   v   a   r       d   =   a   [   c   ]   ;   c   =   a   ,   a   =   d   }   i   f   (   !   e   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       b   ;   v   a   r       f   =   F   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   ,   2   )   ,   g   =   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       a   .   a   p   p   l   y   (   c   ,   f   .   c   o   n   c   a   t   (   F   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   )   )   )   }   ;   g   .   g   u   i   d   =   a   .   g   u   i   d   =   a   .   g   u   i   d   |   |   g   .   g   u   i   d   |   |   e   .   g   u   i   d   +   +   ;   r   e   t   u   r   n       g   }   ,   a   c   c   e   s   s   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   f   ,   g   ,   h   )   {   v   a   r       i   =   a   .   l   e   n   g   t   h   ;   i   f   (   t   y   p   e   o   f       c   =   =   "   o   b   j   e   c   t   "   )   {   f   o   r   (   v   a   r       j       i   n       c   )   e   .   a   c   c   e   s   s   (   a   ,   j   ,   c   [   j   ]   ,   f   ,   g   ,   d   )   ;   r   e   t   u   r   n       a   }   i   f   (   d   !   =   =   b   )   {   f   =   !   h   &amp;   &amp;   f   &amp;   &amp;   e   .   i   s   F   u   n   c   t   i   o   n   (   d   )   ;   f   o   r   (   v   a   r       k   =   0   ;   k   &lt;   i   ;   k   +   +   )   g   (   a   [   k   ]   ,   c   ,   f   ?   d   .   c   a   l   l   (   a   [   k   ]   ,   k   ,   g   (   a   [   k   ]   ,   c   )   )   :   d   ,   h   )   ;   r   e   t   u   r   n       a   }   r   e   t   u   r   n       i   ?   g   (   a   [   0   ]   ,   c   )   :   b   }   ,   n   o   w   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   (   n   e   w       D   a   t   e   )   .   g   e   t   T   i   m   e   (   )   }   ,   u   a   M   a   t   c   h   :   f   u   n   c   t   i   o   n   (   a   )   {   a   =   a   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   v   a   r       b   =   r   .   e   x   e   c   (   a   )   |   |   s   .   e   x   e   c   (   a   )   |   |   t   .   e   x   e   c   (   a   )   |   |   a   .   i   n   d   e   x   O   f   (   "   c   o   m   p   a   t   i   b   l   e   "   )   &lt;   0   &amp;   &amp;   u   .   e   x   e   c   (   a   )   |   |   [   ]   ;   r   e   t   u   r   n   {   b   r   o   w   s   e   r   :   b   [   1   ]   |   |   "   "   ,   v   e   r   s   i   o   n   :   b   [   2   ]   |   |   "   0   "   }   }   ,   s   u   b   :   f   u   n   c   t   i   o   n   (   )   {   f   u   n   c   t   i   o   n       a   (   b   ,   c   )   {   r   e   t   u   r   n       n   e   w       a   .   f   n   .   i   n   i   t   (   b   ,   c   )   }   e   .   e   x   t   e   n   d   (   !   0   ,   a   ,   t   h   i   s   )   ,   a   .   s   u   p   e   r   c   l   a   s   s   =   t   h   i   s   ,   a   .   f   n   =   a   .   p   r   o   t   o   t   y   p   e   =   t   h   i   s   (   )   ,   a   .   f   n   .   c   o   n   s   t   r   u   c   t   o   r   =   a   ,   a   .   s   u   b   =   t   h   i   s   .   s   u   b   ,   a   .   f   n   .   i   n   i   t   =   f   u   n   c   t   i   o   n   (   d   ,   f   )   {   f   &amp;   &amp;   f       i   n   s   t   a   n   c   e   o   f       e   &amp;   &amp;   !   (   f       i   n   s   t   a   n   c   e   o   f       a   )   &amp;   &amp;   (   f   =   a   (   f   )   )   ;   r   e   t   u   r   n       e   .   f   n   .   i   n   i   t   .   c   a   l   l   (   t   h   i   s   ,   d   ,   f   ,   b   )   }   ,   a   .   f   n   .   i   n   i   t   .   p   r   o   t   o   t   y   p   e   =   a   .   f   n   ;   v   a   r       b   =   a   (   c   )   ;   r   e   t   u   r   n       a   }   ,   b   r   o   w   s   e   r   :   {   }   }   )   ,   e   .   e   a   c   h   (   "   B   o   o   l   e   a   n       N   u   m   b   e   r       S   t   r   i   n   g       F   u   n   c   t   i   o   n       A   r   r   a   y       D   a   t   e       R   e   g   E   x   p       O   b   j   e   c   t   "   .   s   p   l   i   t   (   "       "   )   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   I   [   "   [   o   b   j   e   c   t       "   +   b   +   "   ]   "   ]   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   }   )   ,   z   =   e   .   u   a   M   a   t   c   h   (   y   )   ,   z   .   b   r   o   w   s   e   r   &amp;   &amp;   (   e   .   b   r   o   w   s   e   r   [   z   .   b   r   o   w   s   e   r   ]   =   !   0   ,   e   .   b   r   o   w   s   e   r   .   v   e   r   s   i   o   n   =   z   .   v   e   r   s   i   o   n   )   ,   e   .   b   r   o   w   s   e   r   .   w   e   b   k   i   t   &amp;   &amp;   (   e   .   b   r   o   w   s   e   r   .   s   a   f   a   r   i   =   !   0   )   ,   j   .   t   e   s   t   (   "       "   )   &amp;   &amp;   (   k   =   /   ^   [   \   s   \   x   A   0   ]   +   /   ,   l   =   /   [   \   s   \   x   A   0   ]   +   $   /   )   ,   h   =   e   (   c   )   ,   c   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   ?   B   =   f   u   n   c   t   i   o   n   (   )   {   c   .   r   e   m   o   v   e   E   v   e   n   t   L   i   s   t   e   n   e   r   (   "   D   O   M   C   o   n   t   e   n   t   L   o   a   d   e   d   "   ,   B   ,   !   1   )   ,   e   .   r   e   a   d   y   (   )   }   :   c   .   a   t   t   a   c   h   E   v   e   n   t   &amp;   &amp;   (   B   =   f   u   n   c   t   i   o   n   (   )   {   c   .   r   e   a   d   y   S   t   a   t   e   =   =   =   "   c   o   m   p   l   e   t   e   "   &amp;   &amp;   (   c   .   d   e   t   a   c   h   E   v   e   n   t   (   "   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   "   ,   B   )   ,   e   .   r   e   a   d   y   (   )   )   }   )   ;   r   e   t   u   r   n       e   }   (   )   ,   g   =   {   }   ;   f   .   C   a   l   l   b   a   c   k   s   =   f   u   n   c   t   i   o   n   (   a   )   {   a   =   a   ?   g   [   a   ]   |   |   h   (   a   )   :   {   }   ;   v   a   r       c   =   [   ]   ,   d   =   [   ]   ,   e   ,   i   ,   j   ,   k   ,   l   ,   m   =   f   u   n   c   t   i   o   n   (   b   )   {   v   a   r       d   ,   e   ,   g   ,   h   ,   i   ;   f   o   r   (   d   =   0   ,   e   =   b   .   l   e   n   g   t   h   ;   d   &lt;   e   ;   d   +   +   )   g   =   b   [   d   ]   ,   h   =   f   .   t   y   p   e   (   g   )   ,   h   =   =   =   "   a   r   r   a   y   "   ?   m   (   g   )   :   h   =   =   =   "   f   u   n   c   t   i   o   n   "   &amp;   &amp;   (   !   a   .   u   n   i   q   u   e   |   |   !   o   .   h   a   s   (   g   )   )   &amp;   &amp;   c   .   p   u   s   h   (   g   )   }   ,   n   =   f   u   n   c   t   i   o   n   (   b   ,   f   )   {   f   =   f   |   |   [   ]   ,   e   =   !   a   .   m   e   m   o   r   y   |   |   [   b   ,   f   ]   ,   i   =   !   0   ,   l   =   j   |   |   0   ,   j   =   0   ,   k   =   c   .   l   e   n   g   t   h   ;   f   o   r   (   ;   c   &amp;   &amp;   l   &lt;   k   ;   l   +   +   )   i   f   (   c   [   l   ]   .   a   p   p   l   y   (   b   ,   f   )   =   =   =   !   1   &amp;   &amp;   a   .   s   t   o   p   O   n   F   a   l   s   e   )   {   e   =   !   0   ;   b   r   e   a   k   }   i   =   !   1   ,   c   &amp;   &amp;   (   a   .   o   n   c   e   ?   e   =   =   =   !   0   ?   o   .   d   i   s   a   b   l   e   (   )   :   c   =   [   ]   :   d   &amp;   &amp;   d   .   l   e   n   g   t   h   &amp;   &amp;   (   e   =   d   .   s   h   i   f   t   (   )   ,   o   .   f   i   r   e   W   i   t   h   (   e   [   0   ]   ,   e   [   1   ]   )   )   )   }   ,   o   =   {   a   d   d   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   c   )   {   v   a   r       a   =   c   .   l   e   n   g   t   h   ;   m   (   a   r   g   u   m   e   n   t   s   )   ,   i   ?   k   =   c   .   l   e   n   g   t   h   :   e   &amp;   &amp;   e   !   =   =   !   0   &amp;   &amp;   (   j   =   a   ,   n   (   e   [   0   ]   ,   e   [   1   ]   )   )   }   r   e   t   u   r   n       t   h   i   s   }   ,   r   e   m   o   v   e   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   c   )   {   v   a   r       b   =   a   r   g   u   m   e   n   t   s   ,   d   =   0   ,   e   =   b   .   l   e   n   g   t   h   ;   f   o   r   (   ;   d   &lt;   e   ;   d   +   +   )   f   o   r   (   v   a   r       f   =   0   ;   f   &lt;   c   .   l   e   n   g   t   h   ;   f   +   +   )   i   f   (   b   [   d   ]   =   =   =   c   [   f   ]   )   {   i   &amp;   &amp;   f   &lt;   =   k   &amp;   &amp;   (   k   -   -   ,   f   &lt;   =   l   &amp;   &amp;   l   -   -   )   ,   c   .   s   p   l   i   c   e   (   f   -   -   ,   1   )   ;   i   f   (   a   .   u   n   i   q   u   e   )   b   r   e   a   k   }   }   r   e   t   u   r   n       t   h   i   s   }   ,   h   a   s   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   c   )   {   v   a   r       b   =   0   ,   d   =   c   .   l   e   n   g   t   h   ;   f   o   r   (   ;   b   &lt;   d   ;   b   +   +   )   i   f   (   a   =   =   =   c   [   b   ]   )   r   e   t   u   r   n   !   0   }   r   e   t   u   r   n   !   1   }   ,   e   m   p   t   y   :   f   u   n   c   t   i   o   n   (   )   {   c   =   [   ]   ;   r   e   t   u   r   n       t   h   i   s   }   ,   d   i   s   a   b   l   e   :   f   u   n   c   t   i   o   n   (   )   {   c   =   d   =   e   =   b   ;   r   e   t   u   r   n       t   h   i   s   }   ,   d   i   s   a   b   l   e   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   !   c   }   ,   l   o   c   k   :   f   u   n   c   t   i   o   n   (   )   {   d   =   b   ,   (   !   e   |   |   e   =   =   =   !   0   )   &amp;   &amp;   o   .   d   i   s   a   b   l   e   (   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   l   o   c   k   e   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   !   d   }   ,   f   i   r   e   W   i   t   h   :   f   u   n   c   t   i   o   n   (   b   ,   c   )   {   d   &amp;   &amp;   (   i   ?   a   .   o   n   c   e   |   |   d   .   p   u   s   h   (   [   b   ,   c   ]   )   :   (   !   a   .   o   n   c   e   |   |   !   e   )   &amp;   &amp;   n   (   b   ,   c   )   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   f   i   r   e   :   f   u   n   c   t   i   o   n   (   )   {   o   .   f   i   r   e   W   i   t   h   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   f   i   r   e   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   !   !   e   }   }   ;   r   e   t   u   r   n       o   }   ;   v   a   r       i   =   [   ]   .   s   l   i   c   e   ;   f   .   e   x   t   e   n   d   (   {   D   e   f   e   r   r   e   d   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   f   .   C   a   l   l   b   a   c   k   s   (   "   o   n   c   e       m   e   m   o   r   y   "   )   ,   c   =   f   .   C   a   l   l   b   a   c   k   s   (   "   o   n   c   e       m   e   m   o   r   y   "   )   ,   d   =   f   .   C   a   l   l   b   a   c   k   s   (   "   m   e   m   o   r   y   "   )   ,   e   =   "   p   e   n   d   i   n   g   "   ,   g   =   {   r   e   s   o   l   v   e   :   b   ,   r   e   j   e   c   t   :   c   ,   n   o   t   i   f   y   :   d   }   ,   h   =   {   d   o   n   e   :   b   .   a   d   d   ,   f   a   i   l   :   c   .   a   d   d   ,   p   r   o   g   r   e   s   s   :   d   .   a   d   d   ,   s   t   a   t   e   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       e   }   ,   i   s   R   e   s   o   l   v   e   d   :   b   .   f   i   r   e   d   ,   i   s   R   e   j   e   c   t   e   d   :   c   .   f   i   r   e   d   ,   t   h   e   n   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   .   d   o   n   e   (   a   )   .   f   a   i   l   (   b   )   .   p   r   o   g   r   e   s   s   (   c   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   a   l   w   a   y   s   :   f   u   n   c   t   i   o   n   (   )   {   i   .   d   o   n   e   .   a   p   p   l   y   (   i   ,   a   r   g   u   m   e   n   t   s   )   .   f   a   i   l   .   a   p   p   l   y   (   i   ,   a   r   g   u   m   e   n   t   s   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   p   i   p   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   D   e   f   e   r   r   e   d   (   f   u   n   c   t   i   o   n   (   d   )   {   f   .   e   a   c   h   (   {   d   o   n   e   :   [   a   ,   "   r   e   s   o   l   v   e   "   ]   ,   f   a   i   l   :   [   b   ,   "   r   e   j   e   c   t   "   ]   ,   p   r   o   g   r   e   s   s   :   [   c   ,   "   n   o   t   i   f   y   "   ]   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   b   [   0   ]   ,   e   =   b   [   1   ]   ,   g   ;   f   .   i   s   F   u   n   c   t   i   o   n   (   c   )   ?   i   [   a   ]   (   f   u   n   c   t   i   o   n   (   )   {   g   =   c   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   ,   g   &amp;   &amp;   f   .   i   s   F   u   n   c   t   i   o   n   (   g   .   p   r   o   m   i   s   e   )   ?   g   .   p   r   o   m   i   s   e   (   )   .   t   h   e   n   (   d   .   r   e   s   o   l   v   e   ,   d   .   r   e   j   e   c   t   ,   d   .   n   o   t   i   f   y   )   :   d   [   e   +   "   W   i   t   h   "   ]   (   t   h   i   s   =   =   =   i   ?   d   :   t   h   i   s   ,   [   g   ]   )   }   )   :   i   [   a   ]   (   d   [   e   ]   )   }   )   }   )   .   p   r   o   m   i   s   e   (   )   }   ,   p   r   o   m   i   s   e   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   =   =   n   u   l   l   )   a   =   h   ;   e   l   s   e       f   o   r   (   v   a   r       b       i   n       h   )   a   [   b   ]   =   h   [   b   ]   ;   r   e   t   u   r   n       a   }   }   ,   i   =   h   .   p   r   o   m   i   s   e   (   {   }   )   ,   j   ;   f   o   r   (   j       i   n       g   )   i   [   j   ]   =   g   [   j   ]   .   f   i   r   e   ,   i   [   j   +   "   W   i   t   h   "   ]   =   g   [   j   ]   .   f   i   r   e   W   i   t   h   ;   i   .   d   o   n   e   (   f   u   n   c   t   i   o   n   (   )   {   e   =   "   r   e   s   o   l   v   e   d   "   }   ,   c   .   d   i   s   a   b   l   e   ,   d   .   l   o   c   k   )   .   f   a   i   l   (   f   u   n   c   t   i   o   n   (   )   {   e   =   "   r   e   j   e   c   t   e   d   "   }   ,   b   .   d   i   s   a   b   l   e   ,   d   .   l   o   c   k   )   ,   a   &amp;   &amp;   a   .   c   a   l   l   (   i   ,   i   )   ;   r   e   t   u   r   n       i   }   ,   w   h   e   n   :   f   u   n   c   t   i   o   n   (   a   )   {   f   u   n   c   t   i   o   n       m   (   a   )   {   r   e   t   u   r   n       f   u   n   c   t   i   o   n   (   b   )   {   e   [   a   ]   =   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   &gt;   1   ?   i   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   ,   0   )   :   b   ,   j   .   n   o   t   i   f   y   W   i   t   h   (   k   ,   e   )   }   }   f   u   n   c   t   i   o   n       l   (   a   )   {   r   e   t   u   r   n       f   u   n   c   t   i   o   n   (   c   )   {   b   [   a   ]   =   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   &gt;   1   ?   i   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   ,   0   )   :   c   ,   -   -   g   |   |   j   .   r   e   s   o   l   v   e   W   i   t   h   (   j   ,   b   )   }   }   v   a   r       b   =   i   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   ,   0   )   ,   c   =   0   ,   d   =   b   .   l   e   n   g   t   h   ,   e   =   A   r   r   a   y   (   d   )   ,   g   =   d   ,   h   =   d   ,   j   =   d   &lt;   =   1   &amp;   &amp;   a   &amp;   &amp;   f   .   i   s   F   u   n   c   t   i   o   n   (   a   .   p   r   o   m   i   s   e   )   ?   a   :   f   .   D   e   f   e   r   r   e   d   (   )   ,   k   =   j   .   p   r   o   m   i   s   e   (   )   ;   i   f   (   d   &gt;   1   )   {   f   o   r   (   ;   c   &lt;   d   ;   c   +   +   )   b   [   c   ]   &amp;   &amp;   b   [   c   ]   .   p   r   o   m   i   s   e   &amp;   &amp;   f   .   i   s   F   u   n   c   t   i   o   n   (   b   [   c   ]   .   p   r   o   m   i   s   e   )   ?   b   [   c   ]   .   p   r   o   m   i   s   e   (   )   .   t   h   e   n   (   l   (   c   )   ,   j   .   r   e   j   e   c   t   ,   m   (   c   )   )   :   -   -   g   ;   g   |   |   j   .   r   e   s   o   l   v   e   W   i   t   h   (   j   ,   b   )   }   e   l   s   e       j   !   =   =   a   &amp;   &amp;   j   .   r   e   s   o   l   v   e   W   i   t   h   (   j   ,   d   ?   [   a   ]   :   [   ]   )   ;   r   e   t   u   r   n       k   }   }   )   ,   f   .   s   u   p   p   o   r   t   =   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   ,   d   ,   e   ,   g   ,   h   ,   i   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ,   p   ,   q   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   r   =   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ;   q   .   s   e   t   A   t   t   r   i   b   u   t   e   (   "   c   l   a   s   s   N   a   m   e   "   ,   "   t   "   )   ,   q   .   i   n   n   e   r   H   T   M   L   =   "               &lt;   l   i   n   k   /   &gt;   &lt;   t   a   b   l   e   &gt;   &lt;   /   t   a   b   l   e   &gt;   &lt;   a       h   r   e   f   =   '   /   a   '       s   t   y   l   e   =   '   t   o   p   :   1   p   x   ;   f   l   o   a   t   :   l   e   f   t   ;   o   p   a   c   i   t   y   :   .   5   5   ;   '   &gt;   a   &lt;   /   a   &gt;   &lt;   i   n   p   u   t       t   y   p   e   =   '   c   h   e   c   k   b   o   x   '   /   &gt;   "   ,   d   =   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   ,   e   =   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   a   "   )   [   0   ]   ;   i   f   (   !   d   |   |   !   d   .   l   e   n   g   t   h   |   |   !   e   )   r   e   t   u   r   n   {   }   ;   g   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   s   e   l   e   c   t   "   )   ,   h   =   g   .   a   p   p   e   n   d   C   h   i   l   d   (   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   o   p   t   i   o   n   "   )   )   ,   i   =   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   i   n   p   u   t   "   )   [   0   ]   ,   b   =   {   l   e   a   d   i   n   g   W   h   i   t   e   s   p   a   c   e   :   q   .   f   i   r   s   t   C   h   i   l   d   .   n   o   d   e   T   y   p   e   =   =   =   3   ,   t   b   o   d   y   :   !   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   t   b   o   d   y   "   )   .   l   e   n   g   t   h   ,   h   t   m   l   S   e   r   i   a   l   i   z   e   :   !   !   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   l   i   n   k   "   )   .   l   e   n   g   t   h   ,   s   t   y   l   e   :   /   t   o   p   /   .   t   e   s   t   (   e   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   s   t   y   l   e   "   )   )   ,   h   r   e   f   N   o   r   m   a   l   i   z   e   d   :   e   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   h   r   e   f   "   )   =   =   =   "   /   a   "   ,   o   p   a   c   i   t   y   :   /   ^   0   .   5   5   /   .   t   e   s   t   (   e   .   s   t   y   l   e   .   o   p   a   c   i   t   y   )   ,   c   s   s   F   l   o   a   t   :   !   !   e   .   s   t   y   l   e   .   c   s   s   F   l   o   a   t   ,   c   h   e   c   k   O   n   :   i   .   v   a   l   u   e   =   =   =   "   o   n   "   ,   o   p   t   S   e   l   e   c   t   e   d   :   h   .   s   e   l   e   c   t   e   d   ,   g   e   t   S   e   t   A   t   t   r   i   b   u   t   e   :   q   .   c   l   a   s   s   N   a   m   e   !   =   =   "   t   "   ,   e   n   c   t   y   p   e   :   !   !   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   f   o   r   m   "   )   .   e   n   c   t   y   p   e   ,   h   t   m   l   5   C   l   o   n   e   :   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   n   a   v   "   )   .   c   l   o   n   e   N   o   d   e   (   !   0   )   .   o   u   t   e   r   H   T   M   L   !   =   =   "   &lt;   :   n   a   v   &gt;   &lt;   /   :   n   a   v   &gt;   "   ,   s   u   b   m   i   t   B   u   b   b   l   e   s   :   !   0   ,   c   h   a   n   g   e   B   u   b   b   l   e   s   :   !   0   ,   f   o   c   u   s   i   n   B   u   b   b   l   e   s   :   !   1   ,   d   e   l   e   t   e   E   x   p   a   n   d   o   :   !   0   ,   n   o   C   l   o   n   e   E   v   e   n   t   :   !   0   ,   i   n   l   i   n   e   B   l   o   c   k   N   e   e   d   s   L   a   y   o   u   t   :   !   1   ,   s   h   r   i   n   k   W   r   a   p   B   l   o   c   k   s   :   !   1   ,   r   e   l   i   a   b   l   e   M   a   r   g   i   n   R   i   g   h   t   :   !   0   }   ,   i   .   c   h   e   c   k   e   d   =   !   0   ,   b   .   n   o   C   l   o   n   e   C   h   e   c   k   e   d   =   i   .   c   l   o   n   e   N   o   d   e   (   !   0   )   .   c   h   e   c   k   e   d   ,   g   .   d   i   s   a   b   l   e   d   =   !   0   ,   b   .   o   p   t   D   i   s   a   b   l   e   d   =   !   h   .   d   i   s   a   b   l   e   d   ;   t   r   y   {   d   e   l   e   t   e       q   .   t   e   s   t   }   c   a   t   c   h   (   s   )   {   b   .   d   e   l   e   t   e   E   x   p   a   n   d   o   =   !   1   }   !   q   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   &amp;   &amp;   q   .   a   t   t   a   c   h   E   v   e   n   t   &amp;   &amp;   q   .   f   i   r   e   E   v   e   n   t   &amp;   &amp;   (   q   .   a   t   t   a   c   h   E   v   e   n   t   (   "   o   n   c   l   i   c   k   "   ,   f   u   n   c   t   i   o   n   (   )   {   b   .   n   o   C   l   o   n   e   E   v   e   n   t   =   !   1   }   )   ,   q   .   c   l   o   n   e   N   o   d   e   (   !   0   )   .   f   i   r   e   E   v   e   n   t   (   "   o   n   c   l   i   c   k   "   )   )   ,   i   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   i   n   p   u   t   "   )   ,   i   .   v   a   l   u   e   =   "   t   "   ,   i   .   s   e   t   A   t   t   r   i   b   u   t   e   (   "   t   y   p   e   "   ,   "   r   a   d   i   o   "   )   ,   b   .   r   a   d   i   o   V   a   l   u   e   =   i   .   v   a   l   u   e   =   =   =   "   t   "   ,   i   .   s   e   t   A   t   t   r   i   b   u   t   e   (   "   c   h   e   c   k   e   d   "   ,   "   c   h   e   c   k   e   d   "   )   ,   q   .   a   p   p   e   n   d   C   h   i   l   d   (   i   )   ,   k   =   c   .   c   r   e   a   t   e   D   o   c   u   m   e   n   t   F   r   a   g   m   e   n   t   (   )   ,   k   .   a   p   p   e   n   d   C   h   i   l   d   (   q   .   l   a   s   t   C   h   i   l   d   )   ,   b   .   c   h   e   c   k   C   l   o   n   e   =   k   .   c   l   o   n   e   N   o   d   e   (   !   0   )   .   c   l   o   n   e   N   o   d   e   (   !   0   )   .   l   a   s   t   C   h   i   l   d   .   c   h   e   c   k   e   d   ,   b   .   a   p   p   e   n   d   C   h   e   c   k   e   d   =   i   .   c   h   e   c   k   e   d   ,   k   .   r   e   m   o   v   e   C   h   i   l   d   (   i   )   ,   k   .   a   p   p   e   n   d   C   h   i   l   d   (   q   )   ,   q   .   i   n   n   e   r   H   T   M   L   =   "   "   ,   a   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   &amp;   &amp;   (   j   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   j   .   s   t   y   l   e   .   w   i   d   t   h   =   "   0   "   ,   j   .   s   t   y   l   e   .   m   a   r   g   i   n   R   i   g   h   t   =   "   0   "   ,   q   .   s   t   y   l   e   .   w   i   d   t   h   =   "   2   p   x   "   ,   q   .   a   p   p   e   n   d   C   h   i   l   d   (   j   )   ,   b   .   r   e   l   i   a   b   l   e   M   a   r   g   i   n   R   i   g   h   t   =   (   p   a   r   s   e   I   n   t   (   (   a   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   (   j   ,   n   u   l   l   )   |   |   {   m   a   r   g   i   n   R   i   g   h   t   :   0   }   )   .   m   a   r   g   i   n   R   i   g   h   t   ,   1   0   )   |   |   0   )   =   =   =   0   )   ;   i   f   (   q   .   a   t   t   a   c   h   E   v   e   n   t   )   f   o   r   (   o       i   n   {   s   u   b   m   i   t   :   1   ,   c   h   a   n   g   e   :   1   ,   f   o   c   u   s   i   n   :   1   }   )   n   =   "   o   n   "   +   o   ,   p   =   n       i   n       q   ,   p   |   |   (   q   .   s   e   t   A   t   t   r   i   b   u   t   e   (   n   ,   "   r   e   t   u   r   n   ;   "   )   ,   p   =   t   y   p   e   o   f       q   [   n   ]   =   =   "   f   u   n   c   t   i   o   n   "   )   ,   b   [   o   +   "   B   u   b   b   l   e   s   "   ]   =   p   ;   k   .   r   e   m   o   v   e   C   h   i   l   d   (   q   )   ,   k   =   g   =   h   =   j   =   q   =   i   =   n   u   l   l   ,   f   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   ,   d   ,   e   ,   g   ,   h   ,   i   ,   j   ,   k   ,   m   ,   n   ,   o   ,   r   =   c   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   b   o   d   y   "   )   [   0   ]   ;   !   r   |   |   (   j   =   1   ,   k   =   "   p   o   s   i   t   i   o   n   :   a   b   s   o   l   u   t   e   ;   t   o   p   :   0   ;   l   e   f   t   :   0   ;   w   i   d   t   h   :   1   p   x   ;   h   e   i   g   h   t   :   1   p   x   ;   m   a   r   g   i   n   :   0   ;   "   ,   m   =   "   v   i   s   i   b   i   l   i   t   y   :   h   i   d   d   e   n   ;   b   o   r   d   e   r   :   0   ;   "   ,   n   =   "   s   t   y   l   e   =   '   "   +   k   +   "   b   o   r   d   e   r   :   5   p   x       s   o   l   i   d       #   0   0   0   ;   p   a   d   d   i   n   g   :   0   ;   '   "   ,   o   =   "   &lt;   d   i   v       "   +   n   +   "   &gt;   &lt;   d   i   v   &gt;   &lt;   /   d   i   v   &gt;   &lt;   /   d   i   v   &gt;   "   +   "   &lt;   t   a   b   l   e       "   +   n   +   "       c   e   l   l   p   a   d   d   i   n   g   =   '   0   '       c   e   l   l   s   p   a   c   i   n   g   =   '   0   '   &gt;   "   +   "   &lt;   t   r   &gt;   &lt;   t   d   &gt;   &lt;   /   t   d   &gt;   &lt;   /   t   r   &gt;   &lt;   /   t   a   b   l   e   &gt;   "   ,   a   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   a   .   s   t   y   l   e   .   c   s   s   T   e   x   t   =   m   +   "   w   i   d   t   h   :   0   ;   h   e   i   g   h   t   :   0   ;   p   o   s   i   t   i   o   n   :   s   t   a   t   i   c   ;   t   o   p   :   0   ;   m   a   r   g   i   n   -   t   o   p   :   "   +   j   +   "   p   x   "   ,   r   .   i   n   s   e   r   t   B   e   f   o   r   e   (   a   ,   r   .   f   i   r   s   t   C   h   i   l   d   )   ,   q   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   a   .   a   p   p   e   n   d   C   h   i   l   d   (   q   )   ,   q   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   t   a   b   l   e   &gt;   &lt;   t   r   &gt;   &lt;   t   d       s   t   y   l   e   =   '   p   a   d   d   i   n   g   :   0   ;   b   o   r   d   e   r   :   0   ;   d   i   s   p   l   a   y   :   n   o   n   e   '   &gt;   &lt;   /   t   d   &gt;   &lt;   t   d   &gt;   t   &lt;   /   t   d   &gt;   &lt;   /   t   r   &gt;   &lt;   /   t   a   b   l   e   &gt;   "   ,   l   =   q   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   t   d   "   )   ,   p   =   l   [   0   ]   .   o   f   f   s   e   t   H   e   i   g   h   t   =   =   =   0   ,   l   [   0   ]   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   "   ,   l   [   1   ]   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   n   o   n   e   "   ,   b   .   r   e   l   i   a   b   l   e   H   i   d   d   e   n   O   f   f   s   e   t   s   =   p   &amp;   &amp;   l   [   0   ]   .   o   f   f   s   e   t   H   e   i   g   h   t   =   =   =   0   ,   q   .   i   n   n   e   r   H   T   M   L   =   "   "   ,   q   .   s   t   y   l   e   .   w   i   d   t   h   =   q   .   s   t   y   l   e   .   p   a   d   d   i   n   g   L   e   f   t   =   "   1   p   x   "   ,   f   .   b   o   x   M   o   d   e   l   =   b   .   b   o   x   M   o   d   e   l   =   q   .   o   f   f   s   e   t   W   i   d   t   h   =   =   =   2   ,   t   y   p   e   o   f       q   .   s   t   y   l   e   .   z   o   o   m   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   (   q   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   i   n   l   i   n   e   "   ,   q   .   s   t   y   l   e   .   z   o   o   m   =   1   ,   b   .   i   n   l   i   n   e   B   l   o   c   k   N   e   e   d   s   L   a   y   o   u   t   =   q   .   o   f   f   s   e   t   W   i   d   t   h   =   =   =   2   ,   q   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   "   ,   q   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   d   i   v       s   t   y   l   e   =   '   w   i   d   t   h   :   4   p   x   ;   '   &gt;   &lt;   /   d   i   v   &gt;   "   ,   b   .   s   h   r   i   n   k   W   r   a   p   B   l   o   c   k   s   =   q   .   o   f   f   s   e   t   W   i   d   t   h   !   =   =   2   )   ,   q   .   s   t   y   l   e   .   c   s   s   T   e   x   t   =   k   +   m   ,   q   .   i   n   n   e   r   H   T   M   L   =   o   ,   d   =   q   .   f   i   r   s   t   C   h   i   l   d   ,   e   =   d   .   f   i   r   s   t   C   h   i   l   d   ,   h   =   d   .   n   e   x   t   S   i   b   l   i   n   g   .   f   i   r   s   t   C   h   i   l   d   .   f   i   r   s   t   C   h   i   l   d   ,   i   =   {   d   o   e   s   N   o   t   A   d   d   B   o   r   d   e   r   :   e   .   o   f   f   s   e   t   T   o   p   !   =   =   5   ,   d   o   e   s   A   d   d   B   o   r   d   e   r   F   o   r   T   a   b   l   e   A   n   d   C   e   l   l   s   :   h   .   o   f   f   s   e   t   T   o   p   =   =   =   5   }   ,   e   .   s   t   y   l   e   .   p   o   s   i   t   i   o   n   =   "   f   i   x   e   d   "   ,   e   .   s   t   y   l   e   .   t   o   p   =   "   2   0   p   x   "   ,   i   .   f   i   x   e   d   P   o   s   i   t   i   o   n   =   e   .   o   f   f   s   e   t   T   o   p   =   =   =   2   0   |   |   e   .   o   f   f   s   e   t   T   o   p   =   =   =   1   5   ,   e   .   s   t   y   l   e   .   p   o   s   i   t   i   o   n   =   e   .   s   t   y   l   e   .   t   o   p   =   "   "   ,   d   .   s   t   y   l   e   .   o   v   e   r   f   l   o   w   =   "   h   i   d   d   e   n   "   ,   d   .   s   t   y   l   e   .   p   o   s   i   t   i   o   n   =   "   r   e   l   a   t   i   v   e   "   ,   i   .   s   u   b   t   r   a   c   t   s   B   o   r   d   e   r   F   o   r   O   v   e   r   f   l   o   w   N   o   t   V   i   s   i   b   l   e   =   e   .   o   f   f   s   e   t   T   o   p   =   =   =   -   5   ,   i   .   d   o   e   s   N   o   t   I   n   c   l   u   d   e   M   a   r   g   i   n   I   n   B   o   d   y   O   f   f   s   e   t   =   r   .   o   f   f   s   e   t   T   o   p   !   =   =   j   ,   r   .   r   e   m   o   v   e   C   h   i   l   d   (   a   )   ,   q   =   a   =   n   u   l   l   ,   f   .   e   x   t   e   n   d   (   b   ,   i   )   )   }   )   ;   r   e   t   u   r   n       b   }   (   )   ;   v   a   r       j   =   /   ^   (   ?   :   \   {   .   *   \   }   |   \   [   .   *   \   ]   )   $   /   ,   k   =   /   (   [   A   -   Z   ]   )   /   g   ;   f   .   e   x   t   e   n   d   (   {   c   a   c   h   e   :   {   }   ,   u   u   i   d   :   0   ,   e   x   p   a   n   d   o   :   "   j   Q   u   e   r   y   "   +   (   f   .   f   n   .   j   q   u   e   r   y   +   M   a   t   h   .   r   a   n   d   o   m   (   )   )   .   r   e   p   l   a   c   e   (   /   \   D   /   g   ,   "   "   )   ,   n   o   D   a   t   a   :   {   e   m   b   e   d   :   !   0   ,   o   b   j   e   c   t   :   "   c   l   s   i   d   :   D   2   7   C   D   B   6   E   -   A   E   6   D   -   1   1   c   f   -   9   6   B   8   -   4   4   4   5   5   3   5   4   0   0   0   0   "   ,   a   p   p   l   e   t   :   !   0   }   ,   h   a   s   D   a   t   a   :   f   u   n   c   t   i   o   n   (   a   )   {   a   =   a   .   n   o   d   e   T   y   p   e   ?   f   .   c   a   c   h   e   [   a   [   f   .   e   x   p   a   n   d   o   ]   ]   :   a   [   f   .   e   x   p   a   n   d   o   ]   ;   r   e   t   u   r   n   !   !   a   &amp;   &amp;   !   m   (   a   )   }   ,   d   a   t   a   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   )   {   i   f   (   !   !   f   .   a   c   c   e   p   t   D   a   t   a   (   a   )   )   {   v   a   r       g   ,   h   ,   i   ,   j   =   f   .   e   x   p   a   n   d   o   ,   k   =   t   y   p   e   o   f       c   =   =   "   s   t   r   i   n   g   "   ,   l   =   a   .   n   o   d   e   T   y   p   e   ,   m   =   l   ?   f   .   c   a   c   h   e   :   a   ,   n   =   l   ?   a   [   j   ]   :   a   [   j   ]   &amp;   &amp;   j   ,   o   =   c   =   =   =   "   e   v   e   n   t   s   "   ;   i   f   (   (   !   n   |   |   !   m   [   n   ]   |   |   !   o   &amp;   &amp;   !   e   &amp;   &amp;   !   m   [   n   ]   .   d   a   t   a   )   &amp;   &amp;   k   &amp;   &amp;   d   =   =   =   b   )   r   e   t   u   r   n   ;   n   |   |   (   l   ?   a   [   j   ]   =   n   =   +   +   f   .   u   u   i   d   :   n   =   j   )   ,   m   [   n   ]   |   |   (   m   [   n   ]   =   {   }   ,   l   |   |   (   m   [   n   ]   .   t   o   J   S   O   N   =   f   .   n   o   o   p   )   )   ;   i   f   (   t   y   p   e   o   f       c   =   =   "   o   b   j   e   c   t   "   |   |   t   y   p   e   o   f       c   =   =   "   f   u   n   c   t   i   o   n   "   )   e   ?   m   [   n   ]   =   f   .   e   x   t   e   n   d   (   m   [   n   ]   ,   c   )   :   m   [   n   ]   .   d   a   t   a   =   f   .   e   x   t   e   n   d   (   m   [   n   ]   .   d   a   t   a   ,   c   )   ;   g   =   h   =   m   [   n   ]   ,   e   |   |   (   h   .   d   a   t   a   |   |   (   h   .   d   a   t   a   =   {   }   )   ,   h   =   h   .   d   a   t   a   )   ,   d   !   =   =   b   &amp;   &amp;   (   h   [   f   .   c   a   m   e   l   C   a   s   e   (   c   )   ]   =   d   )   ;   i   f   (   o   &amp;   &amp;   !   h   [   c   ]   )   r   e   t   u   r   n       g   .   e   v   e   n   t   s   ;   k   ?   (   i   =   h   [   c   ]   ,   i   =   =   n   u   l   l   &amp;   &amp;   (   i   =   h   [   f   .   c   a   m   e   l   C   a   s   e   (   c   )   ]   )   )   :   i   =   h   ;   r   e   t   u   r   n       i   }   }   ,   r   e   m   o   v   e   D   a   t   a   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   !   !   f   .   a   c   c   e   p   t   D   a   t   a   (   a   )   )   {   v   a   r       d   ,   e   ,   g   ,   h   =   f   .   e   x   p   a   n   d   o   ,   i   =   a   .   n   o   d   e   T   y   p   e   ,   j   =   i   ?   f   .   c   a   c   h   e   :   a   ,   k   =   i   ?   a   [   h   ]   :   h   ;   i   f   (   !   j   [   k   ]   )   r   e   t   u   r   n   ;   i   f   (   b   )   {   d   =   c   ?   j   [   k   ]   :   j   [   k   ]   .   d   a   t   a   ;   i   f   (   d   )   {   f   .   i   s   A   r   r   a   y   (   b   )   |   |   (   b       i   n       d   ?   b   =   [   b   ]   :   (   b   =   f   .   c   a   m   e   l   C   a   s   e   (   b   )   ,   b       i   n       d   ?   b   =   [   b   ]   :   b   =   b   .   s   p   l   i   t   (   "       "   )   )   )   ;   f   o   r   (   e   =   0   ,   g   =   b   .   l   e   n   g   t   h   ;   e   &lt;   g   ;   e   +   +   )   d   e   l   e   t   e       d   [   b   [   e   ]   ]   ;   i   f   (   !   (   c   ?   m   :   f   .   i   s   E   m   p   t   y   O   b   j   e   c   t   )   (   d   )   )   r   e   t   u   r   n   }   }   i   f   (   !   c   )   {   d   e   l   e   t   e       j   [   k   ]   .   d   a   t   a   ;   i   f   (   !   m   (   j   [   k   ]   )   )   r   e   t   u   r   n   }   f   .   s   u   p   p   o   r   t   .   d   e   l   e   t   e   E   x   p   a   n   d   o   |   |   !   j   .   s   e   t   I   n   t   e   r   v   a   l   ?   d   e   l   e   t   e       j   [   k   ]   :   j   [   k   ]   =   n   u   l   l   ,   i   &amp;   &amp;   (   f   .   s   u   p   p   o   r   t   .   d   e   l   e   t   e   E   x   p   a   n   d   o   ?   d   e   l   e   t   e       a   [   h   ]   :   a   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   ?   a   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   h   )   :   a   [   h   ]   =   n   u   l   l   )   }   }   ,   _   d   a   t   a   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   d   a   t   a   (   a   ,   b   ,   c   ,   !   0   )   }   ,   a   c   c   e   p   t   D   a   t   a   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   .   n   o   d   e   N   a   m   e   )   {   v   a   r       b   =   f   .   n   o   D   a   t   a   [   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   ;   i   f   (   b   )   r   e   t   u   r   n       b   !   =   =   !   0   &amp;   &amp;   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   c   l   a   s   s   i   d   "   )   =   =   =   b   }   r   e   t   u   r   n   !   0   }   }   )   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   d   a   t   a   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   ,   e   ,   g   ,   h   =   n   u   l   l   ;   i   f   (   t   y   p   e   o   f       a   =   =   "   u   n   d   e   f   i   n   e   d   "   )   {   i   f   (   t   h   i   s   .   l   e   n   g   t   h   )   {   h   =   f   .   d   a   t   a   (   t   h   i   s   [   0   ]   )   ;   i   f   (   t   h   i   s   [   0   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   !   f   .   _   d   a   t   a   (   t   h   i   s   [   0   ]   ,   "   p   a   r   s   e   d   A   t   t   r   s   "   )   )   {   e   =   t   h   i   s   [   0   ]   .   a   t   t   r   i   b   u   t   e   s   ;   f   o   r   (   v   a   r       i   =   0   ,   j   =   e   .   l   e   n   g   t   h   ;   i   &lt;   j   ;   i   +   +   )   g   =   e   [   i   ]   .   n   a   m   e   ,   g   .   i   n   d   e   x   O   f   (   "   d   a   t   a   -   "   )   =   =   =   0   &amp;   &amp;   (   g   =   f   .   c   a   m   e   l   C   a   s   e   (   g   .   s   u   b   s   t   r   i   n   g   (   5   )   )   ,   l   (   t   h   i   s   [   0   ]   ,   g   ,   h   [   g   ]   )   )   ;   f   .   _   d   a   t   a   (   t   h   i   s   [   0   ]   ,   "   p   a   r   s   e   d   A   t   t   r   s   "   ,   !   0   )   }   }   r   e   t   u   r   n       h   }   i   f   (   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   d   a   t   a   (   t   h   i   s   ,   a   )   }   )   ;   d   =   a   .   s   p   l   i   t   (   "   .   "   )   ,   d   [   1   ]   =   d   [   1   ]   ?   "   .   "   +   d   [   1   ]   :   "   "   ;   i   f   (   c   =   =   =   b   )   {   h   =   t   h   i   s   .   t   r   i   g   g   e   r   H   a   n   d   l   e   r   (   "   g   e   t   D   a   t   a   "   +   d   [   1   ]   +   "   !   "   ,   [   d   [   0   ]   ]   )   ,   h   =   =   =   b   &amp;   &amp;   t   h   i   s   .   l   e   n   g   t   h   &amp;   &amp;   (   h   =   f   .   d   a   t   a   (   t   h   i   s   [   0   ]   ,   a   )   ,   h   =   l   (   t   h   i   s   [   0   ]   ,   a   ,   h   )   )   ;   r   e   t   u   r   n       h   =   =   =   b   &amp;   &amp;   d   [   1   ]   ?   t   h   i   s   .   d   a   t   a   (   d   [   0   ]   )   :   h   }   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   =   f   (   t   h   i   s   )   ,   e   =   [   d   [   0   ]   ,   c   ]   ;   b   .   t   r   i   g   g   e   r   H   a   n   d   l   e   r   (   "   s   e   t   D   a   t   a   "   +   d   [   1   ]   +   "   !   "   ,   e   )   ,   f   .   d   a   t   a   (   t   h   i   s   ,   a   ,   c   )   ,   b   .   t   r   i   g   g   e   r   H   a   n   d   l   e   r   (   "   c   h   a   n   g   e   D   a   t   a   "   +   d   [   1   ]   +   "   !   "   ,   e   )   }   )   }   ,   r   e   m   o   v   e   D   a   t   a   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   r   e   m   o   v   e   D   a   t   a   (   t   h   i   s   ,   a   )   }   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   _   m   a   r   k   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   a   &amp;   &amp;   (   b   =   (   b   |   |   "   f   x   "   )   +   "   m   a   r   k   "   ,   f   .   _   d   a   t   a   (   a   ,   b   ,   (   f   .   _   d   a   t   a   (   a   ,   b   )   |   |   0   )   +   1   )   )   }   ,   _   u   n   m   a   r   k   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   a   !   =   =   !   0   &amp;   &amp;   (   c   =   b   ,   b   =   a   ,   a   =   !   1   )   ;   i   f   (   b   )   {   c   =   c   |   |   "   f   x   "   ;   v   a   r       d   =   c   +   "   m   a   r   k   "   ,   e   =   a   ?   0   :   (   f   .   _   d   a   t   a   (   b   ,   d   )   |   |   1   )   -   1   ;   e   ?   f   .   _   d   a   t   a   (   b   ,   d   ,   e   )   :   (   f   .   r   e   m   o   v   e   D   a   t   a   (   b   ,   d   ,   !   0   )   ,   n   (   b   ,   c   ,   "   m   a   r   k   "   )   )   }   }   ,   q   u   e   u   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ;   i   f   (   a   )   {   b   =   (   b   |   |   "   f   x   "   )   +   "   q   u   e   u   e   "   ,   d   =   f   .   _   d   a   t   a   (   a   ,   b   )   ,   c   &amp;   &amp;   (   !   d   |   |   f   .   i   s   A   r   r   a   y   (   c   )   ?   d   =   f   .   _   d   a   t   a   (   a   ,   b   ,   f   .   m   a   k   e   A   r   r   a   y   (   c   )   )   :   d   .   p   u   s   h   (   c   )   )   ;   r   e   t   u   r   n       d   |   |   [   ]   }   }   ,   d   e   q   u   e   u   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   b   =   b   |   |   "   f   x   "   ;   v   a   r       c   =   f   .   q   u   e   u   e   (   a   ,   b   )   ,   d   =   c   .   s   h   i   f   t   (   )   ,   e   =   {   }   ;   d   =   =   =   "   i   n   p   r   o   g   r   e   s   s   "   &amp;   &amp;   (   d   =   c   .   s   h   i   f   t   (   )   )   ,   d   &amp;   &amp;   (   b   =   =   =   "   f   x   "   &amp;   &amp;   c   .   u   n   s   h   i   f   t   (   "   i   n   p   r   o   g   r   e   s   s   "   )   ,   f   .   _   d   a   t   a   (   a   ,   b   +   "   .   r   u   n   "   ,   e   )   ,   d   .   c   a   l   l   (   a   ,   f   u   n   c   t   i   o   n   (   )   {   f   .   d   e   q   u   e   u   e   (   a   ,   b   )   }   ,   e   )   )   ,   c   .   l   e   n   g   t   h   |   |   (   f   .   r   e   m   o   v   e   D   a   t   a   (   a   ,   b   +   "   q   u   e   u   e       "   +   b   +   "   .   r   u   n   "   ,   !   0   )   ,   n   (   a   ,   b   ,   "   q   u   e   u   e   "   )   )   }   }   )   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   q   u   e   u   e   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   c   =   a   ,   a   =   "   f   x   "   )   ;   i   f   (   c   =   =   =   b   )   r   e   t   u   r   n       f   .   q   u   e   u   e   (   t   h   i   s   [   0   ]   ,   a   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   =   f   .   q   u   e   u   e   (   t   h   i   s   ,   a   ,   c   )   ;   a   =   =   =   "   f   x   "   &amp;   &amp;   b   [   0   ]   !   =   =   "   i   n   p   r   o   g   r   e   s   s   "   &amp;   &amp;   f   .   d   e   q   u   e   u   e   (   t   h   i   s   ,   a   )   }   )   }   ,   d   e   q   u   e   u   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   d   e   q   u   e   u   e   (   t   h   i   s   ,   a   )   }   )   }   ,   d   e   l   a   y   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   a   =   f   .   f   x   ?   f   .   f   x   .   s   p   e   e   d   s   [   a   ]   |   |   a   :   a   ,   b   =   b   |   |   "   f   x   "   ;   r   e   t   u   r   n       t   h   i   s   .   q   u   e   u   e   (   b   ,   f   u   n   c   t   i   o   n   (   b   ,   c   )   {   v   a   r       d   =   s   e   t   T   i   m   e   o   u   t   (   b   ,   a   )   ;   c   .   s   t   o   p   =   f   u   n   c   t   i   o   n   (   )   {   c   l   e   a   r   T   i   m   e   o   u   t   (   d   )   }   }   )   }   ,   c   l   e   a   r   Q   u   e   u   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   q   u   e   u   e   (   a   |   |   "   f   x   "   ,   [   ]   )   }   ,   p   r   o   m   i   s   e   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   f   u   n   c   t   i   o   n       m   (   )   {   -   -   h   |   |   d   .   r   e   s   o   l   v   e   W   i   t   h   (   e   ,   [   e   ]   )   }   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   c   =   a   ,   a   =   b   )   ,   a   =   a   |   |   "   f   x   "   ;   v   a   r       d   =   f   .   D   e   f   e   r   r   e   d   (   )   ,   e   =   t   h   i   s   ,   g   =   e   .   l   e   n   g   t   h   ,   h   =   1   ,   i   =   a   +   "   d   e   f   e   r   "   ,   j   =   a   +   "   q   u   e   u   e   "   ,   k   =   a   +   "   m   a   r   k   "   ,   l   ;   w   h   i   l   e   (   g   -   -   )   i   f   (   l   =   f   .   d   a   t   a   (   e   [   g   ]   ,   i   ,   b   ,   !   0   )   |   |   (   f   .   d   a   t   a   (   e   [   g   ]   ,   j   ,   b   ,   !   0   )   |   |   f   .   d   a   t   a   (   e   [   g   ]   ,   k   ,   b   ,   !   0   )   )   &amp;   &amp;   f   .   d   a   t   a   (   e   [   g   ]   ,   i   ,   f   .   C   a   l   l   b   a   c   k   s   (   "   o   n   c   e       m   e   m   o   r   y   "   )   ,   !   0   )   )   h   +   +   ,   l   .   a   d   d   (   m   )   ;   m   (   )   ;   r   e   t   u   r   n       d   .   p   r   o   m   i   s   e   (   )   }   }   )   ;   v   a   r       o   =   /   [   \   n   \   t   \   r   ]   /   g   ,   p   =   /   \   s   +   /   ,   q   =   /   \   r   /   g   ,   r   =   /   ^   (   ?   :   b   u   t   t   o   n   |   i   n   p   u   t   )   $   /   i   ,   s   =   /   ^   (   ?   :   b   u   t   t   o   n   |   i   n   p   u   t   |   o   b   j   e   c   t   |   s   e   l   e   c   t   |   t   e   x   t   a   r   e   a   )   $   /   i   ,   t   =   /   ^   a   (   ?   :   r   e   a   )   ?   $   /   i   ,   u   =   /   ^   (   ?   :   a   u   t   o   f   o   c   u   s   |   a   u   t   o   p   l   a   y   |   a   s   y   n   c   |   c   h   e   c   k   e   d   |   c   o   n   t   r   o   l   s   |   d   e   f   e   r   |   d   i   s   a   b   l   e   d   |   h   i   d   d   e   n   |   l   o   o   p   |   m   u   l   t   i   p   l   e   |   o   p   e   n   |   r   e   a   d   o   n   l   y   |   r   e   q   u   i   r   e   d   |   s   c   o   p   e   d   |   s   e   l   e   c   t   e   d   )   $   /   i   ,   v   =   f   .   s   u   p   p   o   r   t   .   g   e   t   S   e   t   A   t   t   r   i   b   u   t   e   ,   w   ,   x   ,   y   ;   f   .   f   n   .   e   x   t   e   n   d   (   {   a   t   t   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       f   .   a   c   c   e   s   s   (   t   h   i   s   ,   a   ,   b   ,   !   0   ,   f   .   a   t   t   r   )   }   ,   r   e   m   o   v   e   A   t   t   r   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   r   e   m   o   v   e   A   t   t   r   (   t   h   i   s   ,   a   )   }   )   }   ,   p   r   o   p   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       f   .   a   c   c   e   s   s   (   t   h   i   s   ,   a   ,   b   ,   !   0   ,   f   .   p   r   o   p   )   }   ,   r   e   m   o   v   e   P   r   o   p   :   f   u   n   c   t   i   o   n   (   a   )   {   a   =   f   .   p   r   o   p   F   i   x   [   a   ]   |   |   a   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   t   r   y   {   t   h   i   s   [   a   ]   =   b   ,   d   e   l   e   t   e       t   h   i   s   [   a   ]   }   c   a   t   c   h   (   c   )   {   }   }   )   }   ,   a   d   d   C   l   a   s   s   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   ,   c   ,   d   ,   e   ,   g   ,   h   ,   i   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   (   t   h   i   s   )   .   a   d   d   C   l   a   s   s   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   t   h   i   s   .   c   l   a   s   s   N   a   m   e   )   )   }   )   ;   i   f   (   a   &amp;   &amp;   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   )   {   b   =   a   .   s   p   l   i   t   (   p   )   ;   f   o   r   (   c   =   0   ,   d   =   t   h   i   s   .   l   e   n   g   t   h   ;   c   &lt;   d   ;   c   +   +   )   {   e   =   t   h   i   s   [   c   ]   ;   i   f   (   e   .   n   o   d   e   T   y   p   e   =   =   =   1   )   i   f   (   !   e   .   c   l   a   s   s   N   a   m   e   &amp;   &amp;   b   .   l   e   n   g   t   h   =   =   =   1   )   e   .   c   l   a   s   s   N   a   m   e   =   a   ;   e   l   s   e   {   g   =   "       "   +   e   .   c   l   a   s   s   N   a   m   e   +   "       "   ;   f   o   r   (   h   =   0   ,   i   =   b   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   ~   g   .   i   n   d   e   x   O   f   (   "       "   +   b   [   h   ]   +   "       "   )   |   |   (   g   +   =   b   [   h   ]   +   "       "   )   ;   e   .   c   l   a   s   s   N   a   m   e   =   f   .   t   r   i   m   (   g   )   }   }   }   r   e   t   u   r   n       t   h   i   s   }   ,   r   e   m   o   v   e   C   l   a   s   s   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   ,   d   ,   e   ,   g   ,   h   ,   i   ,   j   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   (   t   h   i   s   )   .   r   e   m   o   v   e   C   l   a   s   s   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   t   h   i   s   .   c   l   a   s   s   N   a   m   e   )   )   }   )   ;   i   f   (   a   &amp;   &amp;   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   |   |   a   =   =   =   b   )   {   c   =   (   a   |   |   "   "   )   .   s   p   l   i   t   (   p   )   ;   f   o   r   (   d   =   0   ,   e   =   t   h   i   s   .   l   e   n   g   t   h   ;   d   &lt;   e   ;   d   +   +   )   {   g   =   t   h   i   s   [   d   ]   ;   i   f   (   g   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   g   .   c   l   a   s   s   N   a   m   e   )   i   f   (   a   )   {   h   =   (   "       "   +   g   .   c   l   a   s   s   N   a   m   e   +   "       "   )   .   r   e   p   l   a   c   e   (   o   ,   "       "   )   ;   f   o   r   (   i   =   0   ,   j   =   c   .   l   e   n   g   t   h   ;   i   &lt;   j   ;   i   +   +   )   h   =   h   .   r   e   p   l   a   c   e   (   "       "   +   c   [   i   ]   +   "       "   ,   "       "   )   ;   g   .   c   l   a   s   s   N   a   m   e   =   f   .   t   r   i   m   (   h   )   }   e   l   s   e       g   .   c   l   a   s   s   N   a   m   e   =   "   "   }   }   r   e   t   u   r   n       t   h   i   s   }   ,   t   o   g   g   l   e   C   l   a   s   s   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   t   y   p   e   o   f       a   ,   d   =   t   y   p   e   o   f       b   =   =   "   b   o   o   l   e   a   n   "   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   c   )   {   f   (   t   h   i   s   )   .   t   o   g   g   l   e   C   l   a   s   s   (   a   .   c   a   l   l   (   t   h   i   s   ,   c   ,   t   h   i   s   .   c   l   a   s   s   N   a   m   e   ,   b   )   ,   b   )   }   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   i   f   (   c   =   =   =   "   s   t   r   i   n   g   "   )   {   v   a   r       e   ,   g   =   0   ,   h   =   f   (   t   h   i   s   )   ,   i   =   b   ,   j   =   a   .   s   p   l   i   t   (   p   )   ;   w   h   i   l   e   (   e   =   j   [   g   +   +   ]   )   i   =   d   ?   i   :   !   h   .   h   a   s   C   l   a   s   s   (   e   )   ,   h   [   i   ?   "   a   d   d   C   l   a   s   s   "   :   "   r   e   m   o   v   e   C   l   a   s   s   "   ]   (   e   )   }   e   l   s   e       i   f   (   c   =   =   =   "   u   n   d   e   f   i   n   e   d   "   |   |   c   =   =   =   "   b   o   o   l   e   a   n   "   )   t   h   i   s   .   c   l   a   s   s   N   a   m   e   &amp;   &amp;   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   _   _   c   l   a   s   s   N   a   m   e   _   _   "   ,   t   h   i   s   .   c   l   a   s   s   N   a   m   e   )   ,   t   h   i   s   .   c   l   a   s   s   N   a   m   e   =   t   h   i   s   .   c   l   a   s   s   N   a   m   e   |   |   a   =   =   =   !   1   ?   "   "   :   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   _   _   c   l   a   s   s   N   a   m   e   _   _   "   )   |   |   "   "   }   )   }   ,   h   a   s   C   l   a   s   s   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   "       "   +   a   +   "       "   ,   c   =   0   ,   d   =   t   h   i   s   .   l   e   n   g   t   h   ;   f   o   r   (   ;   c   &lt;   d   ;   c   +   +   )   i   f   (   t   h   i   s   [   c   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   (   "       "   +   t   h   i   s   [   c   ]   .   c   l   a   s   s   N   a   m   e   +   "       "   )   .   r   e   p   l   a   c   e   (   o   ,   "       "   )   .   i   n   d   e   x   O   f   (   b   )   &gt;   -   1   )   r   e   t   u   r   n   !   0   ;   r   e   t   u   r   n   !   1   }   ,   v   a   l   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   ,   d   ,   e   ,   g   =   t   h   i   s   [   0   ]   ;   {   i   f   (   !   !   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   )   {   e   =   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   d   )   {   v   a   r       g   =   f   (   t   h   i   s   )   ,   h   ;   i   f   (   t   h   i   s   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   e   ?   h   =   a   .   c   a   l   l   (   t   h   i   s   ,   d   ,   g   .   v   a   l   (   )   )   :   h   =   a   ,   h   =   =   n   u   l   l   ?   h   =   "   "   :   t   y   p   e   o   f       h   =   =   "   n   u   m   b   e   r   "   ?   h   +   =   "   "   :   f   .   i   s   A   r   r   a   y   (   h   )   &amp;   &amp;   (   h   =   f   .   m   a   p   (   h   ,   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   "   "   :   a   +   "   "   }   )   )   ,   c   =   f   .   v   a   l   H   o   o   k   s   [   t   h   i   s   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   |   |   f   .   v   a   l   H   o   o   k   s   [   t   h   i   s   .   t   y   p   e   ]   ;   i   f   (   !   c   |   |   !   (   "   s   e   t   "   i   n       c   )   |   |   c   .   s   e   t   (   t   h   i   s   ,   h   ,   "   v   a   l   u   e   "   )   =   =   =   b   )   t   h   i   s   .   v   a   l   u   e   =   h   }   }   )   }   i   f   (   g   )   {   c   =   f   .   v   a   l   H   o   o   k   s   [   g   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   |   |   f   .   v   a   l   H   o   o   k   s   [   g   .   t   y   p   e   ]   ;   i   f   (   c   &amp;   &amp;   "   g   e   t   "   i   n       c   &amp;   &amp;   (   d   =   c   .   g   e   t   (   g   ,   "   v   a   l   u   e   "   )   )   !   =   =   b   )   r   e   t   u   r   n       d   ;   d   =   g   .   v   a   l   u   e   ;   r   e   t   u   r   n       t   y   p   e   o   f       d   =   =   "   s   t   r   i   n   g   "   ?   d   .   r   e   p   l   a   c   e   (   q   ,   "   "   )   :   d   =   =   n   u   l   l   ?   "   "   :   d   }   }   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   v   a   l   H   o   o   k   s   :   {   o   p   t   i   o   n   :   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   a   t   t   r   i   b   u   t   e   s   .   v   a   l   u   e   ;   r   e   t   u   r   n   !   b   |   |   b   .   s   p   e   c   i   f   i   e   d   ?   a   .   v   a   l   u   e   :   a   .   t   e   x   t   }   }   ,   s   e   l   e   c   t   :   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   ,   c   ,   d   ,   e   ,   g   =   a   .   s   e   l   e   c   t   e   d   I   n   d   e   x   ,   h   =   [   ]   ,   i   =   a   .   o   p   t   i   o   n   s   ,   j   =   a   .   t   y   p   e   =   =   =   "   s   e   l   e   c   t   -   o   n   e   "   ;   i   f   (   g   &lt;   0   )   r   e   t   u   r   n       n   u   l   l   ;   c   =   j   ?   g   :   0   ,   d   =   j   ?   g   +   1   :   i   .   l   e   n   g   t   h   ;   f   o   r   (   ;   c   &lt;   d   ;   c   +   +   )   {   e   =   i   [   c   ]   ;   i   f   (   e   .   s   e   l   e   c   t   e   d   &amp;   &amp;   (   f   .   s   u   p   p   o   r   t   .   o   p   t   D   i   s   a   b   l   e   d   ?   !   e   .   d   i   s   a   b   l   e   d   :   e   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   d   i   s   a   b   l   e   d   "   )   =   =   =   n   u   l   l   )   &amp;   &amp;   (   !   e   .   p   a   r   e   n   t   N   o   d   e   .   d   i   s   a   b   l   e   d   |   |   !   f   .   n   o   d   e   N   a   m   e   (   e   .   p   a   r   e   n   t   N   o   d   e   ,   "   o   p   t   g   r   o   u   p   "   )   )   )   {   b   =   f   (   e   )   .   v   a   l   (   )   ;   i   f   (   j   )   r   e   t   u   r   n       b   ;   h   .   p   u   s   h   (   b   )   }   }   i   f   (   j   &amp;   &amp;   !   h   .   l   e   n   g   t   h   &amp;   &amp;   i   .   l   e   n   g   t   h   )   r   e   t   u   r   n       f   (   i   [   g   ]   )   .   v   a   l   (   )   ;   r   e   t   u   r   n       h   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   f   .   m   a   k   e   A   r   r   a   y   (   b   )   ;   f   (   a   )   .   f   i   n   d   (   "   o   p   t   i   o   n   "   )   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   s   e   l   e   c   t   e   d   =   f   .   i   n   A   r   r   a   y   (   f   (   t   h   i   s   )   .   v   a   l   (   )   ,   c   )   &gt;   =   0   }   )   ,   c   .   l   e   n   g   t   h   |   |   (   a   .   s   e   l   e   c   t   e   d   I   n   d   e   x   =   -   1   )   ;   r   e   t   u   r   n       c   }   }   }   ,   a   t   t   r   F   n   :   {   v   a   l   :   !   0   ,   c   s   s   :   !   0   ,   h   t   m   l   :   !   0   ,   t   e   x   t   :   !   0   ,   d   a   t   a   :   !   0   ,   w   i   d   t   h   :   !   0   ,   h   e   i   g   h   t   :   !   0   ,   o   f   f   s   e   t   :   !   0   }   ,   a   t   t   r   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   )   {   v   a   r       g   ,   h   ,   i   ,   j   =   a   .   n   o   d   e   T   y   p   e   ;   i   f   (   !   !   a   &amp;   &amp;   j   !   =   =   3   &amp;   &amp;   j   !   =   =   8   &amp;   &amp;   j   !   =   =   2   )   {   i   f   (   e   &amp;   &amp;   c       i   n       f   .   a   t   t   r   F   n   )   r   e   t   u   r   n       f   (   a   )   [   c   ]   (   d   )   ;   i   f   (   t   y   p   e   o   f       a   .   g   e   t   A   t   t   r   i   b   u   t   e   =   =   "   u   n   d   e   f   i   n   e   d   "   )   r   e   t   u   r   n       f   .   p   r   o   p   (   a   ,   c   ,   d   )   ;   i   =   j   !   =   =   1   |   |   !   f   .   i   s   X   M   L   D   o   c   (   a   )   ,   i   &amp;   &amp;   (   c   =   c   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   h   =   f   .   a   t   t   r   H   o   o   k   s   [   c   ]   |   |   (   u   .   t   e   s   t   (   c   )   ?   x   :   w   )   )   ;   i   f   (   d   !   =   =   b   )   {   i   f   (   d   =   =   =   n   u   l   l   )   {   f   .   r   e   m   o   v   e   A   t   t   r   (   a   ,   c   )   ;   r   e   t   u   r   n   }   i   f   (   h   &amp;   &amp;   "   s   e   t   "   i   n       h   &amp;   &amp;   i   &amp;   &amp;   (   g   =   h   .   s   e   t   (   a   ,   d   ,   c   )   )   !   =   =   b   )   r   e   t   u   r   n       g   ;   a   .   s   e   t   A   t   t   r   i   b   u   t   e   (   c   ,   "   "   +   d   )   ;   r   e   t   u   r   n       d   }   i   f   (   h   &amp;   &amp;   "   g   e   t   "   i   n       h   &amp;   &amp;   i   &amp;   &amp;   (   g   =   h   .   g   e   t   (   a   ,   c   )   )   !   =   =   n   u   l   l   )   r   e   t   u   r   n       g   ;   g   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   c   )   ;   r   e   t   u   r   n       g   =   =   =   n   u   l   l   ?   b   :   g   }   }   ,   r   e   m   o   v   e   A   t   t   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ,   d   ,   e   ,   g   ,   h   =   0   ;   i   f   (   b   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   d   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   .   s   p   l   i   t   (   p   )   ,   g   =   d   .   l   e   n   g   t   h   ;   f   o   r   (   ;   h   &lt;   g   ;   h   +   +   )   e   =   d   [   h   ]   ,   e   &amp;   &amp;   (   c   =   f   .   p   r   o   p   F   i   x   [   e   ]   |   |   e   ,   f   .   a   t   t   r   (   a   ,   e   ,   "   "   )   ,   a   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   v   ?   e   :   c   )   ,   u   .   t   e   s   t   (   e   )   &amp;   &amp;   c       i   n       a   &amp;   &amp;   (   a   [   c   ]   =   !   1   )   )   }   }   ,   a   t   t   r   H   o   o   k   s   :   {   t   y   p   e   :   {   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   r   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   &amp;   &amp;   a   .   p   a   r   e   n   t   N   o   d   e   )   f   .   e   r   r   o   r   (   "   t   y   p   e       p   r   o   p   e   r   t   y       c   a   n   '   t       b   e       c   h   a   n   g   e   d   "   )   ;   e   l   s   e       i   f   (   !   f   .   s   u   p   p   o   r   t   .   r   a   d   i   o   V   a   l   u   e   &amp;   &amp;   b   =   =   =   "   r   a   d   i   o   "   &amp;   &amp;   f   .   n   o   d   e   N   a   m   e   (   a   ,   "   i   n   p   u   t   "   )   )   {   v   a   r       c   =   a   .   v   a   l   u   e   ;   a   .   s   e   t   A   t   t   r   i   b   u   t   e   (   "   t   y   p   e   "   ,   b   )   ,   c   &amp;   &amp;   (   a   .   v   a   l   u   e   =   c   )   ;   r   e   t   u   r   n       b   }   }   }   ,   v   a   l   u   e   :   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   w   &amp;   &amp;   f   .   n   o   d   e   N   a   m   e   (   a   ,   "   b   u   t   t   o   n   "   )   )   r   e   t   u   r   n       w   .   g   e   t   (   a   ,   b   )   ;   r   e   t   u   r   n       b       i   n       a   ?   a   .   v   a   l   u   e   :   n   u   l   l   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   w   &amp;   &amp;   f   .   n   o   d   e   N   a   m   e   (   a   ,   "   b   u   t   t   o   n   "   )   )   r   e   t   u   r   n       w   .   s   e   t   (   a   ,   b   ,   c   )   ;   a   .   v   a   l   u   e   =   b   }   }   }   ,   p   r   o   p   F   i   x   :   {   t   a   b   i   n   d   e   x   :   "   t   a   b   I   n   d   e   x   "   ,   r   e   a   d   o   n   l   y   :   "   r   e   a   d   O   n   l   y   "   ,   "   f   o   r   "   :   "   h   t   m   l   F   o   r   "   ,   "   c   l   a   s   s   "   :   "   c   l   a   s   s   N   a   m   e   "   ,   m   a   x   l   e   n   g   t   h   :   "   m   a   x   L   e   n   g   t   h   "   ,   c   e   l   l   s   p   a   c   i   n   g   :   "   c   e   l   l   S   p   a   c   i   n   g   "   ,   c   e   l   l   p   a   d   d   i   n   g   :   "   c   e   l   l   P   a   d   d   i   n   g   "   ,   r   o   w   s   p   a   n   :   "   r   o   w   S   p   a   n   "   ,   c   o   l   s   p   a   n   :   "   c   o   l   S   p   a   n   "   ,   u   s   e   m   a   p   :   "   u   s   e   M   a   p   "   ,   f   r   a   m   e   b   o   r   d   e   r   :   "   f   r   a   m   e   B   o   r   d   e   r   "   ,   c   o   n   t   e   n   t   e   d   i   t   a   b   l   e   :   "   c   o   n   t   e   n   t   E   d   i   t   a   b   l   e   "   }   ,   p   r   o   p   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       e   ,   g   ,   h   ,   i   =   a   .   n   o   d   e   T   y   p   e   ;   i   f   (   !   !   a   &amp;   &amp;   i   !   =   =   3   &amp;   &amp;   i   !   =   =   8   &amp;   &amp;   i   !   =   =   2   )   {   h   =   i   !   =   =   1   |   |   !   f   .   i   s   X   M   L   D   o   c   (   a   )   ,   h   &amp;   &amp;   (   c   =   f   .   p   r   o   p   F   i   x   [   c   ]   |   |   c   ,   g   =   f   .   p   r   o   p   H   o   o   k   s   [   c   ]   )   ;   r   e   t   u   r   n       d   !   =   =   b   ?   g   &amp;   &amp;   "   s   e   t   "   i   n       g   &amp;   &amp;   (   e   =   g   .   s   e   t   (   a   ,   d   ,   c   )   )   !   =   =   b   ?   e   :   a   [   c   ]   =   d   :   g   &amp;   &amp;   "   g   e   t   "   i   n       g   &amp;   &amp;   (   e   =   g   .   g   e   t   (   a   ,   c   )   )   !   =   =   n   u   l   l   ?   e   :   a   [   c   ]   }   }   ,   p   r   o   p   H   o   o   k   s   :   {   t   a   b   I   n   d   e   x   :   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   "   t   a   b   i   n   d   e   x   "   )   ;   r   e   t   u   r   n       c   &amp;   &amp;   c   .   s   p   e   c   i   f   i   e   d   ?   p   a   r   s   e   I   n   t   (   c   .   v   a   l   u   e   ,   1   0   )   :   s   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   |   |   t   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   &amp;   &amp;   a   .   h   r   e   f   ?   0   :   b   }   }   }   }   )   ,   f   .   a   t   t   r   H   o   o   k   s   .   t   a   b   i   n   d   e   x   =   f   .   p   r   o   p   H   o   o   k   s   .   t   a   b   I   n   d   e   x   ,   x   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   ,   e   =   f   .   p   r   o   p   (   a   ,   c   )   ;   r   e   t   u   r   n       e   =   =   =   !   0   |   |   t   y   p   e   o   f       e   !   =   "   b   o   o   l   e   a   n   "   &amp;   &amp;   (   d   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   c   )   )   &amp;   &amp;   d   .   n   o   d   e   V   a   l   u   e   !   =   =   !   1   ?   c   .   t   o   L   o   w   e   r   C   a   s   e   (   )   :   b   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ;   b   =   =   =   !   1   ?   f   .   r   e   m   o   v   e   A   t   t   r   (   a   ,   c   )   :   (   d   =   f   .   p   r   o   p   F   i   x   [   c   ]   |   |   c   ,   d       i   n       a   &amp;   &amp;   (   a   [   d   ]   =   !   0   )   ,   a   .   s   e   t   A   t   t   r   i   b   u   t   e   (   c   ,   c   .   t   o   L   o   w   e   r   C   a   s   e   (   )   )   )   ;   r   e   t   u   r   n       c   }   }   ,   v   |   |   (   y   =   {   n   a   m   e   :   !   0   ,   i   d   :   !   0   }   ,   w   =   f   .   v   a   l   H   o   o   k   s   .   b   u   t   t   o   n   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   ;   d   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   c   )   ;   r   e   t   u   r   n       d   &amp;   &amp;   (   y   [   c   ]   ?   d   .   n   o   d   e   V   a   l   u   e   !   =   =   "   "   :   d   .   s   p   e   c   i   f   i   e   d   )   ?   d   .   n   o   d   e   V   a   l   u   e   :   b   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   d   )   {   v   a   r       e   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   d   )   ;   e   |   |   (   e   =   c   .   c   r   e   a   t   e   A   t   t   r   i   b   u   t   e   (   d   )   ,   a   .   s   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   e   )   )   ;   r   e   t   u   r   n       e   .   n   o   d   e   V   a   l   u   e   =   b   +   "   "   }   }   ,   f   .   a   t   t   r   H   o   o   k   s   .   t   a   b   i   n   d   e   x   .   s   e   t   =   w   .   s   e   t   ,   f   .   e   a   c   h   (   [   "   w   i   d   t   h   "   ,   "   h   e   i   g   h   t   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   a   t   t   r   H   o   o   k   s   [   b   ]   =   f   .   e   x   t   e   n   d   (   f   .   a   t   t   r   H   o   o   k   s   [   b   ]   ,   {   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   i   f   (   c   =   =   =   "   "   )   {   a   .   s   e   t   A   t   t   r   i   b   u   t   e   (   b   ,   "   a   u   t   o   "   )   ;   r   e   t   u   r   n       c   }   }   }   )   }   )   ,   f   .   a   t   t   r   H   o   o   k   s   .   c   o   n   t   e   n   t   e   d   i   t   a   b   l   e   =   {   g   e   t   :   w   .   g   e   t   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   b   =   =   =   "   "   &amp;   &amp;   (   b   =   "   f   a   l   s   e   "   )   ,   w   .   s   e   t   (   a   ,   b   ,   c   )   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   h   r   e   f   N   o   r   m   a   l   i   z   e   d   |   |   f   .   e   a   c   h   (   [   "   h   r   e   f   "   ,   "   s   r   c   "   ,   "   w   i   d   t   h   "   ,   "   h   e   i   g   h   t   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   f   .   a   t   t   r   H   o   o   k   s   [   c   ]   =   f   .   e   x   t   e   n   d   (   f   .   a   t   t   r   H   o   o   k   s   [   c   ]   ,   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       d   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   c   ,   2   )   ;   r   e   t   u   r   n       d   =   =   =   n   u   l   l   ?   b   :   d   }   }   )   }   )   ,   f   .   s   u   p   p   o   r   t   .   s   t   y   l   e   |   |   (   f   .   a   t   t   r   H   o   o   k   s   .   s   t   y   l   e   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   s   t   y   l   e   .   c   s   s   T   e   x   t   .   t   o   L   o   w   e   r   C   a   s   e   (   )   |   |   b   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       a   .   s   t   y   l   e   .   c   s   s   T   e   x   t   =   "   "   +   b   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   o   p   t   S   e   l   e   c   t   e   d   |   |   (   f   .   p   r   o   p   H   o   o   k   s   .   s   e   l   e   c   t   e   d   =   f   .   e   x   t   e   n   d   (   f   .   p   r   o   p   H   o   o   k   s   .   s   e   l   e   c   t   e   d   ,   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   p   a   r   e   n   t   N   o   d   e   ;   b   &amp;   &amp;   (   b   .   s   e   l   e   c   t   e   d   I   n   d   e   x   ,   b   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   b   .   p   a   r   e   n   t   N   o   d   e   .   s   e   l   e   c   t   e   d   I   n   d   e   x   )   ;   r   e   t   u   r   n       n   u   l   l   }   }   )   )   ,   f   .   s   u   p   p   o   r   t   .   e   n   c   t   y   p   e   |   |   (   f   .   p   r   o   p   F   i   x   .   e   n   c   t   y   p   e   =   "   e   n   c   o   d   i   n   g   "   )   ,   f   .   s   u   p   p   o   r   t   .   c   h   e   c   k   O   n   |   |   f   .   e   a   c   h   (   [   "   r   a   d   i   o   "   ,   "   c   h   e   c   k   b   o   x   "   ]   ,   f   u   n   c   t   i   o   n   (   )   {   f   .   v   a   l   H   o   o   k   s   [   t   h   i   s   ]   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   v   a   l   u   e   "   )   =   =   =   n   u   l   l   ?   "   o   n   "   :   a   .   v   a   l   u   e   }   }   }   )   ,   f   .   e   a   c   h   (   [   "   r   a   d   i   o   "   ,   "   c   h   e   c   k   b   o   x   "   ]   ,   f   u   n   c   t   i   o   n   (   )   {   f   .   v   a   l   H   o   o   k   s   [   t   h   i   s   ]   =   f   .   e   x   t   e   n   d   (   f   .   v   a   l   H   o   o   k   s   [   t   h   i   s   ]   ,   {   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   f   .   i   s   A   r   r   a   y   (   b   )   )   r   e   t   u   r   n       a   .   c   h   e   c   k   e   d   =   f   .   i   n   A   r   r   a   y   (   f   (   a   )   .   v   a   l   (   )   ,   b   )   &gt;   =   0   }   }   )   }   )   ;   v   a   r       z   =   /   ^   (   ?   :   t   e   x   t   a   r   e   a   |   i   n   p   u   t   |   s   e   l   e   c   t   )   $   /   i   ,   A   =   /   ^   (   [   ^   \   .   ]   *   )   ?   (   ?   :   \   .   (   .   +   )   )   ?   $   /   ,   B   =   /   \   b   h   o   v   e   r   (   \   .   \   S   +   )   ?   \   b   /   ,   C   =   /   ^   k   e   y   /   ,   D   =   /   ^   (   ?   :   m   o   u   s   e   |   c   o   n   t   e   x   t   m   e   n   u   )   |   c   l   i   c   k   /   ,   E   =   /   ^   (   ?   :   f   o   c   u   s   i   n   f   o   c   u   s   |   f   o   c   u   s   o   u   t   b   l   u   r   )   $   /   ,   F   =   /   ^   (   \   w   *   )   (   ?   :   #   (   [   \   w   \   -   ]   +   )   )   ?   (   ?   :   \   .   (   [   \   w   \   -   ]   +   )   )   ?   $   /   ,   G   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   F   .   e   x   e   c   (   a   )   ;   b   &amp;   &amp;   (   b   [   1   ]   =   (   b   [   1   ]   |   |   "   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   b   [   3   ]   =   b   [   3   ]   &amp;   &amp;   n   e   w       R   e   g   E   x   p   (   "   (   ?   :   ^   |   \   \   s   )   "   +   b   [   3   ]   +   "   (   ?   :   \   \   s   |   $   )   "   )   )   ;   r   e   t   u   r   n       b   }   ,   H   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   a   .   a   t   t   r   i   b   u   t   e   s   |   |   {   }   ;   r   e   t   u   r   n   (   !   b   [   1   ]   |   |   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   b   [   1   ]   )   &amp;   &amp;   (   !   b   [   2   ]   |   |   (   c   .   i   d   |   |   {   }   )   .   v   a   l   u   e   =   =   =   b   [   2   ]   )   &amp;   &amp;   (   !   b   [   3   ]   |   |   b   [   3   ]   .   t   e   s   t   (   (   c   [   "   c   l   a   s   s   "   ]   |   |   {   }   )   .   v   a   l   u   e   )   )   }   ,   I   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   .   h   o   v   e   r   ?   a   :   a   .   r   e   p   l   a   c   e   (   B   ,   "   m   o   u   s   e   e   n   t   e   r   $   1       m   o   u   s   e   l   e   a   v   e   $   1   "   )   }   ;      
   f   .   e   v   e   n   t   =   {   a   d   d   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   ,   g   )   {   v   a   r       h   ,   i   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ,   p   ,   q   ,   r   ,   s   ;   i   f   (   !   (   a   .   n   o   d   e   T   y   p   e   =   =   =   3   |   |   a   .   n   o   d   e   T   y   p   e   =   =   =   8   |   |   !   c   |   |   !   d   |   |   !   (   h   =   f   .   _   d   a   t   a   (   a   )   )   )   )   {   d   .   h   a   n   d   l   e   r   &amp;   &amp;   (   p   =   d   ,   d   =   p   .   h   a   n   d   l   e   r   )   ,   d   .   g   u   i   d   |   |   (   d   .   g   u   i   d   =   f   .   g   u   i   d   +   +   )   ,   j   =   h   .   e   v   e   n   t   s   ,   j   |   |   (   h   .   e   v   e   n   t   s   =   j   =   {   }   )   ,   i   =   h   .   h   a   n   d   l   e   ,   i   |   |   (   h   .   h   a   n   d   l   e   =   i   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   y   p   e   o   f       f   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   (   !   a   |   |   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   e   d   !   =   =   a   .   t   y   p   e   )   ?   f   .   e   v   e   n   t   .   d   i   s   p   a   t   c   h   .   a   p   p   l   y   (   i   .   e   l   e   m   ,   a   r   g   u   m   e   n   t   s   )   :   b   }   ,   i   .   e   l   e   m   =   a   )   ,   c   =   f   .   t   r   i   m   (   I   (   c   )   )   .   s   p   l   i   t   (   "       "   )   ;   f   o   r   (   k   =   0   ;   k   &lt;   c   .   l   e   n   g   t   h   ;   k   +   +   )   {   l   =   A   .   e   x   e   c   (   c   [   k   ]   )   |   |   [   ]   ,   m   =   l   [   1   ]   ,   n   =   (   l   [   2   ]   |   |   "   "   )   .   s   p   l   i   t   (   "   .   "   )   .   s   o   r   t   (   )   ,   s   =   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   m   ]   |   |   {   }   ,   m   =   (   g   ?   s   .   d   e   l   e   g   a   t   e   T   y   p   e   :   s   .   b   i   n   d   T   y   p   e   )   |   |   m   ,   s   =   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   m   ]   |   |   {   }   ,   o   =   f   .   e   x   t   e   n   d   (   {   t   y   p   e   :   m   ,   o   r   i   g   T   y   p   e   :   l   [   1   ]   ,   d   a   t   a   :   e   ,   h   a   n   d   l   e   r   :   d   ,   g   u   i   d   :   d   .   g   u   i   d   ,   s   e   l   e   c   t   o   r   :   g   ,   q   u   i   c   k   :   G   (   g   )   ,   n   a   m   e   s   p   a   c   e   :   n   .   j   o   i   n   (   "   .   "   )   }   ,   p   )   ,   r   =   j   [   m   ]   ;   i   f   (   !   r   )   {   r   =   j   [   m   ]   =   [   ]   ,   r   .   d   e   l   e   g   a   t   e   C   o   u   n   t   =   0   ;   i   f   (   !   s   .   s   e   t   u   p   |   |   s   .   s   e   t   u   p   .   c   a   l   l   (   a   ,   e   ,   n   ,   i   )   =   =   =   !   1   )   a   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   ?   a   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   (   m   ,   i   ,   !   1   )   :   a   .   a   t   t   a   c   h   E   v   e   n   t   &amp;   &amp;   a   .   a   t   t   a   c   h   E   v   e   n   t   (   "   o   n   "   +   m   ,   i   )   }   s   .   a   d   d   &amp;   &amp;   (   s   .   a   d   d   .   c   a   l   l   (   a   ,   o   )   ,   o   .   h   a   n   d   l   e   r   .   g   u   i   d   |   |   (   o   .   h   a   n   d   l   e   r   .   g   u   i   d   =   d   .   g   u   i   d   )   )   ,   g   ?   r   .   s   p   l   i   c   e   (   r   .   d   e   l   e   g   a   t   e   C   o   u   n   t   +   +   ,   0   ,   o   )   :   r   .   p   u   s   h   (   o   )   ,   f   .   e   v   e   n   t   .   g   l   o   b   a   l   [   m   ]   =   !   0   }   a   =   n   u   l   l   }   }   ,   g   l   o   b   a   l   :   {   }   ,   r   e   m   o   v   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   ,   e   )   {   v   a   r       g   =   f   .   h   a   s   D   a   t   a   (   a   )   &amp;   &amp;   f   .   _   d   a   t   a   (   a   )   ,   h   ,   i   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ,   p   ,   q   ,   r   ,   s   ;   i   f   (   !   !   g   &amp;   &amp;   !   !   (   o   =   g   .   e   v   e   n   t   s   )   )   {   b   =   f   .   t   r   i   m   (   I   (   b   |   |   "   "   )   )   .   s   p   l   i   t   (   "       "   )   ;   f   o   r   (   h   =   0   ;   h   &lt;   b   .   l   e   n   g   t   h   ;   h   +   +   )   {   i   =   A   .   e   x   e   c   (   b   [   h   ]   )   |   |   [   ]   ,   j   =   k   =   i   [   1   ]   ,   l   =   i   [   2   ]   ;   i   f   (   !   j   )   {   f   o   r   (   j       i   n       o   )   f   .   e   v   e   n   t   .   r   e   m   o   v   e   (   a   ,   j   +   b   [   h   ]   ,   c   ,   d   ,   !   0   )   ;   c   o   n   t   i   n   u   e   }   p   =   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   j   ]   |   |   {   }   ,   j   =   (   d   ?   p   .   d   e   l   e   g   a   t   e   T   y   p   e   :   p   .   b   i   n   d   T   y   p   e   )   |   |   j   ,   r   =   o   [   j   ]   |   |   [   ]   ,   m   =   r   .   l   e   n   g   t   h   ,   l   =   l   ?   n   e   w       R   e   g   E   x   p   (   "   (   ^   |   \   \   .   )   "   +   l   .   s   p   l   i   t   (   "   .   "   )   .   s   o   r   t   (   )   .   j   o   i   n   (   "   \   \   .   (   ?   :   .   *   \   \   .   )   ?   "   )   +   "   (   \   \   .   |   $   )   "   )   :   n   u   l   l   ;   f   o   r   (   n   =   0   ;   n   &lt;   r   .   l   e   n   g   t   h   ;   n   +   +   )   s   =   r   [   n   ]   ,   (   e   |   |   k   =   =   =   s   .   o   r   i   g   T   y   p   e   )   &amp;   &amp;   (   !   c   |   |   c   .   g   u   i   d   =   =   =   s   .   g   u   i   d   )   &amp;   &amp;   (   !   l   |   |   l   .   t   e   s   t   (   s   .   n   a   m   e   s   p   a   c   e   )   )   &amp;   &amp;   (   !   d   |   |   d   =   =   =   s   .   s   e   l   e   c   t   o   r   |   |   d   =   =   =   "   *   *   "   &amp;   &amp;   s   .   s   e   l   e   c   t   o   r   )   &amp;   &amp;   (   r   .   s   p   l   i   c   e   (   n   -   -   ,   1   )   ,   s   .   s   e   l   e   c   t   o   r   &amp;   &amp;   r   .   d   e   l   e   g   a   t   e   C   o   u   n   t   -   -   ,   p   .   r   e   m   o   v   e   &amp;   &amp;   p   .   r   e   m   o   v   e   .   c   a   l   l   (   a   ,   s   )   )   ;   r   .   l   e   n   g   t   h   =   =   =   0   &amp;   &amp;   m   !   =   =   r   .   l   e   n   g   t   h   &amp;   &amp;   (   (   !   p   .   t   e   a   r   d   o   w   n   |   |   p   .   t   e   a   r   d   o   w   n   .   c   a   l   l   (   a   ,   l   )   =   =   =   !   1   )   &amp;   &amp;   f   .   r   e   m   o   v   e   E   v   e   n   t   (   a   ,   j   ,   g   .   h   a   n   d   l   e   )   ,   d   e   l   e   t   e       o   [   j   ]   )   }   f   .   i   s   E   m   p   t   y   O   b   j   e   c   t   (   o   )   &amp;   &amp;   (   q   =   g   .   h   a   n   d   l   e   ,   q   &amp;   &amp;   (   q   .   e   l   e   m   =   n   u   l   l   )   ,   f   .   r   e   m   o   v   e   D   a   t   a   (   a   ,   [   "   e   v   e   n   t   s   "   ,   "   h   a   n   d   l   e   "   ]   ,   !   0   )   )   }   }   ,   c   u   s   t   o   m   E   v   e   n   t   :   {   g   e   t   D   a   t   a   :   !   0   ,   s   e   t   D   a   t   a   :   !   0   ,   c   h   a   n   g   e   D   a   t   a   :   !   0   }   ,   t   r   i   g   g   e   r   :   f   u   n   c   t   i   o   n   (   c   ,   d   ,   e   ,   g   )   {   i   f   (   !   e   |   |   e   .   n   o   d   e   T   y   p   e   !   =   =   3   &amp;   &amp;   e   .   n   o   d   e   T   y   p   e   !   =   =   8   )   {   v   a   r       h   =   c   .   t   y   p   e   |   |   c   ,   i   =   [   ]   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ,   p   ,   q   ,   r   ,   s   ;   i   f   (   E   .   t   e   s   t   (   h   +   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   e   d   )   )   r   e   t   u   r   n   ;   h   .   i   n   d   e   x   O   f   (   "   !   "   )   &gt;   =   0   &amp;   &amp;   (   h   =   h   .   s   l   i   c   e   (   0   ,   -   1   )   ,   k   =   !   0   )   ,   h   .   i   n   d   e   x   O   f   (   "   .   "   )   &gt;   =   0   &amp;   &amp;   (   i   =   h   .   s   p   l   i   t   (   "   .   "   )   ,   h   =   i   .   s   h   i   f   t   (   )   ,   i   .   s   o   r   t   (   )   )   ;   i   f   (   (   !   e   |   |   f   .   e   v   e   n   t   .   c   u   s   t   o   m   E   v   e   n   t   [   h   ]   )   &amp;   &amp;   !   f   .   e   v   e   n   t   .   g   l   o   b   a   l   [   h   ]   )   r   e   t   u   r   n   ;   c   =   t   y   p   e   o   f       c   =   =   "   o   b   j   e   c   t   "   ?   c   [   f   .   e   x   p   a   n   d   o   ]   ?   c   :   n   e   w       f   .   E   v   e   n   t   (   h   ,   c   )   :   n   e   w       f   .   E   v   e   n   t   (   h   )   ,   c   .   t   y   p   e   =   h   ,   c   .   i   s   T   r   i   g   g   e   r   =   !   0   ,   c   .   e   x   c   l   u   s   i   v   e   =   k   ,   c   .   n   a   m   e   s   p   a   c   e   =   i   .   j   o   i   n   (   "   .   "   )   ,   c   .   n   a   m   e   s   p   a   c   e   _   r   e   =   c   .   n   a   m   e   s   p   a   c   e   ?   n   e   w       R   e   g   E   x   p   (   "   (   ^   |   \   \   .   )   "   +   i   .   j   o   i   n   (   "   \   \   .   (   ?   :   .   *   \   \   .   )   ?   "   )   +   "   (   \   \   .   |   $   )   "   )   :   n   u   l   l   ,   o   =   h   .   i   n   d   e   x   O   f   (   "   :   "   )   &lt;   0   ?   "   o   n   "   +   h   :   "   "   ;   i   f   (   !   e   )   {   j   =   f   .   c   a   c   h   e   ;   f   o   r   (   l       i   n       j   )   j   [   l   ]   .   e   v   e   n   t   s   &amp;   &amp;   j   [   l   ]   .   e   v   e   n   t   s   [   h   ]   &amp;   &amp;   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   c   ,   d   ,   j   [   l   ]   .   h   a   n   d   l   e   .   e   l   e   m   ,   !   0   )   ;   r   e   t   u   r   n   }   c   .   r   e   s   u   l   t   =   b   ,   c   .   t   a   r   g   e   t   |   |   (   c   .   t   a   r   g   e   t   =   e   )   ,   d   =   d   !   =   n   u   l   l   ?   f   .   m   a   k   e   A   r   r   a   y   (   d   )   :   [   ]   ,   d   .   u   n   s   h   i   f   t   (   c   )   ,   p   =   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   h   ]   |   |   {   }   ;   i   f   (   p   .   t   r   i   g   g   e   r   &amp;   &amp;   p   .   t   r   i   g   g   e   r   .   a   p   p   l   y   (   e   ,   d   )   =   =   =   !   1   )   r   e   t   u   r   n   ;   r   =   [   [   e   ,   p   .   b   i   n   d   T   y   p   e   |   |   h   ]   ]   ;   i   f   (   !   g   &amp;   &amp;   !   p   .   n   o   B   u   b   b   l   e   &amp;   &amp;   !   f   .   i   s   W   i   n   d   o   w   (   e   )   )   {   s   =   p   .   d   e   l   e   g   a   t   e   T   y   p   e   |   |   h   ,   m   =   E   .   t   e   s   t   (   s   +   h   )   ?   e   :   e   .   p   a   r   e   n   t   N   o   d   e   ,   n   =   n   u   l   l   ;   f   o   r   (   ;   m   ;   m   =   m   .   p   a   r   e   n   t   N   o   d   e   )   r   .   p   u   s   h   (   [   m   ,   s   ]   )   ,   n   =   m   ;   n   &amp;   &amp;   n   =   =   =   e   .   o   w   n   e   r   D   o   c   u   m   e   n   t   &amp;   &amp;   r   .   p   u   s   h   (   [   n   .   d   e   f   a   u   l   t   V   i   e   w   |   |   n   .   p   a   r   e   n   t   W   i   n   d   o   w   |   |   a   ,   s   ]   )   }   f   o   r   (   l   =   0   ;   l   &lt;   r   .   l   e   n   g   t   h   &amp;   &amp;   !   c   .   i   s   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   (   )   ;   l   +   +   )   m   =   r   [   l   ]   [   0   ]   ,   c   .   t   y   p   e   =   r   [   l   ]   [   1   ]   ,   q   =   (   f   .   _   d   a   t   a   (   m   ,   "   e   v   e   n   t   s   "   )   |   |   {   }   )   [   c   .   t   y   p   e   ]   &amp;   &amp;   f   .   _   d   a   t   a   (   m   ,   "   h   a   n   d   l   e   "   )   ,   q   &amp;   &amp;   q   .   a   p   p   l   y   (   m   ,   d   )   ,   q   =   o   &amp;   &amp;   m   [   o   ]   ,   q   &amp;   &amp;   f   .   a   c   c   e   p   t   D   a   t   a   (   m   )   &amp;   &amp;   q   .   a   p   p   l   y   (   m   ,   d   )   =   =   =   !   1   &amp;   &amp;   c   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   ;   c   .   t   y   p   e   =   h   ,   !   g   &amp;   &amp;   !   c   .   i   s   D   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   (   )   &amp;   &amp;   (   !   p   .   _   d   e   f   a   u   l   t   |   |   p   .   _   d   e   f   a   u   l   t   .   a   p   p   l   y   (   e   .   o   w   n   e   r   D   o   c   u   m   e   n   t   ,   d   )   =   =   =   !   1   )   &amp;   &amp;   (   h   !   =   =   "   c   l   i   c   k   "   |   |   !   f   .   n   o   d   e   N   a   m   e   (   e   ,   "   a   "   )   )   &amp;   &amp;   f   .   a   c   c   e   p   t   D   a   t   a   (   e   )   &amp;   &amp;   o   &amp;   &amp;   e   [   h   ]   &amp;   &amp;   (   h   !   =   =   "   f   o   c   u   s   "   &amp;   &amp;   h   !   =   =   "   b   l   u   r   "   |   |   c   .   t   a   r   g   e   t   .   o   f   f   s   e   t   W   i   d   t   h   !   =   =   0   )   &amp;   &amp;   !   f   .   i   s   W   i   n   d   o   w   (   e   )   &amp;   &amp;   (   n   =   e   [   o   ]   ,   n   &amp;   &amp;   (   e   [   o   ]   =   n   u   l   l   )   ,   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   e   d   =   h   ,   e   [   h   ]   (   )   ,   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   e   d   =   b   ,   n   &amp;   &amp;   (   e   [   o   ]   =   n   )   )   ;   r   e   t   u   r   n       c   .   r   e   s   u   l   t   }   }   ,   d   i   s   p   a   t   c   h   :   f   u   n   c   t   i   o   n   (   c   )   {   c   =   f   .   e   v   e   n   t   .   f   i   x   (   c   |   |   a   .   e   v   e   n   t   )   ;   v   a   r       d   =   (   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   e   v   e   n   t   s   "   )   |   |   {   }   )   [   c   .   t   y   p   e   ]   |   |   [   ]   ,   e   =   d   .   d   e   l   e   g   a   t   e   C   o   u   n   t   ,   g   =   [   ]   .   s   l   i   c   e   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   ,   0   )   ,   h   =   !   c   .   e   x   c   l   u   s   i   v   e   &amp;   &amp;   !   c   .   n   a   m   e   s   p   a   c   e   ,   i   =   [   ]   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ,   p   ,   q   ,   r   ,   s   ,   t   ;   g   [   0   ]   =   c   ,   c   .   d   e   l   e   g   a   t   e   T   a   r   g   e   t   =   t   h   i   s   ;   i   f   (   e   &amp;   &amp;   !   c   .   t   a   r   g   e   t   .   d   i   s   a   b   l   e   d   &amp;   &amp;   (   !   c   .   b   u   t   t   o   n   |   |   c   .   t   y   p   e   !   =   =   "   c   l   i   c   k   "   )   )   {   m   =   f   (   t   h   i   s   )   ,   m   .   c   o   n   t   e   x   t   =   t   h   i   s   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   t   h   i   s   ;   f   o   r   (   l   =   c   .   t   a   r   g   e   t   ;   l   !   =   t   h   i   s   ;   l   =   l   .   p   a   r   e   n   t   N   o   d   e   |   |   t   h   i   s   )   {   o   =   {   }   ,   q   =   [   ]   ,   m   [   0   ]   =   l   ;   f   o   r   (   j   =   0   ;   j   &lt;   e   ;   j   +   +   )   r   =   d   [   j   ]   ,   s   =   r   .   s   e   l   e   c   t   o   r   ,   o   [   s   ]   =   =   =   b   &amp;   &amp;   (   o   [   s   ]   =   r   .   q   u   i   c   k   ?   H   (   l   ,   r   .   q   u   i   c   k   )   :   m   .   i   s   (   s   )   )   ,   o   [   s   ]   &amp;   &amp;   q   .   p   u   s   h   (   r   )   ;   q   .   l   e   n   g   t   h   &amp;   &amp;   i   .   p   u   s   h   (   {   e   l   e   m   :   l   ,   m   a   t   c   h   e   s   :   q   }   )   }   }   d   .   l   e   n   g   t   h   &gt;   e   &amp;   &amp;   i   .   p   u   s   h   (   {   e   l   e   m   :   t   h   i   s   ,   m   a   t   c   h   e   s   :   d   .   s   l   i   c   e   (   e   )   }   )   ;   f   o   r   (   j   =   0   ;   j   &lt;   i   .   l   e   n   g   t   h   &amp;   &amp;   !   c   .   i   s   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   (   )   ;   j   +   +   )   {   p   =   i   [   j   ]   ,   c   .   c   u   r   r   e   n   t   T   a   r   g   e   t   =   p   .   e   l   e   m   ;   f   o   r   (   k   =   0   ;   k   &lt;   p   .   m   a   t   c   h   e   s   .   l   e   n   g   t   h   &amp;   &amp;   !   c   .   i   s   I   m   m   e   d   i   a   t   e   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   (   )   ;   k   +   +   )   {   r   =   p   .   m   a   t   c   h   e   s   [   k   ]   ;   i   f   (   h   |   |   !   c   .   n   a   m   e   s   p   a   c   e   &amp;   &amp;   !   r   .   n   a   m   e   s   p   a   c   e   |   |   c   .   n   a   m   e   s   p   a   c   e   _   r   e   &amp;   &amp;   c   .   n   a   m   e   s   p   a   c   e   _   r   e   .   t   e   s   t   (   r   .   n   a   m   e   s   p   a   c   e   )   )   c   .   d   a   t   a   =   r   .   d   a   t   a   ,   c   .   h   a   n   d   l   e   O   b   j   =   r   ,   n   =   (   (   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   r   .   o   r   i   g   T   y   p   e   ]   |   |   {   }   )   .   h   a   n   d   l   e   |   |   r   .   h   a   n   d   l   e   r   )   .   a   p   p   l   y   (   p   .   e   l   e   m   ,   g   )   ,   n   !   =   =   b   &amp;   &amp;   (   c   .   r   e   s   u   l   t   =   n   ,   n   =   =   =   !   1   &amp;   &amp;   (   c   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   ,   c   .   s   t   o   p   P   r   o   p   a   g   a   t   i   o   n   (   )   )   )   }   }   r   e   t   u   r   n       c   .   r   e   s   u   l   t   }   ,   p   r   o   p   s   :   "   a   t   t   r   C   h   a   n   g   e       a   t   t   r   N   a   m   e       r   e   l   a   t   e   d   N   o   d   e       s   r   c   E   l   e   m   e   n   t       a   l   t   K   e   y       b   u   b   b   l   e   s       c   a   n   c   e   l   a   b   l   e       c   t   r   l   K   e   y       c   u   r   r   e   n   t   T   a   r   g   e   t       e   v   e   n   t   P   h   a   s   e       m   e   t   a   K   e   y       r   e   l   a   t   e   d   T   a   r   g   e   t       s   h   i   f   t   K   e   y       t   a   r   g   e   t       t   i   m   e   S   t   a   m   p       v   i   e   w       w   h   i   c   h   "   .   s   p   l   i   t   (   "       "   )   ,   f   i   x   H   o   o   k   s   :   {   }   ,   k   e   y   H   o   o   k   s   :   {   p   r   o   p   s   :   "   c   h   a   r       c   h   a   r   C   o   d   e       k   e   y       k   e   y   C   o   d   e   "   .   s   p   l   i   t   (   "       "   )   ,   f   i   l   t   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   a   .   w   h   i   c   h   =   =   n   u   l   l   &amp;   &amp;   (   a   .   w   h   i   c   h   =   b   .   c   h   a   r   C   o   d   e   !   =   n   u   l   l   ?   b   .   c   h   a   r   C   o   d   e   :   b   .   k   e   y   C   o   d   e   )   ;   r   e   t   u   r   n       a   }   }   ,   m   o   u   s   e   H   o   o   k   s   :   {   p   r   o   p   s   :   "   b   u   t   t   o   n       b   u   t   t   o   n   s       c   l   i   e   n   t   X       c   l   i   e   n   t   Y       f   r   o   m   E   l   e   m   e   n   t       o   f   f   s   e   t   X       o   f   f   s   e   t   Y       p   a   g   e   X       p   a   g   e   Y       s   c   r   e   e   n   X       s   c   r   e   e   n   Y       t   o   E   l   e   m   e   n   t   "   .   s   p   l   i   t   (   "       "   )   ,   f   i   l   t   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   d   )   {   v   a   r       e   ,   f   ,   g   ,   h   =   d   .   b   u   t   t   o   n   ,   i   =   d   .   f   r   o   m   E   l   e   m   e   n   t   ;   a   .   p   a   g   e   X   =   =   n   u   l   l   &amp;   &amp;   d   .   c   l   i   e   n   t   X   !   =   n   u   l   l   &amp;   &amp;   (   e   =   a   .   t   a   r   g   e   t   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   c   ,   f   =   e   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ,   g   =   e   .   b   o   d   y   ,   a   .   p   a   g   e   X   =   d   .   c   l   i   e   n   t   X   +   (   f   &amp;   &amp;   f   .   s   c   r   o   l   l   L   e   f   t   |   |   g   &amp;   &amp;   g   .   s   c   r   o   l   l   L   e   f   t   |   |   0   )   -   (   f   &amp;   &amp;   f   .   c   l   i   e   n   t   L   e   f   t   |   |   g   &amp;   &amp;   g   .   c   l   i   e   n   t   L   e   f   t   |   |   0   )   ,   a   .   p   a   g   e   Y   =   d   .   c   l   i   e   n   t   Y   +   (   f   &amp;   &amp;   f   .   s   c   r   o   l   l   T   o   p   |   |   g   &amp;   &amp;   g   .   s   c   r   o   l   l   T   o   p   |   |   0   )   -   (   f   &amp;   &amp;   f   .   c   l   i   e   n   t   T   o   p   |   |   g   &amp;   &amp;   g   .   c   l   i   e   n   t   T   o   p   |   |   0   )   )   ,   !   a   .   r   e   l   a   t   e   d   T   a   r   g   e   t   &amp;   &amp;   i   &amp;   &amp;   (   a   .   r   e   l   a   t   e   d   T   a   r   g   e   t   =   i   =   =   =   a   .   t   a   r   g   e   t   ?   d   .   t   o   E   l   e   m   e   n   t   :   i   )   ,   !   a   .   w   h   i   c   h   &amp;   &amp;   h   !   =   =   b   &amp;   &amp;   (   a   .   w   h   i   c   h   =   h   &amp;   1   ?   1   :   h   &amp;   2   ?   3   :   h   &amp;   4   ?   2   :   0   )   ;   r   e   t   u   r   n       a   }   }   ,   f   i   x   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   [   f   .   e   x   p   a   n   d   o   ]   )   r   e   t   u   r   n       a   ;   v   a   r       d   ,   e   ,   g   =   a   ,   h   =   f   .   e   v   e   n   t   .   f   i   x   H   o   o   k   s   [   a   .   t   y   p   e   ]   |   |   {   }   ,   i   =   h   .   p   r   o   p   s   ?   t   h   i   s   .   p   r   o   p   s   .   c   o   n   c   a   t   (   h   .   p   r   o   p   s   )   :   t   h   i   s   .   p   r   o   p   s   ;   a   =   f   .   E   v   e   n   t   (   g   )   ;   f   o   r   (   d   =   i   .   l   e   n   g   t   h   ;   d   ;   )   e   =   i   [   -   -   d   ]   ,   a   [   e   ]   =   g   [   e   ]   ;   a   .   t   a   r   g   e   t   |   |   (   a   .   t   a   r   g   e   t   =   g   .   s   r   c   E   l   e   m   e   n   t   |   |   c   )   ,   a   .   t   a   r   g   e   t   .   n   o   d   e   T   y   p   e   =   =   =   3   &amp;   &amp;   (   a   .   t   a   r   g   e   t   =   a   .   t   a   r   g   e   t   .   p   a   r   e   n   t   N   o   d   e   )   ,   a   .   m   e   t   a   K   e   y   =   =   =   b   &amp;   &amp;   (   a   .   m   e   t   a   K   e   y   =   a   .   c   t   r   l   K   e   y   )   ;   r   e   t   u   r   n       h   .   f   i   l   t   e   r   ?   h   .   f   i   l   t   e   r   (   a   ,   g   )   :   a   }   ,   s   p   e   c   i   a   l   :   {   r   e   a   d   y   :   {   s   e   t   u   p   :   f   .   b   i   n   d   R   e   a   d   y   }   ,   l   o   a   d   :   {   n   o   B   u   b   b   l   e   :   !   0   }   ,   f   o   c   u   s   :   {   d   e   l   e   g   a   t   e   T   y   p   e   :   "   f   o   c   u   s   i   n   "   }   ,   b   l   u   r   :   {   d   e   l   e   g   a   t   e   T   y   p   e   :   "   f   o   c   u   s   o   u   t   "   }   ,   b   e   f   o   r   e   u   n   l   o   a   d   :   {   s   e   t   u   p   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   f   .   i   s   W   i   n   d   o   w   (   t   h   i   s   )   &amp;   &amp;   (   t   h   i   s   .   o   n   b   e   f   o   r   e   u   n   l   o   a   d   =   c   )   }   ,   t   e   a   r   d   o   w   n   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   t   h   i   s   .   o   n   b   e   f   o   r   e   u   n   l   o   a   d   =   =   =   b   &amp;   &amp;   (   t   h   i   s   .   o   n   b   e   f   o   r   e   u   n   l   o   a   d   =   n   u   l   l   )   }   }   }   ,   s   i   m   u   l   a   t   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   v   a   r       e   =   f   .   e   x   t   e   n   d   (   n   e   w       f   .   E   v   e   n   t   ,   c   ,   {   t   y   p   e   :   a   ,   i   s   S   i   m   u   l   a   t   e   d   :   !   0   ,   o   r   i   g   i   n   a   l   E   v   e   n   t   :   {   }   }   )   ;   d   ?   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   e   ,   n   u   l   l   ,   b   )   :   f   .   e   v   e   n   t   .   d   i   s   p   a   t   c   h   .   c   a   l   l   (   b   ,   e   )   ,   e   .   i   s   D   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   (   )   &amp;   &amp;   c   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   }   }   ,   f   .   e   v   e   n   t   .   h   a   n   d   l   e   =   f   .   e   v   e   n   t   .   d   i   s   p   a   t   c   h   ,   f   .   r   e   m   o   v   e   E   v   e   n   t   =   c   .   r   e   m   o   v   e   E   v   e   n   t   L   i   s   t   e   n   e   r   ?   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   a   .   r   e   m   o   v   e   E   v   e   n   t   L   i   s   t   e   n   e   r   &amp;   &amp;   a   .   r   e   m   o   v   e   E   v   e   n   t   L   i   s   t   e   n   e   r   (   b   ,   c   ,   !   1   )   }   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   a   .   d   e   t   a   c   h   E   v   e   n   t   &amp;   &amp;   a   .   d   e   t   a   c   h   E   v   e   n   t   (   "   o   n   "   +   b   ,   c   )   }   ,   f   .   E   v   e   n   t   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   !   (   t   h   i   s       i   n   s   t   a   n   c   e   o   f       f   .   E   v   e   n   t   )   )   r   e   t   u   r   n       n   e   w       f   .   E   v   e   n   t   (   a   ,   b   )   ;   a   &amp;   &amp;   a   .   t   y   p   e   ?   (   t   h   i   s   .   o   r   i   g   i   n   a   l   E   v   e   n   t   =   a   ,   t   h   i   s   .   t   y   p   e   =   a   .   t   y   p   e   ,   t   h   i   s   .   i   s   D   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   =   a   .   d   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   |   |   a   .   r   e   t   u   r   n   V   a   l   u   e   =   =   =   !   1   |   |   a   .   g   e   t   P   r   e   v   e   n   t   D   e   f   a   u   l   t   &amp;   &amp;   a   .   g   e   t   P   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   ?   K   :   J   )   :   t   h   i   s   .   t   y   p   e   =   a   ,   b   &amp;   &amp;   f   .   e   x   t   e   n   d   (   t   h   i   s   ,   b   )   ,   t   h   i   s   .   t   i   m   e   S   t   a   m   p   =   a   &amp;   &amp;   a   .   t   i   m   e   S   t   a   m   p   |   |   f   .   n   o   w   (   )   ,   t   h   i   s   [   f   .   e   x   p   a   n   d   o   ]   =   !   0   }   ,   f   .   E   v   e   n   t   .   p   r   o   t   o   t   y   p   e   =   {   p   r   e   v   e   n   t   D   e   f   a   u   l   t   :   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   i   s   D   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   =   K   ;   v   a   r       a   =   t   h   i   s   .   o   r   i   g   i   n   a   l   E   v   e   n   t   ;   !   a   |   |   (   a   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   ?   a   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   :   a   .   r   e   t   u   r   n   V   a   l   u   e   =   !   1   )   }   ,   s   t   o   p   P   r   o   p   a   g   a   t   i   o   n   :   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   i   s   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   =   K   ;   v   a   r       a   =   t   h   i   s   .   o   r   i   g   i   n   a   l   E   v   e   n   t   ;   !   a   |   |   (   a   .   s   t   o   p   P   r   o   p   a   g   a   t   i   o   n   &amp;   &amp;   a   .   s   t   o   p   P   r   o   p   a   g   a   t   i   o   n   (   )   ,   a   .   c   a   n   c   e   l   B   u   b   b   l   e   =   !   0   )   }   ,   s   t   o   p   I   m   m   e   d   i   a   t   e   P   r   o   p   a   g   a   t   i   o   n   :   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   i   s   I   m   m   e   d   i   a   t   e   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   =   K   ,   t   h   i   s   .   s   t   o   p   P   r   o   p   a   g   a   t   i   o   n   (   )   }   ,   i   s   D   e   f   a   u   l   t   P   r   e   v   e   n   t   e   d   :   J   ,   i   s   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   :   J   ,   i   s   I   m   m   e   d   i   a   t   e   P   r   o   p   a   g   a   t   i   o   n   S   t   o   p   p   e   d   :   J   }   ,   f   .   e   a   c   h   (   {   m   o   u   s   e   e   n   t   e   r   :   "   m   o   u   s   e   o   v   e   r   "   ,   m   o   u   s   e   l   e   a   v   e   :   "   m   o   u   s   e   o   u   t   "   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   a   ]   =   {   d   e   l   e   g   a   t   e   T   y   p   e   :   b   ,   b   i   n   d   T   y   p   e   :   b   ,   h   a   n   d   l   e   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   =   t   h   i   s   ,   d   =   a   .   r   e   l   a   t   e   d   T   a   r   g   e   t   ,   e   =   a   .   h   a   n   d   l   e   O   b   j   ,   g   =   e   .   s   e   l   e   c   t   o   r   ,   h   ;   i   f   (   !   d   |   |   d   !   =   =   c   &amp;   &amp;   !   f   .   c   o   n   t   a   i   n   s   (   c   ,   d   )   )   a   .   t   y   p   e   =   e   .   o   r   i   g   T   y   p   e   ,   h   =   e   .   h   a   n   d   l   e   r   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   ,   a   .   t   y   p   e   =   b   ;   r   e   t   u   r   n       h   }   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   s   u   b   m   i   t   B   u   b   b   l   e   s   |   |   (   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   .   s   u   b   m   i   t   =   {   s   e   t   u   p   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   f   .   n   o   d   e   N   a   m   e   (   t   h   i   s   ,   "   f   o   r   m   "   )   )   r   e   t   u   r   n   !   1   ;   f   .   e   v   e   n   t   .   a   d   d   (   t   h   i   s   ,   "   c   l   i   c   k   .   _   s   u   b   m   i   t       k   e   y   p   r   e   s   s   .   _   s   u   b   m   i   t   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   =   a   .   t   a   r   g   e   t   ,   d   =   f   .   n   o   d   e   N   a   m   e   (   c   ,   "   i   n   p   u   t   "   )   |   |   f   .   n   o   d   e   N   a   m   e   (   c   ,   "   b   u   t   t   o   n   "   )   ?   c   .   f   o   r   m   :   b   ;   d   &amp;   &amp;   !   d   .   _   s   u   b   m   i   t   _   a   t   t   a   c   h   e   d   &amp;   &amp;   (   f   .   e   v   e   n   t   .   a   d   d   (   d   ,   "   s   u   b   m   i   t   .   _   s   u   b   m   i   t   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   !   a   .   i   s   T   r   i   g   g   e   r   &amp;   &amp;   f   .   e   v   e   n   t   .   s   i   m   u   l   a   t   e   (   "   s   u   b   m   i   t   "   ,   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   ,   a   ,   !   0   )   }   )   ,   d   .   _   s   u   b   m   i   t   _   a   t   t   a   c   h   e   d   =   !   0   )   }   )   }   ,   t   e   a   r   d   o   w   n   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   f   .   n   o   d   e   N   a   m   e   (   t   h   i   s   ,   "   f   o   r   m   "   )   )   r   e   t   u   r   n   !   1   ;   f   .   e   v   e   n   t   .   r   e   m   o   v   e   (   t   h   i   s   ,   "   .   _   s   u   b   m   i   t   "   )   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   c   h   a   n   g   e   B   u   b   b   l   e   s   |   |   (   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   .   c   h   a   n   g   e   =   {   s   e   t   u   p   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   z   .   t   e   s   t   (   t   h   i   s   .   n   o   d   e   N   a   m   e   )   )   {   i   f   (   t   h   i   s   .   t   y   p   e   =   =   =   "   c   h   e   c   k   b   o   x   "   |   |   t   h   i   s   .   t   y   p   e   =   =   =   "   r   a   d   i   o   "   )   f   .   e   v   e   n   t   .   a   d   d   (   t   h   i   s   ,   "   p   r   o   p   e   r   t   y   c   h   a   n   g   e   .   _   c   h   a   n   g   e   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   a   .   o   r   i   g   i   n   a   l   E   v   e   n   t   .   p   r   o   p   e   r   t   y   N   a   m   e   =   =   =   "   c   h   e   c   k   e   d   "   &amp;   &amp;   (   t   h   i   s   .   _   j   u   s   t   _   c   h   a   n   g   e   d   =   !   0   )   }   )   ,   f   .   e   v   e   n   t   .   a   d   d   (   t   h   i   s   ,   "   c   l   i   c   k   .   _   c   h   a   n   g   e   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   _   j   u   s   t   _   c   h   a   n   g   e   d   &amp;   &amp;   !   a   .   i   s   T   r   i   g   g   e   r   &amp;   &amp;   (   t   h   i   s   .   _   j   u   s   t   _   c   h   a   n   g   e   d   =   !   1   ,   f   .   e   v   e   n   t   .   s   i   m   u   l   a   t   e   (   "   c   h   a   n   g   e   "   ,   t   h   i   s   ,   a   ,   !   0   )   )   }   )   ;   r   e   t   u   r   n   !   1   }   f   .   e   v   e   n   t   .   a   d   d   (   t   h   i   s   ,   "   b   e   f   o   r   e   a   c   t   i   v   a   t   e   .   _   c   h   a   n   g   e   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   t   a   r   g   e   t   ;   z   .   t   e   s   t   (   b   .   n   o   d   e   N   a   m   e   )   &amp;   &amp;   !   b   .   _   c   h   a   n   g   e   _   a   t   t   a   c   h   e   d   &amp;   &amp;   (   f   .   e   v   e   n   t   .   a   d   d   (   b   ,   "   c   h   a   n   g   e   .   _   c   h   a   n   g   e   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   !   a   .   i   s   S   i   m   u   l   a   t   e   d   &amp;   &amp;   !   a   .   i   s   T   r   i   g   g   e   r   &amp;   &amp;   f   .   e   v   e   n   t   .   s   i   m   u   l   a   t   e   (   "   c   h   a   n   g   e   "   ,   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   ,   a   ,   !   0   )   }   )   ,   b   .   _   c   h   a   n   g   e   _   a   t   t   a   c   h   e   d   =   !   0   )   }   )   }   ,   h   a   n   d   l   e   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   t   a   r   g   e   t   ;   i   f   (   t   h   i   s   !   =   =   b   |   |   a   .   i   s   S   i   m   u   l   a   t   e   d   |   |   a   .   i   s   T   r   i   g   g   e   r   |   |   b   .   t   y   p   e   !   =   =   "   r   a   d   i   o   "   &amp;   &amp;   b   .   t   y   p   e   !   =   =   "   c   h   e   c   k   b   o   x   "   )   r   e   t   u   r   n       a   .   h   a   n   d   l   e   O   b   j   .   h   a   n   d   l   e   r   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   }   ,   t   e   a   r   d   o   w   n   :   f   u   n   c   t   i   o   n   (   )   {   f   .   e   v   e   n   t   .   r   e   m   o   v   e   (   t   h   i   s   ,   "   .   _   c   h   a   n   g   e   "   )   ;   r   e   t   u   r   n       z   .   t   e   s   t   (   t   h   i   s   .   n   o   d   e   N   a   m   e   )   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   f   o   c   u   s   i   n   B   u   b   b   l   e   s   |   |   f   .   e   a   c   h   (   {   f   o   c   u   s   :   "   f   o   c   u   s   i   n   "   ,   b   l   u   r   :   "   f   o   c   u   s   o   u   t   "   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       d   =   0   ,   e   =   f   u   n   c   t   i   o   n   (   a   )   {   f   .   e   v   e   n   t   .   s   i   m   u   l   a   t   e   (   b   ,   a   .   t   a   r   g   e   t   ,   f   .   e   v   e   n   t   .   f   i   x   (   a   )   ,   !   0   )   }   ;   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   [   b   ]   =   {   s   e   t   u   p   :   f   u   n   c   t   i   o   n   (   )   {   d   +   +   =   =   =   0   &amp;   &amp;   c   .   a   d   d   E   v   e   n   t   L   i   s   t   e   n   e   r   (   a   ,   e   ,   !   0   )   }   ,   t   e   a   r   d   o   w   n   :   f   u   n   c   t   i   o   n   (   )   {   -   -   d   =   =   =   0   &amp;   &amp;   c   .   r   e   m   o   v   e   E   v   e   n   t   L   i   s   t   e   n   e   r   (   a   ,   e   ,   !   0   )   }   }   }   )   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   o   n   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   ,   g   )   {   v   a   r       h   ,   i   ;   i   f   (   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   )   {   t   y   p   e   o   f       c   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   d   =   c   ,   c   =   b   )   ;   f   o   r   (   i       i   n       a   )   t   h   i   s   .   o   n   (   i   ,   c   ,   d   ,   a   [   i   ]   ,   g   )   ;   r   e   t   u   r   n       t   h   i   s   }   d   =   =   n   u   l   l   &amp;   &amp;   e   =   =   n   u   l   l   ?   (   e   =   c   ,   d   =   c   =   b   )   :   e   =   =   n   u   l   l   &amp;   &amp;   (   t   y   p   e   o   f       c   =   =   "   s   t   r   i   n   g   "   ?   (   e   =   d   ,   d   =   b   )   :   (   e   =   d   ,   d   =   c   ,   c   =   b   )   )   ;   i   f   (   e   =   =   =   !   1   )   e   =   J   ;   e   l   s   e       i   f   (   !   e   )   r   e   t   u   r   n       t   h   i   s   ;   g   =   =   =   1   &amp;   &amp;   (   h   =   e   ,   e   =   f   u   n   c   t   i   o   n   (   a   )   {   f   (   )   .   o   f   f   (   a   )   ;   r   e   t   u   r   n       h   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   }   ,   e   .   g   u   i   d   =   h   .   g   u   i   d   |   |   (   h   .   g   u   i   d   =   f   .   g   u   i   d   +   +   )   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   e   v   e   n   t   .   a   d   d   (   t   h   i   s   ,   a   ,   e   ,   d   ,   c   )   }   )   }   ,   o   n   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n       t   h   i   s   .   o   n   .   c   a   l   l   (   t   h   i   s   ,   a   ,   b   ,   c   ,   d   ,   1   )   }   ,   o   f   f   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   i   f   (   a   &amp;   &amp;   a   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   &amp;   &amp;   a   .   h   a   n   d   l   e   O   b   j   )   {   v   a   r       e   =   a   .   h   a   n   d   l   e   O   b   j   ;   f   (   a   .   d   e   l   e   g   a   t   e   T   a   r   g   e   t   )   .   o   f   f   (   e   .   n   a   m   e   s   p   a   c   e   ?   e   .   t   y   p   e   +   "   .   "   +   e   .   n   a   m   e   s   p   a   c   e   :   e   .   t   y   p   e   ,   e   .   s   e   l   e   c   t   o   r   ,   e   .   h   a   n   d   l   e   r   )   ;   r   e   t   u   r   n       t   h   i   s   }   i   f   (   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   )   {   f   o   r   (   v   a   r       g       i   n       a   )   t   h   i   s   .   o   f   f   (   g   ,   c   ,   a   [   g   ]   )   ;   r   e   t   u   r   n       t   h   i   s   }   i   f   (   c   =   =   =   !   1   |   |   t   y   p   e   o   f       c   =   =   "   f   u   n   c   t   i   o   n   "   )   d   =   c   ,   c   =   b   ;   d   =   =   =   !   1   &amp;   &amp;   (   d   =   J   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   e   v   e   n   t   .   r   e   m   o   v   e   (   t   h   i   s   ,   a   ,   d   ,   c   )   }   )   }   ,   b   i   n   d   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       t   h   i   s   .   o   n   (   a   ,   n   u   l   l   ,   b   ,   c   )   }   ,   u   n   b   i   n   d   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       t   h   i   s   .   o   f   f   (   a   ,   n   u   l   l   ,   b   )   }   ,   l   i   v   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   f   (   t   h   i   s   .   c   o   n   t   e   x   t   )   .   o   n   (   a   ,   t   h   i   s   .   s   e   l   e   c   t   o   r   ,   b   ,   c   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   d   i   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   (   t   h   i   s   .   c   o   n   t   e   x   t   )   .   o   f   f   (   a   ,   t   h   i   s   .   s   e   l   e   c   t   o   r   |   |   "   *   *   "   ,   b   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   d   e   l   e   g   a   t   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n       t   h   i   s   .   o   n   (   b   ,   a   ,   c   ,   d   )   }   ,   u   n   d   e   l   e   g   a   t   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   =   =   1   ?   t   h   i   s   .   o   f   f   (   a   ,   "   *   *   "   )   :   t   h   i   s   .   o   f   f   (   b   ,   a   ,   c   )   }   ,   t   r   i   g   g   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   a   ,   b   ,   t   h   i   s   )   }   )   }   ,   t   r   i   g   g   e   r   H   a   n   d   l   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   t   h   i   s   [   0   ]   )   r   e   t   u   r   n       f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   a   ,   b   ,   t   h   i   s   [   0   ]   ,   !   0   )   }   ,   t   o   g   g   l   e   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   r   g   u   m   e   n   t   s   ,   c   =   a   .   g   u   i   d   |   |   f   .   g   u   i   d   +   +   ,   d   =   0   ,   e   =   f   u   n   c   t   i   o   n   (   c   )   {   v   a   r       e   =   (   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   l   a   s   t   T   o   g   g   l   e   "   +   a   .   g   u   i   d   )   |   |   0   )   %   d   ;   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   l   a   s   t   T   o   g   g   l   e   "   +   a   .   g   u   i   d   ,   e   +   1   )   ,   c   .   p   r   e   v   e   n   t   D   e   f   a   u   l   t   (   )   ;   r   e   t   u   r   n       b   [   e   ]   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   |   |   !   1   }   ;   e   .   g   u   i   d   =   c   ;   w   h   i   l   e   (   d   &lt;   b   .   l   e   n   g   t   h   )   b   [   d   +   +   ]   .   g   u   i   d   =   c   ;   r   e   t   u   r   n       t   h   i   s   .   c   l   i   c   k   (   e   )   }   ,   h   o   v   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       t   h   i   s   .   m   o   u   s   e   e   n   t   e   r   (   a   )   .   m   o   u   s   e   l   e   a   v   e   (   b   |   |   a   )   }   }   )   ,   f   .   e   a   c   h   (   "   b   l   u   r       f   o   c   u   s       f   o   c   u   s   i   n       f   o   c   u   s   o   u   t       l   o   a   d       r   e   s   i   z   e       s   c   r   o   l   l       u   n   l   o   a   d       c   l   i   c   k       d   b   l   c   l   i   c   k       m   o   u   s   e   d   o   w   n       m   o   u   s   e   u   p       m   o   u   s   e   m   o   v   e       m   o   u   s   e   o   v   e   r       m   o   u   s   e   o   u   t       m   o   u   s   e   e   n   t   e   r       m   o   u   s   e   l   e   a   v   e       c   h   a   n   g   e       s   e   l   e   c   t       s   u   b   m   i   t       k   e   y   d   o   w   n       k   e   y   p   r   e   s   s       k   e   y   u   p       e   r   r   o   r       c   o   n   t   e   x   t   m   e   n   u   "   .   s   p   l   i   t   (   "       "   )   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   n   [   b   ]   =   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   c   =   =   n   u   l   l   &amp;   &amp;   (   c   =   a   ,   a   =   n   u   l   l   )   ;   r   e   t   u   r   n       a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   &gt;   0   ?   t   h   i   s   .   o   n   (   b   ,   n   u   l   l   ,   a   ,   c   )   :   t   h   i   s   .   t   r   i   g   g   e   r   (   b   )   }   ,   f   .   a   t   t   r   F   n   &amp;   &amp;   (   f   .   a   t   t   r   F   n   [   b   ]   =   !   0   )   ,   C   .   t   e   s   t   (   b   )   &amp;   &amp;   (   f   .   e   v   e   n   t   .   f   i   x   H   o   o   k   s   [   b   ]   =   f   .   e   v   e   n   t   .   k   e   y   H   o   o   k   s   )   ,   D   .   t   e   s   t   (   b   )   &amp;   &amp;   (   f   .   e   v   e   n   t   .   f   i   x   H   o   o   k   s   [   b   ]   =   f   .   e   v   e   n   t   .   m   o   u   s   e   H   o   o   k   s   )   }   )   ,   f   u   n   c   t   i   o   n   (   )   {   f   u   n   c   t   i   o   n       x   (   a   ,   b   ,   c   ,   e   ,   f   ,   g   )   {   f   o   r   (   v   a   r       h   =   0   ,   i   =   e   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   {   v   a   r       j   =   e   [   h   ]   ;   i   f   (   j   )   {   v   a   r       k   =   !   1   ;   j   =   j   [   a   ]   ;   w   h   i   l   e   (   j   )   {   i   f   (   j   [   d   ]   =   =   =   c   )   {   k   =   e   [   j   .   s   i   z   s   e   t   ]   ;   b   r   e   a   k   }   i   f   (   j   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   g   |   |   (   j   [   d   ]   =   c   ,   j   .   s   i   z   s   e   t   =   h   )   ;   i   f   (   t   y   p   e   o   f       b   !   =   "   s   t   r   i   n   g   "   )   {   i   f   (   j   =   =   =   b   )   {   k   =   !   0   ;   b   r   e   a   k   }   }   e   l   s   e       i   f   (   m   .   f   i   l   t   e   r   (   b   ,   [   j   ]   )   .   l   e   n   g   t   h   &gt;   0   )   {   k   =   j   ;   b   r   e   a   k   }   }   j   =   j   [   a   ]   }   e   [   h   ]   =   k   }   }   }   f   u   n   c   t   i   o   n       w   (   a   ,   b   ,   c   ,   e   ,   f   ,   g   )   {   f   o   r   (   v   a   r       h   =   0   ,   i   =   e   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   {   v   a   r       j   =   e   [   h   ]   ;   i   f   (   j   )   {   v   a   r       k   =   !   1   ;   j   =   j   [   a   ]   ;   w   h   i   l   e   (   j   )   {   i   f   (   j   [   d   ]   =   =   =   c   )   {   k   =   e   [   j   .   s   i   z   s   e   t   ]   ;   b   r   e   a   k   }   j   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   !   g   &amp;   &amp;   (   j   [   d   ]   =   c   ,   j   .   s   i   z   s   e   t   =   h   )   ;   i   f   (   j   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   b   )   {   k   =   j   ;   b   r   e   a   k   }   j   =   j   [   a   ]   }   e   [   h   ]   =   k   }   }   }   v   a   r       a   =   /   (   (   ?   :   \   (   (   ?   :   \   (   [   ^   (   )   ]   +   \   )   |   [   ^   (   )   ]   +   )   +   \   )   |   \   [   (   ?   :   \   [   [   ^   \   [   \   ]   ]   *   \   ]   |   [   '   "   ]   [   ^   '   "   ]   *   [   '   "   ]   |   [   ^   \   [   \   ]   '   "   ]   +   )   +   \   ]   |   \   \   .   |   [   ^       &gt;   +   ~   ,   (   \   [   \   \   ]   +   )   +   |   [   &gt;   +   ~   ]   )   (   \   s   *   ,   \   s   *   )   ?   (   (   ?   :   .   |   \   r   |   \   n   )   *   )   /   g   ,   d   =   "   s   i   z   c   a   c   h   e   "   +   (   M   a   t   h   .   r   a   n   d   o   m   (   )   +   "   "   )   .   r   e   p   l   a   c   e   (   "   .   "   ,   "   "   )   ,   e   =   0   ,   g   =   O   b   j   e   c   t   .   p   r   o   t   o   t   y   p   e   .   t   o   S   t   r   i   n   g   ,   h   =   !   1   ,   i   =   !   0   ,   j   =   /   \   \   /   g   ,   k   =   /   \   r   \   n   /   g   ,   l   =   /   \   W   /   ;   [   0   ,   0   ]   .   s   o   r   t   (   f   u   n   c   t   i   o   n   (   )   {   i   =   !   1   ;   r   e   t   u   r   n       0   }   )   ;   v   a   r       m   =   f   u   n   c   t   i   o   n   (   b   ,   d   ,   e   ,   f   )   {   e   =   e   |   |   [   ]   ,   d   =   d   |   |   c   ;   v   a   r       h   =   d   ;   i   f   (   d   .   n   o   d   e   T   y   p   e   !   =   =   1   &amp;   &amp;   d   .   n   o   d   e   T   y   p   e   !   =   =   9   )   r   e   t   u   r   n   [   ]   ;   i   f   (   !   b   |   |   t   y   p   e   o   f       b   !   =   "   s   t   r   i   n   g   "   )   r   e   t   u   r   n       e   ;   v   a   r       i   ,   j   ,   k   ,   l   ,   n   ,   q   ,   r   ,   t   ,   u   =   !   0   ,   v   =   m   .   i   s   X   M   L   (   d   )   ,   w   =   [   ]   ,   x   =   b   ;   d   o   {   a   .   e   x   e   c   (   "   "   )   ,   i   =   a   .   e   x   e   c   (   x   )   ;   i   f   (   i   )   {   x   =   i   [   3   ]   ,   w   .   p   u   s   h   (   i   [   1   ]   )   ;   i   f   (   i   [   2   ]   )   {   l   =   i   [   3   ]   ;   b   r   e   a   k   }   }   }   w   h   i   l   e   (   i   )   ;   i   f   (   w   .   l   e   n   g   t   h   &gt;   1   &amp;   &amp;   p   .   e   x   e   c   (   b   )   )   i   f   (   w   .   l   e   n   g   t   h   =   =   =   2   &amp;   &amp;   o   .   r   e   l   a   t   i   v   e   [   w   [   0   ]   ]   )   j   =   y   (   w   [   0   ]   +   w   [   1   ]   ,   d   ,   f   )   ;   e   l   s   e   {   j   =   o   .   r   e   l   a   t   i   v   e   [   w   [   0   ]   ]   ?   [   d   ]   :   m   (   w   .   s   h   i   f   t   (   )   ,   d   )   ;   w   h   i   l   e   (   w   .   l   e   n   g   t   h   )   b   =   w   .   s   h   i   f   t   (   )   ,   o   .   r   e   l   a   t   i   v   e   [   b   ]   &amp;   &amp;   (   b   +   =   w   .   s   h   i   f   t   (   )   )   ,   j   =   y   (   b   ,   j   ,   f   )   }   e   l   s   e   {   !   f   &amp;   &amp;   w   .   l   e   n   g   t   h   &gt;   1   &amp;   &amp;   d   .   n   o   d   e   T   y   p   e   =   =   =   9   &amp;   &amp;   !   v   &amp;   &amp;   o   .   m   a   t   c   h   .   I   D   .   t   e   s   t   (   w   [   0   ]   )   &amp;   &amp;   !   o   .   m   a   t   c   h   .   I   D   .   t   e   s   t   (   w   [   w   .   l   e   n   g   t   h   -   1   ]   )   &amp;   &amp;   (   n   =   m   .   f   i   n   d   (   w   .   s   h   i   f   t   (   )   ,   d   ,   v   )   ,   d   =   n   .   e   x   p   r   ?   m   .   f   i   l   t   e   r   (   n   .   e   x   p   r   ,   n   .   s   e   t   )   [   0   ]   :   n   .   s   e   t   [   0   ]   )   ;   i   f   (   d   )   {   n   =   f   ?   {   e   x   p   r   :   w   .   p   o   p   (   )   ,   s   e   t   :   s   (   f   )   }   :   m   .   f   i   n   d   (   w   .   p   o   p   (   )   ,   w   .   l   e   n   g   t   h   =   =   =   1   &amp;   &amp;   (   w   [   0   ]   =   =   =   "   ~   "   |   |   w   [   0   ]   =   =   =   "   +   "   )   &amp;   &amp;   d   .   p   a   r   e   n   t   N   o   d   e   ?   d   .   p   a   r   e   n   t   N   o   d   e   :   d   ,   v   )   ,   j   =   n   .   e   x   p   r   ?   m   .   f   i   l   t   e   r   (   n   .   e   x   p   r   ,   n   .   s   e   t   )   :   n   .   s   e   t   ,   w   .   l   e   n   g   t   h   &gt;   0   ?   k   =   s   (   j   )   :   u   =   !   1   ;   w   h   i   l   e   (   w   .   l   e   n   g   t   h   )   q   =   w   .   p   o   p   (   )   ,   r   =   q   ,   o   .   r   e   l   a   t   i   v   e   [   q   ]   ?   r   =   w   .   p   o   p   (   )   :   q   =   "   "   ,   r   =   =   n   u   l   l   &amp;   &amp;   (   r   =   d   )   ,   o   .   r   e   l   a   t   i   v   e   [   q   ]   (   k   ,   r   ,   v   )   }   e   l   s   e       k   =   w   =   [   ]   }   k   |   |   (   k   =   j   )   ,   k   |   |   m   .   e   r   r   o   r   (   q   |   |   b   )   ;   i   f   (   g   .   c   a   l   l   (   k   )   =   =   =   "   [   o   b   j   e   c   t       A   r   r   a   y   ]   "   )   i   f   (   !   u   )   e   .   p   u   s   h   .   a   p   p   l   y   (   e   ,   k   )   ;   e   l   s   e       i   f   (   d   &amp;   &amp;   d   .   n   o   d   e   T   y   p   e   =   =   =   1   )   f   o   r   (   t   =   0   ;   k   [   t   ]   !   =   n   u   l   l   ;   t   +   +   )   k   [   t   ]   &amp;   &amp;   (   k   [   t   ]   =   =   =   !   0   |   |   k   [   t   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   m   .   c   o   n   t   a   i   n   s   (   d   ,   k   [   t   ]   )   )   &amp;   &amp;   e   .   p   u   s   h   (   j   [   t   ]   )   ;   e   l   s   e       f   o   r   (   t   =   0   ;   k   [   t   ]   !   =   n   u   l   l   ;   t   +   +   )   k   [   t   ]   &amp;   &amp;   k   [   t   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   e   .   p   u   s   h   (   j   [   t   ]   )   ;   e   l   s   e       s   (   k   ,   e   )   ;   l   &amp;   &amp;   (   m   (   l   ,   h   ,   e   ,   f   )   ,   m   .   u   n   i   q   u   e   S   o   r   t   (   e   )   )   ;   r   e   t   u   r   n       e   }   ;   m   .   u   n   i   q   u   e   S   o   r   t   =   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   u   )   {   h   =   i   ,   a   .   s   o   r   t   (   u   )   ;   i   f   (   h   )   f   o   r   (   v   a   r       b   =   1   ;   b   &lt;   a   .   l   e   n   g   t   h   ;   b   +   +   )   a   [   b   ]   =   =   =   a   [   b   -   1   ]   &amp;   &amp;   a   .   s   p   l   i   c   e   (   b   -   -   ,   1   )   }   r   e   t   u   r   n       a   }   ,   m   .   m   a   t   c   h   e   s   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       m   (   a   ,   n   u   l   l   ,   n   u   l   l   ,   b   )   }   ,   m   .   m   a   t   c   h   e   s   S   e   l   e   c   t   o   r   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       m   (   b   ,   n   u   l   l   ,   n   u   l   l   ,   [   a   ]   )   .   l   e   n   g   t   h   &gt;   0   }   ,   m   .   f   i   n   d   =   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   e   ,   f   ,   g   ,   h   ,   i   ;   i   f   (   !   a   )   r   e   t   u   r   n   [   ]   ;   f   o   r   (   e   =   0   ,   f   =   o   .   o   r   d   e   r   .   l   e   n   g   t   h   ;   e   &lt;   f   ;   e   +   +   )   {   h   =   o   .   o   r   d   e   r   [   e   ]   ;   i   f   (   g   =   o   .   l   e   f   t   M   a   t   c   h   [   h   ]   .   e   x   e   c   (   a   )   )   {   i   =   g   [   1   ]   ,   g   .   s   p   l   i   c   e   (   1   ,   1   )   ;   i   f   (   i   .   s   u   b   s   t   r   (   i   .   l   e   n   g   t   h   -   1   )   !   =   =   "   \   \   "   )   {   g   [   1   ]   =   (   g   [   1   ]   |   |   "   "   )   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   ,   d   =   o   .   f   i   n   d   [   h   ]   (   g   ,   b   ,   c   )   ;   i   f   (   d   !   =   n   u   l   l   )   {   a   =   a   .   r   e   p   l   a   c   e   (   o   .   m   a   t   c   h   [   h   ]   ,   "   "   )   ;   b   r   e   a   k   }   }   }   }   d   |   |   (   d   =   t   y   p   e   o   f       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   ?   b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   :   [   ]   )   ;   r   e   t   u   r   n   {   s   e   t   :   d   ,   e   x   p   r   :   a   }   }   ,   m   .   f   i   l   t   e   r   =   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   )   {   v   a   r       f   ,   g   ,   h   ,   i   ,   j   ,   k   ,   l   ,   n   ,   p   ,   q   =   a   ,   r   =   [   ]   ,   s   =   c   ,   t   =   c   &amp;   &amp;   c   [   0   ]   &amp;   &amp;   m   .   i   s   X   M   L   (   c   [   0   ]   )   ;   w   h   i   l   e   (   a   &amp;   &amp;   c   .   l   e   n   g   t   h   )   {   f   o   r   (   h       i   n       o   .   f   i   l   t   e   r   )   i   f   (   (   f   =   o   .   l   e   f   t   M   a   t   c   h   [   h   ]   .   e   x   e   c   (   a   )   )   !   =   n   u   l   l   &amp;   &amp;   f   [   2   ]   )   {   k   =   o   .   f   i   l   t   e   r   [   h   ]   ,   l   =   f   [   1   ]   ,   g   =   !   1   ,   f   .   s   p   l   i   c   e   (   1   ,   1   )   ;   i   f   (   l   .   s   u   b   s   t   r   (   l   .   l   e   n   g   t   h   -   1   )   =   =   =   "   \   \   "   )   c   o   n   t   i   n   u   e   ;   s   =   =   =   r   &amp;   &amp;   (   r   =   [   ]   )   ;   i   f   (   o   .   p   r   e   F   i   l   t   e   r   [   h   ]   )   {   f   =   o   .   p   r   e   F   i   l   t   e   r   [   h   ]   (   f   ,   s   ,   d   ,   r   ,   e   ,   t   )   ;   i   f   (   !   f   )   g   =   i   =   !   0   ;   e   l   s   e       i   f   (   f   =   =   =   !   0   )   c   o   n   t   i   n   u   e   }   i   f   (   f   )   f   o   r   (   n   =   0   ;   (   j   =   s   [   n   ]   )   !   =   n   u   l   l   ;   n   +   +   )   j   &amp;   &amp;   (   i   =   k   (   j   ,   f   ,   n   ,   s   )   ,   p   =   e   ^   i   ,   d   &amp;   &amp;   i   !   =   n   u   l   l   ?   p   ?   g   =   !   0   :   s   [   n   ]   =   !   1   :   p   &amp;   &amp;   (   r   .   p   u   s   h   (   j   )   ,   g   =   !   0   )   )   ;   i   f   (   i   !   =   =   b   )   {   d   |   |   (   s   =   r   )   ,   a   =   a   .   r   e   p   l   a   c   e   (   o   .   m   a   t   c   h   [   h   ]   ,   "   "   )   ;   i   f   (   !   g   )   r   e   t   u   r   n   [   ]   ;   b   r   e   a   k   }   }   i   f   (   a   =   =   =   q   )   i   f   (   g   =   =   n   u   l   l   )   m   .   e   r   r   o   r   (   a   )   ;   e   l   s   e       b   r   e   a   k   ;   q   =   a   }   r   e   t   u   r   n       s   }   ,   m   .   e   r   r   o   r   =   f   u   n   c   t   i   o   n   (   a   )   {   t   h   r   o   w       n   e   w       E   r   r   o   r   (   "   S   y   n   t   a   x       e   r   r   o   r   ,       u   n   r   e   c   o   g   n   i   z   e   d       e   x   p   r   e   s   s   i   o   n   :       "   +   a   )   }   ;   v   a   r       n   =   m   .   g   e   t   T   e   x   t   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   ,   c   ,   d   =   a   .   n   o   d   e   T   y   p   e   ,   e   =   "   "   ;   i   f   (   d   )   {   i   f   (   d   =   =   =   1   |   |   d   =   =   =   9   )   {   i   f   (   t   y   p   e   o   f       a   .   t   e   x   t   C   o   n   t   e   n   t   =   =   "   s   t   r   i   n   g   "   )   r   e   t   u   r   n       a   .   t   e   x   t   C   o   n   t   e   n   t   ;   i   f   (   t   y   p   e   o   f       a   .   i   n   n   e   r   T   e   x   t   =   =   "   s   t   r   i   n   g   "   )   r   e   t   u   r   n       a   .   i   n   n   e   r   T   e   x   t   .   r   e   p   l   a   c   e   (   k   ,   "   "   )   ;   f   o   r   (   a   =   a   .   f   i   r   s   t   C   h   i   l   d   ;   a   ;   a   =   a   .   n   e   x   t   S   i   b   l   i   n   g   )   e   +   =   n   (   a   )   }   e   l   s   e       i   f   (   d   =   =   =   3   |   |   d   =   =   =   4   )   r   e   t   u   r   n       a   .   n   o   d   e   V   a   l   u   e   }   e   l   s   e       f   o   r   (   b   =   0   ;   c   =   a   [   b   ]   ;   b   +   +   )   c   .   n   o   d   e   T   y   p   e   !   =   =   8   &amp;   &amp;   (   e   +   =   n   (   c   )   )   ;   r   e   t   u   r   n       e   }   ,   o   =   m   .   s   e   l   e   c   t   o   r   s   =   {   o   r   d   e   r   :   [   "   I   D   "   ,   "   N   A   M   E   "   ,   "   T   A   G   "   ]   ,   m   a   t   c   h   :   {   I   D   :   /   #   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   +   )   /   ,   C   L   A   S   S   :   /   \   .   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   +   )   /   ,   N   A   M   E   :   /   \   [   n   a   m   e   =   [   '   "   ]   *   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   +   )   [   '   "   ]   *   \   ]   /   ,   A   T   T   R   :   /   \   [   \   s   *   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   +   )   \   s   *   (   ?   :   (   \   S   ?   =   )   \   s   *   (   ?   :   (   [   '   "   ]   )   (   .   *   ?   )   \   3   |   (   #   ?   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   *   )   |   )   |   )   \   s   *   \   ]   /   ,   T   A   G   :   /   ^   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   *   \   -   ]   |   \   \   .   )   +   )   /   ,   C   H   I   L   D   :   /   :   (   o   n   l   y   |   n   t   h   |   l   a   s   t   |   f   i   r   s   t   )   -   c   h   i   l   d   (   ?   :   \   (   \   s   *   (   e   v   e   n   |   o   d   d   |   (   ?   :   [   +   \   -   ]   ?   \   d   +   |   (   ?   :   [   +   \   -   ]   ?   \   d   *   )   ?   n   \   s   *   (   ?   :   [   +   \   -   ]   \   s   *   \   d   +   )   ?   )   )   \   s   *   \   )   )   ?   /   ,   P   O   S   :   /   :   (   n   t   h   |   e   q   |   g   t   |   l   t   |   f   i   r   s   t   |   l   a   s   t   |   e   v   e   n   |   o   d   d   )   (   ?   :   \   (   (   \   d   *   )   \   )   )   ?   (   ?   =   [   ^   \   -   ]   |   $   )   /   ,   P   S   E   U   D   O   :   /   :   (   (   ?   :   [   \   w   \   u   0   0   c   0   -   \   u   F   F   F   F   \   -   ]   |   \   \   .   )   +   )   (   ?   :   \   (   (   [   '   "   ]   ?   )   (   (   ?   :   \   (   [   ^   \   )   ]   +   \   )   |   [   ^   \   (   \   )   ]   *   )   +   )   \   2   \   )   )   ?   /   }   ,   l   e   f   t   M   a   t   c   h   :   {   }   ,   a   t   t   r   M   a   p   :   {   "   c   l   a   s   s   "   :   "   c   l   a   s   s   N   a   m   e   "   ,   "   f   o   r   "   :   "   h   t   m   l   F   o   r   "   }   ,   a   t   t   r   H   a   n   d   l   e   :   {   h   r   e   f   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   h   r   e   f   "   )   }   ,   t   y   p   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   t   y   p   e   "   )   }   }   ,   r   e   l   a   t   i   v   e   :   {   "   +   "   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   t   y   p   e   o   f       b   =   =   "   s   t   r   i   n   g   "   ,   d   =   c   &amp;   &amp;   !   l   .   t   e   s   t   (   b   )   ,   e   =   c   &amp;   &amp;   !   d   ;   d   &amp;   &amp;   (   b   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   )   ;   f   o   r   (   v   a   r       f   =   0   ,   g   =   a   .   l   e   n   g   t   h   ,   h   ;   f   &lt;   g   ;   f   +   +   )   i   f   (   h   =   a   [   f   ]   )   {   w   h   i   l   e   (   (   h   =   h   .   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   )   &amp;   &amp;   h   .   n   o   d   e   T   y   p   e   !   =   =   1   )   ;   a   [   f   ]   =   e   |   |   h   &amp;   &amp;   h   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   b   ?   h   |   |   !   1   :   h   =   =   =   b   }   e   &amp;   &amp;   m   .   f   i   l   t   e   r   (   b   ,   a   ,   !   0   )   }   ,   "   &gt;   "   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ,   d   =   t   y   p   e   o   f       b   =   =   "   s   t   r   i   n   g   "   ,   e   =   0   ,   f   =   a   .   l   e   n   g   t   h   ;   i   f   (   d   &amp;   &amp;   !   l   .   t   e   s   t   (   b   )   )   {   b   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   f   o   r   (   ;   e   &lt;   f   ;   e   +   +   )   {   c   =   a   [   e   ]   ;   i   f   (   c   )   {   v   a   r       g   =   c   .   p   a   r   e   n   t   N   o   d   e   ;   a   [   e   ]   =   g   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   b   ?   g   :   !   1   }   }   }   e   l   s   e   {   f   o   r   (   ;   e   &lt;   f   ;   e   +   +   )   c   =   a   [   e   ]   ,   c   &amp;   &amp;   (   a   [   e   ]   =   d   ?   c   .   p   a   r   e   n   t   N   o   d   e   :   c   .   p   a   r   e   n   t   N   o   d   e   =   =   =   b   )   ;   d   &amp;   &amp;   m   .   f   i   l   t   e   r   (   b   ,   a   ,   !   0   )   }   }   ,   "   "   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   f   =   e   +   +   ,   g   =   x   ;   t   y   p   e   o   f       b   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   !   l   .   t   e   s   t   (   b   )   &amp;   &amp;   (   b   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   d   =   b   ,   g   =   w   )   ,   g   (   "   p   a   r   e   n   t   N   o   d   e   "   ,   b   ,   f   ,   a   ,   d   ,   c   )   }   ,   "   ~   "   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   f   =   e   +   +   ,   g   =   x   ;   t   y   p   e   o   f       b   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   !   l   .   t   e   s   t   (   b   )   &amp;   &amp;   (   b   =   b   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   d   =   b   ,   g   =   w   )   ,   g   (   "   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   "   ,   b   ,   f   ,   a   ,   d   ,   c   )   }   }   ,   f   i   n   d   :   {   I   D   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   t   y   p   e   o   f       b   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   !   c   )   {   v   a   r       d   =   b   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   (   a   [   1   ]   )   ;   r   e   t   u   r   n       d   &amp;   &amp;   d   .   p   a   r   e   n   t   N   o   d   e   ?   [   d   ]   :   [   ]   }   }   ,   N   A   M   E   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   t   y   p   e   o   f       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   )   {   v   a   r       c   =   [   ]   ,   d   =   b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   N   a   m   e   (   a   [   1   ]   )   ;   f   o   r   (   v   a   r       e   =   0   ,   f   =   d   .   l   e   n   g   t   h   ;   e   &lt;   f   ;   e   +   +   )   d   [   e   ]   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   n   a   m   e   "   )   =   =   =   a   [   1   ]   &amp;   &amp;   c   .   p   u   s   h   (   d   [   e   ]   )   ;   r   e   t   u   r   n       c   .   l   e   n   g   t   h   =   =   =   0   ?   n   u   l   l   :   c   }   }   ,   T   A   G   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   t   y   p   e   o   f       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   )   r   e   t   u   r   n       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   a   [   1   ]   )   }   }   ,   p   r   e   F   i   l   t   e   r   :   {   C   L   A   S   S   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   ,   e   ,   f   )   {   a   =   "       "   +   a   [   1   ]   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   +   "       "   ;   i   f   (   f   )   r   e   t   u   r   n       a   ;   f   o   r   (   v   a   r       g   =   0   ,   h   ;   (   h   =   b   [   g   ]   )   !   =   n   u   l   l   ;   g   +   +   )   h   &amp;   &amp;   (   e   ^   (   h   .   c   l   a   s   s   N   a   m   e   &amp;   &amp;   (   "       "   +   h   .   c   l   a   s   s   N   a   m   e   +   "       "   )   .   r   e   p   l   a   c   e   (   /   [   \   t   \   n   \   r   ]   /   g   ,   "       "   )   .   i   n   d   e   x   O   f   (   a   )   &gt;   =   0   )   ?   c   |   |   d   .   p   u   s   h   (   h   )   :   c   &amp;   &amp;   (   b   [   g   ]   =   !   1   )   )   ;   r   e   t   u   r   n   !   1   }   ,   I   D   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   [   1   ]   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   }   ,   T   A   G   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       a   [   1   ]   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   }   ,   C   H   I   L   D   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   [   1   ]   =   =   =   "   n   t   h   "   )   {   a   [   2   ]   |   |   m   .   e   r   r   o   r   (   a   [   0   ]   )   ,   a   [   2   ]   =   a   [   2   ]   .   r   e   p   l   a   c   e   (   /   ^   \   +   |   \   s   *   /   g   ,   "   "   )   ;   v   a   r       b   =   /   (   -   ?   )   (   \   d   *   )   (   ?   :   n   (   [   +   \   -   ]   ?   \   d   *   )   )   ?   /   .   e   x   e   c   (   a   [   2   ]   =   =   =   "   e   v   e   n   "   &amp;   &amp;   "   2   n   "   |   |   a   [   2   ]   =   =   =   "   o   d   d   "   &amp;   &amp;   "   2   n   +   1   "   |   |   !   /   \   D   /   .   t   e   s   t   (   a   [   2   ]   )   &amp;   &amp;   "   0   n   +   "   +   a   [   2   ]   |   |   a   [   2   ]   )   ;   a   [   2   ]   =   b   [   1   ]   +   (   b   [   2   ]   |   |   1   )   -   0   ,   a   [   3   ]   =   b   [   3   ]   -   0   }   e   l   s   e       a   [   2   ]   &amp;   &amp;   m   .   e   r   r   o   r   (   a   [   0   ]   )   ;   a   [   0   ]   =   e   +   +   ;   r   e   t   u   r   n       a   }   ,   A   T   T   R   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   ,   e   ,   f   )   {   v   a   r       g   =   a   [   1   ]   =   a   [   1   ]   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   ;   !   f   &amp;   &amp;   o   .   a   t   t   r   M   a   p   [   g   ]   &amp;   &amp;   (   a   [   1   ]   =   o   .   a   t   t   r   M   a   p   [   g   ]   )   ,   a   [   4   ]   =   (   a   [   4   ]   |   |   a   [   5   ]   |   |   "   "   )   .   r   e   p   l   a   c   e   (   j   ,   "   "   )   ,   a   [   2   ]   =   =   =   "   ~   =   "   &amp;   &amp;   (   a   [   4   ]   =   "       "   +   a   [   4   ]   +   "       "   )   ;   r   e   t   u   r   n       a   }   ,   P   S   E   U   D   O   :   f   u   n   c   t   i   o   n   (   b   ,   c   ,   d   ,   e   ,   f   )   {   i   f   (   b   [   1   ]   =   =   =   "   n   o   t   "   )   i   f   (   (   a   .   e   x   e   c   (   b   [   3   ]   )   |   |   "   "   )   .   l   e   n   g   t   h   &gt;   1   |   |   /   ^   \   w   /   .   t   e   s   t   (   b   [   3   ]   )   )   b   [   3   ]   =   m   (   b   [   3   ]   ,   n   u   l   l   ,   n   u   l   l   ,   c   )   ;   e   l   s   e   {   v   a   r       g   =   m   .   f   i   l   t   e   r   (   b   [   3   ]   ,   c   ,   d   ,   !   0   ^   f   )   ;   d   |   |   e   .   p   u   s   h   .   a   p   p   l   y   (   e   ,   g   )   ;   r   e   t   u   r   n   !   1   }   e   l   s   e       i   f   (   o   .   m   a   t   c   h   .   P   O   S   .   t   e   s   t   (   b   [   0   ]   )   |   |   o   .   m   a   t   c   h   .   C   H   I   L   D   .   t   e   s   t   (   b   [   0   ]   )   )   r   e   t   u   r   n   !   0   ;   r   e   t   u   r   n       b   }   ,   P   O   S   :   f   u   n   c   t   i   o   n   (   a   )   {   a   .   u   n   s   h   i   f   t   (   !   0   )   ;   r   e   t   u   r   n       a   }   }   ,   f   i   l   t   e   r   s   :   {   e   n   a   b   l   e   d   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   d   i   s   a   b   l   e   d   =   =   =   !   1   &amp;   &amp;   a   .   t   y   p   e   !   =   =   "   h   i   d   d   e   n   "   }   ,   d   i   s   a   b   l   e   d   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   d   i   s   a   b   l   e   d   =   =   =   !   0   }   ,   c   h   e   c   k   e   d   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   c   h   e   c   k   e   d   =   =   =   !   0   }   ,   s   e   l   e   c   t   e   d   :   f   u   n   c   t   i   o   n   (   a   )   {   a   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   a   .   p   a   r   e   n   t   N   o   d   e   .   s   e   l   e   c   t   e   d   I   n   d   e   x   ;   r   e   t   u   r   n       a   .   s   e   l   e   c   t   e   d   =   =   =   !   0   }   ,   p   a   r   e   n   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   !   a   .   f   i   r   s   t   C   h   i   l   d   }   ,   e   m   p   t   y   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   a   .   f   i   r   s   t   C   h   i   l   d   }   ,   h   a   s   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n   !   !   m   (   c   [   3   ]   ,   a   )   .   l   e   n   g   t   h   }   ,   h   e   a   d   e   r   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   /   h   \   d   /   i   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   }   ,   t   e   x   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   t   y   p   e   "   )   ,   c   =   a   .   t   y   p   e   ;   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   t   e   x   t   "   =   =   =   c   &amp;   &amp;   (   b   =   =   =   c   |   |   b   =   =   =   n   u   l   l   )   }   ,   r   a   d   i   o   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   r   a   d   i   o   "   =   =   =   a   .   t   y   p   e   }   ,   c   h   e   c   k   b   o   x   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   c   h   e   c   k   b   o   x   "   =   =   =   a   .   t   y   p   e   }   ,   f   i   l   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   f   i   l   e   "   =   =   =   a   .   t   y   p   e   }   ,   p   a   s   s   w   o   r   d   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   p   a   s   s   w   o   r   d   "   =   =   =   a   .   t   y   p   e   }   ,   s   u   b   m   i   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   r   e   t   u   r   n   (   b   =   =   =   "   i   n   p   u   t   "   |   |   b   =   =   =   "   b   u   t   t   o   n   "   )   &amp;   &amp;   "   s   u   b   m   i   t   "   =   =   =   a   .   t   y   p   e   }   ,   i   m   a   g   e   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   i   m   a   g   e   "   =   =   =   a   .   t   y   p   e   }   ,   r   e   s   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   r   e   t   u   r   n   (   b   =   =   =   "   i   n   p   u   t   "   |   |   b   =   =   =   "   b   u   t   t   o   n   "   )   &amp;   &amp;   "   r   e   s   e   t   "   =   =   =   a   .   t   y   p   e   }   ,   b   u   t   t   o   n   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   r   e   t   u   r   n       b   =   =   =   "   i   n   p   u   t   "   &amp;   &amp;   "   b   u   t   t   o   n   "   =   =   =   a   .   t   y   p   e   |   |   b   =   =   =   "   b   u   t   t   o   n   "   }   ,   i   n   p   u   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   /   i   n   p   u   t   |   s   e   l   e   c   t   |   t   e   x   t   a   r   e   a   |   b   u   t   t   o   n   /   i   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   }   ,   f   o   c   u   s   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   =   =   =   a   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   a   c   t   i   v   e   E   l   e   m   e   n   t   }   }   ,   s   e   t   F   i   l   t   e   r   s   :   {   f   i   r   s   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       b   =   =   =   0   }   ,   l   a   s   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n       b   =   =   =   d   .   l   e   n   g   t   h   -   1   }   ,   e   v   e   n   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       b   %   2   =   =   =   0   }   ,   o   d   d   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       b   %   2   =   =   =   1   }   ,   l   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       b   &lt;   c   [   3   ]   -   0   }   ,   g   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       b   &gt;   c   [   3   ]   -   0   }   ,   n   t   h   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       c   [   3   ]   -   0   =   =   =   b   }   ,   e   q   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       c   [   3   ]   -   0   =   =   =   b   }   }   ,   f   i   l   t   e   r   :   {   P   S   E   U   D   O   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   v   a   r       e   =   b   [   1   ]   ,   f   =   o   .   f   i   l   t   e   r   s   [   e   ]   ;   i   f   (   f   )   r   e   t   u   r   n       f   (   a   ,   c   ,   b   ,   d   )   ;   i   f   (   e   =   =   =   "   c   o   n   t   a   i   n   s   "   )   r   e   t   u   r   n   (   a   .   t   e   x   t   C   o   n   t   e   n   t   |   |   a   .   i   n   n   e   r   T   e   x   t   |   |   n   (   [   a   ]   )   |   |   "   "   )   .   i   n   d   e   x   O   f   (   b   [   3   ]   )   &gt;   =   0   ;   i   f   (   e   =   =   =   "   n   o   t   "   )   {   v   a   r       g   =   b   [   3   ]   ;   f   o   r   (   v   a   r       h   =   0   ,   i   =   g   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   i   f   (   g   [   h   ]   =   =   =   a   )   r   e   t   u   r   n   !   1   ;   r   e   t   u   r   n   !   0   }   m   .   e   r   r   o   r   (   e   )   }   ,   C   H   I   L   D   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ,   e   ,   f   ,   g   ,   h   ,   i   ,   j   ,   k   =   b   [   1   ]   ,   l   =   a   ;   s   w   i   t   c   h   (   k   )   {   c   a   s   e   "   o   n   l   y   "   :   c   a   s   e   "   f   i   r   s   t   "   :   w   h   i   l   e   (   l   =   l   .   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   )   i   f   (   l   .   n   o   d   e   T   y   p   e   =   =   =   1   )   r   e   t   u   r   n   !   1   ;   i   f   (   k   =   =   =   "   f   i   r   s   t   "   )   r   e   t   u   r   n   !   0   ;   l   =   a   ;   c   a   s   e   "   l   a   s   t   "   :   w   h   i   l   e   (   l   =   l   .   n   e   x   t   S   i   b   l   i   n   g   )   i   f   (   l   .   n   o   d   e   T   y   p   e   =   =   =   1   )   r   e   t   u   r   n   !   1   ;   r   e   t   u   r   n   !   0   ;   c   a   s   e   "   n   t   h   "   :   c   =   b   [   2   ]   ,   e   =   b   [   3   ]   ;   i   f   (   c   =   =   =   1   &amp;   &amp;   e   =   =   =   0   )   r   e   t   u   r   n   !   0   ;   f   =   b   [   0   ]   ,   g   =   a   .   p   a   r   e   n   t   N   o   d   e   ;   i   f   (   g   &amp;   &amp;   (   g   [   d   ]   !   =   =   f   |   |   !   a   .   n   o   d   e   I   n   d   e   x   )   )   {   i   =   0   ;   f   o   r   (   l   =   g   .   f   i   r   s   t   C   h   i   l   d   ;   l   ;   l   =   l   .   n   e   x   t   S   i   b   l   i   n   g   )   l   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   (   l   .   n   o   d   e   I   n   d   e   x   =   +   +   i   )   ;   g   [   d   ]   =   f   }   j   =   a   .   n   o   d   e   I   n   d   e   x   -   e   ;   r   e   t   u   r   n       c   =   =   =   0   ?   j   =   =   =   0   :   j   %   c   =   =   =   0   &amp;   &amp;   j   /   c   &gt;   =   0   }   }   ,   I   D   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       a   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   i   d   "   )   =   =   =   b   }   ,   T   A   G   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       b   =   =   =   "   *   "   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   =   =   =   1   |   |   !   !   a   .   n   o   d   e   N   a   m   e   &amp;   &amp;   a   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   b   }   ,   C   L   A   S   S   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n   (   "       "   +   (   a   .   c   l   a   s   s   N   a   m   e   |   |   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   c   l   a   s   s   "   )   )   +   "       "   )   .   i   n   d   e   x   O   f   (   b   )   &gt;   -   1   }   ,   A   T   T   R   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   b   [   1   ]   ,   d   =   m   .   a   t   t   r   ?   m   .   a   t   t   r   (   a   ,   c   )   :   o   .   a   t   t   r   H   a   n   d   l   e   [   c   ]   ?   o   .   a   t   t   r   H   a   n   d   l   e   [   c   ]   (   a   )   :   a   [   c   ]   !   =   n   u   l   l   ?   a   [   c   ]   :   a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   c   )   ,   e   =   d   +   "   "   ,   f   =   b   [   2   ]   ,   g   =   b   [   4   ]   ;   r   e   t   u   r   n       d   =   =   n   u   l   l   ?   f   =   =   =   "   !   =   "   :   !   f   &amp;   &amp;   m   .   a   t   t   r   ?   d   !   =   n   u   l   l   :   f   =   =   =   "   =   "   ?   e   =   =   =   g   :   f   =   =   =   "   *   =   "   ?   e   .   i   n   d   e   x   O   f   (   g   )   &gt;   =   0   :   f   =   =   =   "   ~   =   "   ?   (   "       "   +   e   +   "       "   )   .   i   n   d   e   x   O   f   (   g   )   &gt;   =   0   :   g   ?   f   =   =   =   "   !   =   "   ?   e   !   =   =   g   :   f   =   =   =   "   ^   =   "   ?   e   .   i   n   d   e   x   O   f   (   g   )   =   =   =   0   :   f   =   =   =   "   $   =   "   ?   e   .   s   u   b   s   t   r   (   e   .   l   e   n   g   t   h   -   g   .   l   e   n   g   t   h   )   =   =   =   g   :   f   =   =   =   "   |   =   "   ?   e   =   =   =   g   |   |   e   .   s   u   b   s   t   r   (   0   ,   g   .   l   e   n   g   t   h   +   1   )   =   =   =   g   +   "   -   "   :   !   1   :   e   &amp;   &amp;   d   !   =   =   !   1   }   ,   P   O   S   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   v   a   r       e   =   b   [   2   ]   ,   f   =   o   .   s   e   t   F   i   l   t   e   r   s   [   e   ]   ;   i   f   (   f   )   r   e   t   u   r   n       f   (   a   ,   c   ,   b   ,   d   )   }   }   }   ,   p   =   o   .   m   a   t   c   h   .   P   O   S   ,   q   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n   "   \   \   "   +   (   b   -   0   +   1   )   }   ;   f   o   r   (   v   a   r       r       i   n       o   .   m   a   t   c   h   )   o   .   m   a   t   c   h   [   r   ]   =   n   e   w       R   e   g   E   x   p   (   o   .   m   a   t   c   h   [   r   ]   .   s   o   u   r   c   e   +   /   (   ?   !   [   ^   \   [   ]   *   \   ]   )   (   ?   !   [   ^   \   (   ]   *   \   )   )   /   .   s   o   u   r   c   e   )   ,   o   .   l   e   f   t   M   a   t   c   h   [   r   ]   =   n   e   w       R   e   g   E   x   p   (   /   (   ^   (   ?   :   .   |   \   r   |   \   n   )   *   ?   )   /   .   s   o   u   r   c   e   +   o   .   m   a   t   c   h   [   r   ]   .   s   o   u   r   c   e   .   r   e   p   l   a   c   e   (   /   \   \   (   \   d   +   )   /   g   ,   q   )   )   ;   v   a   r       s   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   a   =   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   s   l   i   c   e   .   c   a   l   l   (   a   ,   0   )   ;   i   f   (   b   )   {   b   .   p   u   s   h   .   a   p   p   l   y   (   b   ,   a   )   ;   r   e   t   u   r   n       b   }   r   e   t   u   r   n       a   }   ;   t   r   y   {   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   s   l   i   c   e   .   c   a   l   l   (   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   c   h   i   l   d   N   o   d   e   s   ,   0   )   [   0   ]   .   n   o   d   e   T   y   p   e   }   c   a   t   c   h   (   t   )   {   s   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   0   ,   d   =   b   |   |   [   ]   ;   i   f   (   g   .   c   a   l   l   (   a   )   =   =   =   "   [   o   b   j   e   c   t       A   r   r   a   y   ]   "   )   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   p   u   s   h   .   a   p   p   l   y   (   d   ,   a   )   ;   e   l   s   e       i   f   (   t   y   p   e   o   f       a   .   l   e   n   g   t   h   =   =   "   n   u   m   b   e   r   "   )   f   o   r   (   v   a   r       e   =   a   .   l   e   n   g   t   h   ;   c   &lt;   e   ;   c   +   +   )   d   .   p   u   s   h   (   a   [   c   ]   )   ;   e   l   s   e       f   o   r   (   ;   a   [   c   ]   ;   c   +   +   )   d   .   p   u   s   h   (   a   [   c   ]   )   ;   r   e   t   u   r   n       d   }   }   v   a   r       u   ,   v   ;   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   ?   u   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   a   =   =   =   b   )   {   h   =   !   0   ;   r   e   t   u   r   n       0   }   i   f   (   !   a   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   |   |   !   b   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   )   r   e   t   u   r   n       a   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   ?   -   1   :   1   ;   r   e   t   u   r   n       a   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   (   b   )   &amp;   4   ?   -   1   :   1   }   :   (   u   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   a   =   =   =   b   )   {   h   =   !   0   ;   r   e   t   u   r   n       0   }   i   f   (   a   .   s   o   u   r   c   e   I   n   d   e   x   &amp;   &amp;   b   .   s   o   u   r   c   e   I   n   d   e   x   )   r   e   t   u   r   n       a   .   s   o   u   r   c   e   I   n   d   e   x   -   b   .   s   o   u   r   c   e   I   n   d   e   x   ;   v   a   r       c   ,   d   ,   e   =   [   ]   ,   f   =   [   ]   ,   g   =   a   .   p   a   r   e   n   t   N   o   d   e   ,   i   =   b   .   p   a   r   e   n   t   N   o   d   e   ,   j   =   g   ;   i   f   (   g   =   =   =   i   )   r   e   t   u   r   n       v   (   a   ,   b   )   ;   i   f   (   !   g   )   r   e   t   u   r   n   -   1   ;   i   f   (   !   i   )   r   e   t   u   r   n       1   ;   w   h   i   l   e   (   j   )   e   .   u   n   s   h   i   f   t   (   j   )   ,   j   =   j   .   p   a   r   e   n   t   N   o   d   e   ;   j   =   i   ;   w   h   i   l   e   (   j   )   f   .   u   n   s   h   i   f   t   (   j   )   ,   j   =   j   .   p   a   r   e   n   t   N   o   d   e   ;   c   =   e   .   l   e   n   g   t   h   ,   d   =   f   .   l   e   n   g   t   h   ;   f   o   r   (   v   a   r       k   =   0   ;   k   &lt;   c   &amp;   &amp;   k   &lt;   d   ;   k   +   +   )   i   f   (   e   [   k   ]   !   =   =   f   [   k   ]   )   r   e   t   u   r   n       v   (   e   [   k   ]   ,   f   [   k   ]   )   ;   r   e   t   u   r   n       k   =   =   =   c   ?   v   (   a   ,   f   [   k   ]   ,   -   1   )   :   v   (   e   [   k   ]   ,   b   ,   1   )   }   ,   v   =   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   a   =   =   =   b   )   r   e   t   u   r   n       c   ;   v   a   r       d   =   a   .   n   e   x   t   S   i   b   l   i   n   g   ;   w   h   i   l   e   (   d   )   {   i   f   (   d   =   =   =   b   )   r   e   t   u   r   n   -   1   ;   d   =   d   .   n   e   x   t   S   i   b   l   i   n   g   }   r   e   t   u   r   n       1   }   )   ,   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   d   =   "   s   c   r   i   p   t   "   +   (   n   e   w       D   a   t   e   )   .   g   e   t   T   i   m   e   (   )   ,   e   =   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ;   a   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   a       n   a   m   e   =   '   "   +   d   +   "   '   /   &gt;   "   ,   e   .   i   n   s   e   r   t   B   e   f   o   r   e   (   a   ,   e   .   f   i   r   s   t   C   h   i   l   d   )   ,   c   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   (   d   )   &amp;   &amp;   (   o   .   f   i   n   d   .   I   D   =   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   i   f   (   t   y   p   e   o   f       c   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   !   d   )   {   v   a   r       e   =   c   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   (   a   [   1   ]   )   ;   r   e   t   u   r   n       e   ?   e   .   i   d   =   =   =   a   [   1   ]   |   |   t   y   p   e   o   f       e   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   e   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   "   i   d   "   )   .   n   o   d   e   V   a   l   u   e   =   =   =   a   [   1   ]   ?   [   e   ]   :   b   :   [   ]   }   }   ,   o   .   f   i   l   t   e   r   .   I   D   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   t   y   p   e   o   f       a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   a   .   g   e   t   A   t   t   r   i   b   u   t   e   N   o   d   e   (   "   i   d   "   )   ;   r   e   t   u   r   n       a   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   c   &amp;   &amp;   c   .   n   o   d   e   V   a   l   u   e   =   =   =   b   }   )   ,   e   .   r   e   m   o   v   e   C   h   i   l   d   (   a   )   ,   e   =   a   =   n   u   l   l   }   (   )   ,   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ;   a   .   a   p   p   e   n   d   C   h   i   l   d   (   c   .   c   r   e   a   t   e   C   o   m   m   e   n   t   (   "   "   )   )   ,   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   .   l   e   n   g   t   h   &gt;   0   &amp;   &amp;   (   o   .   f   i   n   d   .   T   A   G   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   a   [   1   ]   )   ;   i   f   (   a   [   1   ]   =   =   =   "   *   "   )   {   v   a   r       d   =   [   ]   ;   f   o   r   (   v   a   r       e   =   0   ;   c   [   e   ]   ;   e   +   +   )   c   [   e   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   d   .   p   u   s   h   (   c   [   e   ]   )   ;   c   =   d   }   r   e   t   u   r   n       c   }   )   ,   a   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   a       h   r   e   f   =   '   #   '   &gt;   &lt;   /   a   &gt;   "   ,   a   .   f   i   r   s   t   C   h   i   l   d   &amp;   &amp;   t   y   p   e   o   f       a   .   f   i   r   s   t   C   h   i   l   d   .   g   e   t   A   t   t   r   i   b   u   t   e   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   a   .   f   i   r   s   t   C   h   i   l   d   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   h   r   e   f   "   )   !   =   =   "   #   "   &amp;   &amp;   (   o   .   a   t   t   r   H   a   n   d   l   e   .   h   r   e   f   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       a   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   h   r   e   f   "   ,   2   )   }   )   ,   a   =   n   u   l   l   }   (   )   ,   c   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   &amp;   &amp;   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   m   ,   b   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   d   =   "   _   _   s   i   z   z   l   e   _   _   "   ;   b   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   p       c   l   a   s   s   =   '   T   E   S   T   '   &gt;   &lt;   /   p   &gt;   "   ;   i   f   (   !   b   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   |   |   b   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   (   "   .   T   E   S   T   "   )   .   l   e   n   g   t   h   !   =   =   0   )   {   m   =   f   u   n   c   t   i   o   n   (   b   ,   e   ,   f   ,   g   )   {   e   =   e   |   |   c   ;   i   f   (   !   g   &amp;   &amp;   !   m   .   i   s   X   M   L   (   e   )   )   {   v   a   r       h   =   /   ^   (   \   w   +   $   )   |   ^   \   .   (   [   \   w   \   -   ]   +   $   )   |   ^   #   (   [   \   w   \   -   ]   +   $   )   /   .   e   x   e   c   (   b   )   ;   i   f   (   h   &amp;   &amp;   (   e   .   n   o   d   e   T   y   p   e   =   =   =   1   |   |   e   .   n   o   d   e   T   y   p   e   =   =   =   9   )   )   {   i   f   (   h   [   1   ]   )   r   e   t   u   r   n       s   (   e   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   b   )   ,   f   )   ;   i   f   (   h   [   2   ]   &amp;   &amp;   o   .   f   i   n   d   .   C   L   A   S   S   &amp;   &amp;   e   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   )   r   e   t   u   r   n       s   (   e   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   (   h   [   2   ]   )   ,   f   )   }   i   f   (   e   .   n   o   d   e   T   y   p   e   =   =   =   9   )   {   i   f   (   b   =   =   =   "   b   o   d   y   "   &amp;   &amp;   e   .   b   o   d   y   )   r   e   t   u   r   n       s   (   [   e   .   b   o   d   y   ]   ,   f   )   ;   i   f   (   h   &amp;   &amp;   h   [   3   ]   )   {   v   a   r       i   =   e   .   g   e   t   E   l   e   m   e   n   t   B   y   I   d   (   h   [   3   ]   )   ;   i   f   (   !   i   |   |   !   i   .   p   a   r   e   n   t   N   o   d   e   )   r   e   t   u   r   n       s   (   [   ]   ,   f   )   ;   i   f   (   i   .   i   d   =   =   =   h   [   3   ]   )   r   e   t   u   r   n       s   (   [   i   ]   ,   f   )   }   t   r   y   {   r   e   t   u   r   n       s   (   e   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   (   b   )   ,   f   )   }   c   a   t   c   h   (   j   )   {   }   }   e   l   s   e       i   f   (   e   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   e   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   !   =   =   "   o   b   j   e   c   t   "   )   {   v   a   r       k   =   e   ,   l   =   e   .   g   e   t   A   t   t   r   i   b   u   t   e   (   "   i   d   "   )   ,   n   =   l   |   |   d   ,   p   =   e   .   p   a   r   e   n   t   N   o   d   e   ,   q   =   /   ^   \   s   *   [   +   ~   ]   /   .   t   e   s   t   (   b   )   ;   l   ?   n   =   n   .   r   e   p   l   a   c   e   (   /   '   /   g   ,   "   \   \   $   &amp;   "   )   :   e   .   s   e   t   A   t   t   r   i   b   u   t   e   (   "   i   d   "   ,   n   )   ,   q   &amp;   &amp;   p   &amp;   &amp;   (   e   =   e   .   p   a   r   e   n   t   N   o   d   e   )   ;   t   r   y   {   i   f   (   !   q   |   |   p   )   r   e   t   u   r   n       s   (   e   .   q   u   e   r   y   S   e   l   e   c   t   o   r   A   l   l   (   "   [   i   d   =   '   "   +   n   +   "   '   ]       "   +   b   )   ,   f   )   }   c   a   t   c   h   (   r   )   {   }   f   i   n   a   l   l   y   {   l   |   |   k   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   "   i   d   "   )   }   }   }   r   e   t   u   r   n       a   (   b   ,   e   ,   f   ,   g   )   }   ;   f   o   r   (   v   a   r       e       i   n       a   )   m   [   e   ]   =   a   [   e   ]   ;   b   =   n   u   l   l   }   }   (   )   ,   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ,   b   =   a   .   m   a   t   c   h   e   s   S   e   l   e   c   t   o   r   |   |   a   .   m   o   z   M   a   t   c   h   e   s   S   e   l   e   c   t   o   r   |   |   a   .   w   e   b   k   i   t   M   a   t   c   h   e   s   S   e   l   e   c   t   o   r   |   |   a   .   m   s   M   a   t   c   h   e   s   S   e   l   e   c   t   o   r   ;   i   f   (   b   )   {   v   a   r       d   =   !   b   .   c   a   l   l   (   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ,   "   d   i   v   "   )   ,   e   =   !   1   ;   t   r   y   {   b   .   c   a   l   l   (   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ,   "   [   t   e   s   t   !   =   '   '   ]   :   s   i   z   z   l   e   "   )   }   c   a   t   c   h   (   f   )   {   e   =   !   0   }   m   .   m   a   t   c   h   e   s   S   e   l   e   c   t   o   r   =   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   c   =   c   .   r   e   p   l   a   c   e   (   /   \   =   \   s   *   (   [   ^   '   "   \   ]   ]   *   )   \   s   *   \   ]   /   g   ,   "   =   '   $   1   '   ]   "   )   ;   i   f   (   !   m   .   i   s   X   M   L   (   a   )   )   t   r   y   {   i   f   (   e   |   |   !   o   .   m   a   t   c   h   .   P   S   E   U   D   O   .   t   e   s   t   (   c   )   &amp;   &amp;   !   /   !   =   /   .   t   e   s   t   (   c   )   )   {   v   a   r       f   =   b   .   c   a   l   l   (   a   ,   c   )   ;   i   f   (   f   |   |   !   d   |   |   a   .   d   o   c   u   m   e   n   t   &amp;   &amp;   a   .   d   o   c   u   m   e   n   t   .   n   o   d   e   T   y   p   e   !   =   =   1   1   )   r   e   t   u   r   n       f   }   }   c   a   t   c   h   (   g   )   {   }   r   e   t   u   r   n       m   (   c   ,   n   u   l   l   ,   n   u   l   l   ,   [   a   ]   )   .   l   e   n   g   t   h   &gt;   0   }   }   }   (   )   ,   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ;   a   .   i   n   n   e   r   H   T   M   L   =   "   &lt;   d   i   v       c   l   a   s   s   =   '   t   e   s   t       e   '   &gt;   &lt;   /   d   i   v   &gt;   &lt;   d   i   v       c   l   a   s   s   =   '   t   e   s   t   '   &gt;   &lt;   /   d   i   v   &gt;   "   ;   i   f   (   !   !   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   &amp;   &amp;   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   (   "   e   "   )   .   l   e   n   g   t   h   !   =   =   0   )   {   a   .   l   a   s   t   C   h   i   l   d   .   c   l   a   s   s   N   a   m   e   =   "   e   "   ;   i   f   (   a   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   (   "   e   "   )   .   l   e   n   g   t   h   =   =   =   1   )   r   e   t   u   r   n   ;   o   .   o   r   d   e   r   .   s   p   l   i   c   e   (   1   ,   0   ,   "   C   L   A   S   S   "   )   ,   o   .   f   i   n   d   .   C   L   A   S   S   =   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   t   y   p   e   o   f       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   !   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   !   c   )   r   e   t   u   r   n       b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   C   l   a   s   s   N   a   m   e   (   a   [   1   ]   )   }   ,   a   =   n   u   l   l   }   }   (   )   ,   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   c   o   n   t   a   i   n   s   ?   m   .   c   o   n   t   a   i   n   s   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       a   !   =   =   b   &amp;   &amp;   (   a   .   c   o   n   t   a   i   n   s   ?   a   .   c   o   n   t   a   i   n   s   (   b   )   :   !   0   )   }   :   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   ?   m   .   c   o   n   t   a   i   n   s   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n   !   !   (   a   .   c   o   m   p   a   r   e   D   o   c   u   m   e   n   t   P   o   s   i   t   i   o   n   (   b   )   &amp;   1   6   )   }   :   m   .   c   o   n   t   a   i   n   s   =   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   !   1   }   ,   m   .   i   s   X   M   L   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   (   a   ?   a   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   a   :   0   )   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ;   r   e   t   u   r   n       b   ?   b   .   n   o   d   e   N   a   m   e   !   =   =   "   H   T   M   L   "   :   !   1   }   ;   v   a   r       y   =   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   e   =   [   ]   ,   f   =   "   "   ,   g   =   b   .   n   o   d   e   T   y   p   e   ?   [   b   ]   :   b   ;   w   h   i   l   e   (   d   =   o   .   m   a   t   c   h   .   P   S   E   U   D   O   .   e   x   e   c   (   a   )   )   f   +   =   d   [   0   ]   ,   a   =   a   .   r   e   p   l   a   c   e   (   o   .   m   a   t   c   h   .   P   S   E   U   D   O   ,   "   "   )   ;   a   =   o   .   r   e   l   a   t   i   v   e   [   a   ]   ?   a   +   "   *   "   :   a   ;   f   o   r   (   v   a   r       h   =   0   ,   i   =   g   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   m   (   a   ,   g   [   h   ]   ,   e   ,   c   )   ;   r   e   t   u   r   n       m   .   f   i   l   t   e   r   (   f   ,   e   )   }   ;   m   .   a   t   t   r   =   f   .   a   t   t   r   ,   m   .   s   e   l   e   c   t   o   r   s   .   a   t   t   r   M   a   p   =   {   }   ,   f   .   f   i   n   d   =   m   ,   f   .   e   x   p   r   =   m   .   s   e   l   e   c   t   o   r   s   ,   f   .   e   x   p   r   [   "   :   "   ]   =   f   .   e   x   p   r   .   f   i   l   t   e   r   s   ,   f   .   u   n   i   q   u   e   =   m   .   u   n   i   q   u   e   S   o   r   t   ,   f   .   t   e   x   t   =   m   .   g   e   t   T   e   x   t   ,   f   .   i   s   X   M   L   D   o   c   =   m   .   i   s   X   M   L   ,   f   .   c   o   n   t   a   i   n   s   =   m   .   c   o   n   t   a   i   n   s   }   (   )   ;   v   a   r       L   =   /   U   n   t   i   l   $   /   ,   M   =   /   ^   (   ?   :   p   a   r   e   n   t   s   |   p   r   e   v   U   n   t   i   l   |   p   r   e   v   A   l   l   )   /   ,   N   =   /   ,   /   ,   O   =   /   ^   .   [   ^   :   #   \   [   \   .   ,   ]   *   $   /   ,   P   =   A   r   r   a   y   .   p   r   o   t   o   t   y   p   e   .   s   l   i   c   e   ,   Q   =   f   .   e   x   p   r   .   m   a   t   c   h   .   P   O   S   ,   R   =   {   c   h   i   l   d   r   e   n   :   !   0   ,   c   o   n   t   e   n   t   s   :   !   0   ,   n   e   x   t   :   !   0   ,   p   r   e   v   :   !   0   }   ;   f   .   f   n   .   e   x   t   e   n   d   (   {   f   i   n   d   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   t   h   i   s   ,   c   ,   d   ;   i   f   (   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   )   r   e   t   u   r   n       f   (   a   )   .   f   i   l   t   e   r   (   f   u   n   c   t   i   o   n   (   )   {   f   o   r   (   c   =   0   ,   d   =   b   .   l   e   n   g   t   h   ;   c   &lt;   d   ;   c   +   +   )   i   f   (   f   .   c   o   n   t   a   i   n   s   (   b   [   c   ]   ,   t   h   i   s   )   )   r   e   t   u   r   n   !   0   }   )   ;   v   a   r       e   =   t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   "   "   ,   "   f   i   n   d   "   ,   a   )   ,   g   ,   h   ,   i   ;   f   o   r   (   c   =   0   ,   d   =   t   h   i   s   .   l   e   n   g   t   h   ;   c   &lt;   d   ;   c   +   +   )   {   g   =   e   .   l   e   n   g   t   h   ,   f   .   f   i   n   d   (   a   ,   t   h   i   s   [   c   ]   ,   e   )   ;   i   f   (   c   &gt;   0   )   f   o   r   (   h   =   g   ;   h   &lt;   e   .   l   e   n   g   t   h   ;   h   +   +   )   f   o   r   (   i   =   0   ;   i   &lt;   g   ;   i   +   +   )   i   f   (   e   [   i   ]   =   =   =   e   [   h   ]   )   {   e   .   s   p   l   i   c   e   (   h   -   -   ,   1   )   ;   b   r   e   a   k   }   }   r   e   t   u   r   n       e   }   ,   h   a   s   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   f   (   a   )   ;   r   e   t   u   r   n       t   h   i   s   .   f   i   l   t   e   r   (   f   u   n   c   t   i   o   n   (   )   {   f   o   r   (   v   a   r       a   =   0   ,   c   =   b   .   l   e   n   g   t   h   ;   a   &lt;   c   ;   a   +   +   )   i   f   (   f   .   c   o   n   t   a   i   n   s   (   t   h   i   s   ,   b   [   a   ]   )   )   r   e   t   u   r   n   !   0   }   )   }   ,   n   o   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   T   (   t   h   i   s   ,   a   ,   !   1   )   ,   "   n   o   t   "   ,   a   )   }   ,   f   i   l   t   e   r   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   T   (   t   h   i   s   ,   a   ,   !   0   )   ,   "   f   i   l   t   e   r   "   ,   a   )   }   ,   i   s   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   !   a   &amp;   &amp;   (   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   ?   Q   .   t   e   s   t   (   a   )   ?   f   (   a   ,   t   h   i   s   .   c   o   n   t   e   x   t   )   .   i   n   d   e   x   (   t   h   i   s   [   0   ]   )   &gt;   =   0   :   f   .   f   i   l   t   e   r   (   a   ,   t   h   i   s   )   .   l   e   n   g   t   h   &gt;   0   :   t   h   i   s   .   f   i   l   t   e   r   (   a   )   .   l   e   n   g   t   h   &gt;   0   )   }   ,   c   l   o   s   e   s   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   [   ]   ,   d   ,   e   ,   g   =   t   h   i   s   [   0   ]   ;   i   f   (   f   .   i   s   A   r   r   a   y   (   a   )   )   {   v   a   r       h   =   1   ;   w   h   i   l   e   (   g   &amp;   &amp;   g   .   o   w   n   e   r   D   o   c   u   m   e   n   t   &amp;   &amp;   g   !   =   =   b   )   {   f   o   r   (   d   =   0   ;   d   &lt;   a   .   l   e   n   g   t   h   ;   d   +   +   )   f   (   g   )   .   i   s   (   a   [   d   ]   )   &amp;   &amp;   c   .   p   u   s   h   (   {   s   e   l   e   c   t   o   r   :   a   [   d   ]   ,   e   l   e   m   :   g   ,   l   e   v   e   l   :   h   }   )   ;   g   =   g   .   p   a   r   e   n   t   N   o   d   e   ,   h   +   +   }   r   e   t   u   r   n       c   }   v   a   r       i   =   Q   .   t   e   s   t   (   a   )   |   |   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   ?   f   (   a   ,   b   |   |   t   h   i   s   .   c   o   n   t   e   x   t   )   :   0   ;   f   o   r   (   d   =   0   ,   e   =   t   h   i   s   .   l   e   n   g   t   h   ;   d   &lt;   e   ;   d   +   +   )   {   g   =   t   h   i   s   [   d   ]   ;   w   h   i   l   e   (   g   )   {   i   f   (   i   ?   i   .   i   n   d   e   x   (   g   )   &gt;   -   1   :   f   .   f   i   n   d   .   m   a   t   c   h   e   s   S   e   l   e   c   t   o   r   (   g   ,   a   )   )   {   c   .   p   u   s   h   (   g   )   ;   b   r   e   a   k   }   g   =   g   .   p   a   r   e   n   t   N   o   d   e   ;   i   f   (   !   g   |   |   !   g   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   g   =   =   =   b   |   |   g   .   n   o   d   e   T   y   p   e   =   =   =   1   1   )   b   r   e   a   k   }   }   c   =   c   .   l   e   n   g   t   h   &gt;   1   ?   f   .   u   n   i   q   u   e   (   c   )   :   c   ;   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   c   ,   "   c   l   o   s   e   s   t   "   ,   a   )   }   ,   i   n   d   e   x   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   !   a   )   r   e   t   u   r   n       t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   ?   t   h   i   s   .   p   r   e   v   A   l   l   (   )   .   l   e   n   g   t   h   :   -   1   ;   i   f   (   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   )   r   e   t   u   r   n       f   .   i   n   A   r   r   a   y   (   t   h   i   s   [   0   ]   ,   f   (   a   )   )   ;   r   e   t   u   r   n       f   .   i   n   A   r   r   a   y   (   a   .   j   q   u   e   r   y   ?   a   [   0   ]   :   a   ,   t   h   i   s   )   }   ,   a   d   d   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   ?   f   (   a   ,   b   )   :   f   .   m   a   k   e   A   r   r   a   y   (   a   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   ?   [   a   ]   :   a   )   ,   d   =   f   .   m   e   r   g   e   (   t   h   i   s   .   g   e   t   (   )   ,   c   )   ;   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   S   (   c   [   0   ]   )   |   |   S   (   d   [   0   ]   )   ?   d   :   f   .   u   n   i   q   u   e   (   d   )   )   }   ,   a   n   d   S   e   l   f   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   a   d   d   (   t   h   i   s   .   p   r   e   v   O   b   j   e   c   t   )   }   }   )   ,   f   .   e   a   c   h   (   {   p   a   r   e   n   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   p   a   r   e   n   t   N   o   d   e   ;   r   e   t   u   r   n       b   &amp;   &amp;   b   .   n   o   d   e   T   y   p   e   !   =   =   1   1   ?   b   :   n   u   l   l   }   ,   p   a   r   e   n   t   s   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   p   a   r   e   n   t   N   o   d   e   "   )   }   ,   p   a   r   e   n   t   s   U   n   t   i   l   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   p   a   r   e   n   t   N   o   d   e   "   ,   c   )   }   ,   n   e   x   t   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   n   t   h   (   a   ,   2   ,   "   n   e   x   t   S   i   b   l   i   n   g   "   )   }   ,   p   r   e   v   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   n   t   h   (   a   ,   2   ,   "   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   "   )   }   ,   n   e   x   t   A   l   l   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   n   e   x   t   S   i   b   l   i   n   g   "   )   }   ,   p   r   e   v   A   l   l   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   "   )   }   ,   n   e   x   t   U   n   t   i   l   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   n   e   x   t   S   i   b   l   i   n   g   "   ,   c   )   }   ,   p   r   e   v   U   n   t   i   l   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   d   i   r   (   a   ,   "   p   r   e   v   i   o   u   s   S   i   b   l   i   n   g   "   ,   c   )   }   ,   s   i   b   l   i   n   g   s   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   s   i   b   l   i   n   g   (   a   .   p   a   r   e   n   t   N   o   d   e   .   f   i   r   s   t   C   h   i   l   d   ,   a   )   }   ,   c   h   i   l   d   r   e   n   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   s   i   b   l   i   n   g   (   a   .   f   i   r   s   t   C   h   i   l   d   )   }   ,   c   o   n   t   e   n   t   s   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   n   o   d   e   N   a   m   e   (   a   ,   "   i   f   r   a   m   e   "   )   ?   a   .   c   o   n   t   e   n   t   D   o   c   u   m   e   n   t   |   |   a   .   c   o   n   t   e   n   t   W   i   n   d   o   w   .   d   o   c   u   m   e   n   t   :   f   .   m   a   k   e   A   r   r   a   y   (   a   .   c   h   i   l   d   N   o   d   e   s   )   }   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   n   [   a   ]   =   f   u   n   c   t   i   o   n   (   c   ,   d   )   {   v   a   r       e   =   f   .   m   a   p   (   t   h   i   s   ,   b   ,   c   )   ;   L   .   t   e   s   t   (   a   )   |   |   (   d   =   c   )   ,   d   &amp;   &amp;   t   y   p   e   o   f       d   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   e   =   f   .   f   i   l   t   e   r   (   d   ,   e   )   )   ,   e   =   t   h   i   s   .   l   e   n   g   t   h   &gt;   1   &amp;   &amp;   !   R   [   a   ]   ?   f   .   u   n   i   q   u   e   (   e   )   :   e   ,   (   t   h   i   s   .   l   e   n   g   t   h   &gt;   1   |   |   N   .   t   e   s   t   (   d   )   )   &amp;   &amp;   M   .   t   e   s   t   (   a   )   &amp;   &amp;   (   e   =   e   .   r   e   v   e   r   s   e   (   )   )   ;   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   e   ,   a   ,   P   .   c   a   l   l   (   a   r   g   u   m   e   n   t   s   )   .   j   o   i   n   (   "   ,   "   )   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   f   i   l   t   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   c   &amp;   &amp;   (   a   =   "   :   n   o   t   (   "   +   a   +   "   )   "   )   ;   r   e   t   u   r   n       b   .   l   e   n   g   t   h   =   =   =   1   ?   f   .   f   i   n   d   .   m   a   t   c   h   e   s   S   e   l   e   c   t   o   r   (   b   [   0   ]   ,   a   )   ?   [   b   [   0   ]   ]   :   [   ]   :   f   .   f   i   n   d   .   m   a   t   c   h   e   s   (   a   ,   b   )   }   ,   d   i   r   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       e   =   [   ]   ,   g   =   a   [   c   ]   ;   w   h   i   l   e   (   g   &amp;   &amp;   g   .   n   o   d   e   T   y   p   e   !   =   =   9   &amp;   &amp;   (   d   =   =   =   b   |   |   g   .   n   o   d   e   T   y   p   e   !   =   =   1   |   |   !   f   (   g   )   .   i   s   (   d   )   )   )   g   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   e   .   p   u   s   h   (   g   )   ,   g   =   g   [   c   ]   ;   r   e   t   u   r   n       e   }   ,   n   t   h   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   b   =   b   |   |   1   ;   v   a   r       e   =   0   ;   f   o   r   (   ;   a   ;   a   =   a   [   c   ]   )   i   f   (   a   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   +   +   e   =   =   =   b   )   b   r   e   a   k   ;   r   e   t   u   r   n       a   }   ,   s   i   b   l   i   n   g   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   [   ]   ;   f   o   r   (   ;   a   ;   a   =   a   .   n   e   x   t   S   i   b   l   i   n   g   )   a   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   a   !   =   =   b   &amp;   &amp;   c   .   p   u   s   h   (   a   )   ;   r   e   t   u   r   n       c   }   }   )   ;   v   a   r       V   =   "   a   b   b   r   |   a   r   t   i   c   l   e   |   a   s   i   d   e   |   a   u   d   i   o   |   c   a   n   v   a   s   |   d   a   t   a   l   i   s   t   |   d   e   t   a   i   l   s   |   f   i   g   c   a   p   t   i   o   n   |   f   i   g   u   r   e   |   f   o   o   t   e   r   |   h   e   a   d   e   r   |   h   g   r   o   u   p   |   m   a   r   k   |   m   e   t   e   r   |   n   a   v   |   o   u   t   p   u   t   |   p   r   o   g   r   e   s   s   |   s   e   c   t   i   o   n   |   s   u   m   m   a   r   y   |   t   i   m   e   |   v   i   d   e   o   "   ,   W   =   /       j   Q   u   e   r   y   \   d   +   =   "   (   ?   :   \   d   +   |   n   u   l   l   )   "   /   g   ,   X   =   /   ^   \   s   +   /   ,   Y   =   /   &lt;   (   ?   !   a   r   e   a   |   b   r   |   c   o   l   |   e   m   b   e   d   |   h   r   |   i   m   g   |   i   n   p   u   t   |   l   i   n   k   |   m   e   t   a   |   p   a   r   a   m   )   (   (   [   \   w   :   ]   +   )   [   ^   &gt;   ]   *   )   \   /   &gt;   /   i   g   ,   Z   =   /   &lt;   (   [   \   w   :   ]   +   )   /   ,   $   =   /   &lt;   t   b   o   d   y   /   i   ,   _   =   /   &lt;   |   &amp;   #   ?   \   w   +   ;   /   ,   b   a   =   /   &lt;   (   ?   :   s   c   r   i   p   t   |   s   t   y   l   e   )   /   i   ,   b   b   =   /   &lt;   (   ?   :   s   c   r   i   p   t   |   o   b   j   e   c   t   |   e   m   b   e   d   |   o   p   t   i   o   n   |   s   t   y   l   e   )   /   i   ,   b   c   =   n   e   w       R   e   g   E   x   p   (   "   &lt;   (   ?   :   "   +   V   +   "   )   "   ,   "   i   "   )   ,   b   d   =   /   c   h   e   c   k   e   d   \   s   *   (   ?   :   [   ^   =   ]   |   =   \   s   *   .   c   h   e   c   k   e   d   .   )   /   i   ,   b   e   =   /   \   /   (   j   a   v   a   |   e   c   m   a   )   s   c   r   i   p   t   /   i   ,   b   f   =   /   ^   \   s   *   &lt;   !   (   ?   :   \   [   C   D   A   T   A   \   [   |   \   -   \   -   )   /   ,   b   g   =   {   o   p   t   i   o   n   :   [   1   ,   "   &lt;   s   e   l   e   c   t       m   u   l   t   i   p   l   e   =   '   m   u   l   t   i   p   l   e   '   &gt;   "   ,   "   &lt;   /   s   e   l   e   c   t   &gt;   "   ]   ,   l   e   g   e   n   d   :   [   1   ,   "   &lt;   f   i   e   l   d   s   e   t   &gt;   "   ,   "   &lt;   /   f   i   e   l   d   s   e   t   &gt;   "   ]   ,   t   h   e   a   d   :   [   1   ,   "   &lt;   t   a   b   l   e   &gt;   "   ,   "   &lt;   /   t   a   b   l   e   &gt;   "   ]   ,   t   r   :   [   2   ,   "   &lt;   t   a   b   l   e   &gt;   &lt;   t   b   o   d   y   &gt;   "   ,   "   &lt;   /   t   b   o   d   y   &gt;   &lt;   /   t   a   b   l   e   &gt;   "   ]   ,   t   d   :   [   3   ,   "   &lt;   t   a   b   l   e   &gt;   &lt;   t   b   o   d   y   &gt;   &lt;   t   r   &gt;   "   ,   "   &lt;   /   t   r   &gt;   &lt;   /   t   b   o   d   y   &gt;   &lt;   /   t   a   b   l   e   &gt;   "   ]   ,   c   o   l   :   [   2   ,   "   &lt;   t   a   b   l   e   &gt;   &lt;   t   b   o   d   y   &gt;   &lt;   /   t   b   o   d   y   &gt;   &lt;   c   o   l   g   r   o   u   p   &gt;   "   ,   "   &lt;   /   c   o   l   g   r   o   u   p   &gt;   &lt;   /   t   a   b   l   e   &gt;   "   ]   ,   a   r   e   a   :   [   1   ,   "   &lt;   m   a   p   &gt;   "   ,   "   &lt;   /   m   a   p   &gt;   "   ]   ,   _   d   e   f   a   u   l   t   :   [   0   ,   "   "   ,   "   "   ]   }   ,   b   h   =   U   (   c   )   ;   b   g   .   o   p   t   g   r   o   u   p   =   b   g   .   o   p   t   i   o   n   ,   b   g   .   t   b   o   d   y   =   b   g   .   t   f   o   o   t   =   b   g   .   c   o   l   g   r   o   u   p   =   b   g   .   c   a   p   t   i   o   n   =   b   g   .   t   h   e   a   d   ,   b   g   .   t   h   =   b   g   .   t   d   ,   f   .   s   u   p   p   o   r   t   .   h   t   m   l   S   e   r   i   a   l   i   z   e   |   |   (   b   g   .   _   d   e   f   a   u   l   t   =   [   1   ,   "   d   i   v   &lt;   d   i   v   &gt;   "   ,   "   &lt;   /   d   i   v   &gt;   "   ]   )   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   t   e   x   t   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   v   a   r       c   =   f   (   t   h   i   s   )   ;   c   .   t   e   x   t   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   c   .   t   e   x   t   (   )   )   )   }   )   ;   i   f   (   t   y   p   e   o   f       a   !   =   "   o   b   j   e   c   t   "   &amp;   &amp;   a   !   =   =   b   )   r   e   t   u   r   n       t   h   i   s   .   e   m   p   t   y   (   )   .   a   p   p   e   n   d   (   (   t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   c   )   .   c   r   e   a   t   e   T   e   x   t   N   o   d   e   (   a   )   )   ;   r   e   t   u   r   n       f   .   t   e   x   t   (   t   h   i   s   )   }   ,   w   r   a   p   A   l   l   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   (   t   h   i   s   )   .   w   r   a   p   A   l   l   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   )   )   }   )   ;   i   f   (   t   h   i   s   [   0   ]   )   {   v   a   r       b   =   f   (   a   ,   t   h   i   s   [   0   ]   .   o   w   n   e   r   D   o   c   u   m   e   n   t   )   .   e   q   (   0   )   .   c   l   o   n   e   (   !   0   )   ;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   b   .   i   n   s   e   r   t   B   e   f   o   r   e   (   t   h   i   s   [   0   ]   )   ,   b   .   m   a   p   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   t   h   i   s   ;   w   h   i   l   e   (   a   .   f   i   r   s   t   C   h   i   l   d   &amp;   &amp;   a   .   f   i   r   s   t   C   h   i   l   d   .   n   o   d   e   T   y   p   e   =   =   =   1   )   a   =   a   .   f   i   r   s   t   C   h   i   l   d   ;   r   e   t   u   r   n       a   }   )   .   a   p   p   e   n   d   (   t   h   i   s   )   }   r   e   t   u   r   n       t   h   i   s   }   ,   w   r   a   p   I   n   n   e   r   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   (   t   h   i   s   )   .   w   r   a   p   I   n   n   e   r   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   )   )   }   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   =   f   (   t   h   i   s   )   ,   c   =   b   .   c   o   n   t   e   n   t   s   (   )   ;   c   .   l   e   n   g   t   h   ?   c   .   w   r   a   p   A   l   l   (   a   )   :   b   .   a   p   p   e   n   d   (   a   )   }   )   }   ,   w   r   a   p   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   c   )   {   f   (   t   h   i   s   )   .   w   r   a   p   A   l   l   (   b   ?   a   .   c   a   l   l   (   t   h   i   s   ,   c   )   :   a   )   }   )   }   ,   u   n   w   r   a   p   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   p   a   r   e   n   t   (   )   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   .   n   o   d   e   N   a   m   e   (   t   h   i   s   ,   "   b   o   d   y   "   )   |   |   f   (   t   h   i   s   )   .   r   e   p   l   a   c   e   W   i   t   h   (   t   h   i   s   .   c   h   i   l   d   N   o   d   e   s   )   }   )   .   e   n   d   (   )   }   ,   a   p   p   e   n   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   d   o   m   M   a   n   i   p   (   a   r   g   u   m   e   n   t   s   ,   !   0   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   t   h   i   s   .   a   p   p   e   n   d   C   h   i   l   d   (   a   )   }   )   }   ,   p   r   e   p   e   n   d   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   d   o   m   M   a   n   i   p   (   a   r   g   u   m   e   n   t   s   ,   !   0   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   t   h   i   s   .   i   n   s   e   r   t   B   e   f   o   r   e   (   a   ,   t   h   i   s   .   f   i   r   s   t   C   h   i   l   d   )   }   )   }   ,   b   e   f   o   r   e   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   )   r   e   t   u   r   n       t   h   i   s   .   d   o   m   M   a   n   i   p   (   a   r   g   u   m   e   n   t   s   ,   !   1   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   .   i   n   s   e   r   t   B   e   f   o   r   e   (   a   ,   t   h   i   s   )   }   )   ;   i   f   (   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   )   {   v   a   r       a   =   f   .   c   l   e   a   n   (   a   r   g   u   m   e   n   t   s   )   ;   a   .   p   u   s   h   .   a   p   p   l   y   (   a   ,   t   h   i   s   .   t   o   A   r   r   a   y   (   )   )   ;   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   a   ,   "   b   e   f   o   r   e   "   ,   a   r   g   u   m   e   n   t   s   )   }   }   ,   a   f   t   e   r   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   )   r   e   t   u   r   n       t   h   i   s   .   d   o   m   M   a   n   i   p   (   a   r   g   u   m   e   n   t   s   ,   !   1   ,   f   u   n   c   t   i   o   n   (   a   )   {   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   .   i   n   s   e   r   t   B   e   f   o   r   e   (   a   ,   t   h   i   s   .   n   e   x   t   S   i   b   l   i   n   g   )   }   )   ;   i   f   (   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   )   {   v   a   r       a   =   t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   t   h   i   s   ,   "   a   f   t   e   r   "   ,   a   r   g   u   m   e   n   t   s   )   ;   a   .   p   u   s   h   .   a   p   p   l   y   (   a   ,   f   .   c   l   e   a   n   (   a   r   g   u   m   e   n   t   s   )   )   ;   r   e   t   u   r   n       a   }   }   ,   r   e   m   o   v   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   o   r   (   v   a   r       c   =   0   ,   d   ;   (   d   =   t   h   i   s   [   c   ]   )   !   =   n   u   l   l   ;   c   +   +   )   i   f   (   !   a   |   |   f   .   f   i   l   t   e   r   (   a   ,   [   d   ]   )   .   l   e   n   g   t   h   )   !   b   &amp;   &amp;   d   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   (   f   .   c   l   e   a   n   D   a   t   a   (   d   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   )   ,   f   .   c   l   e   a   n   D   a   t   a   (   [   d   ]   )   )   ,   d   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   d   .   p   a   r   e   n   t   N   o   d   e   .   r   e   m   o   v   e   C   h   i   l   d   (   d   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   e   m   p   t   y   :   f   u   n   c   t   i   o   n   (   )      
   {   f   o   r   (   v   a   r       a   =   0   ,   b   ;   (   b   =   t   h   i   s   [   a   ]   )   !   =   n   u   l   l   ;   a   +   +   )   {   b   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   f   .   c   l   e   a   n   D   a   t   a   (   b   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   )   ;   w   h   i   l   e   (   b   .   f   i   r   s   t   C   h   i   l   d   )   b   .   r   e   m   o   v   e   C   h   i   l   d   (   b   .   f   i   r   s   t   C   h   i   l   d   )   }   r   e   t   u   r   n       t   h   i   s   }   ,   c   l   o   n   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   a   =   a   =   =   n   u   l   l   ?   !   1   :   a   ,   b   =   b   =   =   n   u   l   l   ?   a   :   b   ;   r   e   t   u   r   n       t   h   i   s   .   m   a   p   (   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       f   .   c   l   o   n   e   (   t   h   i   s   ,   a   ,   b   )   }   )   }   ,   h   t   m   l   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   =   =   =   b   )   r   e   t   u   r   n       t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   ?   t   h   i   s   [   0   ]   .   i   n   n   e   r   H   T   M   L   .   r   e   p   l   a   c   e   (   W   ,   "   "   )   :   n   u   l   l   ;   i   f   (   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   !   b   a   .   t   e   s   t   (   a   )   &amp;   &amp;   (   f   .   s   u   p   p   o   r   t   .   l   e   a   d   i   n   g   W   h   i   t   e   s   p   a   c   e   |   |   !   X   .   t   e   s   t   (   a   )   )   &amp;   &amp;   !   b   g   [   (   Z   .   e   x   e   c   (   a   )   |   |   [   "   "   ,   "   "   ]   )   [   1   ]   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   )   {   a   =   a   .   r   e   p   l   a   c   e   (   Y   ,   "   &lt;   $   1   &gt;   &lt;   /   $   2   &gt;   "   )   ;   t   r   y   {   f   o   r   (   v   a   r       c   =   0   ,   d   =   t   h   i   s   .   l   e   n   g   t   h   ;   c   &lt;   d   ;   c   +   +   )   t   h   i   s   [   c   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   &amp;   &amp;   (   f   .   c   l   e   a   n   D   a   t   a   (   t   h   i   s   [   c   ]   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   *   "   )   )   ,   t   h   i   s   [   c   ]   .   i   n   n   e   r   H   T   M   L   =   a   )   }   c   a   t   c   h   (   e   )   {   t   h   i   s   .   e   m   p   t   y   (   )   .   a   p   p   e   n   d   (   a   )   }   }   e   l   s   e       f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   ?   t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   v   a   r       c   =   f   (   t   h   i   s   )   ;   c   .   h   t   m   l   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   c   .   h   t   m   l   (   )   )   )   }   )   :   t   h   i   s   .   e   m   p   t   y   (   )   .   a   p   p   e   n   d   (   a   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   r   e   p   l   a   c   e   W   i   t   h   :   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   t   h   i   s   [   0   ]   &amp;   &amp;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   )   {   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   v   a   r       c   =   f   (   t   h   i   s   )   ,   d   =   c   .   h   t   m   l   (   )   ;   c   .   r   e   p   l   a   c   e   W   i   t   h   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   d   )   )   }   )   ;   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   a   =   f   (   a   )   .   d   e   t   a   c   h   (   )   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   =   t   h   i   s   .   n   e   x   t   S   i   b   l   i   n   g   ,   c   =   t   h   i   s   .   p   a   r   e   n   t   N   o   d   e   ;   f   (   t   h   i   s   )   .   r   e   m   o   v   e   (   )   ,   b   ?   f   (   b   )   .   b   e   f   o   r   e   (   a   )   :   f   (   c   )   .   a   p   p   e   n   d   (   a   )   }   )   }   r   e   t   u   r   n       t   h   i   s   .   l   e   n   g   t   h   ?   t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   ?   a   (   )   :   a   )   ,   "   r   e   p   l   a   c   e   W   i   t   h   "   ,   a   )   :   t   h   i   s   }   ,   d   e   t   a   c   h   :   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   r   e   m   o   v   e   (   a   ,   !   0   )   }   ,   d   o   m   M   a   n   i   p   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       e   ,   g   ,   h   ,   i   ,   j   =   a   [   0   ]   ,   k   =   [   ]   ;   i   f   (   !   f   .   s   u   p   p   o   r   t   .   c   h   e   c   k   C   l   o   n   e   &amp;   &amp;   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   =   =   =   3   &amp;   &amp;   t   y   p   e   o   f       j   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   b   d   .   t   e   s   t   (   j   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   (   t   h   i   s   )   .   d   o   m   M   a   n   i   p   (   a   ,   c   ,   d   ,   !   0   )   }   )   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   j   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   e   )   {   v   a   r       g   =   f   (   t   h   i   s   )   ;   a   [   0   ]   =   j   .   c   a   l   l   (   t   h   i   s   ,   e   ,   c   ?   g   .   h   t   m   l   (   )   :   b   )   ,   g   .   d   o   m   M   a   n   i   p   (   a   ,   c   ,   d   )   }   )   ;   i   f   (   t   h   i   s   [   0   ]   )   {   i   =   j   &amp;   &amp;   j   .   p   a   r   e   n   t   N   o   d   e   ,   f   .   s   u   p   p   o   r   t   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   i   &amp;   &amp;   i   .   n   o   d   e   T   y   p   e   =   =   =   1   1   &amp;   &amp;   i   .   c   h   i   l   d   N   o   d   e   s   .   l   e   n   g   t   h   =   =   =   t   h   i   s   .   l   e   n   g   t   h   ?   e   =   {   f   r   a   g   m   e   n   t   :   i   }   :   e   =   f   .   b   u   i   l   d   F   r   a   g   m   e   n   t   (   a   ,   t   h   i   s   ,   k   )   ,   h   =   e   .   f   r   a   g   m   e   n   t   ,   h   .   c   h   i   l   d   N   o   d   e   s   .   l   e   n   g   t   h   =   =   =   1   ?   g   =   h   =   h   .   f   i   r   s   t   C   h   i   l   d   :   g   =   h   .   f   i   r   s   t   C   h   i   l   d   ;   i   f   (   g   )   {   c   =   c   &amp;   &amp;   f   .   n   o   d   e   N   a   m   e   (   g   ,   "   t   r   "   )   ;   f   o   r   (   v   a   r       l   =   0   ,   m   =   t   h   i   s   .   l   e   n   g   t   h   ,   n   =   m   -   1   ;   l   &lt;   m   ;   l   +   +   )   d   .   c   a   l   l   (   c   ?   b   i   (   t   h   i   s   [   l   ]   ,   g   )   :   t   h   i   s   [   l   ]   ,   e   .   c   a   c   h   e   a   b   l   e   |   |   m   &gt;   1   &amp;   &amp;   l   &lt;   n   ?   f   .   c   l   o   n   e   (   h   ,   !   0   ,   !   0   )   :   h   )   }   k   .   l   e   n   g   t   h   &amp;   &amp;   f   .   e   a   c   h   (   k   ,   b   p   )   }   r   e   t   u   r   n       t   h   i   s   }   }   )   ,   f   .   b   u   i   l   d   F   r   a   g   m   e   n   t   =   f   u   n   c   t   i   o   n   (   a   ,   b   ,   d   )   {   v   a   r       e   ,   g   ,   h   ,   i   ,   j   =   a   [   0   ]   ;   b   &amp;   &amp;   b   [   0   ]   &amp;   &amp;   (   i   =   b   [   0   ]   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   b   [   0   ]   )   ,   i   .   c   r   e   a   t   e   D   o   c   u   m   e   n   t   F   r   a   g   m   e   n   t   |   |   (   i   =   c   )   ,   a   .   l   e   n   g   t   h   =   =   =   1   &amp;   &amp;   t   y   p   e   o   f       j   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   j   .   l   e   n   g   t   h   &lt;   5   1   2   &amp;   &amp;   i   =   =   =   c   &amp;   &amp;   j   .   c   h   a   r   A   t   (   0   )   =   =   =   "   &lt;   "   &amp;   &amp;   !   b   b   .   t   e   s   t   (   j   )   &amp;   &amp;   (   f   .   s   u   p   p   o   r   t   .   c   h   e   c   k   C   l   o   n   e   |   |   !   b   d   .   t   e   s   t   (   j   )   )   &amp;   &amp;   (   f   .   s   u   p   p   o   r   t   .   h   t   m   l   5   C   l   o   n   e   |   |   !   b   c   .   t   e   s   t   (   j   )   )   &amp;   &amp;   (   g   =   !   0   ,   h   =   f   .   f   r   a   g   m   e   n   t   s   [   j   ]   ,   h   &amp;   &amp;   h   !   =   =   1   &amp;   &amp;   (   e   =   h   )   )   ,   e   |   |   (   e   =   i   .   c   r   e   a   t   e   D   o   c   u   m   e   n   t   F   r   a   g   m   e   n   t   (   )   ,   f   .   c   l   e   a   n   (   a   ,   i   ,   e   ,   d   )   )   ,   g   &amp;   &amp;   (   f   .   f   r   a   g   m   e   n   t   s   [   j   ]   =   h   ?   e   :   1   )   ;   r   e   t   u   r   n   {   f   r   a   g   m   e   n   t   :   e   ,   c   a   c   h   e   a   b   l   e   :   g   }   }   ,   f   .   f   r   a   g   m   e   n   t   s   =   {   }   ,   f   .   e   a   c   h   (   {   a   p   p   e   n   d   T   o   :   "   a   p   p   e   n   d   "   ,   p   r   e   p   e   n   d   T   o   :   "   p   r   e   p   e   n   d   "   ,   i   n   s   e   r   t   B   e   f   o   r   e   :   "   b   e   f   o   r   e   "   ,   i   n   s   e   r   t   A   f   t   e   r   :   "   a   f   t   e   r   "   ,   r   e   p   l   a   c   e   A   l   l   :   "   r   e   p   l   a   c   e   W   i   t   h   "   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   n   [   a   ]   =   f   u   n   c   t   i   o   n   (   c   )   {   v   a   r       d   =   [   ]   ,   e   =   f   (   c   )   ,   g   =   t   h   i   s   .   l   e   n   g   t   h   =   =   =   1   &amp;   &amp;   t   h   i   s   [   0   ]   .   p   a   r   e   n   t   N   o   d   e   ;   i   f   (   g   &amp;   &amp;   g   .   n   o   d   e   T   y   p   e   =   =   =   1   1   &amp;   &amp;   g   .   c   h   i   l   d   N   o   d   e   s   .   l   e   n   g   t   h   =   =   =   1   &amp;   &amp;   e   .   l   e   n   g   t   h   =   =   =   1   )   {   e   [   b   ]   (   t   h   i   s   [   0   ]   )   ;   r   e   t   u   r   n       t   h   i   s   }   f   o   r   (   v   a   r       h   =   0   ,   i   =   e   .   l   e   n   g   t   h   ;   h   &lt;   i   ;   h   +   +   )   {   v   a   r       j   =   (   h   &gt;   0   ?   t   h   i   s   .   c   l   o   n   e   (   !   0   )   :   t   h   i   s   )   .   g   e   t   (   )   ;   f   (   e   [   h   ]   )   [   b   ]   (   j   )   ,   d   =   d   .   c   o   n   c   a   t   (   j   )   }   r   e   t   u   r   n       t   h   i   s   .   p   u   s   h   S   t   a   c   k   (   d   ,   a   ,   e   .   s   e   l   e   c   t   o   r   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   c   l   o   n   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   e   ,   g   ,   h   =   f   .   s   u   p   p   o   r   t   .   h   t   m   l   5   C   l   o   n   e   |   |   !   b   c   .   t   e   s   t   (   "   &lt;   "   +   a   .   n   o   d   e   N   a   m   e   )   ?   a   .   c   l   o   n   e   N   o   d   e   (   !   0   )   :   b   o   (   a   )   ;   i   f   (   (   !   f   .   s   u   p   p   o   r   t   .   n   o   C   l   o   n   e   E   v   e   n   t   |   |   !   f   .   s   u   p   p   o   r   t   .   n   o   C   l   o   n   e   C   h   e   c   k   e   d   )   &amp;   &amp;   (   a   .   n   o   d   e   T   y   p   e   =   =   =   1   |   |   a   .   n   o   d   e   T   y   p   e   =   =   =   1   1   )   &amp;   &amp;   !   f   .   i   s   X   M   L   D   o   c   (   a   )   )   {   b   k   (   a   ,   h   )   ,   d   =   b   l   (   a   )   ,   e   =   b   l   (   h   )   ;   f   o   r   (   g   =   0   ;   d   [   g   ]   ;   +   +   g   )   e   [   g   ]   &amp;   &amp;   b   k   (   d   [   g   ]   ,   e   [   g   ]   )   }   i   f   (   b   )   {   b   j   (   a   ,   h   )   ;   i   f   (   c   )   {   d   =   b   l   (   a   )   ,   e   =   b   l   (   h   )   ;   f   o   r   (   g   =   0   ;   d   [   g   ]   ;   +   +   g   )   b   j   (   d   [   g   ]   ,   e   [   g   ]   )   }   }   d   =   e   =   n   u   l   l   ;   r   e   t   u   r   n       h   }   ,   c   l   e   a   n   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   d   ,   e   )   {   v   a   r       g   ;   b   =   b   |   |   c   ,   t   y   p   e   o   f       b   .   c   r   e   a   t   e   E   l   e   m   e   n   t   =   =   "   u   n   d   e   f   i   n   e   d   "   &amp;   &amp;   (   b   =   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   b   [   0   ]   &amp;   &amp;   b   [   0   ]   .   o   w   n   e   r   D   o   c   u   m   e   n   t   |   |   c   )   ;   v   a   r       h   =   [   ]   ,   i   ;   f   o   r   (   v   a   r       j   =   0   ,   k   ;   (   k   =   a   [   j   ]   )   !   =   n   u   l   l   ;   j   +   +   )   {   t   y   p   e   o   f       k   =   =   "   n   u   m   b   e   r   "   &amp;   &amp;   (   k   +   =   "   "   )   ;   i   f   (   !   k   )   c   o   n   t   i   n   u   e   ;   i   f   (   t   y   p   e   o   f       k   =   =   "   s   t   r   i   n   g   "   )   i   f   (   !   _   .   t   e   s   t   (   k   )   )   k   =   b   .   c   r   e   a   t   e   T   e   x   t   N   o   d   e   (   k   )   ;   e   l   s   e   {   k   =   k   .   r   e   p   l   a   c   e   (   Y   ,   "   &lt;   $   1   &gt;   &lt;   /   $   2   &gt;   "   )   ;   v   a   r       l   =   (   Z   .   e   x   e   c   (   k   )   |   |   [   "   "   ,   "   "   ]   )   [   1   ]   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   m   =   b   g   [   l   ]   |   |   b   g   .   _   d   e   f   a   u   l   t   ,   n   =   m   [   0   ]   ,   o   =   b   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   d   i   v   "   )   ;   b   =   =   =   c   ?   b   h   .   a   p   p   e   n   d   C   h   i   l   d   (   o   )   :   U   (   b   )   .   a   p   p   e   n   d   C   h   i   l   d   (   o   )   ,   o   .   i   n   n   e   r   H   T   M   L   =   m   [   1   ]   +   k   +   m   [   2   ]   ;   w   h   i   l   e   (   n   -   -   )   o   =   o   .   l   a   s   t   C   h   i   l   d   ;   i   f   (   !   f   .   s   u   p   p   o   r   t   .   t   b   o   d   y   )   {   v   a   r       p   =   $   .   t   e   s   t   (   k   )   ,   q   =   l   =   =   =   "   t   a   b   l   e   "   &amp;   &amp;   !   p   ?   o   .   f   i   r   s   t   C   h   i   l   d   &amp;   &amp;   o   .   f   i   r   s   t   C   h   i   l   d   .   c   h   i   l   d   N   o   d   e   s   :   m   [   1   ]   =   =   =   "   &lt;   t   a   b   l   e   &gt;   "   &amp;   &amp;   !   p   ?   o   .   c   h   i   l   d   N   o   d   e   s   :   [   ]   ;   f   o   r   (   i   =   q   .   l   e   n   g   t   h   -   1   ;   i   &gt;   =   0   ;   -   -   i   )   f   .   n   o   d   e   N   a   m   e   (   q   [   i   ]   ,   "   t   b   o   d   y   "   )   &amp;   &amp;   !   q   [   i   ]   .   c   h   i   l   d   N   o   d   e   s   .   l   e   n   g   t   h   &amp;   &amp;   q   [   i   ]   .   p   a   r   e   n   t   N   o   d   e   .   r   e   m   o   v   e   C   h   i   l   d   (   q   [   i   ]   )   }   !   f   .   s   u   p   p   o   r   t   .   l   e   a   d   i   n   g   W   h   i   t   e   s   p   a   c   e   &amp;   &amp;   X   .   t   e   s   t   (   k   )   &amp;   &amp;   o   .   i   n   s   e   r   t   B   e   f   o   r   e   (   b   .   c   r   e   a   t   e   T   e   x   t   N   o   d   e   (   X   .   e   x   e   c   (   k   )   [   0   ]   )   ,   o   .   f   i   r   s   t   C   h   i   l   d   )   ,   k   =   o   .   c   h   i   l   d   N   o   d   e   s   }   v   a   r       r   ;   i   f   (   !   f   .   s   u   p   p   o   r   t   .   a   p   p   e   n   d   C   h   e   c   k   e   d   )   i   f   (   k   [   0   ]   &amp;   &amp;   t   y   p   e   o   f       (   r   =   k   .   l   e   n   g   t   h   )   =   =   "   n   u   m   b   e   r   "   )   f   o   r   (   i   =   0   ;   i   &lt;   r   ;   i   +   +   )   b   n   (   k   [   i   ]   )   ;   e   l   s   e       b   n   (   k   )   ;   k   .   n   o   d   e   T   y   p   e   ?   h   .   p   u   s   h   (   k   )   :   h   =   f   .   m   e   r   g   e   (   h   ,   k   )   }   i   f   (   d   )   {   g   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   a   .   t   y   p   e   |   |   b   e   .   t   e   s   t   (   a   .   t   y   p   e   )   }   ;   f   o   r   (   j   =   0   ;   h   [   j   ]   ;   j   +   +   )   i   f   (   e   &amp;   &amp;   f   .   n   o   d   e   N   a   m   e   (   h   [   j   ]   ,   "   s   c   r   i   p   t   "   )   &amp;   &amp;   (   !   h   [   j   ]   .   t   y   p   e   |   |   h   [   j   ]   .   t   y   p   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   =   =   =   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "   )   )   e   .   p   u   s   h   (   h   [   j   ]   .   p   a   r   e   n   t   N   o   d   e   ?   h   [   j   ]   .   p   a   r   e   n   t   N   o   d   e   .   r   e   m   o   v   e   C   h   i   l   d   (   h   [   j   ]   )   :   h   [   j   ]   )   ;   e   l   s   e   {   i   f   (   h   [   j   ]   .   n   o   d   e   T   y   p   e   =   =   =   1   )   {   v   a   r       s   =   f   .   g   r   e   p   (   h   [   j   ]   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   s   c   r   i   p   t   "   )   ,   g   )   ;   h   .   s   p   l   i   c   e   .   a   p   p   l   y   (   h   ,   [   j   +   1   ,   0   ]   .   c   o   n   c   a   t   (   s   )   )   }   d   .   a   p   p   e   n   d   C   h   i   l   d   (   h   [   j   ]   )   }   }   r   e   t   u   r   n       h   }   ,   c   l   e   a   n   D   a   t   a   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   ,   c   ,   d   =   f   .   c   a   c   h   e   ,   e   =   f   .   e   v   e   n   t   .   s   p   e   c   i   a   l   ,   g   =   f   .   s   u   p   p   o   r   t   .   d   e   l   e   t   e   E   x   p   a   n   d   o   ;   f   o   r   (   v   a   r       h   =   0   ,   i   ;   (   i   =   a   [   h   ]   )   !   =   n   u   l   l   ;   h   +   +   )   {   i   f   (   i   .   n   o   d   e   N   a   m   e   &amp;   &amp;   f   .   n   o   D   a   t   a   [   i   .   n   o   d   e   N   a   m   e   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   )   c   o   n   t   i   n   u   e   ;   c   =   i   [   f   .   e   x   p   a   n   d   o   ]   ;   i   f   (   c   )   {   b   =   d   [   c   ]   ;   i   f   (   b   &amp;   &amp;   b   .   e   v   e   n   t   s   )   {   f   o   r   (   v   a   r       j       i   n       b   .   e   v   e   n   t   s   )   e   [   j   ]   ?   f   .   e   v   e   n   t   .   r   e   m   o   v   e   (   i   ,   j   )   :   f   .   r   e   m   o   v   e   E   v   e   n   t   (   i   ,   j   ,   b   .   h   a   n   d   l   e   )   ;   b   .   h   a   n   d   l   e   &amp;   &amp;   (   b   .   h   a   n   d   l   e   .   e   l   e   m   =   n   u   l   l   )   }   g   ?   d   e   l   e   t   e       i   [   f   .   e   x   p   a   n   d   o   ]   :   i   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   &amp;   &amp;   i   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   f   .   e   x   p   a   n   d   o   )   ,   d   e   l   e   t   e       d   [   c   ]   }   }   }   }   )   ;   v   a   r       b   q   =   /   a   l   p   h   a   \   (   [   ^   )   ]   *   \   )   /   i   ,   b   r   =   /   o   p   a   c   i   t   y   =   (   [   ^   )   ]   *   )   /   ,   b   s   =   /   (   [   A   -   Z   ]   |   ^   m   s   )   /   g   ,   b   t   =   /   ^   -   ?   \   d   +   (   ?   :   p   x   )   ?   $   /   i   ,   b   u   =   /   ^   -   ?   \   d   /   ,   b   v   =   /   ^   (   [   \   -   +   ]   )   =   (   [   \   -   +   .   \   d   e   ]   +   )   /   ,   b   w   =   {   p   o   s   i   t   i   o   n   :   "   a   b   s   o   l   u   t   e   "   ,   v   i   s   i   b   i   l   i   t   y   :   "   h   i   d   d   e   n   "   ,   d   i   s   p   l   a   y   :   "   b   l   o   c   k   "   }   ,   b   x   =   [   "   L   e   f   t   "   ,   "   R   i   g   h   t   "   ]   ,   b   y   =   [   "   T   o   p   "   ,   "   B   o   t   t   o   m   "   ]   ,   b   z   ,   b   A   ,   b   B   ;   f   .   f   n   .   c   s   s   =   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   i   f   (   a   r   g   u   m   e   n   t   s   .   l   e   n   g   t   h   =   =   =   2   &amp;   &amp;   c   =   =   =   b   )   r   e   t   u   r   n       t   h   i   s   ;   r   e   t   u   r   n       f   .   a   c   c   e   s   s   (   t   h   i   s   ,   a   ,   c   ,   !   0   ,   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   r   e   t   u   r   n       d   !   =   =   b   ?   f   .   s   t   y   l   e   (   a   ,   c   ,   d   )   :   f   .   c   s   s   (   a   ,   c   )   }   )   }   ,   f   .   e   x   t   e   n   d   (   {   c   s   s   H   o   o   k   s   :   {   o   p   a   c   i   t   y   :   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   b   )   {   v   a   r       c   =   b   z   (   a   ,   "   o   p   a   c   i   t   y   "   ,   "   o   p   a   c   i   t   y   "   )   ;   r   e   t   u   r   n       c   =   =   =   "   "   ?   "   1   "   :   c   }   r   e   t   u   r   n       a   .   s   t   y   l   e   .   o   p   a   c   i   t   y   }   }   }   ,   c   s   s   N   u   m   b   e   r   :   {   f   i   l   l   O   p   a   c   i   t   y   :   !   0   ,   f   o   n   t   W   e   i   g   h   t   :   !   0   ,   l   i   n   e   H   e   i   g   h   t   :   !   0   ,   o   p   a   c   i   t   y   :   !   0   ,   o   r   p   h   a   n   s   :   !   0   ,   w   i   d   o   w   s   :   !   0   ,   z   I   n   d   e   x   :   !   0   ,   z   o   o   m   :   !   0   }   ,   c   s   s   P   r   o   p   s   :   {   "   f   l   o   a   t   "   :   f   .   s   u   p   p   o   r   t   .   c   s   s   F   l   o   a   t   ?   "   c   s   s   F   l   o   a   t   "   :   "   s   t   y   l   e   F   l   o   a   t   "   }   ,   s   t   y   l   e   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   ,   e   )   {   i   f   (   !   !   a   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   !   =   =   3   &amp;   &amp;   a   .   n   o   d   e   T   y   p   e   !   =   =   8   &amp;   &amp;   !   !   a   .   s   t   y   l   e   )   {   v   a   r       g   ,   h   ,   i   =   f   .   c   a   m   e   l   C   a   s   e   (   c   )   ,   j   =   a   .   s   t   y   l   e   ,   k   =   f   .   c   s   s   H   o   o   k   s   [   i   ]   ;   c   =   f   .   c   s   s   P   r   o   p   s   [   i   ]   |   |   i   ;   i   f   (   d   =   =   =   b   )   {   i   f   (   k   &amp;   &amp;   "   g   e   t   "   i   n       k   &amp;   &amp;   (   g   =   k   .   g   e   t   (   a   ,   !   1   ,   e   )   )   !   =   =   b   )   r   e   t   u   r   n       g   ;   r   e   t   u   r   n       j   [   c   ]   }   h   =   t   y   p   e   o   f       d   ,   h   =   =   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   g   =   b   v   .   e   x   e   c   (   d   )   )   &amp;   &amp;   (   d   =   +   (   g   [   1   ]   +   1   )   *   +   g   [   2   ]   +   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   c   )   )   ,   h   =   "   n   u   m   b   e   r   "   )   ;   i   f   (   d   =   =   n   u   l   l   |   |   h   =   =   =   "   n   u   m   b   e   r   "   &amp;   &amp;   i   s   N   a   N   (   d   )   )   r   e   t   u   r   n   ;   h   =   =   =   "   n   u   m   b   e   r   "   &amp;   &amp;   !   f   .   c   s   s   N   u   m   b   e   r   [   i   ]   &amp;   &amp;   (   d   +   =   "   p   x   "   )   ;   i   f   (   !   k   |   |   !   (   "   s   e   t   "   i   n       k   )   |   |   (   d   =   k   .   s   e   t   (   a   ,   d   )   )   !   =   =   b   )   t   r   y   {   j   [   c   ]   =   d   }   c   a   t   c   h   (   l   )   {   }   }   }   ,   c   s   s   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       e   ,   g   ;   c   =   f   .   c   a   m   e   l   C   a   s   e   (   c   )   ,   g   =   f   .   c   s   s   H   o   o   k   s   [   c   ]   ,   c   =   f   .   c   s   s   P   r   o   p   s   [   c   ]   |   |   c   ,   c   =   =   =   "   c   s   s   F   l   o   a   t   "   &amp;   &amp;   (   c   =   "   f   l   o   a   t   "   )   ;   i   f   (   g   &amp;   &amp;   "   g   e   t   "   i   n       g   &amp;   &amp;   (   e   =   g   .   g   e   t   (   a   ,   !   0   ,   d   )   )   !   =   =   b   )   r   e   t   u   r   n       e   ;   i   f   (   b   z   )   r   e   t   u   r   n       b   z   (   a   ,   c   )   }   ,   s   w   a   p   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   {   }   ;   f   o   r   (   v   a   r       e       i   n       b   )   d   [   e   ]   =   a   .   s   t   y   l   e   [   e   ]   ,   a   .   s   t   y   l   e   [   e   ]   =   b   [   e   ]   ;   c   .   c   a   l   l   (   a   )   ;   f   o   r   (   e       i   n       b   )   a   .   s   t   y   l   e   [   e   ]   =   d   [   e   ]   }   }   )   ,   f   .   c   u   r   C   S   S   =   f   .   c   s   s   ,   f   .   e   a   c   h   (   [   "   h   e   i   g   h   t   "   ,   "   w   i   d   t   h   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   c   s   s   H   o   o   k   s   [   b   ]   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   v   a   r       e   ;   i   f   (   c   )   {   i   f   (   a   .   o   f   f   s   e   t   W   i   d   t   h   !   =   =   0   )   r   e   t   u   r   n       b   C   (   a   ,   b   ,   d   )   ;   f   .   s   w   a   p   (   a   ,   b   w   ,   f   u   n   c   t   i   o   n   (   )   {   e   =   b   C   (   a   ,   b   ,   d   )   }   )   ;   r   e   t   u   r   n       e   }   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   !   b   t   .   t   e   s   t   (   b   )   )   r   e   t   u   r   n       b   ;   b   =   p   a   r   s   e   F   l   o   a   t   (   b   )   ;   i   f   (   b   &gt;   =   0   )   r   e   t   u   r   n       b   +   "   p   x   "   }   }   }   )   ,   f   .   s   u   p   p   o   r   t   .   o   p   a   c   i   t   y   |   |   (   f   .   c   s   s   H   o   o   k   s   .   o   p   a   c   i   t   y   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   r   e   t   u   r   n       b   r   .   t   e   s   t   (   (   b   &amp;   &amp;   a   .   c   u   r   r   e   n   t   S   t   y   l   e   ?   a   .   c   u   r   r   e   n   t   S   t   y   l   e   .   f   i   l   t   e   r   :   a   .   s   t   y   l   e   .   f   i   l   t   e   r   )   |   |   "   "   )   ?   p   a   r   s   e   F   l   o   a   t   (   R   e   g   E   x   p   .   $   1   )   /   1   0   0   +   "   "   :   b   ?   "   1   "   :   "   "   }   ,   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   a   .   s   t   y   l   e   ,   d   =   a   .   c   u   r   r   e   n   t   S   t   y   l   e   ,   e   =   f   .   i   s   N   u   m   e   r   i   c   (   b   )   ?   "   a   l   p   h   a   (   o   p   a   c   i   t   y   =   "   +   b   *   1   0   0   +   "   )   "   :   "   "   ,   g   =   d   &amp;   &amp;   d   .   f   i   l   t   e   r   |   |   c   .   f   i   l   t   e   r   |   |   "   "   ;   c   .   z   o   o   m   =   1   ;   i   f   (   b   &gt;   =   1   &amp;   &amp;   f   .   t   r   i   m   (   g   .   r   e   p   l   a   c   e   (   b   q   ,   "   "   )   )   =   =   =   "   "   )   {   c   .   r   e   m   o   v   e   A   t   t   r   i   b   u   t   e   (   "   f   i   l   t   e   r   "   )   ;   i   f   (   d   &amp;   &amp;   !   d   .   f   i   l   t   e   r   )   r   e   t   u   r   n   }   c   .   f   i   l   t   e   r   =   b   q   .   t   e   s   t   (   g   )   ?   g   .   r   e   p   l   a   c   e   (   b   q   ,   e   )   :   g   +   "       "   +   e   }   }   )   ,   f   (   f   u   n   c   t   i   o   n   (   )   {   f   .   s   u   p   p   o   r   t   .   r   e   l   i   a   b   l   e   M   a   r   g   i   n   R   i   g   h   t   |   |   (   f   .   c   s   s   H   o   o   k   s   .   m   a   r   g   i   n   R   i   g   h   t   =   {   g   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ;   f   .   s   w   a   p   (   a   ,   {   d   i   s   p   l   a   y   :   "   i   n   l   i   n   e   -   b   l   o   c   k   "   }   ,   f   u   n   c   t   i   o   n   (   )   {   b   ?   c   =   b   z   (   a   ,   "   m   a   r   g   i   n   -   r   i   g   h   t   "   ,   "   m   a   r   g   i   n   R   i   g   h   t   "   )   :   c   =   a   .   s   t   y   l   e   .   m   a   r   g   i   n   R   i   g   h   t   }   )   ;   r   e   t   u   r   n       c   }   }   )   }   )   ,   c   .   d   e   f   a   u   l   t   V   i   e   w   &amp;   &amp;   c   .   d   e   f   a   u   l   t   V   i   e   w   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   &amp;   &amp;   (   b   A   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ,   d   ,   e   ;   b   =   b   .   r   e   p   l   a   c   e   (   b   s   ,   "   -   $   1   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ,   (   d   =   a   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   d   e   f   a   u   l   t   V   i   e   w   )   &amp;   &amp;   (   e   =   d   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   (   a   ,   n   u   l   l   )   )   &amp;   &amp;   (   c   =   e   .   g   e   t   P   r   o   p   e   r   t   y   V   a   l   u   e   (   b   )   ,   c   =   =   =   "   "   &amp;   &amp;   !   f   .   c   o   n   t   a   i   n   s   (   a   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ,   a   )   &amp;   &amp;   (   c   =   f   .   s   t   y   l   e   (   a   ,   b   )   )   )   ;   r   e   t   u   r   n       c   }   )   ,   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   .   c   u   r   r   e   n   t   S   t   y   l   e   &amp;   &amp;   (   b   B   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   ,   d   ,   e   ,   f   =   a   .   c   u   r   r   e   n   t   S   t   y   l   e   &amp;   &amp;   a   .   c   u   r   r   e   n   t   S   t   y   l   e   [   b   ]   ,   g   =   a   .   s   t   y   l   e   ;   f   =   =   =   n   u   l   l   &amp;   &amp;   g   &amp;   &amp;   (   e   =   g   [   b   ]   )   &amp;   &amp;   (   f   =   e   )   ,   !   b   t   .   t   e   s   t   (   f   )   &amp;   &amp;   b   u   .   t   e   s   t   (   f   )   &amp;   &amp;   (   c   =   g   .   l   e   f   t   ,   d   =   a   .   r   u   n   t   i   m   e   S   t   y   l   e   &amp;   &amp;   a   .   r   u   n   t   i   m   e   S   t   y   l   e   .   l   e   f   t   ,   d   &amp;   &amp;   (   a   .   r   u   n   t   i   m   e   S   t   y   l   e   .   l   e   f   t   =   a   .   c   u   r   r   e   n   t   S   t   y   l   e   .   l   e   f   t   )   ,   g   .   l   e   f   t   =   b   =   =   =   "   f   o   n   t   S   i   z   e   "   ?   "   1   e   m   "   :   f   |   |   0   ,   f   =   g   .   p   i   x   e   l   L   e   f   t   +   "   p   x   "   ,   g   .   l   e   f   t   =   c   ,   d   &amp;   &amp;   (   a   .   r   u   n   t   i   m   e   S   t   y   l   e   .   l   e   f   t   =   d   )   )   ;   r   e   t   u   r   n       f   =   =   =   "   "   ?   "   a   u   t   o   "   :   f   }   )   ,   b   z   =   b   A   |   |   b   B   ,   f   .   e   x   p   r   &amp;   &amp;   f   .   e   x   p   r   .   f   i   l   t   e   r   s   &amp;   &amp;   (   f   .   e   x   p   r   .   f   i   l   t   e   r   s   .   h   i   d   d   e   n   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   o   f   f   s   e   t   W   i   d   t   h   ,   c   =   a   .   o   f   f   s   e   t   H   e   i   g   h   t   ;   r   e   t   u   r   n       b   =   =   =   0   &amp;   &amp;   c   =   =   =   0   |   |   !   f   .   s   u   p   p   o   r   t   .   r   e   l   i   a   b   l   e   H   i   d   d   e   n   O   f   f   s   e   t   s   &amp;   &amp;   (   a   .   s   t   y   l   e   &amp;   &amp;   a   .   s   t   y   l   e   .   d   i   s   p   l   a   y   |   |   f   .   c   s   s   (   a   ,   "   d   i   s   p   l   a   y   "   )   )   =   =   =   "   n   o   n   e   "   }   ,   f   .   e   x   p   r   .   f   i   l   t   e   r   s   .   v   i   s   i   b   l   e   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n   !   f   .   e   x   p   r   .   f   i   l   t   e   r   s   .   h   i   d   d   e   n   (   a   )   }   )   ;   v   a   r       b   D   =   /   %   2   0   /   g   ,   b   E   =   /   \   [   \   ]   $   /   ,   b   F   =   /   \   r   ?   \   n   /   g   ,   b   G   =   /   #   .   *   $   /   ,   b   H   =   /   ^   (   .   *   ?   )   :   [       \   t   ]   *   (   [   ^   \   r   \   n   ]   *   )   \   r   ?   $   /   m   g   ,   b   I   =   /   ^   (   ?   :   c   o   l   o   r   |   d   a   t   e   |   d   a   t   e   t   i   m   e   |   d   a   t   e   t   i   m   e   -   l   o   c   a   l   |   e   m   a   i   l   |   h   i   d   d   e   n   |   m   o   n   t   h   |   n   u   m   b   e   r   |   p   a   s   s   w   o   r   d   |   r   a   n   g   e   |   s   e   a   r   c   h   |   t   e   l   |   t   e   x   t   |   t   i   m   e   |   u   r   l   |   w   e   e   k   )   $   /   i   ,   b   J   =   /   ^   (   ?   :   a   b   o   u   t   |   a   p   p   |   a   p   p   \   -   s   t   o   r   a   g   e   |   .   +   \   -   e   x   t   e   n   s   i   o   n   |   f   i   l   e   |   r   e   s   |   w   i   d   g   e   t   )   :   $   /   ,   b   K   =   /   ^   (   ?   :   G   E   T   |   H   E   A   D   )   $   /   ,   b   L   =   /   ^   \   /   \   /   /   ,   b   M   =   /   \   ?   /   ,   b   N   =   /   &lt;   s   c   r   i   p   t   \   b   [   ^   &lt;   ]   *   (   ?   :   (   ?   !   &lt;   \   /   s   c   r   i   p   t   &gt;   )   &lt;   [   ^   &lt;   ]   *   )   *   &lt;   \   /   s   c   r   i   p   t   &gt;   /   g   i   ,   b   O   =   /   ^   (   ?   :   s   e   l   e   c   t   |   t   e   x   t   a   r   e   a   )   /   i   ,   b   P   =   /   \   s   +   /   ,   b   Q   =   /   (   [   ?   &amp;   ]   )   _   =   [   ^   &amp;   ]   *   /   ,   b   R   =   /   ^   (   [   \   w   \   +   \   .   \   -   ]   +   :   )   (   ?   :   \   /   \   /   (   [   ^   \   /   ?   #   :   ]   *   )   (   ?   :   :   (   \   d   +   )   )   ?   )   ?   /   ,   b   S   =   f   .   f   n   .   l   o   a   d   ,   b   T   =   {   }   ,   b   U   =   {   }   ,   b   V   ,   b   W   ,   b   X   =   [   "   *   /   "   ]   +   [   "   *   "   ]   ;   t   r   y   {   b   V   =   e   .   h   r   e   f   }   c   a   t   c   h   (   b   Y   )   {   b   V   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   a   "   )   ,   b   V   .   h   r   e   f   =   "   "   ,   b   V   =   b   V   .   h   r   e   f   }   b   W   =   b   R   .   e   x   e   c   (   b   V   .   t   o   L   o   w   e   r   C   a   s   e   (   )   )   |   |   [   ]   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   l   o   a   d   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   i   f   (   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   b   S   )   r   e   t   u   r   n       b   S   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   ;   i   f   (   !   t   h   i   s   .   l   e   n   g   t   h   )   r   e   t   u   r   n       t   h   i   s   ;   v   a   r       e   =   a   .   i   n   d   e   x   O   f   (   "       "   )   ;   i   f   (   e   &gt;   =   0   )   {   v   a   r       g   =   a   .   s   l   i   c   e   (   e   ,   a   .   l   e   n   g   t   h   )   ;   a   =   a   .   s   l   i   c   e   (   0   ,   e   )   }   v   a   r       h   =   "   G   E   T   "   ;   c   &amp;   &amp;   (   f   .   i   s   F   u   n   c   t   i   o   n   (   c   )   ?   (   d   =   c   ,   c   =   b   )   :   t   y   p   e   o   f       c   =   =   "   o   b   j   e   c   t   "   &amp;   &amp;   (   c   =   f   .   p   a   r   a   m   (   c   ,   f   .   a   j   a   x   S   e   t   t   i   n   g   s   .   t   r   a   d   i   t   i   o   n   a   l   )   ,   h   =   "   P   O   S   T   "   )   )   ;   v   a   r       i   =   t   h   i   s   ;   f   .   a   j   a   x   (   {   u   r   l   :   a   ,   t   y   p   e   :   h   ,   d   a   t   a   T   y   p   e   :   "   h   t   m   l   "   ,   d   a   t   a   :   c   ,   c   o   m   p   l   e   t   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   c   =   a   .   r   e   s   p   o   n   s   e   T   e   x   t   ,   a   .   i   s   R   e   s   o   l   v   e   d   (   )   &amp;   &amp;   (   a   .   d   o   n   e   (   f   u   n   c   t   i   o   n   (   a   )   {   c   =   a   }   )   ,   i   .   h   t   m   l   (   g   ?   f   (   "   &lt;   d   i   v   &gt;   "   )   .   a   p   p   e   n   d   (   c   .   r   e   p   l   a   c   e   (   b   N   ,   "   "   )   )   .   f   i   n   d   (   g   )   :   c   )   )   ,   d   &amp;   &amp;   i   .   e   a   c   h   (   d   ,   [   c   ,   b   ,   a   ]   )   }   }   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   s   e   r   i   a   l   i   z   e   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       f   .   p   a   r   a   m   (   t   h   i   s   .   s   e   r   i   a   l   i   z   e   A   r   r   a   y   (   )   )   }   ,   s   e   r   i   a   l   i   z   e   A   r   r   a   y   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   m   a   p   (   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   e   l   e   m   e   n   t   s   ?   f   .   m   a   k   e   A   r   r   a   y   (   t   h   i   s   .   e   l   e   m   e   n   t   s   )   :   t   h   i   s   }   )   .   f   i   l   t   e   r   (   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   n   a   m   e   &amp;   &amp;   !   t   h   i   s   .   d   i   s   a   b   l   e   d   &amp;   &amp;   (   t   h   i   s   .   c   h   e   c   k   e   d   |   |   b   O   .   t   e   s   t   (   t   h   i   s   .   n   o   d   e   N   a   m   e   )   |   |   b   I   .   t   e   s   t   (   t   h   i   s   .   t   y   p   e   )   )   }   )   .   m   a   p   (   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   v   a   r       c   =   f   (   t   h   i   s   )   .   v   a   l   (   )   ;   r   e   t   u   r   n       c   =   =   n   u   l   l   ?   n   u   l   l   :   f   .   i   s   A   r   r   a   y   (   c   )   ?   f   .   m   a   p   (   c   ,   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   r   e   t   u   r   n   {   n   a   m   e   :   b   .   n   a   m   e   ,   v   a   l   u   e   :   a   .   r   e   p   l   a   c   e   (   b   F   ,   "   \   r   \   n   "   )   }   }   )   :   {   n   a   m   e   :   b   .   n   a   m   e   ,   v   a   l   u   e   :   c   .   r   e   p   l   a   c   e   (   b   F   ,   "   \   r   \   n   "   )   }   }   )   .   g   e   t   (   )   }   }   )   ,   f   .   e   a   c   h   (   "   a   j   a   x   S   t   a   r   t       a   j   a   x   S   t   o   p       a   j   a   x   C   o   m   p   l   e   t   e       a   j   a   x   E   r   r   o   r       a   j   a   x   S   u   c   c   e   s   s       a   j   a   x   S   e   n   d   "   .   s   p   l   i   t   (   "       "   )   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   n   [   b   ]   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       t   h   i   s   .   o   n   (   b   ,   a   )   }   }   )   ,   f   .   e   a   c   h   (   [   "   g   e   t   "   ,   "   p   o   s   t   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   f   [   c   ]   =   f   u   n   c   t   i   o   n   (   a   ,   d   ,   e   ,   g   )   {   f   .   i   s   F   u   n   c   t   i   o   n   (   d   )   &amp;   &amp;   (   g   =   g   |   |   e   ,   e   =   d   ,   d   =   b   )   ;   r   e   t   u   r   n       f   .   a   j   a   x   (   {   t   y   p   e   :   c   ,   u   r   l   :   a   ,   d   a   t   a   :   d   ,   s   u   c   c   e   s   s   :   e   ,   d   a   t   a   T   y   p   e   :   g   }   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   g   e   t   S   c   r   i   p   t   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   r   e   t   u   r   n       f   .   g   e   t   (   a   ,   b   ,   c   ,   "   s   c   r   i   p   t   "   )   }   ,   g   e   t   J   S   O   N   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   r   e   t   u   r   n       f   .   g   e   t   (   a   ,   b   ,   c   ,   "   j   s   o   n   "   )   }   ,   a   j   a   x   S   e   t   u   p   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   b   ?   b   _   (   a   ,   f   .   a   j   a   x   S   e   t   t   i   n   g   s   )   :   (   b   =   a   ,   a   =   f   .   a   j   a   x   S   e   t   t   i   n   g   s   )   ,   b   _   (   a   ,   b   )   ;   r   e   t   u   r   n       a   }   ,   a   j   a   x   S   e   t   t   i   n   g   s   :   {   u   r   l   :   b   V   ,   i   s   L   o   c   a   l   :   b   J   .   t   e   s   t   (   b   W   [   1   ]   )   ,   g   l   o   b   a   l   :   !   0   ,   t   y   p   e   :   "   G   E   T   "   ,   c   o   n   t   e   n   t   T   y   p   e   :   "   a   p   p   l   i   c   a   t   i   o   n   /   x   -   w   w   w   -   f   o   r   m   -   u   r   l   e   n   c   o   d   e   d   "   ,   p   r   o   c   e   s   s   D   a   t   a   :   !   0   ,   a   s   y   n   c   :   !   0   ,   a   c   c   e   p   t   s   :   {   x   m   l   :   "   a   p   p   l   i   c   a   t   i   o   n   /   x   m   l   ,       t   e   x   t   /   x   m   l   "   ,   h   t   m   l   :   "   t   e   x   t   /   h   t   m   l   "   ,   t   e   x   t   :   "   t   e   x   t   /   p   l   a   i   n   "   ,   j   s   o   n   :   "   a   p   p   l   i   c   a   t   i   o   n   /   j   s   o   n   ,       t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "   ,   "   *   "   :   b   X   }   ,   c   o   n   t   e   n   t   s   :   {   x   m   l   :   /   x   m   l   /   ,   h   t   m   l   :   /   h   t   m   l   /   ,   j   s   o   n   :   /   j   s   o   n   /   }   ,   r   e   s   p   o   n   s   e   F   i   e   l   d   s   :   {   x   m   l   :   "   r   e   s   p   o   n   s   e   X   M   L   "   ,   t   e   x   t   :   "   r   e   s   p   o   n   s   e   T   e   x   t   "   }   ,   c   o   n   v   e   r   t   e   r   s   :   {   "   *       t   e   x   t   "   :   a   .   S   t   r   i   n   g   ,   "   t   e   x   t       h   t   m   l   "   :   !   0   ,   "   t   e   x   t       j   s   o   n   "   :   f   .   p   a   r   s   e   J   S   O   N   ,   "   t   e   x   t       x   m   l   "   :   f   .   p   a   r   s   e   X   M   L   }   ,   f   l   a   t   O   p   t   i   o   n   s   :   {   c   o   n   t   e   x   t   :   !   0   ,   u   r   l   :   !   0   }   }   ,   a   j   a   x   P   r   e   f   i   l   t   e   r   :   b   Z   (   b   T   )   ,   a   j   a   x   T   r   a   n   s   p   o   r   t   :   b   Z   (   b   U   )   ,   a   j   a   x   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   f   u   n   c   t   i   o   n       w   (   a   ,   c   ,   l   ,   m   )   {   i   f   (   s   !   =   =   2   )   {   s   =   2   ,   q   &amp;   &amp;   c   l   e   a   r   T   i   m   e   o   u   t   (   q   )   ,   p   =   b   ,   n   =   m   |   |   "   "   ,   v   .   r   e   a   d   y   S   t   a   t   e   =   a   &gt;   0   ?   4   :   0   ;   v   a   r       o   ,   r   ,   u   ,   w   =   c   ,   x   =   l   ?   c   b   (   d   ,   v   ,   l   )   :   b   ,   y   ,   z   ;   i   f   (   a   &gt;   =   2   0   0   &amp;   &amp;   a   &lt;   3   0   0   |   |   a   =   =   =   3   0   4   )   {   i   f   (   d   .   i   f   M   o   d   i   f   i   e   d   )   {   i   f   (   y   =   v   .   g   e   t   R   e   s   p   o   n   s   e   H   e   a   d   e   r   (   "   L   a   s   t   -   M   o   d   i   f   i   e   d   "   )   )   f   .   l   a   s   t   M   o   d   i   f   i   e   d   [   k   ]   =   y   ;   i   f   (   z   =   v   .   g   e   t   R   e   s   p   o   n   s   e   H   e   a   d   e   r   (   "   E   t   a   g   "   )   )   f   .   e   t   a   g   [   k   ]   =   z   }   i   f   (   a   =   =   =   3   0   4   )   w   =   "   n   o   t   m   o   d   i   f   i   e   d   "   ,   o   =   !   0   ;   e   l   s   e       t   r   y   {   r   =   c   c   (   d   ,   x   )   ,   w   =   "   s   u   c   c   e   s   s   "   ,   o   =   !   0   }   c   a   t   c   h   (   A   )   {   w   =   "   p   a   r   s   e   r   e   r   r   o   r   "   ,   u   =   A   }   }   e   l   s   e   {   u   =   w   ;   i   f   (   !   w   |   |   a   )   w   =   "   e   r   r   o   r   "   ,   a   &lt;   0   &amp;   &amp;   (   a   =   0   )   }   v   .   s   t   a   t   u   s   =   a   ,   v   .   s   t   a   t   u   s   T   e   x   t   =   "   "   +   (   c   |   |   w   )   ,   o   ?   h   .   r   e   s   o   l   v   e   W   i   t   h   (   e   ,   [   r   ,   w   ,   v   ]   )   :   h   .   r   e   j   e   c   t   W   i   t   h   (   e   ,   [   v   ,   w   ,   u   ]   )   ,   v   .   s   t   a   t   u   s   C   o   d   e   (   j   )   ,   j   =   b   ,   t   &amp;   &amp;   g   .   t   r   i   g   g   e   r   (   "   a   j   a   x   "   +   (   o   ?   "   S   u   c   c   e   s   s   "   :   "   E   r   r   o   r   "   )   ,   [   v   ,   d   ,   o   ?   r   :   u   ]   )   ,   i   .   f   i   r   e   W   i   t   h   (   e   ,   [   v   ,   w   ]   )   ,   t   &amp;   &amp;   (   g   .   t   r   i   g   g   e   r   (   "   a   j   a   x   C   o   m   p   l   e   t   e   "   ,   [   v   ,   d   ]   )   ,   -   -   f   .   a   c   t   i   v   e   |   |   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   "   a   j   a   x   S   t   o   p   "   )   )   }   }   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   &amp;   &amp;   (   c   =   a   ,   a   =   b   )   ,   c   =   c   |   |   {   }   ;   v   a   r       d   =   f   .   a   j   a   x   S   e   t   u   p   (   {   }   ,   c   )   ,   e   =   d   .   c   o   n   t   e   x   t   |   |   d   ,   g   =   e   !   =   =   d   &amp;   &amp;   (   e   .   n   o   d   e   T   y   p   e   |   |   e       i   n   s   t   a   n   c   e   o   f       f   )   ?   f   (   e   )   :   f   .   e   v   e   n   t   ,   h   =   f   .   D   e   f   e   r   r   e   d   (   )   ,   i   =   f   .   C   a   l   l   b   a   c   k   s   (   "   o   n   c   e       m   e   m   o   r   y   "   )   ,   j   =   d   .   s   t   a   t   u   s   C   o   d   e   |   |   {   }   ,   k   ,   l   =   {   }   ,   m   =   {   }   ,   n   ,   o   ,   p   ,   q   ,   r   ,   s   =   0   ,   t   ,   u   ,   v   =   {   r   e   a   d   y   S   t   a   t   e   :   0   ,   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   i   f   (   !   s   )   {   v   a   r       c   =   a   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   a   =   m   [   c   ]   =   m   [   c   ]   |   |   a   ,   l   [   a   ]   =   b   }   r   e   t   u   r   n       t   h   i   s   }   ,   g   e   t   A   l   l   R   e   s   p   o   n   s   e   H   e   a   d   e   r   s   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       s   =   =   =   2   ?   n   :   n   u   l   l   }   ,   g   e   t   R   e   s   p   o   n   s   e   H   e   a   d   e   r   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       c   ;   i   f   (   s   =   =   =   2   )   {   i   f   (   !   o   )   {   o   =   {   }   ;   w   h   i   l   e   (   c   =   b   H   .   e   x   e   c   (   n   )   )   o   [   c   [   1   ]   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   =   c   [   2   ]   }   c   =   o   [   a   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ]   }   r   e   t   u   r   n       c   =   =   =   b   ?   n   u   l   l   :   c   }   ,   o   v   e   r   r   i   d   e   M   i   m   e   T   y   p   e   :   f   u   n   c   t   i   o   n   (   a   )   {   s   |   |   (   d   .   m   i   m   e   T   y   p   e   =   a   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   a   b   o   r   t   :   f   u   n   c   t   i   o   n   (   a   )   {   a   =   a   |   |   "   a   b   o   r   t   "   ,   p   &amp;   &amp;   p   .   a   b   o   r   t   (   a   )   ,   w   (   0   ,   a   )   ;   r   e   t   u   r   n       t   h   i   s   }   }   ;   h   .   p   r   o   m   i   s   e   (   v   )   ,   v   .   s   u   c   c   e   s   s   =   v   .   d   o   n   e   ,   v   .   e   r   r   o   r   =   v   .   f   a   i   l   ,   v   .   c   o   m   p   l   e   t   e   =   i   .   a   d   d   ,   v   .   s   t   a   t   u   s   C   o   d   e   =   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   )   {   v   a   r       b   ;   i   f   (   s   &lt;   2   )   f   o   r   (   b       i   n       a   )   j   [   b   ]   =   [   j   [   b   ]   ,   a   [   b   ]   ]   ;   e   l   s   e       b   =   a   [   v   .   s   t   a   t   u   s   ]   ,   v   .   t   h   e   n   (   b   ,   b   )   }   r   e   t   u   r   n       t   h   i   s   }   ,   d   .   u   r   l   =   (   (   a   |   |   d   .   u   r   l   )   +   "   "   )   .   r   e   p   l   a   c   e   (   b   G   ,   "   "   )   .   r   e   p   l   a   c   e   (   b   L   ,   b   W   [   1   ]   +   "   /   /   "   )   ,   d   .   d   a   t   a   T   y   p   e   s   =   f   .   t   r   i   m   (   d   .   d   a   t   a   T   y   p   e   |   |   "   *   "   )   .   t   o   L   o   w   e   r   C   a   s   e   (   )   .   s   p   l   i   t   (   b   P   )   ,   d   .   c   r   o   s   s   D   o   m   a   i   n   =   =   n   u   l   l   &amp;   &amp;   (   r   =   b   R   .   e   x   e   c   (   d   .   u   r   l   .   t   o   L   o   w   e   r   C   a   s   e   (   )   )   ,   d   .   c   r   o   s   s   D   o   m   a   i   n   =   !   (   !   r   |   |   r   [   1   ]   =   =   b   W   [   1   ]   &amp;   &amp;   r   [   2   ]   =   =   b   W   [   2   ]   &amp;   &amp;   (   r   [   3   ]   |   |   (   r   [   1   ]   =   =   =   "   h   t   t   p   :   "   ?   8   0   :   4   4   3   )   )   =   =   (   b   W   [   3   ]   |   |   (   b   W   [   1   ]   =   =   =   "   h   t   t   p   :   "   ?   8   0   :   4   4   3   )   )   )   )   ,   d   .   d   a   t   a   &amp;   &amp;   d   .   p   r   o   c   e   s   s   D   a   t   a   &amp;   &amp;   t   y   p   e   o   f       d   .   d   a   t   a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   d   .   d   a   t   a   =   f   .   p   a   r   a   m   (   d   .   d   a   t   a   ,   d   .   t   r   a   d   i   t   i   o   n   a   l   )   )   ,   b   $   (   b   T   ,   d   ,   c   ,   v   )   ;   i   f   (   s   =   =   =   2   )   r   e   t   u   r   n   !   1   ;   t   =   d   .   g   l   o   b   a   l   ,   d   .   t   y   p   e   =   d   .   t   y   p   e   .   t   o   U   p   p   e   r   C   a   s   e   (   )   ,   d   .   h   a   s   C   o   n   t   e   n   t   =   !   b   K   .   t   e   s   t   (   d   .   t   y   p   e   )   ,   t   &amp;   &amp;   f   .   a   c   t   i   v   e   +   +   =   =   =   0   &amp;   &amp;   f   .   e   v   e   n   t   .   t   r   i   g   g   e   r   (   "   a   j   a   x   S   t   a   r   t   "   )   ;   i   f   (   !   d   .   h   a   s   C   o   n   t   e   n   t   )   {   d   .   d   a   t   a   &amp;   &amp;   (   d   .   u   r   l   +   =   (   b   M   .   t   e   s   t   (   d   .   u   r   l   )   ?   "   &amp;   "   :   "   ?   "   )   +   d   .   d   a   t   a   ,   d   e   l   e   t   e       d   .   d   a   t   a   )   ,   k   =   d   .   u   r   l   ;   i   f   (   d   .   c   a   c   h   e   =   =   =   !   1   )   {   v   a   r       x   =   f   .   n   o   w   (   )   ,   y   =   d   .   u   r   l   .   r   e   p   l   a   c   e   (   b   Q   ,   "   $   1   _   =   "   +   x   )   ;   d   .   u   r   l   =   y   +   (   y   =   =   =   d   .   u   r   l   ?   (   b   M   .   t   e   s   t   (   d   .   u   r   l   )   ?   "   &amp;   "   :   "   ?   "   )   +   "   _   =   "   +   x   :   "   "   )   }   }   (   d   .   d   a   t   a   &amp;   &amp;   d   .   h   a   s   C   o   n   t   e   n   t   &amp;   &amp;   d   .   c   o   n   t   e   n   t   T   y   p   e   !   =   =   !   1   |   |   c   .   c   o   n   t   e   n   t   T   y   p   e   )   &amp;   &amp;   v   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   "   C   o   n   t   e   n   t   -   T   y   p   e   "   ,   d   .   c   o   n   t   e   n   t   T   y   p   e   )   ,   d   .   i   f   M   o   d   i   f   i   e   d   &amp;   &amp;   (   k   =   k   |   |   d   .   u   r   l   ,   f   .   l   a   s   t   M   o   d   i   f   i   e   d   [   k   ]   &amp;   &amp;   v   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   "   I   f   -   M   o   d   i   f   i   e   d   -   S   i   n   c   e   "   ,   f   .   l   a   s   t   M   o   d   i   f   i   e   d   [   k   ]   )   ,   f   .   e   t   a   g   [   k   ]   &amp;   &amp;   v   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   "   I   f   -   N   o   n   e   -   M   a   t   c   h   "   ,   f   .   e   t   a   g   [   k   ]   )   )   ,   v   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   "   A   c   c   e   p   t   "   ,   d   .   d   a   t   a   T   y   p   e   s   [   0   ]   &amp;   &amp;   d   .   a   c   c   e   p   t   s   [   d   .   d   a   t   a   T   y   p   e   s   [   0   ]   ]   ?   d   .   a   c   c   e   p   t   s   [   d   .   d   a   t   a   T   y   p   e   s   [   0   ]   ]   +   (   d   .   d   a   t   a   T   y   p   e   s   [   0   ]   !   =   =   "   *   "   ?   "   ,       "   +   b   X   +   "   ;       q   =   0   .   0   1   "   :   "   "   )   :   d   .   a   c   c   e   p   t   s   [   "   *   "   ]   )   ;   f   o   r   (   u       i   n       d   .   h   e   a   d   e   r   s   )   v   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   u   ,   d   .   h   e   a   d   e   r   s   [   u   ]   )   ;   i   f   (   d   .   b   e   f   o   r   e   S   e   n   d   &amp;   &amp;   (   d   .   b   e   f   o   r   e   S   e   n   d   .   c   a   l   l   (   e   ,   v   ,   d   )   =   =   =   !   1   |   |   s   =   =   =   2   )   )   {   v   .   a   b   o   r   t   (   )   ;   r   e   t   u   r   n   !   1   }   f   o   r   (   u       i   n   {   s   u   c   c   e   s   s   :   1   ,   e   r   r   o   r   :   1   ,   c   o   m   p   l   e   t   e   :   1   }   )   v   [   u   ]   (   d   [   u   ]   )   ;   p   =   b   $   (   b   U   ,   d   ,   c   ,   v   )   ;   i   f   (   !   p   )   w   (   -   1   ,   "   N   o       T   r   a   n   s   p   o   r   t   "   )   ;   e   l   s   e   {   v   .   r   e   a   d   y   S   t   a   t   e   =   1   ,   t   &amp;   &amp;   g   .   t   r   i   g   g   e   r   (   "   a   j   a   x   S   e   n   d   "   ,   [   v   ,   d   ]   )   ,   d   .   a   s   y   n   c   &amp;   &amp;   d   .   t   i   m   e   o   u   t   &gt;   0   &amp;   &amp;   (   q   =   s   e   t   T   i   m   e   o   u   t   (   f   u   n   c   t   i   o   n   (   )   {   v   .   a   b   o   r   t   (   "   t   i   m   e   o   u   t   "   )   }   ,   d   .   t   i   m   e   o   u   t   )   )   ;   t   r   y   {   s   =   1   ,   p   .   s   e   n   d   (   l   ,   w   )   }   c   a   t   c   h   (   z   )   {   i   f   (   s   &lt;   2   )   w   (   -   1   ,   z   )   ;   e   l   s   e       t   h   r   o   w       z   }   }   r   e   t   u   r   n       v   }   ,   p   a   r   a   m   :   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   =   [   ]   ,   e   =   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   b   =   f   .   i   s   F   u   n   c   t   i   o   n   (   b   )   ?   b   (   )   :   b   ,   d   [   d   .   l   e   n   g   t   h   ]   =   e   n   c   o   d   e   U   R   I   C   o   m   p   o   n   e   n   t   (   a   )   +   "   =   "   +   e   n   c   o   d   e   U   R   I   C   o   m   p   o   n   e   n   t   (   b   )   }   ;   c   =   =   =   b   &amp;   &amp;   (   c   =   f   .   a   j   a   x   S   e   t   t   i   n   g   s   .   t   r   a   d   i   t   i   o   n   a   l   )   ;   i   f   (   f   .   i   s   A   r   r   a   y   (   a   )   |   |   a   .   j   q   u   e   r   y   &amp;   &amp;   !   f   .   i   s   P   l   a   i   n   O   b   j   e   c   t   (   a   )   )   f   .   e   a   c   h   (   a   ,   f   u   n   c   t   i   o   n   (   )   {   e   (   t   h   i   s   .   n   a   m   e   ,   t   h   i   s   .   v   a   l   u   e   )   }   )   ;   e   l   s   e       f   o   r   (   v   a   r       g       i   n       a   )   c   a   (   g   ,   a   [   g   ]   ,   c   ,   e   )   ;   r   e   t   u   r   n       d   .   j   o   i   n   (   "   &amp;   "   )   .   r   e   p   l   a   c   e   (   b   D   ,   "   +   "   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   a   c   t   i   v   e   :   0   ,   l   a   s   t   M   o   d   i   f   i   e   d   :   {   }   ,   e   t   a   g   :   {   }   }   )   ;   v   a   r       c   d   =   f   .   n   o   w   (   )   ,   c   e   =   /   (   \   =   )   \   ?   (   &amp;   |   $   )   |   \   ?   \   ?   /   i   ;   f   .   a   j   a   x   S   e   t   u   p   (   {   j   s   o   n   p   :   "   c   a   l   l   b   a   c   k   "   ,   j   s   o   n   p   C   a   l   l   b   a   c   k   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       f   .   e   x   p   a   n   d   o   +   "   _   "   +   c   d   +   +   }   }   )   ,   f   .   a   j   a   x   P   r   e   f   i   l   t   e   r   (   "   j   s   o   n       j   s   o   n   p   "   ,   f   u   n   c   t   i   o   n   (   b   ,   c   ,   d   )   {   v   a   r       e   =   b   .   c   o   n   t   e   n   t   T   y   p   e   =   =   =   "   a   p   p   l   i   c   a   t   i   o   n   /   x   -   w   w   w   -   f   o   r   m   -   u   r   l   e   n   c   o   d   e   d   "   &amp;   &amp;   t   y   p   e   o   f       b   .   d   a   t   a   =   =   "   s   t   r   i   n   g   "   ;   i   f   (   b   .   d   a   t   a   T   y   p   e   s   [   0   ]   =   =   =   "   j   s   o   n   p   "   |   |   b   .   j   s   o   n   p   !   =   =   !   1   &amp;   &amp;   (   c   e   .   t   e   s   t   (   b   .   u   r   l   )   |   |   e   &amp;   &amp;   c   e   .   t   e   s   t   (   b   .   d   a   t   a   )   )   )   {   v   a   r       g   ,   h   =   b   .   j   s   o   n   p   C   a   l   l   b   a   c   k   =   f   .   i   s   F   u   n   c   t   i   o   n   (   b   .   j   s   o   n   p   C   a   l   l   b   a   c   k   )   ?   b   .   j   s   o   n   p   C   a   l   l   b   a   c   k   (   )   :   b   .   j   s   o   n   p   C   a   l   l   b   a   c   k   ,   i   =   a   [   h   ]   ,   j   =   b   .   u   r   l   ,   k   =   b   .   d   a   t   a   ,   l   =   "   $   1   "   +   h   +   "   $   2   "   ;   b   .   j   s   o   n   p   !   =   =   !   1   &amp;   &amp;   (   j   =   j   .   r   e   p   l   a   c   e   (   c   e   ,   l   )   ,   b   .   u   r   l   =   =   =   j   &amp;   &amp;   (   e   &amp;   &amp;   (   k   =   k   .   r   e   p   l   a   c   e   (   c   e   ,   l   )   )   ,   b   .   d   a   t   a   =   =   =   k   &amp;   &amp;   (   j   +   =   (   /   \   ?   /   .   t   e   s   t   (   j   )   ?   "   &amp;   "   :   "   ?   "   )   +   b   .   j   s   o   n   p   +   "   =   "   +   h   )   )   )   ,   b   .   u   r   l   =   j   ,   b   .   d   a   t   a   =   k   ,   a   [   h   ]   =   f   u   n   c   t   i   o   n   (   a   )   {   g   =   [   a   ]   }   ,   d   .   a   l   w   a   y   s   (   f   u   n   c   t   i   o   n   (   )   {   a   [   h   ]   =   i   ,   g   &amp;   &amp;   f   .   i   s   F   u   n   c   t   i   o   n   (   i   )   &amp;   &amp;   a   [   h   ]   (   g   [   0   ]   )   }   )   ,   b   .   c   o   n   v   e   r   t   e   r   s   [   "   s   c   r   i   p   t       j   s   o   n   "   ]   =   f   u   n   c   t   i   o   n   (   )   {   g   |   |   f   .   e   r   r   o   r   (   h   +   "       w   a   s       n   o   t       c   a   l   l   e   d   "   )   ;   r   e   t   u   r   n       g   [   0   ]   }   ,   b   .   d   a   t   a   T   y   p   e   s   [   0   ]   =   "   j   s   o   n   "   ;   r   e   t   u   r   n   "   s   c   r   i   p   t   "   }   }   )   ,   f   .   a   j   a   x   S   e   t   u   p   (   {   a   c   c   e   p   t   s   :   {   s   c   r   i   p   t   :   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   ,       a   p   p   l   i   c   a   t   i   o   n   /   j   a   v   a   s   c   r   i   p   t   ,       a   p   p   l   i   c   a   t   i   o   n   /   e   c   m   a   s   c   r   i   p   t   ,       a   p   p   l   i   c   a   t   i   o   n   /   x   -   e   c   m   a   s   c   r   i   p   t   "   }   ,   c   o   n   t   e   n   t   s   :   {   s   c   r   i   p   t   :   /   j   a   v   a   s   c   r   i   p   t   |   e   c   m   a   s   c   r   i   p   t   /   }   ,   c   o   n   v   e   r   t   e   r   s   :   {   "   t   e   x   t       s   c   r   i   p   t   "   :   f   u   n   c   t   i   o   n   (   a   )   {   f   .   g   l   o   b   a   l   E   v   a   l   (   a   )   ;   r   e   t   u   r   n       a   }   }   }   )   ,   f   .   a   j   a   x   P   r   e   f   i   l   t   e   r   (   "   s   c   r   i   p   t   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   a   .   c   a   c   h   e   =   =   =   b   &amp;   &amp;   (   a   .   c   a   c   h   e   =   !   1   )   ,   a   .   c   r   o   s   s   D   o   m   a   i   n   &amp;   &amp;   (   a   .   t   y   p   e   =   "   G   E   T   "   ,   a   .   g   l   o   b   a   l   =   !   1   )   }   )   ,   f   .   a   j   a   x   T   r   a   n   s   p   o   r   t   (   "   s   c   r   i   p   t   "   ,   f   u   n   c   t   i   o   n   (   a   )   {   i   f   (   a   .   c   r   o   s   s   D   o   m   a   i   n   )   {   v   a   r       d   ,   e   =   c   .   h   e   a   d   |   |   c   .   g   e   t   E   l   e   m   e   n   t   s   B   y   T   a   g   N   a   m   e   (   "   h   e   a   d   "   )   [   0   ]   |   |   c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ;   r   e   t   u   r   n   {   s   e   n   d   :   f   u   n   c   t   i   o   n   (   f   ,   g   )   {   d   =   c   .   c   r   e   a   t   e   E   l   e   m   e   n   t   (   "   s   c   r   i   p   t   "   )   ,   d   .   a   s   y   n   c   =   "   a   s   y   n   c   "   ,   a   .   s   c   r   i   p   t   C   h   a   r   s   e   t   &amp;   &amp;   (   d   .   c   h   a   r   s   e   t   =   a   .   s   c   r   i   p   t   C   h   a   r   s   e   t   )   ,   d   .   s   r   c   =   a   .   u   r   l   ,   d   .   o   n   l   o   a   d   =   d   .   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   =   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   i   f   (   c   |   |   !   d   .   r   e   a   d   y   S   t   a   t   e   |   |   /   l   o   a   d   e   d   |   c   o   m   p   l   e   t   e   /   .   t   e   s   t   (   d   .   r   e   a   d   y   S   t   a   t   e   )   )   d   .   o   n   l   o   a   d   =   d   .   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   =   n   u   l   l   ,   e   &amp;   &amp;   d   .   p   a   r   e   n   t   N   o   d   e   &amp;   &amp;   e   .   r   e   m   o   v   e   C   h   i   l   d   (   d   )   ,   d   =   b   ,   c   |   |   g   (   2   0   0   ,   "   s   u   c   c   e   s   s   "   )   }   ,   e   .   i   n   s   e   r   t   B   e   f   o   r   e   (   d   ,   e   .   f   i   r   s   t   C   h   i   l   d   )   }   ,   a   b   o   r   t   :   f   u   n   c   t   i   o   n   (   )   {   d   &amp;   &amp;   d   .   o   n   l   o   a   d   (   0   ,   1   )   }   }   }   }   )   ;   v   a   r       c   f   =   a   .   A   c   t   i   v   e   X   O   b   j   e   c   t   ?   f   u   n   c   t   i   o   n   (   )   {   f   o   r   (   v   a   r       a       i   n       c   h   )   c   h   [   a   ]   (   0   ,   1   )   }   :   !   1   ,   c   g   =   0   ,   c   h   ;   f   .   a   j   a   x   S   e   t   t   i   n   g   s   .   x   h   r   =   a   .   A   c   t   i   v   e   X   O   b   j   e   c   t   ?   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n   !   t   h   i   s   .   i   s   L   o   c   a   l   &amp;   &amp;   c   i   (   )   |   |   c   j   (   )   }   :   c   i   ,   f   u   n   c   t   i   o   n   (   a   )   {   f   .   e   x   t   e   n   d   (   f   .   s   u   p   p   o   r   t   ,   {   a   j   a   x   :   !   !   a   ,   c   o   r   s   :   !   !   a   &amp;   &amp;   "   w   i   t   h   C   r   e   d   e   n   t   i   a   l   s   "   i   n       a   }   )   }   (   f   .   a   j   a   x   S   e   t   t   i   n   g   s   .   x   h   r   (   )   )   ,   f   .   s   u   p   p   o   r   t   .   a   j   a   x   &amp;   &amp;   f   .   a   j   a   x   T   r   a   n   s   p   o   r   t   (   f   u   n   c   t   i   o   n   (   c   )   {   i   f   (   !   c   .   c   r   o   s   s   D   o   m   a   i   n   |   |   f   .   s   u   p   p   o   r   t   .   c   o   r   s   )   {   v   a   r       d   ;   r   e   t   u   r   n   {   s   e   n   d   :   f   u   n   c   t   i   o   n   (   e   ,   g   )   {   v   a   r       h   =   c   .   x   h   r   (   )   ,   i   ,   j   ;   c   .   u   s   e   r   n   a   m   e   ?   h   .   o   p   e   n   (   c   .   t   y   p   e   ,   c   .   u   r   l   ,   c   .   a   s   y   n   c   ,   c   .   u   s   e   r   n   a   m   e   ,   c   .   p   a   s   s   w   o   r   d   )   :   h   .   o   p   e   n   (   c   .   t   y   p   e   ,   c   .   u   r   l   ,   c   .   a   s   y   n   c   )   ;   i   f   (   c   .   x   h   r   F   i   e   l   d   s   )   f   o   r   (   j       i   n       c   .   x   h   r   F   i   e   l   d   s   )   h   [   j   ]   =   c   .   x   h   r   F   i   e   l   d   s   [   j   ]   ;   c   .   m   i   m   e   T   y   p   e   &amp;   &amp;   h   .   o   v   e   r   r   i   d   e   M   i   m   e   T   y   p   e   &amp;   &amp;   h   .   o   v   e   r   r   i   d   e   M   i   m   e   T   y   p   e   (   c   .   m   i   m   e   T   y   p   e   )   ,   !   c   .   c   r   o   s   s   D   o   m   a   i   n   &amp;   &amp;   !   e   [   "   X   -   R   e   q   u   e   s   t   e   d   -   W   i   t   h   "   ]   &amp;   &amp;   (   e   [   "   X   -   R   e   q   u   e   s   t   e   d   -   W   i   t   h   "   ]   =   "   X   M   L   H   t   t   p   R   e   q   u   e   s   t   "   )   ;   t   r   y   {   f   o   r   (   j       i   n       e   )   h   .   s   e   t   R   e   q   u   e   s   t   H   e   a   d   e   r   (   j   ,   e   [   j   ]   )   }   c   a   t   c   h   (   k   )   {   }   h   .   s   e   n   d   (   c   .   h   a   s   C   o   n   t   e   n   t   &amp;   &amp;   c   .   d   a   t   a   |   |   n   u   l   l   )   ,   d   =   f   u   n   c   t   i   o   n   (   a   ,   e   )   {   v   a   r       j   ,   k   ,   l   ,   m   ,   n   ;   t   r   y   {   i   f   (   d   &amp;   &amp;   (   e   |   |   h   .   r   e   a   d   y   S   t   a   t   e   =   =   =   4   )   )   {   d   =   b   ,   i   &amp;   &amp;   (   h   .   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   =   f   .   n   o   o   p   ,   c   f   &amp;   &amp;   d   e   l   e   t   e       c   h   [   i   ]   )   ;   i   f   (   e   )   h   .   r   e   a   d   y   S   t   a   t   e   !   =   =   4   &amp;   &amp;   h   .   a   b   o   r   t   (   )   ;   e   l   s   e   {   j   =   h   .   s   t   a   t   u   s   ,   l   =   h   .   g   e   t   A   l   l   R   e   s   p   o   n   s   e   H   e   a   d   e   r   s   (   )   ,   m   =   {   }   ,   n   =   h   .   r   e   s   p   o   n   s   e   X   M   L   ,   n   &amp;   &amp;   n   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   &amp;   &amp;   (   m   .   x   m   l   =   n   )   ,   m   .   t   e   x   t   =   h   .   r   e   s   p   o   n   s   e   T   e   x   t   ;   t   r   y   {   k   =   h   .   s   t   a   t   u   s   T   e   x   t   }   c   a   t   c   h   (   o   )   {   k   =   "   "   }   !   j   &amp;   &amp;   c   .   i   s   L   o   c   a   l   &amp;   &amp;   !   c   .   c   r   o   s   s   D   o   m   a   i   n   ?   j   =   m   .   t   e   x   t   ?   2   0   0   :   4   0   4   :   j   =   =   =   1   2   2   3   &amp;   &amp;   (   j   =   2   0   4   )   }   }   }   c   a   t   c   h   (   p   )   {   e   |   |   g   (   -   1   ,   p   )   }   m   &amp;   &amp;   g   (   j   ,   k   ,   m   ,   l   )   }   ,   !   c   .   a   s   y   n   c   |   |   h   .   r   e   a   d   y   S   t   a   t   e   =   =   =   4   ?   d   (   )   :   (   i   =   +   +   c   g   ,   c   f   &amp;   &amp;   (   c   h   |   |   (   c   h   =   {   }   ,   f   (   a   )   .   u   n   l   o   a   d   (   c   f   )   )   ,   c   h   [   i   ]   =   d   )   ,   h   .   o   n   r   e   a   d   y   s   t   a   t   e   c   h   a   n   g   e   =   d   )   }   ,   a   b   o   r   t   :   f   u   n   c   t   i   o   n   (   )   {   d   &amp;   &amp;   d   (   0   ,   1   )   }   }   }   }   )   ;   v   a   r       c   k   =   {   }   ,   c   l   ,   c   m   ,   c   n   =   /   ^   (   ?   :   t   o   g   g   l   e   |   s   h   o   w   |   h   i   d   e   )   $   /   ,   c   o   =   /   ^   (   [   +   \   -   ]   =   )   ?   (   [   \   d   +   .   \   -   ]   +   )   (   [   a   -   z   %   ]   *   )   $   /   i   ,   c   p   ,   c   q   =   [   [   "   h   e   i   g   h   t   "   ,   "   m   a   r   g   i   n   T   o   p   "   ,   "   m   a   r   g   i   n   B   o   t   t   o   m   "   ,   "   p   a   d   d   i   n   g   T   o   p   "   ,   "   p   a   d   d   i   n   g   B   o   t   t   o   m   "   ]   ,   [   "   w   i   d   t   h   "   ,   "   m   a   r   g   i   n   L   e   f   t   "   ,   "   m   a   r   g   i   n   R   i   g   h   t   "   ,   "   p   a   d   d   i   n   g   L   e   f   t   "   ,   "   p   a   d   d   i   n   g   R   i   g   h   t   "   ]   ,   [   "   o   p   a   c   i   t   y   "   ]   ]   ,   c   r   ;   f   .   f   n   .   e   x   t   e   n   d   (   {   s   h   o   w   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   ,   e   ;   i   f   (   a   |   |   a   =   =   =   0   )   r   e   t   u   r   n       t   h   i   s   .   a   n   i   m   a   t   e   (   c   u   (   "   s   h   o   w   "   ,   3   )   ,   a   ,   b   ,   c   )   ;   f   o   r   (   v   a   r       g   =   0   ,   h   =   t   h   i   s   .   l   e   n   g   t   h   ;   g   &lt;   h   ;   g   +   +   )   d   =   t   h   i   s   [   g   ]   ,   d   .   s   t   y   l   e   &amp;   &amp;   (   e   =   d   .   s   t   y   l   e   .   d   i   s   p   l   a   y   ,   !   f   .   _   d   a   t   a   (   d   ,   "   o   l   d   d   i   s   p   l   a   y   "   )   &amp;   &amp;   e   =   =   =   "   n   o   n   e   "   &amp;   &amp;   (   e   =   d   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   "   )   ,   e   =   =   =   "   "   &amp;   &amp;   f   .   c   s   s   (   d   ,   "   d   i   s   p   l   a   y   "   )   =   =   =   "   n   o   n   e   "   &amp;   &amp;   f   .   _   d   a   t   a   (   d   ,   "   o   l   d   d   i   s   p   l   a   y   "   ,   c   v   (   d   .   n   o   d   e   N   a   m   e   )   )   )   ;   f   o   r   (   g   =   0   ;   g   &lt;   h   ;   g   +   +   )   {   d   =   t   h   i   s   [   g   ]   ;   i   f   (   d   .   s   t   y   l   e   )   {   e   =   d   .   s   t   y   l   e   .   d   i   s   p   l   a   y   ;   i   f   (   e   =   =   =   "   "   |   |   e   =   =   =   "   n   o   n   e   "   )   d   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   f   .   _   d   a   t   a   (   d   ,   "   o   l   d   d   i   s   p   l   a   y   "   )   |   |   "   "   }   }   r   e   t   u   r   n       t   h   i   s   }   ,   h   i   d   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   i   f   (   a   |   |   a   =   =   =   0   )   r   e   t   u   r   n       t   h   i   s   .   a   n   i   m   a   t   e   (   c   u   (   "   h   i   d   e   "   ,   3   )   ,   a   ,   b   ,   c   )   ;   v   a   r       d   ,   e   ,   g   =   0   ,   h   =   t   h   i   s   .   l   e   n   g   t   h   ;   f   o   r   (   ;   g   &lt;   h   ;   g   +   +   )   d   =   t   h   i   s   [   g   ]   ,   d   .   s   t   y   l   e   &amp;   &amp;   (   e   =   f   .   c   s   s   (   d   ,   "   d   i   s   p   l   a   y   "   )   ,   e   !   =   =   "   n   o   n   e   "   &amp;   &amp;   !   f   .   _   d   a   t   a   (   d   ,   "   o   l   d   d   i   s   p   l   a   y   "   )   &amp;   &amp;   f   .   _   d   a   t   a   (   d   ,   "   o   l   d   d   i   s   p   l   a   y   "   ,   e   )   )   ;   f   o   r   (   g   =   0   ;   g   &lt;   h   ;   g   +   +   )   t   h   i   s   [   g   ]   .   s   t   y   l   e   &amp;   &amp;   (   t   h   i   s   [   g   ]   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   n   o   n   e   "   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   _   t   o   g   g   l   e   :   f   .   f   n   .   t   o   g   g   l   e   ,   t   o   g   g   l   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   t   y   p   e   o   f       a   =   =   "   b   o   o   l   e   a   n   "   ;   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   &amp;   &amp;   f   .   i   s   F   u   n   c   t   i   o   n   (   b   )   ?   t   h   i   s   .   _   t   o   g   g   l   e   .   a   p   p   l   y   (   t   h   i   s   ,   a   r   g   u   m   e   n   t   s   )   :   a   =   =   n   u   l   l   |   |   d   ?   t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       b   =   d   ?   a   :   f   (   t   h   i   s   )   .   i   s   (   "   :   h   i   d   d   e   n   "   )   ;   f   (   t   h   i   s   )   [   b   ?   "   s   h   o   w   "   :   "   h   i   d   e   "   ]   (   )   }   )   :   t   h   i   s   .   a   n   i   m   a   t   e   (   c   u   (   "   t   o   g   g   l   e   "   ,   3   )   ,   a   ,   b   ,   c   )   ;   r   e   t   u   r   n       t   h   i   s   }   ,   f   a   d   e   T   o   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n       t   h   i   s   .   f   i   l   t   e   r   (   "   :   h   i   d   d   e   n   "   )   .   c   s   s   (   "   o   p   a   c   i   t   y   "   ,   0   )   .   s   h   o   w   (   )   .   e   n   d   (   )   .   a   n   i   m   a   t   e   (   {   o   p   a   c   i   t   y   :   b   }   ,   a   ,   c   ,   d   )   }   ,   a   n   i   m   a   t   e   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   f   u   n   c   t   i   o   n       g   (   )   {   e   .   q   u   e   u   e   =   =   =   !   1   &amp;   &amp;   f   .   _   m   a   r   k   (   t   h   i   s   )   ;   v   a   r       b   =   f   .   e   x   t   e   n   d   (   {   }   ,   e   )   ,   c   =   t   h   i   s   .   n   o   d   e   T   y   p   e   =   =   =   1   ,   d   =   c   &amp;   &amp;   f   (   t   h   i   s   )   .   i   s   (   "   :   h   i   d   d   e   n   "   )   ,   g   ,   h   ,   i   ,   j   ,   k   ,   l   ,   m   ,   n   ,   o   ;   b   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   =   {   }   ;   f   o   r   (   i       i   n       a   )   {   g   =   f   .   c   a   m   e   l   C   a   s   e   (   i   )   ,   i   !   =   =   g   &amp;   &amp;   (   a   [   g   ]   =   a   [   i   ]   ,   d   e   l   e   t   e       a   [   i   ]   )   ,   h   =   a   [   g   ]   ,   f   .   i   s   A   r   r   a   y   (   h   )   ?   (   b   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   [   g   ]   =   h   [   1   ]   ,   h   =   a   [   g   ]   =   h   [   0   ]   )   :   b   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   [   g   ]   =   b   .   s   p   e   c   i   a   l   E   a   s   i   n   g   &amp;   &amp;   b   .   s   p   e   c   i   a   l   E   a   s   i   n   g   [   g   ]   |   |   b   .   e   a   s   i   n   g   |   |   "   s   w   i   n   g   "   ;   i   f   (   h   =   =   =   "   h   i   d   e   "   &amp;   &amp;   d   |   |   h   =   =   =   "   s   h   o   w   "   &amp;   &amp;   !   d   )   r   e   t   u   r   n       b   .   c   o   m   p   l   e   t   e   .   c   a   l   l   (   t   h   i   s   )   ;   c   &amp;   &amp;   (   g   =   =   =   "   h   e   i   g   h   t   "   |   |   g   =   =   =   "   w   i   d   t   h   "   )   &amp;   &amp;   (   b   .   o   v   e   r   f   l   o   w   =   [   t   h   i   s   .   s   t   y   l   e   .   o   v   e   r   f   l   o   w   ,   t   h   i   s   .   s   t   y   l   e   .   o   v   e   r   f   l   o   w   X   ,   t   h   i   s   .   s   t   y   l   e   .   o   v   e   r   f   l   o   w   Y   ]   ,   f   .   c   s   s   (   t   h   i   s   ,   "   d   i   s   p   l   a   y   "   )   =   =   =   "   i   n   l   i   n   e   "   &amp;   &amp;   f   .   c   s   s   (   t   h   i   s   ,   "   f   l   o   a   t   "   )   =   =   =   "   n   o   n   e   "   &amp;   &amp;   (   !   f   .   s   u   p   p   o   r   t   .   i   n   l   i   n   e   B   l   o   c   k   N   e   e   d   s   L   a   y   o   u   t   |   |   c   v   (   t   h   i   s   .   n   o   d   e   N   a   m   e   )   =   =   =   "   i   n   l   i   n   e   "   ?   t   h   i   s   .   s   t   y   l   e   .   d   i   s   p   l   a   y   =   "   i   n   l   i   n   e   -   b   l   o   c   k   "   :   t   h   i   s   .   s   t   y   l   e   .   z   o   o   m   =   1   )   )   }   b   .   o   v   e   r   f   l   o   w   !   =   n   u   l   l   &amp;   &amp;   (   t   h   i   s   .   s   t   y   l   e   .   o   v   e   r   f   l   o   w   =   "   h   i   d   d   e   n   "   )   ;   f   o   r   (   i       i   n       a   )   j   =   n   e   w       f   .   f   x   (   t   h   i   s   ,   b   ,   i   )   ,   h   =   a   [   i   ]   ,   c   n   .   t   e   s   t   (   h   )   ?   (   o   =   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   t   o   g   g   l   e   "   +   i   )   |   |   (   h   =   =   =   "   t   o   g   g   l   e   "   ?   d   ?   "   s   h   o   w   "   :   "   h   i   d   e   "   :   0   )   ,   o   ?   (   f   .   _   d   a   t   a   (   t   h   i   s   ,   "   t   o   g   g   l   e   "   +   i   ,   o   =   =   =   "   s   h   o   w   "   ?   "   h   i   d   e   "   :   "   s   h   o   w   "   )   ,   j   [   o   ]   (   )   )   :   j   [   h   ]   (   )   )   :   (   k   =   c   o   .   e   x   e   c   (   h   )   ,   l   =   j   .   c   u   r   (   )   ,   k   ?   (   m   =   p   a   r   s   e   F   l   o   a   t   (   k   [   2   ]   )   ,   n   =   k   [   3   ]   |   |   (   f   .   c   s   s   N   u   m   b   e   r   [   i   ]   ?   "   "   :   "   p   x   "   )   ,   n   !   =   =   "   p   x   "   &amp;   &amp;   (   f   .   s   t   y   l   e   (   t   h   i   s   ,   i   ,   (   m   |   |   1   )   +   n   )   ,   l   =   (   m   |   |   1   )   /   j   .   c   u   r   (   )   *   l   ,   f   .   s   t   y   l   e   (   t   h   i   s   ,   i   ,   l   +   n   )   )   ,   k   [   1   ]   &amp;   &amp;   (   m   =   (   k   [   1   ]   =   =   =   "   -   =   "   ?   -   1   :   1   )   *   m   +   l   )   ,   j   .   c   u   s   t   o   m   (   l   ,   m   ,   n   )   )   :   j   .   c   u   s   t   o   m   (   l   ,   h   ,   "   "   )   )   ;   r   e   t   u   r   n   !   0   }   v   a   r       e   =   f   .   s   p   e   e   d   (   b   ,   c   ,   d   )   ;   i   f   (   f   .   i   s   E   m   p   t   y   O   b   j   e   c   t   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   e   .   c   o   m   p   l   e   t   e   ,   [   !   1   ]   )   ;   a   =   f   .   e   x   t   e   n   d   (   {   }   ,   a   )   ;   r   e   t   u   r   n       e   .   q   u   e   u   e   =   =   =   !   1   ?   t   h   i   s   .   e   a   c   h   (   g   )   :   t   h   i   s   .   q   u   e   u   e   (   e   .   q   u   e   u   e   ,   g   )   }   ,   s   t   o   p   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   t   y   p   e   o   f       a   !   =   "   s   t   r   i   n   g   "   &amp;   &amp;   (   d   =   c   ,   c   =   a   ,   a   =   b   )   ,   c   &amp;   &amp;   a   !   =   =   !   1   &amp;   &amp;   t   h   i   s   .   q   u   e   u   e   (   a   |   |   "   f   x   "   ,   [   ]   )   ;   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   f   u   n   c   t   i   o   n       h   (   a   ,   b   ,   c   )   {   v   a   r       e   =   b   [   c   ]   ;   f   .   r   e   m   o   v   e   D   a   t   a   (   a   ,   c   ,   !   0   )   ,   e   .   s   t   o   p   (   d   )   }   v   a   r       b   ,   c   =   !   1   ,   e   =   f   .   t   i   m   e   r   s   ,   g   =   f   .   _   d   a   t   a   (   t   h   i   s   )   ;   d   |   |   f   .   _   u   n   m   a   r   k   (   !   0   ,   t   h   i   s   )   ;   i   f   (   a   =   =   n   u   l   l   )   f   o   r   (   b       i   n       g   )   g   [   b   ]   &amp;   &amp;   g   [   b   ]   .   s   t   o   p   &amp;   &amp;   b   .   i   n   d   e   x   O   f   (   "   .   r   u   n   "   )   =   =   =   b   .   l   e   n   g   t   h   -   4   &amp;   &amp;   h   (   t   h   i   s   ,   g   ,   b   )   ;   e   l   s   e       g   [   b   =   a   +   "   .   r   u   n   "   ]   &amp;   &amp;   g   [   b   ]   .   s   t   o   p   &amp;   &amp;   h   (   t   h   i   s   ,   g   ,   b   )   ;   f   o   r   (   b   =   e   .   l   e   n   g   t   h   ;   b   -   -   ;   )   e   [   b   ]   .   e   l   e   m   =   =   =   t   h   i   s   &amp;   &amp;   (   a   =   =   n   u   l   l   |   |   e   [   b   ]   .   q   u   e   u   e   =   =   =   a   )   &amp;   &amp;   (   d   ?   e   [   b   ]   (   !   0   )   :   e   [   b   ]   .   s   a   v   e   S   t   a   t   e   (   )   ,   c   =   !   0   ,   e   .   s   p   l   i   c   e   (   b   ,   1   )   )   ;   (   !   d   |   |   !   c   )   &amp;   &amp;   f   .   d   e   q   u   e   u   e   (   t   h   i   s   ,   a   )   }   )   }   }   )   ,   f   .   e   a   c   h   (   {   s   l   i   d   e   D   o   w   n   :   c   u   (   "   s   h   o   w   "   ,   1   )   ,   s   l   i   d   e   U   p   :   c   u   (   "   h   i   d   e   "   ,   1   )   ,   s   l   i   d   e   T   o   g   g   l   e   :   c   u   (   "   t   o   g   g   l   e   "   ,   1   )   ,   f   a   d   e   I   n   :   {   o   p   a   c   i   t   y   :   "   s   h   o   w   "   }   ,   f   a   d   e   O   u   t   :   {   o   p   a   c   i   t   y   :   "   h   i   d   e   "   }   ,   f   a   d   e   T   o   g   g   l   e   :   {   o   p   a   c   i   t   y   :   "   t   o   g   g   l   e   "   }   }   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   n   [   a   ]   =   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   r   e   t   u   r   n       t   h   i   s   .   a   n   i   m   a   t   e   (   b   ,   a   ,   c   ,   d   )   }   }   )   ,   f   .   e   x   t   e   n   d   (   {   s   p   e   e   d   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   a   &amp;   &amp;   t   y   p   e   o   f       a   =   =   "   o   b   j   e   c   t   "   ?   f   .   e   x   t   e   n   d   (   {   }   ,   a   )   :   {   c   o   m   p   l   e   t   e   :   c   |   |   !   c   &amp;   &amp;   b   |   |   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   &amp;   &amp;   a   ,   d   u   r   a   t   i   o   n   :   a   ,   e   a   s   i   n   g   :   c   &amp;   &amp;   b   |   |   b   &amp;   &amp;   !   f   .   i   s   F   u   n   c   t   i   o   n   (   b   )   &amp;   &amp;   b   }   ;   d   .   d   u   r   a   t   i   o   n   =   f   .   f   x   .   o   f   f   ?   0   :   t   y   p   e   o   f       d   .   d   u   r   a   t   i   o   n   =   =   "   n   u   m   b   e   r   "   ?   d   .   d   u   r   a   t   i   o   n   :   d   .   d   u   r   a   t   i   o   n       i   n       f   .   f   x   .   s   p   e   e   d   s   ?   f   .   f   x   .   s   p   e   e   d   s   [   d   .   d   u   r   a   t   i   o   n   ]   :   f   .   f   x   .   s   p   e   e   d   s   .   _   d   e   f   a   u   l   t   ;   i   f   (   d   .   q   u   e   u   e   =   =   n   u   l   l   |   |   d   .   q   u   e   u   e   =   =   =   !   0   )   d   .   q   u   e   u   e   =   "   f   x   "   ;   d   .   o   l   d   =   d   .   c   o   m   p   l   e   t   e   ,   d   .   c   o   m   p   l   e   t   e   =   f   u   n   c   t   i   o   n   (   a   )   {   f   .   i   s   F   u   n   c   t   i   o   n   (   d   .   o   l   d   )   &amp;   &amp;   d   .   o   l   d   .   c   a   l   l   (   t   h   i   s   )   ,   d   .   q   u   e   u   e   ?   f   .   d   e   q   u   e   u   e   (   t   h   i   s   ,   d   .   q   u   e   u   e   )   :   a   !   =   =   !   1   &amp;   &amp;   f   .   _   u   n   m   a   r   k   (   t   h   i   s   )   }   ;   r   e   t   u   r   n       d   }   ,   e   a   s   i   n   g   :   {   l   i   n   e   a   r   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n       c   +   d   *   a   }   ,   s   w   i   n   g   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   ,   d   )   {   r   e   t   u   r   n   (   -   M   a   t   h   .   c   o   s   (   a   *   M   a   t   h   .   P   I   )   /   2   +   .   5   )   *   d   +   c   }   }   ,   t   i   m   e   r   s   :   [   ]   ,   f   x   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   t   h   i   s   .   o   p   t   i   o   n   s   =   b   ,   t   h   i   s   .   e   l   e   m   =   a   ,   t   h   i   s   .   p   r   o   p   =   c   ,   b   .   o   r   i   g   =   b   .   o   r   i   g   |   |   {   }   }   }   )   ,   f   .   f   x   .   p   r   o   t   o   t   y   p   e   =   {   u   p   d   a   t   e   :   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   o   p   t   i   o   n   s   .   s   t   e   p   &amp;   &amp;   t   h   i   s   .   o   p   t   i   o   n   s   .   s   t   e   p   .   c   a   l   l   (   t   h   i   s   .   e   l   e   m   ,   t   h   i   s   .   n   o   w   ,   t   h   i   s   )   ,   (   f   .   f   x   .   s   t   e   p   [   t   h   i   s   .   p   r   o   p   ]   |   |   f   .   f   x   .   s   t   e   p   .   _   d   e   f   a   u   l   t   )   (   t   h   i   s   )   }   ,   c   u   r   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   t   h   i   s   .   e   l   e   m   [   t   h   i   s   .   p   r   o   p   ]   !   =   n   u   l   l   &amp;   &amp;   (   !   t   h   i   s   .   e   l   e   m   .   s   t   y   l   e   |   |   t   h   i   s   .   e   l   e   m   .   s   t   y   l   e   [   t   h   i   s   .   p   r   o   p   ]   =   =   n   u   l   l   )   )   r   e   t   u   r   n       t   h   i   s   .   e   l   e   m   [   t   h   i   s   .   p   r   o   p   ]   ;   v   a   r       a   ,   b   =   f   .   c   s   s   (   t   h   i   s   .   e   l   e   m   ,   t   h   i   s   .   p   r   o   p   )   ;   r   e   t   u   r   n       i   s   N   a   N   (   a   =   p   a   r   s   e   F   l   o   a   t   (   b   )   )   ?   !   b   |   |   b   =   =   =   "   a   u   t   o   "   ?   0   :   b   :   a   }   ,   c   u   s   t   o   m   :   f   u   n   c   t   i   o   n   (   a   ,   c   ,   d   )   {   f   u   n   c   t   i   o   n       h   (   a   )   {   r   e   t   u   r   n       e   .   s   t   e   p   (   a   )   }   v   a   r       e   =   t   h   i   s   ,   g   =   f   .   f   x   ;   t   h   i   s   .   s   t   a   r   t   T   i   m   e   =   c   r   |   |   c   s   (   )   ,   t   h   i   s   .   e   n   d   =   c   ,   t   h   i   s   .   n   o   w   =   t   h   i   s   .   s   t   a   r   t   =   a   ,   t   h   i   s   .   p   o   s   =   t   h   i   s   .   s   t   a   t   e   =   0   ,   t   h   i   s   .   u   n   i   t   =   d   |   |   t   h   i   s   .   u   n   i   t   |   |   (   f   .   c   s   s   N   u   m   b   e   r   [   t   h   i   s   .   p   r   o   p   ]   ?   "   "   :   "   p   x   "   )   ,   h   .   q   u   e   u   e   =   t   h   i   s   .   o   p   t   i   o   n   s   .   q   u   e   u   e   ,   h   .   e   l   e   m   =   t   h   i   s   .   e   l   e   m   ,   h   .   s   a   v   e   S   t   a   t   e   =   f   u   n   c   t   i   o   n   (   )   {   e   .   o   p   t   i   o   n   s   .   h   i   d   e   &amp;   &amp;   f   .   _   d   a   t   a   (   e   .   e   l   e   m   ,   "   f   x   s   h   o   w   "   +   e   .   p   r   o   p   )   =   =   =   b   &amp;   &amp;   f   .   _   d   a   t   a   (   e   .   e   l   e   m   ,   "   f   x   s   h   o   w   "   +   e   .   p   r   o   p   ,   e   .   s   t   a   r   t   )   }   ,   h   (   )   &amp;   &amp;   f   .   t   i   m   e   r   s   .   p   u   s   h   (   h   )   &amp;   &amp;   !   c   p   &amp;   &amp;   (   c   p   =   s   e   t   I   n   t   e   r   v   a   l   (   g   .   t   i   c   k   ,   g   .   i   n   t   e   r   v   a   l   )   )   }   ,   s   h   o   w   :   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   f   .   _   d   a   t   a   (   t   h   i   s   .   e   l   e   m   ,   "   f   x   s   h   o   w   "   +   t   h   i   s   .   p   r   o   p   )   ;   t   h   i   s   .   o   p   t   i   o   n   s   .   o   r   i   g   [   t   h   i   s   .   p   r   o   p   ]   =   a   |   |   f   .   s   t   y   l   e   (   t   h   i   s   .   e   l   e   m   ,   t   h   i   s   .   p   r   o   p   )   ,   t   h   i   s   .   o   p   t   i   o   n   s   .   s   h   o   w   =   !   0   ,   a   !   =   =   b   ?   t   h   i   s   .   c   u   s   t   o   m   (   t   h   i   s   .   c   u   r   (   )   ,   a   )   :   t   h   i   s   .   c   u   s   t   o   m   (   t   h   i   s   .   p   r   o   p   =   =   =   "   w   i   d   t   h   "   |   |   t   h   i   s   .   p   r   o   p   =   =   =   "   h   e   i   g   h   t   "   ?   1   :   0   ,   t   h   i   s   .   c   u   r   (   )   )   ,   f   (   t   h   i   s   .   e   l   e   m   )   .   s   h   o   w   (   )   }   ,   h   i   d   e   :   f   u   n   c   t   i   o   n   (   )   {   t   h   i   s   .   o   p   t   i   o   n   s   .   o   r   i   g   [   t   h   i   s   .   p   r   o   p   ]   =   f   .   _   d   a   t   a   (   t   h   i   s   .   e   l   e   m   ,   "   f   x   s   h   o   w   "   +   t   h   i   s   .   p   r   o   p   )   |   |   f   .   s   t   y   l   e   (   t   h   i   s   .   e   l   e   m   ,   t   h   i   s   .   p   r   o   p   )   ,   t   h   i   s   .   o   p   t   i   o   n   s   .   h   i   d   e   =   !   0   ,   t   h   i   s   .   c   u   s   t   o   m   (   t   h   i   s   .   c   u   r   (   )   ,   0   )   }   ,   s   t   e   p   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   ,   c   ,   d   ,   e   =   c   r   |   |   c   s   (   )   ,   g   =   !   0   ,   h   =   t   h   i   s   .   e   l   e   m   ,   i   =   t   h   i   s   .   o   p   t   i   o   n   s   ;   i   f   (   a   |   |   e   &gt;   =   i   .   d   u   r   a   t   i   o   n   +   t   h   i   s   .   s   t   a   r   t   T   i   m   e   )   {   t   h   i   s   .   n   o   w   =   t   h   i   s   .   e   n   d   ,   t   h   i   s   .   p   o   s   =   t   h   i   s   .   s   t   a   t   e   =   1   ,   t   h   i   s   .   u   p   d   a   t   e   (   )   ,   i   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   [   t   h   i   s   .   p   r   o   p   ]   =   !   0   ;   f   o   r   (   b       i   n       i   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   )   i   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   [   b   ]   !   =   =   !   0   &amp;   &amp;   (   g   =   !   1   )   ;   i   f   (   g   )   {   i   .   o   v   e   r   f   l   o   w   !   =   n   u   l   l   &amp;   &amp;   !   f   .   s   u   p   p   o   r   t   .   s   h   r   i   n   k   W   r   a   p   B   l   o   c   k   s   &amp;   &amp;   f   .   e   a   c   h   (   [   "   "   ,   "   X   "   ,   "   Y   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   h   .   s   t   y   l   e   [   "   o   v   e   r   f   l   o   w   "   +   b   ]   =   i   .   o   v   e   r   f   l   o   w   [   a   ]   }   )   ,   i   .   h   i   d   e   &amp;   &amp;   f   (   h   )   .   h   i   d   e   (   )   ;   i   f   (   i   .   h   i   d   e   |   |   i   .   s   h   o   w   )   f   o   r   (   b       i   n       i   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   )   f   .   s   t   y   l   e   (   h   ,   b   ,   i   .   o   r   i   g   [   b   ]   )   ,   f   .   r   e   m   o   v   e   D   a   t   a   (   h   ,   "   f   x   s   h   o   w   "   +   b   ,   !   0   )   ,   f   .   r   e   m   o   v   e   D   a   t   a   (   h   ,   "   t   o   g   g   l   e   "   +   b   ,   !   0   )   ;   d   =   i   .   c   o   m   p   l   e   t   e   ,   d   &amp;   &amp;   (   i   .   c   o   m   p   l   e   t   e   =   !   1   ,   d   .   c   a   l   l   (   h   )   )   }   r   e   t   u   r   n   !   1   }   i   .   d   u   r   a   t   i   o   n   =   =   I   n   f   i   n   i   t   y   ?   t   h   i   s   .   n   o   w   =   e   :   (   c   =   e   -   t   h   i   s   .   s   t   a   r   t   T   i   m   e   ,   t   h   i   s   .   s   t   a   t   e   =   c   /   i   .   d   u   r   a   t   i   o   n   ,   t   h   i   s   .   p   o   s   =   f   .   e   a   s   i   n   g   [   i   .   a   n   i   m   a   t   e   d   P   r   o   p   e   r   t   i   e   s   [   t   h   i   s   .   p   r   o   p   ]   ]   (   t   h   i   s   .   s   t   a   t   e   ,   c   ,   0   ,   1   ,   i   .   d   u   r   a   t   i   o   n   )   ,   t   h   i   s   .   n   o   w   =   t   h   i   s   .   s   t   a   r   t   +   (   t   h   i   s   .   e   n   d   -   t   h   i   s   .   s   t   a   r   t   )   *   t   h   i   s   .   p   o   s   )   ,   t   h   i   s   .   u   p   d   a   t   e   (   )   ;   r   e   t   u   r   n   !   0   }   }   ,   f   .   e   x   t   e   n   d   (   f   .   f   x   ,   {   t   i   c   k   :   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   ,   b   =   f   .   t   i   m   e   r   s   ,   c   =   0   ;   f   o   r   (   ;   c   &lt;   b   .   l   e   n   g   t   h   ;   c   +   +   )   a   =   b   [   c   ]   ,   !   a   (   )   &amp;   &amp;   b   [   c   ]   =   =   =   a   &amp;   &amp;   b   .   s   p   l   i   c   e   (   c   -   -   ,   1   )   ;   b   .   l   e   n   g   t   h   |   |   f   .   f   x   .   s   t   o   p   (   )   }   ,   i   n   t   e   r   v   a   l   :   1   3   ,   s   t   o   p   :   f   u   n   c   t   i   o   n   (   )   {   c   l   e   a   r   I   n   t   e   r   v   a   l   (   c   p   )   ,   c   p   =   n   u   l   l   }   ,   s   p   e   e   d   s   :   {   s   l   o   w   :   6   0   0   ,   f   a   s   t   :   2   0   0   ,   _   d   e   f   a   u   l   t   :   4   0   0   }   ,   s   t   e   p   :   {   o   p   a   c   i   t   y   :   f   u   n   c   t   i   o   n   (   a   )   {   f   .   s   t   y   l   e   (   a   .   e   l   e   m   ,   "   o   p   a   c   i   t   y   "   ,   a   .   n   o   w   )   }   ,   _   d   e   f   a   u   l   t   :   f   u   n   c   t   i   o   n   (   a   )   {   a   .   e   l   e   m   .   s   t   y   l   e   &amp;   &amp;   a   .   e   l   e   m   .   s   t   y   l   e   [   a   .   p   r   o   p   ]   !   =   n   u   l   l   ?   a   .   e   l   e   m   .   s   t   y   l   e   [   a   .   p   r   o   p   ]   =   a   .   n   o   w   +   a   .   u   n   i   t   :   a   .   e   l   e   m   [   a   .   p   r   o   p   ]   =   a   .   n   o   w   }   }   }   )   ,   f   .   e   a   c   h   (   [   "   w   i   d   t   h   "   ,   "   h   e   i   g   h   t   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   b   )   {   f   .   f   x   .   s   t   e   p   [   b   ]   =   f   u   n   c   t   i   o   n   (   a   )   {   f   .   s   t   y   l   e   (   a   .   e   l   e   m   ,   b   ,   M   a   t   h   .   m   a   x   (   0   ,   a   .   n   o   w   )   +   a   .   u   n   i   t   )   }   }   )   ,   f   .   e   x   p   r   &amp;   &amp;   f   .   e   x   p   r   .   f   i   l   t   e   r   s   &amp;   &amp;   (   f   .   e   x   p   r   .   f   i   l   t   e   r   s   .   a   n   i   m   a   t   e   d   =   f   u   n   c   t   i   o   n   (   a   )   {   r   e   t   u   r   n       f   .   g   r   e   p   (   f   .   t   i   m   e   r   s   ,   f   u   n   c   t   i   o   n   (   b   )   {   r   e   t   u   r   n       a   =   =   =   b   .   e   l   e   m   }   )   .   l   e   n   g   t   h   }   )   ;   v   a   r       c   w   =   /   ^   t   (   ?   :   a   b   l   e   |   d   |   h   )   $   /   i   ,   c   x   =   /   ^   (   ?   :   b   o   d   y   |   h   t   m   l   )   $   /   i   ;   "   g   e   t   B   o   u   n   d   i   n   g   C   l   i   e   n   t   R   e   c   t   "   i   n       c   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ?   f   .   f   n   .   o   f   f   s   e   t   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   t   h   i   s   [   0   ]   ,   c   ;   i   f   (   a   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   .   o   f   f   s   e   t   .   s   e   t   O   f   f   s   e   t   (   t   h   i   s   ,   a   ,   b   )   }   )   ;   i   f   (   !   b   |   |   !   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   )   r   e   t   u   r   n       n   u   l   l   ;   i   f   (   b   =   =   =   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   b   o   d   y   )   r   e   t   u   r   n       f   .   o   f   f   s   e   t   .   b   o   d   y   O   f   f   s   e   t   (   b   )   ;   t   r   y   {   c   =   b   .   g   e   t   B   o   u   n   d   i   n   g   C   l   i   e   n   t   R   e   c   t   (   )   }   c   a   t   c   h   (   d   )   {   }   v   a   r       e   =   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   ,   g   =   e   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ;   i   f   (   !   c   |   |   !   f   .   c   o   n   t   a   i   n   s   (   g   ,   b   )   )   r   e   t   u   r   n       c   ?   {   t   o   p   :   c   .   t   o   p   ,   l   e   f   t   :   c   .   l   e   f   t   }   :   {   t   o   p   :   0   ,   l   e   f   t   :   0   }   ;   v   a   r       h   =   e   .   b   o   d   y   ,   i   =   c   y   (   e   )   ,   j   =   g   .   c   l   i   e   n   t   T   o   p   |   |   h   .   c   l   i   e   n   t   T   o   p   |   |   0   ,   k   =   g   .   c   l   i   e   n   t   L   e   f   t   |   |   h   .   c   l   i   e   n   t   L   e   f   t   |   |   0   ,   l   =   i   .   p   a   g   e   Y   O   f   f   s   e   t   |   |   f   .   s   u   p   p   o   r   t   .   b   o   x   M   o   d   e   l   &amp;   &amp;   g   .   s   c   r   o   l   l   T   o   p   |   |   h   .   s   c   r   o   l   l   T   o   p   ,   m   =   i   .   p   a   g   e   X   O   f   f   s   e   t   |   |   f   .   s   u   p   p   o   r   t   .   b   o   x   M   o   d   e   l   &amp;   &amp;   g   .   s   c   r   o   l   l   L   e   f   t   |   |   h   .   s   c   r   o   l   l   L   e   f   t   ,   n   =   c   .   t   o   p   +   l   -   j   ,   o   =   c   .   l   e   f   t   +   m   -   k   ;   r   e   t   u   r   n   {   t   o   p   :   n   ,   l   e   f   t   :   o   }   }   :   f   .   f   n   .   o   f   f   s   e   t   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   t   h   i   s   [   0   ]   ;   i   f   (   a   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   f   .   o   f   f   s   e   t   .   s   e   t   O   f   f   s   e   t   (   t   h   i   s   ,   a   ,   b   )   }   )   ;   i   f   (   !   b   |   |   !   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   )   r   e   t   u   r   n       n   u   l   l   ;   i   f   (   b   =   =   =   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   .   b   o   d   y   )   r   e   t   u   r   n       f   .   o   f   f   s   e   t   .   b   o   d   y   O   f   f   s   e   t   (   b   )   ;   v   a   r       c   ,   d   =   b   .   o   f   f   s   e   t   P   a   r   e   n   t   ,   e   =   b   ,   g   =   b   .   o   w   n   e   r   D   o   c   u   m   e   n   t   ,   h   =   g   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   ,   i   =   g   .   b   o   d   y   ,   j   =   g   .   d   e   f   a   u   l   t   V   i   e   w   ,   k   =   j   ?   j   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   (   b   ,   n   u   l   l   )   :   b   .   c   u   r   r   e   n   t   S   t   y   l   e   ,   l   =   b   .   o   f   f   s   e   t   T   o   p   ,   m   =   b   .   o   f   f   s   e   t   L   e   f   t   ;   w   h   i   l   e   (   (   b   =   b   .   p   a   r   e   n   t   N   o   d   e   )   &amp;   &amp;   b   !   =   =   i   &amp;   &amp;   b   !   =   =   h   )   {   i   f   (   f   .   s   u   p   p   o   r   t   .   f   i   x   e   d   P   o   s   i   t   i   o   n   &amp;   &amp;   k   .   p   o   s   i   t   i   o   n   =   =   =   "   f   i   x   e   d   "   )   b   r   e   a   k   ;   c   =   j   ?   j   .   g   e   t   C   o   m   p   u   t   e   d   S   t   y   l   e   (   b   ,   n   u   l   l   )   :   b   .   c   u   r   r   e   n   t   S   t   y   l   e   ,   l   -   =   b   .   s   c   r   o   l   l   T   o   p   ,   m   -   =   b   .   s   c   r   o   l   l   L   e   f   t   ,   b   =   =   =   d   &amp;   &amp;   (   l   +   =   b   .   o   f   f   s   e   t   T   o   p   ,   m   +   =   b   .   o   f   f   s   e   t   L   e   f   t   ,   f   .   s   u   p   p   o   r   t   .   d   o   e   s   N   o   t   A   d   d   B   o   r   d   e   r   &amp;   &amp;   (   !   f   .   s   u   p   p   o   r   t   .   d   o   e   s   A   d   d   B   o   r   d   e   r   F   o   r   T   a   b   l   e   A   n   d   C   e   l   l   s   |   |   !   c   w   .   t   e   s   t   (   b   .   n   o   d   e   N   a   m   e   )   )   &amp;   &amp;   (   l   +   =   p   a   r   s   e   F   l   o   a   t   (   c   .   b   o   r   d   e   r   T   o   p   W   i   d   t   h   )   |   |   0   ,   m   +   =   p   a   r   s   e   F   l   o   a   t   (   c   .   b   o   r   d   e   r   L   e   f   t   W   i   d   t   h   )   |   |   0   )   ,   e   =   d   ,   d   =   b   .   o   f   f   s   e   t   P   a   r   e   n   t   )   ,   f   .   s   u   p   p   o   r   t   .   s   u   b   t   r   a   c   t   s   B   o   r   d   e   r   F   o   r   O   v   e   r   f   l   o   w   N   o   t   V   i   s   i   b   l   e   &amp;   &amp;   c   .   o   v   e   r   f   l   o   w   !   =   =   "   v   i   s   i   b   l   e   "   &amp;   &amp;   (   l   +   =   p   a   r   s   e   F   l   o   a   t   (   c   .   b   o   r   d   e   r   T   o   p   W   i   d   t   h   )   |   |   0   ,   m   +   =   p   a   r   s   e   F   l   o   a   t   (   c   .   b   o   r   d   e   r   L   e   f   t   W   i   d   t   h   )   |   |   0   )   ,   k   =   c   }   i   f   (   k   .   p   o   s   i   t   i   o   n   =   =   =   "   r   e   l   a   t   i   v   e   "   |   |   k   .   p   o   s   i   t   i   o   n   =   =   =   "   s   t   a   t   i   c   "   )   l   +   =   i   .   o   f   f   s   e   t   T   o   p   ,   m   +   =   i   .   o   f   f   s   e   t   L   e   f   t   ;   f   .   s   u   p   p   o   r   t   .   f   i   x   e   d   P   o   s   i   t   i   o   n   &amp;   &amp;   k   .   p   o   s   i   t   i   o   n   =   =   =   "   f   i   x   e   d   "   &amp;   &amp;   (   l   +   =   M   a   t   h   .   m   a   x   (   h   .   s   c   r   o   l   l   T   o   p   ,   i   .   s   c   r   o   l   l   T   o   p   )   ,   m   +   =   M   a   t   h   .   m   a   x   (   h   .   s   c   r   o   l   l   L   e   f   t   ,   i   .   s   c   r   o   l   l   L   e   f   t   )   )   ;   r   e   t   u   r   n   {   t   o   p   :   l   ,   l   e   f   t   :   m   }   }   ,   f   .   o   f   f   s   e   t   =   {   b   o   d   y   O   f   f   s   e   t   :   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   a   .   o   f   f   s   e   t   T   o   p   ,   c   =   a   .   o   f   f   s   e   t   L   e   f   t   ;   f   .   s   u   p   p   o   r   t   .   d   o   e   s   N   o   t   I   n   c   l   u   d   e   M   a   r   g   i   n   I   n   B   o   d   y   O   f   f   s   e   t   &amp;   &amp;   (   b   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   m   a   r   g   i   n   T   o   p   "   )   )   |   |   0   ,   c   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   m   a   r   g   i   n   L   e   f   t   "   )   )   |   |   0   )   ;   r   e   t   u   r   n   {   t   o   p   :   b   ,   l   e   f   t   :   c   }   }   ,   s   e   t   O   f   f   s   e   t   :   f   u   n   c   t   i   o   n   (   a   ,   b   ,   c   )   {   v   a   r       d   =   f   .   c   s   s   (   a   ,   "   p   o   s   i   t   i   o   n   "   )   ;   d   =   =   =   "   s   t   a   t   i   c   "   &amp;   &amp;   (   a   .   s   t   y   l   e   .   p   o   s   i   t   i   o   n   =   "   r   e   l   a   t   i   v   e   "   )   ;   v   a   r       e   =   f   (   a   )   ,   g   =   e   .   o   f   f   s   e   t   (   )   ,   h   =   f   .   c   s   s   (   a   ,   "   t   o   p   "   )   ,   i   =   f   .   c   s   s   (   a   ,   "   l   e   f   t   "   )   ,   j   =   (   d   =   =   =   "   a   b   s   o   l   u   t   e   "   |   |   d   =   =   =   "   f   i   x   e   d   "   )   &amp;   &amp;   f   .   i   n   A   r   r   a   y   (   "   a   u   t   o   "   ,   [   h   ,   i   ]   )   &gt;   -   1   ,   k   =   {   }   ,   l   =   {   }   ,   m   ,   n   ;   j   ?   (   l   =   e   .   p   o   s   i   t   i   o   n   (   )   ,   m   =   l   .   t   o   p   ,   n   =   l   .   l   e   f   t   )   :   (   m   =   p   a   r   s   e   F   l   o   a   t   (   h   )   |   |   0   ,   n   =   p   a   r   s   e   F   l   o   a   t   (   i   )   |   |   0   )   ,   f   .   i   s   F   u   n   c   t   i   o   n   (   b   )   &amp;   &amp;   (   b   =   b   .   c   a   l   l   (   a   ,   c   ,   g   )   )   ,   b   .   t   o   p   !   =   n   u   l   l   &amp;   &amp;   (   k   .   t   o   p   =   b   .   t   o   p   -   g   .   t   o   p   +   m   )   ,   b   .   l   e   f   t   !   =   n   u   l   l   &amp;   &amp;   (   k   .   l   e   f   t   =   b   .   l   e   f   t   -   g   .   l   e   f   t   +   n   )   ,   "   u   s   i   n   g   "   i   n       b   ?   b   .   u   s   i   n   g   .   c   a   l   l   (   a   ,   k   )   :   e   .   c   s   s   (   k   )   }   }   ,   f   .   f   n   .   e   x   t   e   n   d   (   {   p   o   s   i   t   i   o   n   :   f   u   n   c   t   i   o   n   (   )   {   i   f   (   !   t   h   i   s   [   0   ]   )   r   e   t   u   r   n       n   u   l   l   ;   v   a   r       a   =   t   h   i   s   [   0   ]   ,   b   =   t   h   i   s   .   o   f   f   s   e   t   P   a   r   e   n   t   (   )   ,   c   =   t   h   i   s   .   o   f   f   s   e   t   (   )   ,   d   =   c   x   .   t   e   s   t   (   b   [   0   ]   .   n   o   d   e   N   a   m   e   )   ?   {   t   o   p   :   0   ,   l   e   f   t   :   0   }   :   b   .   o   f   f   s   e   t   (   )   ;   c   .   t   o   p   -   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   m   a   r   g   i   n   T   o   p   "   )   )   |   |   0   ,   c   .   l   e   f   t   -   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   "   m   a   r   g   i   n   L   e   f   t   "   )   )   |   |   0   ,   d   .   t   o   p   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   b   [   0   ]   ,   "   b   o   r   d   e   r   T   o   p   W   i   d   t   h   "   )   )   |   |   0   ,   d   .   l   e   f   t   +   =   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   b   [   0   ]   ,   "   b   o   r   d   e   r   L   e   f   t   W   i   d   t   h   "   )   )   |   |   0   ;   r   e   t   u   r   n   {   t   o   p   :   c   .   t   o   p   -   d   .   t   o   p   ,   l   e   f   t   :   c   .   l   e   f   t   -   d   .   l   e   f   t   }   }   ,   o   f   f   s   e   t   P   a   r   e   n   t   :   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       t   h   i   s   .   m   a   p   (   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   t   h   i   s   .   o   f   f   s   e   t   P   a   r   e   n   t   |   |   c   .   b   o   d   y   ;   w   h   i   l   e   (   a   &amp;   &amp;   !   c   x   .   t   e   s   t   (   a   .   n   o   d   e   N   a   m   e   )   &amp;   &amp;   f   .   c   s   s   (   a   ,   "   p   o   s   i   t   i   o   n   "   )   =   =   =   "   s   t   a   t   i   c   "   )   a   =   a   .   o   f   f   s   e   t   P   a   r   e   n   t   ;   r   e   t   u   r   n       a   }   )   }   }   )   ,   f   .   e   a   c   h   (   [   "   L   e   f   t   "   ,   "   T   o   p   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   =   "   s   c   r   o   l   l   "   +   c   ;   f   .   f   n   [   d   ]   =   f   u   n   c   t   i   o   n   (   c   )   {   v   a   r       e   ,   g   ;   i   f   (   c   =   =   =   b   )   {   e   =   t   h   i   s   [   0   ]   ;   i   f   (   !   e   )   r   e   t   u   r   n       n   u   l   l   ;   g   =   c   y   (   e   )   ;   r   e   t   u   r   n       g   ?   "   p   a   g   e   X   O   f   f   s   e   t   "   i   n       g   ?   g   [   a   ?   "   p   a   g   e   Y   O   f   f   s   e   t   "   :   "   p   a   g   e   X   O   f   f   s   e   t   "   ]   :   f   .   s   u   p   p   o   r   t   .   b   o   x   M   o   d   e   l   &amp;   &amp;   g   .   d   o   c   u   m   e   n   t   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   [   d   ]   |   |   g   .   d   o   c   u   m   e   n   t   .   b   o   d   y   [   d   ]   :   e   [   d   ]   }   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   )   {   g   =   c   y   (   t   h   i   s   )   ,   g   ?   g   .   s   c   r   o   l   l   T   o   (   a   ?   f   (   g   )   .   s   c   r   o   l   l   L   e   f   t   (   )   :   c   ,   a   ?   c   :   f   (   g   )   .   s   c   r   o   l   l   T   o   p   (   )   )   :   t   h   i   s   [   d   ]   =   c   }   )   }   }   )   ,   f   .   e   a   c   h   (   [   "   H   e   i   g   h   t   "   ,   "   W   i   d   t   h   "   ]   ,   f   u   n   c   t   i   o   n   (   a   ,   c   )   {   v   a   r       d   =   c   .   t   o   L   o   w   e   r   C   a   s   e   (   )   ;   f   .   f   n   [   "   i   n   n   e   r   "   +   c   ]   =   f   u   n   c   t   i   o   n   (   )   {   v   a   r       a   =   t   h   i   s   [   0   ]   ;   r   e   t   u   r   n       a   ?   a   .   s   t   y   l   e   ?   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   a   ,   d   ,   "   p   a   d   d   i   n   g   "   )   )   :   t   h   i   s   [   d   ]   (   )   :   n   u   l   l   }   ,   f   .   f   n   [   "   o   u   t   e   r   "   +   c   ]   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       b   =   t   h   i   s   [   0   ]   ;   r   e   t   u   r   n       b   ?   b   .   s   t   y   l   e   ?   p   a   r   s   e   F   l   o   a   t   (   f   .   c   s   s   (   b   ,   d   ,   a   ?   "   m   a   r   g   i   n   "   :   "   b   o   r   d   e   r   "   )   )   :   t   h   i   s   [   d   ]   (   )   :   n   u   l   l   }   ,   f   .   f   n   [   d   ]   =   f   u   n   c   t   i   o   n   (   a   )   {   v   a   r       e   =   t   h   i   s   [   0   ]   ;   i   f   (   !   e   )   r   e   t   u   r   n       a   =   =   n   u   l   l   ?   n   u   l   l   :   t   h   i   s   ;   i   f   (   f   .   i   s   F   u   n   c   t   i   o   n   (   a   )   )   r   e   t   u   r   n       t   h   i   s   .   e   a   c   h   (   f   u   n   c   t   i   o   n   (   b   )   {   v   a   r       c   =   f   (   t   h   i   s   )   ;   c   [   d   ]   (   a   .   c   a   l   l   (   t   h   i   s   ,   b   ,   c   [   d   ]   (   )   )   )   }   )   ;   i   f   (   f   .   i   s   W   i   n   d   o   w   (   e   )   )   {   v   a   r       g   =   e   .   d   o   c   u   m   e   n   t   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   [   "   c   l   i   e   n   t   "   +   c   ]   ,   h   =   e   .   d   o   c   u   m   e   n   t   .   b   o   d   y   ;   r   e   t   u   r   n       e   .   d   o   c   u   m   e   n   t   .   c   o   m   p   a   t   M   o   d   e   =   =   =   "   C   S   S   1   C   o   m   p   a   t   "   &amp;   &amp;   g   |   |   h   &amp;   &amp;   h   [   "   c   l   i   e   n   t   "   +   c   ]   |   |   g   }   i   f   (   e   .   n   o   d   e   T   y   p   e   =   =   =   9   )   r   e   t   u   r   n       M   a   t   h   .   m   a   x   (   e   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   [   "   c   l   i   e   n   t   "   +   c   ]   ,   e   .   b   o   d   y   [   "   s   c   r   o   l   l   "   +   c   ]   ,   e   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   [   "   s   c   r   o   l   l   "   +   c   ]   ,   e   .   b   o   d   y   [   "   o   f   f   s   e   t   "   +   c   ]   ,   e   .   d   o   c   u   m   e   n   t   E   l   e   m   e   n   t   [   "   o   f   f   s   e   t   "   +   c   ]   )   ;   i   f   (   a   =   =   =   b   )   {   v   a   r       i   =   f   .   c   s   s   (   e   ,   d   )   ,   j   =   p   a   r   s   e   F   l   o   a   t   (   i   )   ;   r   e   t   u   r   n       f   .   i   s   N   u   m   e   r   i   c   (   j   )   ?   j   :   i   }   r   e   t   u   r   n       t   h   i   s   .   c   s   s   (   d   ,   t   y   p   e   o   f       a   =   =   "   s   t   r   i   n   g   "   ?   a   :   a   +   "   p   x   "   )   }   }   )   ,   a   .   j   Q   u   e   r   y   =   a   .   $   =   f   ,   t   y   p   e   o   f       d   e   f   i   n   e   =   =   "   f   u   n   c   t   i   o   n   "   &amp;   &amp;   d   e   f   i   n   e   .   a   m   d   &amp;   &amp;   d   e   f   i   n   e   .   a   m   d   .   j   Q   u   e   r   y   &amp;   &amp;   d   e   f   i   n   e   (   "   j   q   u   e   r   y   "   ,   [   ]   ,   f   u   n   c   t   i   o   n   (   )   {   r   e   t   u   r   n       f   }   )   }   )   (   w   i   n   d   o   w   )   ;      
   &lt;   /   s   c   r   i   p   t   &gt;      
      
   &lt;   /   h   e   a   d   &gt;      
   &lt;   b   o   d   y   &gt;      
      
      
   &lt;   s   c   r   i   p   t       t   y   p   e   =   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "   &gt;   &lt;   !   -   -      
           e   9       =       n   e   w       O   b   j   e   c   t   (   )   ;      
           e   9   .   n   o   A   d       =       1   ;      
           e   9   .   p   o   p   O   n   l   y       =       1   ;      
   /   /   -   -   &gt;   &lt;   /   s   c   r   i   p   t   &gt;      
   &lt;   s   c   r   i   p   t       t   y   p   e   =   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "       s   r   c   =   "   h   t   t   p   :   /   /   t   a   g   s   .   e   x   p   o   9   .   e   x   p   o   n   e   n   t   i   a   l   .   c   o   m   /   t   a   g   s   /   D   i   s   c   l   o   s   e   t   v   /   R   O   S   /   t   a   g   s   .   j   s   "   &gt;   &lt;   /   s   c   r   i   p   t   &gt;      
      
   &lt;   !   -   -       B   e   g   i   n   :       a   d   B   r   i   t   e   ,       G   e   n   e   r   a   t   e   d   :       2   0   1   1   -   1   0   -   0   3       1   4   :   2   7   :   2   4           -   -   &gt;      
   &lt;   s   c   r   i   p   t       t   y   p   e   =   "   t   e   x   t   /   j   a   v   a   s   c   r   i   p   t   "       s   r   c   =   "   h   t   t   p   :   /   /   a   d   s   .   a   d   b   r   i   t   e   .   c   o   m   /   m   b   /   t   e   x   t   _   g   r   o   u   p   .   p   h   p   ?   s   i   d   =   2   0   2   3   4   1   6   &amp;   b   r   =   1   "   &gt;   &lt;   /   s   c   r   i   p   t   &gt;      
   &lt;   !   -   -       E   n   d   :       a   d   B   r   i   t   e       -   -   &gt;      
      
      
      
   &lt;   d   i   v       c   l   a   s   s   =   "   h   e   a   d   e   r   "   &gt;      
      
                   &lt;   i   m   g       s   r   c   =   "   /   b   u   z   z   /   d   i   s   c   l   o   s   e   _   l   o   g   o   _   w   e   b   .   g   i   f   "       s   t   y   l   e   =   "   m   a   r   g   i   n   :       0       a   u   t   o       3   0   p   x       0   ;   "       a   l   t   =   "   D   i   s   c   l   o   s   e   .   t   v       L   o   g   o   "   &gt;      
      
   &lt;   p   &gt;   &lt;   f   o   n   t       c   o   l   o   r   =   "   r   e   d   "   &gt;   &lt;   b   &gt;   E   R   R   O   R       w   i   t   h       e   x   t   e   r   n   a   l       U   R   L   !       S   o   r   r   y   ,       c   a   n       n   o   t       r   e   d   i   r   e   c   t       y   o   u   .   &lt;   /   b   &gt;   &lt;   /   f   o   n   t   &gt;   &lt;   /   p   &gt;      
   &lt;   /   d   i   v   &gt;      
      
   &lt;   /   b   o   d   y   &gt;      
      
   &lt;   /   h   t   m   l   &gt;
  </style>
 </head>
</html>