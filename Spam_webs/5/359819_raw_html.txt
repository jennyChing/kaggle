<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="index,follow" name="robots"/>
  <meta content="Random topics Web related, IIS, .NET, SEO, Azure, Microsoft Cloud and more." name="description"/>
  <meta content="IIS,SEO,Web,Azure,.NET,Cloud" name="keywords"/>
  <meta content="Telligent Evolution Platform Developer Build (Build: 5.6.50428.7875)" name="GENERATOR"/>
  <link href="http://blogs.msdn.com/b/carlosag/pingback.aspx" rel="pingback"/>
  <link href="http://i1.blogs.msdn.com/rrcontent/7632fe1dd91290a46b3a118f9478cf1b-27cae0dd5641775697cb89e9a8587625-RequestReducedStyle.css" rel="Stylesheet" type="text/css"/>
  <link href="http://blogs.msdn.com/rss.aspx" rel="alternate" title="Site Home (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/CarlosAg/comments/rss.aspx" rel="alternate" title="CarlosAg's Comments (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/CarlosAg/activities/rss.aspx" rel="alternate" title="CarlosAg's Activities (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/CarlosAg/activities/followersrss.aspx" rel="alternate" title="Activities of People CarlosAg Follows (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/CarlosAg/activities/groupsrss.aspx" rel="alternate" title="CarlosAg's Groups Activities (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://feeds.feedburner.com/CarlosAg" rel="alternate" title="CarlosAg Blog (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://blogs.msdn.com/b/carlosag/rsscomments.aspx" rel="alternate" title="CarlosAg Blog - All Comments (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://blogs.msdn.com/b/carlosag/rsscomments.aspx?WeblogPostID=8918637" rel="alternate" title="IIS 7.0 and URL Rewrite, make your Web Site SEO - Comments for this post (RSS 2.0)" type="application/rss+xml"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <link href="/themes/MSDN2/favicon.ico" rel="shortcut icon" type="image/ico"/>
  <!--
            Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use  http://www.asp.net/ajaxlibrary/CDN.ashx.
          -->
  <link href="http://i1.blogs.msdn.com/rrcontent/6e455ee01481483d5d047db51a775dad-ffc9f7e1f0412800af51bef62a866f63-RequestReducedStyle.css" rel="Stylesheet" type="text/css"/>
  <script language="javascript" src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js" type="text/javascript">
  </script>
  <link href="/themes/MSDN2/css/DynamicStyle.aspx?PreviewKey=0" media="screen,print" rel="stylesheet" type="text/css"/>
  <link href="/themes/blogs/MSDN2/css/DynamicStyle.aspx?WeblogID=4933&amp;PreviewKey=0" media="screen,print" rel="stylesheet" type="text/css"/>
  <!--[if lte IE 6]&gt;
              &lt;link type="text/css" rel="stylesheet" href="/themes/MSDN2/css/ie6.css" media="screen,print" /&gt;
          &lt;![endif]-->
  <meta content="B717AD6FC29D3A844832AF011B5F9E4C" name="msvalidate.01"/>
  <link href="http://blogs.msdn.com/b/carlosag/rsd.ashx" rel="EditURI" title="RSD" type="application/rsd+xml"/>
  <link href="http://blogs.msdn.com/b/carlosag/wlwmanifest.ashx" rel="wlwmanifest" title="WLWManifest" type="application/wlwmanifest+xml"/>
  <!--
            Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use  http://www.asp.net/ajaxlibrary/CDN.ashx.
          -->
  <script language="javascript" src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js" type="text/javascript">
  </script>
  <title>
   IIS 7.0 and URL Rewrite, make your Web Site SEO - CarlosAg Blog - Site Home - MSDN Blogs
  </title>
 </head>
 <body spellcheck="true">
  <form action="/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx" id="aspnetForm" method="post" name="aspnetForm">
   <div>
    <input id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer" name="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer" type="hidden" value=""/>
    <input id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_encrypted" name="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_encrypted" type="hidden" value="J/tTQfB6RPyzHucV2pnJ/0A6j8XG41J7870IRIQ4zyk="/>
    <input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUKMTM5OTAxNDYyNWRkvI787cXLvh9XHlDReEjVejxzcZ4="/>
   </div>
   <script src="http://i1.blogs.msdn.com/rrcontent/4edef1267f1395bd62b445ccb12bfb8c-8a095e5b39e6369792015dc17f44b1cf-RequestReducedScript.js" type="text/javascript">
   </script>
   <div>
    <input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="84C00179"/>
   </div>
   <div class="header-fragments-header">
   </div>
   <div class="header-fragments">
    <div class="header-fragment-outer top-bar msdn-header-fragment-outer msdn-top-bar">
     <div class="header-fragment-inner top-bar msdn-header-fragment-inner msdn-top-bar">
      <div class="header-fragment welcome-message" id="header-fragment-1402503690">
       <!-- always render -->
      </div>
      <div class="header-fragment login-logout" id="header-fragment-1402503691">
       <div class="navigation-list-header">
       </div>
       <ul class="navigation-list">
        <li class="navigation-item">
         <span class="internal-link live-id-button" id="ctl00_header_fragment_1402503691__b7c54d_ctl00_ctl02_ctl05_WLIDLoginButton1">
          <a href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=12&amp;ct=1436900494&amp;rver=6.0.5286.0&amp;wp=MBI&amp;wreply=http:%2F%2Fblogs.msdn.com%2Fb%2Fcarlosag%2Farchive%2F2008%2F09%2F02%2Fiis7urlrewriteseo.aspx&amp;lc=1033&amp;id=271611">
           Sign in
          </a>
         </span>
        </li>
       </ul>
       <div class="navigation-list-footer">
       </div>
      </div>
      <div class="header-fragment user-welcome-without-login" id="header-fragment-1402503692">
       <!-- always render -->
      </div>
     </div>
    </div>
    <div class="header-fragment blog-banner" id="header-fragment-1402503693">
     <div class="site-banner blog-banner">
      <h1 class="blog-banner-name">
       <a href="/b/carlosag/">
        CarlosAg Blog
       </a>
      </h1>
     </div>
    </div>
   </div>
   <div class="header-fragments-footer">
   </div>
   <div class="content-fragment-page post" id="ctl00_content_ctl00_page">
    <div class="layout">
     <div class="layout-header">
     </div>
     <div class="layout-content content-left-sidebar-right" id="ctl00_content_ctl00_layout">
      <div class="layout-region right-sidebar" id="ctl00_content_ctl00_right-sidebar">
       <div class="layout-region-inner right-sidebar">
        <div class="content-fragment c-t-f-widget no-wrapper-with-spacing with-header" id="fragment-52310">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Translate This Page
           </div>
          </div>
          <div class="content-fragment-content">
           <!--
         
           localize text, such as translate this &amp; powered by 
           
           
            -->
           <div id="MicrosoftTranslatorWidget" style="width: 275px; min-height: 83px;
    border-color: #333333; background-color: #CCCCCC;">
            <noscript>
             <a href="http://www.microsofttranslator.com/bv.aspx?a=http%3a%2f%2fblogs.msdn.com%2f">
              Translate this
            page
             </a>
             <br/>
             Powered by
             <a href="http://www.microsofttranslator.com">
              Microsoft Translator
             </a>
            </noscript>
            <script type="text/javascript">
             setTimeout(function () {
            var s = document.createElement("script");
            s.type = "text/javascript";
            s.charset = "UTF-8";
            s.src = "http://www.microsofttranslator.com/Ajax/V2/Widget.aspx?siteData=ncUzpG6DNC3ChU0huEHZCFQbqrzCQRcTVqXdHso8P2KRGM-oFXjoeYwum3D31voFEyqUPj4HjacfvEdrHEyIG8CuATkNhQmRwcZkpGVFjvVnLd1gzFP2dxWEWKdcQtE1&amp;mode=manual&amp;from=en-us&amp;layout=ts";
            var p = document.getElementsByTagName('head')[0] || document.documentElement; p.insertBefore(s, p.firstChild);
        }, 0);
            </script>
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment blog-links no-wrapper-with-spacing with-header" id="fragment-52311">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Options
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="navigation-list-header">
           </div>
           <ul class="navigation-list">
            <li class="navigation-item">
             <a class="internal-link view-application" href="/b/carlosag/">
              <span>
              </span>
              Blog Home
             </a>
            </li>
            <li class="navigation-item">
             <a class="internal-link view-contact" href="/b/carlosag/contact.aspx">
              <span>
              </span>
              Email Blog Author
             </a>
            </li>
            <li class="navigation-item">
             <a class="internal-link email-post" href="mailto:?subject=IIS 7.0 and URL Rewrite, make your Web Site SEO&amp;body=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx">
              <span>
              </span>
              Share this
             </a>
            </li>
            <li class="navigation-item">
             <a class="internal-link rss" href="http://feeds.feedburner.com/CarlosAg">
              <span>
              </span>
              RSS for posts
             </a>
            </li>
            <li class="navigation-item">
             <a class="internal-link rss" href="http://feeds.feedburner.com/CarlosAg">
              <span>
              </span>
              Atom
             </a>
            </li>
            <li class="navigation-item" id="" rsscomments="">
             <a class="internal-link rss" href="/b/carlosag/rsscomments.aspx">
              <span>
              </span>
              RSS for comments
             </a>
            </li>
           </ul>
           <div class="navigation-list-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment search-form no-wrapper-with-spacing with-header" id="fragment-52312">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Search
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="field-list-header">
           </div>
           <fieldset class="field-list">
            <ul class="field-list">
             <li class="field-item search">
              <div id="search-allblogs-container">
               <span class="field-item-input">
                <input autocomplete="off" class="searchField" id="SearchTextBox_AllBlogs" maxlength="64" name="SearchTextBox_AllBlogs" size="45" type="text"/>
                <input class="search-button" id="SearchButton_AllBlogs" name="SearchButton_AllBlogs" type="button"/>
               </span>
              </div>
              <div id="search-thisblog-container">
               <span class="field-item-input">
                <input autocomplete="off" class="searchField" id="SearchTextBox_ThisBlog" maxlength="64" name="SearchTextBox_ThisBlog" size="45" type="text"/>
                <input class="search-button" id="SearchButton_ThisBlog" name="SearchButton_ThisBlog" type="button"/>
               </span>
              </div>
             </li>
            </ul>
           </fieldset>
           <div class="field-list-footer">
            <div id="search-switch-container">
             <span style="display: inline-block">
              <input checked="checked" id="ThisBlog" name="SearchTypeRadio" type="radio" value="ThisBlog"/>
              <label for="ThisBlog" id="ThisBlogText">
               Search this blog
              </label>
             </span>
             <span style="display: inline-block">
              <input id="AllBlogs" name="SearchTypeRadio" type="radio" value="AllBlogs"/>
              <label for="AllBlogs" id="AllBlogsText">
               Search all blogs
              </label>
             </span>
            </div>
           </div>
           <script type="text/javascript">
            var elmSearchAll = $('#search-allblogs-container').hide();
var elmSearchThis = $('#search-thisblog-container');

// try to get the blog id, if we fail, then we aren't on a blog and just use the regular search approach       
(4933 === -1) &amp;&amp; $('#search-switch-container').hide();

$(document).ready(function() {
    $('#ThisBlog').click(function () {
        var self = $(this);
        if (self.is(':checked')) {
            elmSearchAll.hide();
            elmSearchThis.show();
        }
    });
    
    $('#AllBlogs').click(function () {
        var self = $(this);
        if (self.is(':checked')) {
            elmSearchThis.hide();
            elmSearchAll.show();
        }
    });
});
           </script>
           <script language="javascript" src="http://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=SearchTextBox_AllBlogs&amp;btnid=SearchButton_AllBlogs&amp;brand=MSDN&amp;refinement=109&amp;resref=&amp;addEnglish=&amp;rn=&amp;rq=&amp;watermark=&amp;focusOnInit=false&amp;beta=0&amp;iroot=&amp;overrideWatermark=false" type="text/javascript">
           </script>
           <script language="javascript" src="http://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=SearchTextBox_ThisBlog&amp;btnid=SearchButton_ThisBlog&amp;brand=MSDN&amp;refinement=&amp;resref=&amp;addEnglish=&amp;watermark=&amp;focusOnInit=false&amp;beta=0&amp;iroot=&amp;overrideWatermark=false&amp;rn=CarlosAg%2bBlog&amp;rq=site:blogs.msdn.com/b/carlosag/" type="text/javascript">
           </script>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment tag-cloud no-wrapper-with-spacing with-header" id="fragment-52313">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Tags
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="tag-list-header">
           </div>
           <ul class="tag-list">
            <li class="tag-item level-2">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/-NET/" rel="tag">
              .NET
             </a>
            </li>
            <li class="tag-item level-4">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/ARR/" rel="tag">
              ARR
             </a>
            </li>
            <li class="tag-item level-4">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/ASP-NET/" rel="tag">
              ASP.NET
             </a>
            </li>
            <li class="tag-item level-6">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/Debugging/" rel="tag">
              Debugging
             </a>
            </li>
            <li class="tag-item level-1">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/IIS/" rel="tag">
              IIS
             </a>
            </li>
            <li class="tag-item level-1">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/IIS+Manager/" rel="tag">
              IIS Manager
             </a>
            </li>
            <li class="tag-item level-3">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/IIS+News+Item/" rel="tag">
              IIS News Item
             </a>
            </li>
            <li class="tag-item level-6">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/LogicApps/" rel="tag">
              LogicApps
             </a>
            </li>
            <li class="tag-item level-2">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/Microsoft-Web-Administration/" rel="tag">
              Microsoft.Web.Administration
             </a>
            </li>
            <li class="tag-item level-6">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/Personal/" rel="tag">
              Personal
             </a>
            </li>
            <li class="tag-item level-1">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/SEO/" rel="tag">
              SEO
             </a>
            </li>
            <li class="tag-item level-3">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/URL+Rewrite/" rel="tag">
              URL Rewrite
             </a>
            </li>
            <li class="tag-item level-6">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/Windows+Azure/" rel="tag">
              Windows Azure
             </a>
            </li>
            <li class="tag-item level-6">
             <a href="http://blogs.msdn.com/b/carlosag/archive/tags/WinForms/" rel="tag">
              WinForms
             </a>
            </li>
           </ul>
           <div class="tag-list-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment blog-archive-list no-wrapper-with-spacing with-header" id="fragment-52314">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Archive
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="content-list-header">
           </div>
           <div class="content-list-name">
            Archives
           </div>
           <ul class="content-list">
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2015/05.aspx">
              May 2015
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2014/11.aspx">
              November 2014
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2014/10.aspx">
              October 2014
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2012/07.aspx">
              July 2012
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2012/03.aspx">
              March 2012
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2011/12.aspx">
              December 2011
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2011/08.aspx">
              August 2011
             </a>
             (3)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2011/01.aspx">
              January 2011
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/11.aspx">
              November 2010
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/10.aspx">
              October 2010
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/05.aspx">
              May 2010
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/04.aspx">
              April 2010
             </a>
             (3)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/03.aspx">
              March 2010
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2010/02.aspx">
              February 2010
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/11.aspx">
              November 2009
             </a>
             (9)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/10.aspx">
              October 2009
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/09.aspx">
              September 2009
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/07.aspx">
              July 2009
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/06.aspx">
              June 2009
             </a>
             (6)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2009/02.aspx">
              February 2009
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/11.aspx">
              November 2008
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/10.aspx">
              October 2008
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/09.aspx">
              September 2008
             </a>
             (4)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/08.aspx">
              August 2008
             </a>
             (3)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/07.aspx">
              July 2008
             </a>
             (5)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/06.aspx">
              June 2008
             </a>
             (4)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/05.aspx">
              May 2008
             </a>
             (3)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/04.aspx">
              April 2008
             </a>
             (4)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/03.aspx">
              March 2008
             </a>
             (6)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/02.aspx">
              February 2008
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2008/01.aspx">
              January 2008
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/12.aspx">
              December 2007
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/11.aspx">
              November 2007
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/10.aspx">
              October 2007
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/09.aspx">
              September 2007
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/06.aspx">
              June 2007
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/05.aspx">
              May 2007
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/03.aspx">
              March 2007
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2007/02.aspx">
              February 2007
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2006/08.aspx">
              August 2006
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2006/06.aspx">
              June 2006
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2006/05.aspx">
              May 2006
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2006/04.aspx">
              April 2006
             </a>
             (2)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2005/11.aspx">
              November 2005
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2005/09.aspx">
              September 2005
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2005/08.aspx">
              August 2005
             </a>
             (1)
            </li>
            <li class="content-item">
             <a class="internal-link view-post-archive-list" href="/b/carlosag/archive/2005/07.aspx">
              July 2005
             </a>
             (1)
            </li>
           </ul>
           <div class="content-list-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="layout-region content" id="ctl00_content_ctl00_content">
       <div class="layout-region-inner content">
        <div class="content-fragment blog-title full-border" id="fragment-52315">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-content">
           <h1 class="title">
            IIS 7.0 and URL Rewrite, make your Web Site SEO
           </h1>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment blog-bread-crumbs no-wrapper" id="fragment-52316">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="breadcrumb-list-header">
           </div>
           <div class="breadcrumb-list">
            <span class="breadcrumb-item">
             <a class="internal-link view-home" href="/">
              MSDN Blogs
             </a>
            </span>
            <span class="separator">
             &gt;
            </span>
            <span class="breadcrumb-item">
             <a href="/b/carlosag/">
              CarlosAg Blog
             </a>
            </span>
            <span class="separator">
             &gt;
            </span>
            <span class="breadcrumb-item">
             <a href="/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx">
              IIS 7.0 and URL Rewrite, make your Web Site SEO
             </a>
            </span>
           </div>
           <div class="breadcrumb-list-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment blog-post no-wrapper" id="fragment-52317">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-content">
           <div class="full-post-header">
           </div>
           <div class="full-post">
            <h3 class="post-name">
             IIS 7.0 and URL Rewrite, make your Web Site SEO
            </h3>
            <div class="post-author">
             <span class="avatar">
              <a href="/8578/ProfileUrlRedirect.ashx">
               <img alt="" src="http://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=carlosag&amp;size=large" style="border-width:0px;max-height:32px;max-width:32px;"/>
              </a>
             </span>
             <span class="profile-usercard-hover" data-profile-userid="5cde3bab-8912-4270-8ebc-2df25fc0ef62">
              <span class="user-name">
               <a class="internal-link view-user-profile" href="/8578/ProfileUrlRedirect.ashx">
                <span>
                </span>
                CarlosAg
               </a>
              </span>
             </span>
            </div>
            <div class="post-date">
             <span class="value">
              2 Sep 2008 2:00 AM
             </span>
            </div>
            <div class="post-attributes">
             <div class="attribute-list-header">
             </div>
             <ul class="attribute-list">
              <li class="attribute-item post-reply-count">
               <span class="attribute-name">
                Comments
               </span>
               <span class="attribute-value">
                <a class="internal-link view-replies" href="#comments">
                 <span>
                 </span>
                 29
                </a>
               </span>
              </li>
             </ul>
             <div class="attribute-list-footer">
             </div>
            </div>
            <div class="post-content user-defined-markup">
             <p>
              In the past few days I've been reading a bit about SEO and trying to understand more about what makes a Web Site be SEO (Search-Engine-Optimized) and what are some of the typical headaches when trying to achieve that as well as how we can implement them in IIS.
             </p>
             <p>
              Today I decided to post how you can make your Web Site running IIS 7.0 a bit "friendlier" to Search Engines without having to modify any code in your application. Being SEO is a big statement since it can include several things, so for now I will scope the discussion to 3 things that can be easily addressed using the
              <a href="http://learn.iis.net/page.aspx/460/using-url-rewrite-module/" mce_href="http://learn.iis.net/page.aspx/460/using-url-rewrite-module/" target="_blank">
               IIS URL Rewrite Module
              </a>
              :
             </p>
             <ol>
              <li>
               Canonicalization
              </li>
              <li>
               Friendly URL's
              </li>
              <li>
               Site Reorganization
              </li>
             </ol>
             <h2>
              1) Canonicalization
             </h2>
             <p>
              Basically the goal of canonicalization is to ensure that the content of a page is only exposed as a unique URI. The reason this is important is because even though for humans it's easy to tell that
              <a href="http://www.carlosag.net/" mce_href="http://www.carlosag.net">
               http://www.carlosag.net
              </a>
              is the same as
              <a href="http://carlosag.net/" mce_href="http://carlosag.net">
               http://carlosag.net
              </a>
              , many search engines will not make any assumptions and keep them as two separate entries, potentially splitting the rankings of them lowering their relevance. Another example of this is
              <a href="http://www.carlosag.net/default.aspx" mce_href="http://www.carlosag.net/default.aspx">
               http://www.carlosag.net/default.aspx
              </a>
              and
              <a href="http://www.carlosag.net/" mce_href="http://www.carlosag.net/">
               http://www.carlosag.net/
              </a>
              . You can certainly minimize the impact of this by writing your application using the canonical forms of your links, for example in your links you can always link to the right content for example:
              <a href="http://www.carlosag.net/tools/webchart/" mce_href="http://www.carlosag.net/tools/webchart/">
               http://www.carlosag.net/tools/webchart/
              </a>
              and remove the default.aspx, however that only accounts for part of the equation since you cannot assume everyone referencing your Web Site will follow this carefully, you cannot control their links.
             </p>
             <p>
              This is when URL Rewrite comes into play and truly solves this problem.
             </p>
             <h3>
              Host name.
             </h3>
             <p>
              URL Rewrite can help you redirect when the users type your URL in a way you don't unnecessarily want them to, for example just carlosag.net. Choosing between using WWW or not is a matter of taste but once you choose one you should ensure that you guide everyone to the right one. The following rule will automatically redirect everyone using just carlosag.net to
              <a href="http://www.carlosag.net/" mce_href="http://www.carlosag.net">
               www.carlosag.net
              </a>
              . This configuration can be saved in the Web.config file in the root of your Web Site.Note that I'm only including the XML in this blog, however I used IIS Manager to generate all of these settings so you don't need to memorize the XML schema since the UI includes several friendly capabilities to generate all of these..
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               configuration
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               system.webServer
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Redirect to WWW"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               =".*"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{HTTP_HOST}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="^carlosag.net$"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="http://www.carlosag.net/{R:0}"
              </font>
              <font color="#ff0000">
               redirectType
              </font>
              <font color="#0000ff">
               ="Permanent"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               system.webServer
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               configuration
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              Note that one important thing is to use Permanent redirects (301) , this will ensure that if anybody links your page using a non-WWW link when the search engine bot crawls their Web Site it will identify the link as permanently moved and it will treat the new URL as the correct address and it will not index the old URL, which is the case when using Temporary (302) redirects. The following shows how the response of the server looks like:
             </p>
             <div class="code">
              HTTP/1.1
              <strong>
               301 Moved Permanently
              </strong>
              <br/>
              Content-Type: text/html; charset=UTF-8
              <br/>
              Location:
              <a href="http://www.carlosag.net/tools/" mce_href="http://www.carlosag.net/tools/">
               http://www.carlosag.net/tools/
              </a>
              <br/>
              Server: Microsoft-IIS/7.0
              <br/>
              X-Powered-By: ASP.NET
              <br/>
              Date: Mon, 01 Sep 2008 22:45:49 GMT
              <br/>
              Content-Length: 155
              <br/>
              <br/>
              &lt;head&gt;&lt;title&gt;Document Moved&lt;/title&gt;&lt;/head&gt;
              <br/>
              &lt;body&gt;&lt;h1&gt;Object Moved&lt;/h1&gt;This document may be found &lt;a HREF=http://www.carlosag.net/tools/&gt;here&lt;/a&gt;&lt;/body&gt;
             </div>
             <h3>
              Default Documents
             </h3>
             <p>
              IIS has a feature called Default Document that allows you to specify the content that should be processed when a user enters a URL that is mapped to a directory and not an actual file. In other words, if the user enters
              <a href="http://www.carlosag.net/tools/" mce_href="http://www.carlosag.net/tools/">
               http://www.carlosag.net/tools/
              </a>
              then they will actually get the content as if they entered
              <a href="http://www.carlosag.net/tools/default.aspx" mce_href="http://www.carlosag.net/tools/default.aspx">
               http://www.carlosag.net/tools/default.aspx
              </a>
              . That is all great, the problem is that this feature only works one way by mapping a Directory to a File, however it does not map the File to the Document, this means that if some of your links or other users enter the full URL, then search engines will see two different URL's. To solve that problem we can use a configuration very similar to the rule above, following is a rule that will redirect the default.aspx to the canonical URL (the folder).
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Default Document"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="(.*)default.aspx"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="{R:1}"
              </font>
              <font color="#ff0000">
               redirectType
              </font>
              <font color="#0000ff">
               ="Permanent"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              This again, uses a Permanent redirect to extract everything before Default.aspx and redirect it to the "parent" URL path, so for example, if the user enters
              <a href="http://www.carlosag.net/Tools/WindowsLiveWriter/default.aspx" mce_href="http://www.carlosag.net/Tools/WindowsLiveWriter/default.aspx" title="http://www.carlosag.net/Tools/WindowsLiveWriter/">
               http://www.carlosag.net/Tools/WindowsLiveWriter/default.aspx
              </a>
              it will be redirected to
              <a href="http://www.carlosag.net/Tools/WindowsLiveWriter/" mce_href="http://www.carlosag.net/Tools/WindowsLiveWriter/" title="http://www.carlosag.net/Tools/WindowsLiveWriter/">
               http://www.carlosag.net/Tools/WindowsLiveWriter/
              </a>
              as well as
              <a href="http://www.carlosag.net/Tools/default.aspx" mce_href="http://www.carlosag.net/Tools/default.aspx" title="http://www.carlosag.net/Tools/">
               http://www.carlosag.net/Tools/default.aspx
              </a>
              to
              <a href="http://www.carlosag.net/Tools/" mce_href="http://www.carlosag.net/Tools/" title="http://www.carlosag.net/Tools/">
               http://www.carlosag.net/Tools/
              </a>
              . You can place this rule at the root of your site and it will take care of all the default documents (if you have a default.aspx in every folder)
             </p>
             <h2>
              2) Friendly URL's
             </h2>
             <p>
              Asking your user to remember that
              <a href="http://www.contoso.com/books.aspx?isbn=0735624410" mce_href="http://www.contoso.com/books.aspx?isbn=0735624410">
               www.contoso.com/books.aspx?isbn=
               <strong>
                0735624410
               </strong>
              </a>
              is the URL for the IIS Resource Kit is not the nicest thing to do, first of all why do they care about this being an ASPX and the fact that it takes arguments and what not. It seems that providing them with a URL like
              <a href="http://www.contoso.com/books/IISResourceKit" mce_href="http://www.contoso.com/books/IISResourceKit">
               www.contoso.com/books/IISResourceKit
              </a>
              will truly resonate with them and be easier for them to remember and pass along. Most importantly it really doesn't tie you to any Web technology.
             </p>
             <p>
              With URL Rewrite you can easily build this kind of logic automatically without having to modify your code using Rewrite Maps:
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               configuration
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               system.webServer
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Rewrite for Books"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="Books/(.+)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Rewrite"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="books.aspx?isbn={Books:{R:1}}"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Books"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="IISResourceKit"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="0735624410"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="ProfessionalIIS7"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="0470097825"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="IIS7AdministratorsPocketConsultant"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="0735623643"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="IIS7ImplementationandAdministration"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="0470178930"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               system.webServer
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               configuration
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              The configuration above includes a rule that uses a Rewrite Map to translate a URL like:
              <a href="http://www.contoso.com/books/IISResourceKit" mce_href="http://www.contoso.com/books/IISResourceKit">
               http://www.contoso.com/books/IISResourceKit
              </a>
              into
              <a href="http://www.contoso.com/books.aspx?isbn=0735624410" mce_href="http://www.contoso.com/books.aspx?isbn=0735624410">
               http://www.contoso.com/books.aspx?isbn=0735624410
              </a>
              automatically. Using maps is a very convenient way to have a "table" of values that can be transformed into any other value to be used in the result URL. Of course there are better ways of doing this when using large catalogs or values that change frequently but is extremely useful when you have a consistent set of values or when you can't make changes to an existing application. Note that since we use Rewrite the end users never see the "ugly-URL" unless they knew it already and typed it, and of course this means you can use the inverse approach to ensure the canonicalization is preserved:
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Redirect Books to Canonical URL"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="books\.aspx"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="Books/{ISBN:{C:1}}"
              </font>
              <font color="#ff0000">
               appendQueryString
              </font>
              <font color="#0000ff">
               ="false"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{QUERY_STRING}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="isbn=(.+)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="ISBN"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="0735624410"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="IISResourceKit"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="0470097825"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="ProfessionalIIS7"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="0735623643"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="IIS7AdministratorsPocketConsultant"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="0470178930"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="IIS7ImplementationandAdministration"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              The rule above does the "inverse" by matching the URL books.aspx, extracting the ISBN query string value and doing a lookup in the ISBN table and redirecting the client to the canonical URL, so again if user enters
              <a href="http://www.contoso.com/books.aspx?isbn=0735624410" mce_href="http://www.contoso.com/books.aspx?isbn=0735624410">
               http://www.contoso.com/books.aspx?isbn=0735624410
              </a>
              they will be redirected to
              <a href="http://www.contoso.com/books/IISResourceKit" mce_href="http://www.contoso.com/books/IISResourceKit">
               http://www.contoso.com/books/IISResourceKit
              </a>
              .
             </p>
             <p>
              This Friendly URL to me is more of a user feature than a SEO feature, however I've read in every SEO guide to reduce the number of parameters in your Query String, however, I have not find yet any document that clearly states if there is truly a limit in the search engine bot's that would truly impact the search relevance. I guess it makes sense that they wouldn't keep track of thousands of links to a catalog.aspx that has zillions of permutations based on hundreds of values in the query string (category, department, price range, etc) even if all of them were linked, but again I don't have any prove.
             </p>
             <h2>
              3) Site Reorganization
             </h2>
             <p>
              One complex tasks that Web Developers face sometimes is trying to reorganize their current Web Site structure, whether its moving a section to a different path, or something as simple as renaming a single file, you need to take into consideration things like, Is this move a temporary thing?, How do I ensure old clients get the new URL?, How do I prevent losing the search engine relevance?. URL Rewrite will help you perform these tasks.
             </p>
             <h3>
              Rename a file
             </h3>
             <p>
              If you rename a file you can very easily just write a Rewrite or Redirect Rule that ensures that your users continue getting the content. If your intent is to never go back to the old name you should use a Redirect Permanent so everyone starts getting the new content with its new "Canonical URL", however, if this could be a temporary thing you should use a Redirect Temporary. Finally a Rewrite is useful if you still want both URL's to continue to be valid (though this breaks the
              <em>
               canonicality
              </em>
              ).
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Rename File.php to MyFile.aspx"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="File\.php"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="MyFile.aspx"
              </font>
              <font color="#ff0000">
               redirectType
              </font>
              <font color="#0000ff">
               ="Permanent"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <h3>
              Moving directories
             </h3>
             <p>
              Another common scenario is when you need to move an entire directory to another place of the Web Site. It could also be that based on some criteria (say Mobile browsers or other User Agent) get a different set of pages/images. Either way, URL rewrite helps with this. The following configuration will redirect every call to the /Images directory to the /NewImages directory.
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Move Images to NewImages"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="^images/(.*)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="NewImages/{R:1}"
              </font>
              <font color="#ff0000">
               redirectType
              </font>
              <font color="#0000ff">
               ="Permanent"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              A related scenario is if you wanted to show different smaller images whenever a user of Windows CE was accessing your site, you could have a "img" directory where all the small images are stored and use a rule like the following:
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Use Small Images for Windows CE"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="^images/(.*)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Rewrite"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="/img/{R:1}"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{HTTP_USER_AGENT}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="Windows CE"
              </font>
              <font color="#ff0000">
               ignoreCase
              </font>
              <font color="#0000ff">
               ="false"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              Note, that in this case the use of Rewrite makes sense since we want the small images to look as the original images to the browser and it will save a "round-trip" to it.
             </p>
             <h3>
              Moving multiple files
             </h3>
             <p>
              Another common operation is when you randomly need to relocate pages for whatever reason (such as Marketing Campaigns, Branding, etc). In this case if you have several files that have been moved or renamed you can have a single rule that catches all of those and redirects them accordingly. Similarly, another sample could include an incremental migration from one technology to another where say you are moving from Classic ASP to ASP.NET and as you rewrite some of the old ASP pages into ASPX pages you want to start serving them without breaking any links or the search engine relevance.
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Redirect Old Files and Broken Links"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               =".*"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{OldFiles:{REQUEST_URI}}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="(.+)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Redirect"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="{C:0}"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="OldFiles"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/tools/WebChart/sample.asp"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="tools/WebChart/sample.aspx"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/tools/default.asp"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="tools/"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/images/brokenlink.jpg"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="/images/brokenlink.png"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              Now, you can just keep adding to this table any broken link and specify its new address.
             </p>
             <h2>
              Others
             </h2>
             <p>
              Other potential use of URL Rewrite is when using RIA applications in the browser, whether using things like AJAX, Silverlight or Flash, that are not easy to parse and index by search engines, you could use URL Rewrite to rewrite the URL to static HTML versions of your content, however you should make sure that the content is consistent so you don't misguide users and search engines. For example the following rule will rewrite all the files in the RIAFiles table to their static HTML counterpart but only if the User Agent is the MSNBot or the GoogleBot:
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Rewrite RIA Files"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               =".*"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{HTTP_USER_AGENT}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="MSNBot|Googlebot"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{RIAFiles:{REQUEST_URI}}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="(.+)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="Rewrite"
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               ="{C:0}"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="RIAFiles"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/samples/Silverlight.aspx"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="/samples/Silverlight.htm"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/samples/MyAjax.aspx"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="/samples/MyAjax.htm"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              Related to this is that you might want to prevent search engines from crawling certain files (or your entire site), for that, you can use the Robots.txt semantics and use a "disallow", however, you can also use URL Rewrite to prevent this with more functionality such as blocking only a specific user agent:
             </p>
             <div class="code">
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="Prevent access to files"
              </font>
              <font color="#ff0000">
               stopProcessing
              </font>
              <font color="#0000ff">
               ="true"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               match
              </font>
              <font color="#ff0000">
               url
              </font>
              <font color="#0000ff">
               =".*"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{HTTP_USER_AGENT}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="SomeRandomBot"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               input
              </font>
              <font color="#0000ff">
               ="{NonIndexedFiles:{REQUEST_URI}}"
              </font>
              <font color="#ff0000">
               pattern
              </font>
              <font color="#0000ff">
               ="(.+)"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               conditions
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               action
              </font>
              <font color="#ff0000">
               type
              </font>
              <font color="#0000ff">
               ="AbortRequest"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rule
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rules
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#ff0000">
               name
              </font>
              <font color="#0000ff">
               ="NonIndexedFiles"&gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/profile.aspx"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="block"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;
              </font>
              <font color="#800000">
               add
              </font>
              <font color="#ff0000">
               key
              </font>
              <font color="#0000ff">
               ="/personal.aspx"
              </font>
              <font color="#ff0000">
               value
              </font>
              <font color="#0000ff">
               ="block"
              </font>
              <font color="#ff0000">
              </font>
              <font color="#0000ff">
               /&gt;
               <br/>
               &lt;/
              </font>
              <font color="#800000">
               rewriteMap
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewriteMaps
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
               <br/>
              </font>
              <font color="#0000ff">
               &lt;/
              </font>
              <font color="#800000">
               rewrite
              </font>
              <font color="#0000ff">
               &gt;
              </font>
              <font color="#000000">
              </font>
             </div>
             <p>
              There are several other things you can do to ensure that your Web Site is friendly with Search Engines, however most of them require changes to your application, but certainly worth the effort, for example:
             </p>
             <ul>
              <li>
               Ensure your HTML includes a &lt;title&gt; tag.
              </li>
              <li>
               Ensure your HTML includes a &lt;meta name="description".
              </li>
              <li>
               Use the correct HTML semantics, use H1 once and only once, use the alt attribute in your &lt;img&gt;, use &lt;noscript&gt; etc.
              </li>
              <li>
               Redirect using status code 301 and not 302.
              </li>
              <li>
               Provide Site Map's and/or Robots.txt.
              </li>
              <li>
               Beware of POST backs and links that require script to run.
              </li>
             </ul>
             <h2>
              Resources
             </h2>
             <p>
              For this entry I read and used some of the resources at several Web Sites, including:
             </p>
             <ul>
              <li>
               <a href="http://blogs.msdn.com/webmaster/" mce_href="http://blogs.msdn.com/webmaster/" title="http://blogs.msdn.com/webmaster/">
                http://blogs.msdn.com/webmaster/
               </a>
              </li>
              <li>
               <a href="http://webmaster.live.com/" mce_href="http://webmaster.live.com/" title="http://webmaster.live.com/">
                http://webmaster.live.com/
               </a>
              </li>
              <li>
               <a href="http://www.robotstxt.org/" mce_href="http://www.robotstxt.org/" title="http://www.robotstxt.org/">
                http://www.robotstxt.org/
               </a>
              </li>
              <li>
               <a href="http://www.sitemaps.org/" mce_href="http://www.sitemaps.org/" title="http://www.sitemaps.org/">
                http://www.sitemaps.org/
               </a>
              </li>
             </ul>
            </div>
            <div class="post-attachment-viewer">
            </div>
            <div class="post-actions">
             <div class="navigation-list-header">
             </div>
             <ul class="navigation-list">
              <!-- -->
              <li class="navigation-item">
               <a class="internal-link view-replies" href="/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx#comments">
                <span>
                </span>
                29 Comments
               </a>
              </li>
             </ul>
             <div class="navigation-list-footer">
             </div>
            </div>
            <div class="post-tags">
             <div id="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Container" style="display: none;">
              <div class="tags-editor">
               <textarea cols="30" id="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Tags" rows="2" style="width: 97%; height: 100%;">
               </textarea>
               <div style="white-space: nowrap; padding-top: 4px;">
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                 <tr>
                  <td align="left">
                   <input onclick="Telligent_Modal.Open('\/utility\/TagSelector.aspx?TagEditor=ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_TagEditor',400,300,null);;return false;" type="button" value="Select Tags..."/>
                  </td>
                  <td align="right">
                   <input onclick="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01.Save(); return false;" type="button" value="Save"/>
                   <input onclick="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01.Close(); return false;" type="button" value="Cancel"/>
                  </td>
                 </tr>
                </table>
               </div>
              </div>
             </div>
             <span id="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02">
              <a href="http://blogs.msdn.com/b/carlosag/archive/tags/IIS/" rel="tag">
               IIS
              </a>
              ,
              <a href="http://blogs.msdn.com/b/carlosag/archive/tags/URL+Rewrite/" rel="tag">
               URL Rewrite
              </a>
             </span>
             <input id="ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02_State" name="ctl00$content$ctl00$w_52317$_b7c54d$ctl00$ctl15$ctl02" type="hidden" value="nochange"/>
            </div>
           </div>
           <div class="full-post-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment social-media-sharing no-wrapper" id="fragment-52318">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-content">
           <script src="http://i1.blogs.msdn.com/rrcontent/47499858c4077d6e043f7add14000981-e99ec8f3b45f97b38095df2708dc5898-RequestReducedScript.js" type="text/javascript">
           </script>
           <div class="ShareThisMainPanel">
            <div class="ShareThis_ChildRootPanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_a4486f3e_e1d1_4b39_bb6f_10afec6a5a7f" onmouseout="ShareThisChildRootPanelOnmouseOut(this.id);" onmouseover="ShareThisChildRootPanelOnmouseOver(this.id);">
             <div class="tierOnePanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_ShareThisBtnCollPanel_97f7f8ebec7c452f9b9f7fd7353f56d5">
              <div class="buttonPanel">
               <a class="iconsOnPanel" href="http://www.facebook.com/sharer.php?u=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;t=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on Facebook">
                <img src="/CustomWidgets/SocialMediaSharingUC/Resources/facebook.gif" style="border-width:0px;" title="Share on Facebook"/>
               </a>
              </div>
              <div class="buttonPanel">
               <a class="iconsOnPanel" href="http://twitter.com/home?status=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO : http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx" target="_blank" title="Share on Twitter">
                <img src="/CustomWidgets/SocialMediaSharingUC/Resources/twitter.gif" style="border-width:0px;" title="Share on Twitter"/>
               </a>
              </div>
              <div class="buttonPanel">
               <a class="iconsOnPanel" href="http://digg.com/submit?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on Digg">
                <img src="/CustomWidgets/SocialMediaSharingUC/Resources/digg.gif" style="border-width:0px;" title="Share on Digg"/>
               </a>
              </div>
              <div class="buttonPanel">
               <a class="iconsOnPanel" href="http://del.icio.us/post?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on del.icio.us">
                <img src="/CustomWidgets/SocialMediaSharingUC/Resources/delicious.gif" style="border-width:0px;" title="Share on del.icio.us"/>
               </a>
              </div>
             </div>
             <div class="tierTwoPanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_ShareThisBtnCollPanel_e545c1c5e4404ebcbacddc149973f13d" onclick="TierTwoPanelOnclick(this.id);" onkeypress="if (event.keyCode == 13) TierTwoPanelOnclick(this.id);" onmouseout="TierTwoPanelOnmouseOut(this.id);" onmouseover="TierTwoPanelOnmouseOver(this.id);">
              <div class="tierTwoRowPanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_ShareThisBtnCollPanel_4dff74a4f4194cb599471739eed165c4">
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://www.reddit.com/submit?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on Reddit">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/reddit.gif" style="border-width:0px;" title="Share on Reddit"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://www.linkedin.com/shareArticle?mini=true&amp;ro=true&amp;url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO&amp;summary=&amp;source=Microsoft&amp;armin=armin" target="_blank" title="Share on LinkedIn">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/linkedin.gif" style="border-width:0px;" title="Share on LinkedIn"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://slashdot.org/bookmark.pl?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on Slashdot">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/slashdot.gif" style="border-width:0px;" title="Share on Slashdot"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://www.myspace.com/Modules/PostTo/Pages/?u=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;t=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on MySpace">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/myspace.gif" style="border-width:0px;" title="Share on MySpace"/>
                </a>
               </div>
              </div>
              <div class="tierTwoRowPanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_ShareThisBtnCollPanel_5d597bd3b75849a4ae75304c27d462e4">
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://technorati.com/faves/?add=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx" target="_blank" title="Share on Technorati">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/technorati.gif" style="border-width:0px;" title="Share on Technorati"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://friendfeed.com/?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on FriendFeed">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/friendfeed.gif" style="border-width:0px;" title="Share on FriendFeed"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://profile.live.com/badge?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on Messenger">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/messenger.png" style="border-width:0px;" title="Share on Messenger"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://www.stumbleupon.com/submit?url=http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx&amp;title=IIS+7.0+and+URL+Rewrite%2c+make+your+Web+Site+SEO" target="_blank" title="Share on StumbleUpon">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/stumbleupon.gif" style="border-width:0px;" title="Share on StumbleUpon"/>
                </a>
               </div>
              </div>
             </div>
            </div>
            <div class="ShowMoreLessButtonsPanel" id="ctl00_content_ctl00_w_52318__b7c54d_ctl00_ShowMoreLessButtonsPanel_5877eca0_7f2f_4c4a_8493_de1900fd6d81" onclick="ShowMoreLessButtonsPanelOnClick(this.id);" onkeypress="if (event.keyCode == 13) ShowMoreLessButtonsPanelOnClick(this.id);" onmouseout="ShowMoreLessButtonsPanelOnmouseOut(this.id);" onmouseover="ShowMoreLessButtonsPanelOnmouseOver(this.id);" tabindex="1">
             <a class="buttonMoreLess" id="btn_more">
              <img border="0" src="/CustomWidgets/SocialMediaSharingUC/Resources/more.gif" title="More"/>
             </a>
             <a class="buttonMoreLess" id="btn_less">
              <img border="0" src="/CustomWidgets/SocialMediaSharingUC/Resources/less.gif" title="Less"/>
             </a>
            </div>
           </div>
           <div class="ShareClearFloatsPanel">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment blog-feedback-list no-wrapper with-header" id="fragment-52319">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Blog - Comment List MSDN TechNet
           </div>
          </div>
          <div class="content-fragment-content">
           <script src="http://i1.blogs.msdn.com/rrcontent/c6cf9e2cff3f0bfc0a1a8c20bf243544-5882c0bb1c3252f4238afcfee921f6f5-RequestReducedScript.js" type="text/javascript">
           </script>
           <script type="text/javascript">
            // &lt;![CDATA[
    (function ($) {
        $.extend(jQuery.tmpl.tag, {
            "for": {
                _default: { $2: "var i=1;i&lt;=1;i++" },
                open: 'for ($2){',
                close: '};'
            }
        });
    })(jQuery);

    function findYPos(obj) {
        var curtop = 0;
        if (obj.offsetParent) {
            do {
                curtop += obj.offsetTop;
            } while (obj = obj.offsetParent);
            return [curtop];
        }
    }

    var endpoint = '/b/carlosag/listComments.aspx';
    var deleteendpoint = '/Utility/ContentFragments/Blogs/FeedbackListAjax.asmx';  
    $(document).ready(function () {
        if (window.location.hash) {
            var commentHash = parseInt(window.location.hash.substring(1, window.location.hash.length));
            if (!isNaN(commentHash)) {
                loadComments(0, commentHash, true);
                return;
            }
        }

        loadComments(0, 0, true);
    });

    function loadComments(page, anchorId, isFirstLoad) {
        $.ajax({
            type: 'POST',
            async: false,
            contentType: 'application/json',
            dataType: 'json',
            url: endpoint + '?blogId=4933&amp;postId=8918637&amp;page=' + page + '&amp;commentId=' + anchorId + '&amp;pageSize=1000&amp;firstLoad=' + isFirstLoad + "&amp;time=" + new Date().getTime(),
            success: function (data) {
                var pager = $('#pagerContainer');

                $('#commentList').html('');
                $('#commentList').html($('#commentTemplate').tmpl(data.Comments));
                $('#pagerContainer').html($('#pagerTemplate').tmpl(data));

                $('.pagingLink').click(function (e) {
                    e.preventDefault();
                    loadComments($(this).data('page'), 0, false);
                    window.scroll(0, findYPos(document.getElementById('commentList')) - 50);
                    return false;
                });

                $('.pagingLink').removeClass('selected');
                $('#pager' + data.CurrentPage).addClass('selected');

	            
            }
        });
    }
    // ]]&gt;
           </script>
           <a name="comments">
           </a>
           <div class="content-list-header">
           </div>
           <div class="content-list-name">
            <a class="internal-link rss" href="/b/carlosag/rsscomments.aspx?WeblogPostID=8918637">
             <span>
             </span>
             Comments
            </a>
           </div>
           <ul class="content-list" id="commentList">
            <li class="content-item">
             Loading...
            </li>
           </ul>
           <div class="pager" id="pagerContainer">
           </div>
           <div class="content-list-footer">
           </div>
           <script id="commentTemplate" type="text/html">
            {{if Author}}
    &lt;li id="commentItem${Id}" class="content-item"&gt;
        &lt;div class="full-post-outer fiji-full-post-outer"&gt;&lt;div class="full-post-header"&gt;&lt;div class="r fiji-r"&gt;&lt;/div&gt;&lt;/div&gt;
        &lt;div class="full-post"&gt;&lt;div class="full-post-inner fiji-full-post-inner"&gt;
            &lt;div class="post-author"&gt;
                &lt;span class="avatar"&gt;
                    {{if !Author.IsAnonymous}}
                    &lt;a href="${Author.ProfileUrl}"&gt;
                        &lt;img src="${Author.AvatarUrl}" style="border-width:0;max-height:32px;max-width:32px;"/&gt;
                    &lt;/a&gt;
                    {{else}}
                    &lt;img src="${Author.AvatarUrl}" style="border-width:0;max-height:32px;max-width:32px;"/&gt;
                    {{/if}}
                &lt;/span&gt;
                &lt;span class="profile-usercard-hover" data-profile-userid="${Author.ProfileId}"&gt;
                    &lt;span class="user-name"&gt;
                        {{if !Author.IsAnonymous}}
                        &lt;a href="${Author.ProfileUrl}"&gt;
                            ${Author.DisplayName}
                        &lt;/a&gt;
                        {{else}}
                        ${Author.DisplayName}
                        {{/if}}
                    &lt;/span&gt;
                &lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="post-date"&gt;
                &lt;span class="value"&gt;${PublishedDate}&lt;/span&gt;
            &lt;/div&gt;
            &lt;a name="${Id}" style="padding-left:5px;" href="#${Id}"&gt;#&lt;/a&gt;
            &lt;div class="post-content user-defined-markup"&gt;
                {{html Body}}
            &lt;/div&gt;
            &lt;div class="post-actions"&gt;
                
            &lt;/div&gt;
        &lt;/div&gt;
        {{if !Author.IsAnonymous &amp;&amp; Author.Id == 8578}}
        &lt;div class="full-post-footer user-is-author"&gt;
        {{else}}
        &lt;div class="full-post-footer"&gt;
        {{/if}}
            &lt;div class="r wireframe-r"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/li&gt;
    {{/if}}
           </script>
           <script id="pagerTemplate" type="text/html">
            {{if TotalPages}}     
        {{if TotalPages &gt; 1}}     
            &lt;span class="summary"&gt;Page 1 of 3 (39 items)&lt;/span&gt;            
        
             {{for(i=1;i&lt;=TotalPages;i++)}}            
                &lt;a id="pager${i}" data-page="${i}" href="javascript:void(0);" class="pagingLink"&gt;
                    &lt;span&gt;${i}&lt;/span&gt;
                &lt;/a&gt;
                &lt;span class="separator"&gt;&lt;/span&gt;
            {{/for }}
        {{else}}  
        {{/if}}
    {{else}}      
    {{/if}}
           </script>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
        <div class="content-fragment captcha-blog-post-comment-form no-wrapper" id="fragment-52320">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-content">
           <input id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_postCommentUrl" name="ctl00$content$ctl00$w_52320$_b7c54d$ctl00$ctl00$postCommentUrl" type="hidden"/>
           <div class="field-list-header">
           </div>
           <fieldset class="field-list">
            <legend class="field-list-description">
             Leave a Comment
            </legend>
            <ul class="field-list">
             <li class="field-item" id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_NameField">
              <label class="field-item-header" for="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName">
               Name
              </label>
              <span class="field-item-input">
               <input id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName" name="ctl00$content$ctl00$w_52320$_b7c54d$ctl00$ctl00$PlaceHolder1$ctl04$bpCommentForm$ctl04$tbName" size="60" type="text"/>
              </span>
             </li>
             <li class="field-item post-body">
              <label class="field-item-header" for="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment">
               Comment
              </label>
              <span class="field-item-input">
               <textarea cols="20" id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment" name="ctl00$content$ctl00$w_52320$_b7c54d$ctl00$ctl00$PlaceHolder1$ctl04$bpCommentForm$ctl04$tbComment" rows="2">
               </textarea>
              </span>
             </li>
             <li class="field-item">
              <span id="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_subtext_captcha">
               Please add 4 and 5 and type the answer here:
               <input name="ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_visibleanswer" type="text" value=""/>
              </span>
             </li>
             <li class="field-item">
              <script type="text/javascript">
               // &lt;![CDATA[

                            $(document).ready(function () {
                                $('a.add-reply.post').click(function (e) {
                                    e.preventDefault();
                                    postComment(this);
                                    return false;
                                });

                                $('#ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').keyup(function (e) {
                                    $('#errorOnPosting').hide();
                                });
                                var nameBox = $('#ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName');
                                if (nameBox.length &gt; 0) {
                                    $(nameBox).keyup(function (e) {
                                        $('#errorOnPosting').hide();
                                    });
                                }
                            });

                            function postComment(anchor) {
                                if (Page_ClientValidate('BlogPostCommentForm-ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00')) {
                                    togglePostAndPublishing();

                                    var Core_CreateBlogComment_AjaxEndpoint = '/Utility/ContentFragments/Core/CreateBlogComment.asmx' + "/PostComment";
                                    var name = '';
                                    var nameBox = $('#ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName');
                                    if (nameBox.length &gt; 0) {
                                        name = $(nameBox).val();
                                    }
                                    var body = $('#ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').val();
                                    var weblogPostId = '8918637';

                                    $.ajax({
                                        type: "POST",
                                        async: false,
                                        url: Core_CreateBlogComment_AjaxEndpoint,
                                        beforeSend: function (xhr) { TelligentUtility.WriteAuthorizationHeader(xhr); },
                                        data: { weblogPostId: weblogPostId, url: '', subject: '', message: body, name: name, remember: false },
                                        success: function (results) {
                                            var responseVal = $(results.firstChild).text();
                                            if (responseVal === "-1" || responseVal === "-2") {
                                                togglePostAndPublishing();
                                                if (responseVal == "-2")
                                                    $('#errorOnPosting').html('Your comment has been flagged as spam! The blog administrator has been notified.');
                                                $('#errorOnPosting').show();
                                                return;
                                            }
                                            var redirectUrl = window.location.href;
                                            if (redirectUrl.indexOf("?") &gt; -1) {
                                                redirectUrl = redirectUrl.replace(/\?.*/, "");
                                            } else if (redirectUrl.indexOf("#") &gt; -1) {
                                                redirectUrl = redirectUrl.replace(/\#.*/, "");
                                            }

                                            redirectUrl += '?CommentPosted=true#commentmessage';
                                            if (window.location.href == redirectUrl) {
                                                location.reload(true);
                                            }
                                            else {
                                                window.location.href = redirectUrl;
                                            }
                                        },
                                        error: function (xhr, textStatus, errorThrown) {
                                            togglePostAndPublishing();
                                            $('#errorOnPosting').show();
                                        }
                                    });

                                }
                            }

                            function togglePostAndPublishing() {
                                $('a.add-reply.post').toggle();
                                $('a.publishing').toggle();
                            }
                            // ]]&gt;
              </script>
              <span class="field-item-input">
               <a class="internal-link add-reply post" style="cursor: pointer;">
                <span>
                </span>
                Post
               </a>
               <a class="internal-link add-reply publishing" style="color:#c7c7c7; display: none;cursor: pointer;">
                <span>
                </span>
                Publishing
               </a>
               <span id="errorOnPosting" style="color: white; background-color: red; padding: 5px; margin-left: 10px; display: none;">
                An error occurred while posting! Please retry posting your comment.
               </span>
              </span>
             </li>
            </ul>
           </fieldset>
           <div class="field-list-footer">
           </div>
          </div>
          <div class="content-fragment-footer">
          </div>
          <div class="content-fragment-bottom msdn-content-fragment-bottom">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="layout-footer">
     </div>
    </div>
   </div>
   <div class="footer-fragments-header">
   </div>
   <div class="footer-fragments">
    <div class="footer-fragment copyright-info" id="footer-fragment-1402503690">
     <ul class="footer-fragment-links">
      <li class="message copyright">
        2015 Microsoft Corporation.
      </li>
      <li class="message termsOfService">
       <a href="http://msdn.microsoft.com/cc300389">
        Terms of Use
       </a>
      </li>
      <li class="message trademarks">
       <a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">
        Trademarks
       </a>
      </li>
      <li class="message privacy">
       <a href="http://go.microsoft.com/fwlink/?LinkId=248681">
        Privacy &amp; Cookies
       </a>
      </li>
      <li class="message abuse">
       <a href='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$footer_fragment_1402503690$_b7c54d$ctl00$ctl00$ctl01$lnkAbuse", "", true, "", "", false, true))' id="ctl00_footer_fragment_1402503690__b7c54d_ctl00_ctl00_ctl01_lnkAbuse">
        Report Abuse
       </a>
      </li>
      <li class="message version">
       5.6.426.415
      </li>
     </ul>
    </div>
    <div class="footer-fragment omniture-footer-fragment" id="footer-fragment-1402503691">
     <script src="http://i1.blogs.msdn.com/rrcontent/2569210a296af7a76a1f0a41cafcfd42-2e0c141b75ad92888490f6154505d4c2-RequestReducedScript.js" type="text/javascript">
     </script>
     <noscript>
      <a href="http://www.omniture.com" title="Web Analytics">
       <img alt="" border="0" height="1" src="http://msstomsdnblogs.112.2O7.net/b/ss/msstomsdnblogs/1/H.20.2--NS/0" width="1"/>
      </a>
     </noscript>
    </div>
    <div class="footer-fragment app-insights-footer-fragment" id="footer-fragment-1402503692">
     <script language="javascript" type="text/javascript">
      $(document).ready(function () {
                window.appInsights = { queue: [], start: function (n) { function r(n, t) { n[t] = function () { var i = arguments; n.queue.push(function () { n[t].apply(n, i) }) } } var t, i; this.applicationInsightsId = n; this.accountId = null; this.appUserId = null; r(this, "logEvent"); r(this, "logPageView"); t = document.createElement("script"); t.type = "text/javascript"; t.src = "//az416426.vo.msecnd.net/scripts/ai.js"; t.async = !0; i = document.getElementsByTagName("script")[0]; i.parentNode.insertBefore(t, i) } };
                window.appInsights.start("b4d65b72-ce61-486e-b07c-969cef6675f6");
                window.appInsights.logPageView();
            });
     </script>
    </div>
   </div>
   <div class="footer-fragments-footer">
   </div>
   <script type="text/javascript">
    // &lt;![CDATA[
ctl00_content_ctl00 = new ContentFragmentPageCustomCallback('ctl00_content_ctl00',new Function('mode','parameters','callback','errorCallback','context','ctl00_content_ctl00_ctl00._doCallback(mode+\':\'+parameters,callback,context,errorCallback);'));
// ]]&gt;
   </script>
   <!--
&lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"&gt;
&lt;rdf:Description
rdf:about="http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx"
dc:identifier="http://blogs.msdn.com/b/carlosag/archive/2008/09/02/iis7urlrewriteseo.aspx"
dc:title="IIS 7.0 and URL Rewrite, make your Web Site SEO"
trackback:ping="http://blogs.msdn.com/b/carlosag/trackback.ashx?WeblogPostID=8918637" /&gt;
&lt;/rdf:RDF&gt;
-->
   <script type="text/javascript">
    // &lt;![CDATA[
Telligent_Modal.Configure('\/utility\/loading.htm',['modal'],['modal-title','modal-title-2','modal-title-3','modal-title-4'],['modal-close'],['modal-content','modal-content-2'],['modal-footer','modal-footer-2','modal-footer-3'],['modal-resize'],['modal-mask'],10000,false,true,true);
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
window.ctl00_content_ctl00_ctl00 = new Telligent_CallbackManager('ctl00_content_ctl00_ctl00','ctl00$content$ctl00$ctl00','aspnetForm');
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
$('#ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Container input[value="Save"]').attr('onclick','').removeAttr('onclick').click( function(){ try { var tagText = $('#ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Tags').val(); if (!tagText) return false;var tagList = tagText.replace(';',',').split(','); var isValid = true; for (var i=0,l=tagList.length;i&lt;l;i++) {isValid = /^[ -~]{0,100}$/ig.test(tagList[i]); if (!isValid) { alert(tagList[i] + ' : is not valide'); return false; } }ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01.Save();}catch(ex){ } return false; });
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
window.ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01 = new Telligent_InlineEditor('ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Container',new Function('id', 'p', 'ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor.SetInlineEditorPanelAndParameter(id,p);'),new Function('return ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor.GetContent();'),new Function('c', 'ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor.SetContent(c);'),null,new Function('ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor.Focus();'),new Function('w', 'h', 'ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor.Resize(w,h);'),300,90);
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
var ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_TagEditor = new TagEditor('ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_TagEditor',[['.NET','.NET'],['ARR','ARR'],['ASP.NET','ASP.NET'],['Debugging','Debugging'],['IIS','IIS'],['IIS Manager','IIS Manager'],['IIS News Item','IIS News Item'],['LogicApps','LogicApps'],['Microsoft.Web.Administration','Microsoft.Web.Administration'],['Personal','Personal'],['SEO','SEO'],['URL Rewrite','URL Rewrite'],['Windows Azure','Windows Azure'],['WinForms','WinForms']],'ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Tags');
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
var ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor = new InlineTagEditor('ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_InlineTagEditor','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Container','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01_Tags');
// ]]&gt;
   </script>
   <script type="text/javascript">
    // &lt;![CDATA[
window.ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02 = new Telligent_InlineEditorPanel('ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl02_State','ctl00_content_ctl00_w_52317__b7c54d_ctl00_ctl15_ctl01',false,null,null,null);
// ]]&gt;
   </script>
   <script type="text/javascript">
    //&lt;![CDATA[
$('#ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').autoResize({animate : false,extraSpace : 0,limit : 3000});//]]&gt;
   </script>
   <script type="text/javascript">
    subtext_invisible_captcha_hideFromJavascriptEnabledBrowsers('ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_subtext_captcha');
   </script>
   <script type="text/javascript">
    subtext_invisible_captcha_setAnswer(4, 5, 'ctl00_content_ctl00_w_52320__b7c54d_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer');
   </script>
  </form>
  <script type="text/javascript">
   $(window).load(function () {
            $.getScript('http://widgets.membership.s-msft.com/v1/loader.js?brand=msdn&amp;lang=en-US', function () {
            });
        });
  </script>
  <script type="text/javascript">
   $('div.breadcrumb-list span:last a').addClass('last');
  </script>
 </body>
</html>