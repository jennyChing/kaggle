<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Refinance Calculator - Should I Refinance?
  </title>
  <meta content="5F4A4D2F3F55C1D9C26C73F9AB307CE2" name="msvalidate.01"/>
  <meta content="width=device-width, user-scalable=no" name="viewport"/>
  <meta content="Award Winning Calculator determines if Refinancing makes sense using live mortgages and real data. Find out now exactly how much you can save or cash out from refinancing..." name="description"/>
  <meta content="" name="author"/>
  <meta content="https://www.smartasset.com/images/fb/site.jpg" property="og:image"/>
  <!-- BEGIN TRACKJS -->
  <script type="text/javascript">
   window._trackJs = { token: '3d9ca7340e5646beb52987ad9bb40dfc' };
  </script>
  <script crossorigin="anonymous" src="//d2zah9y47r7bi2.cloudfront.net/releases/current/tracker.js" type="text/javascript">
  </script>
  <!-- END TRACKJS -->
  <script>
   var REQUIRE_BASE_URL = "//d1l53avkert0hz.cloudfront.net/files/5056/";
        var IS_DEV = false;
        var IS_DEBUG = false;
        var USER_ID = 20384629;
        var AB_VERSION = 0;
  </script>
  <!-- There are some JS files we need to load ahead of everything else -->
  <!-- typekit fonts -->
  <script src="https://use.typekit.net/fks6bqh.js">
  </script>
  <script>
   try{Typekit.load();}catch(e){}
  </script>
  <meta content="" property="sa:test"/>
  <meta content="Interactive" property="st:type"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/favicon_16.png" rel="shortcut icon" type="image/png"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/favicon_32.png" rel="shortcut icon" sizes="32x32" type="image/png"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/app_icon_76.png" rel="apple-touch-icon"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/app_icon_76.png" rel="apple-touch-icon" sizes="76x76"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/app_icon_120.png" rel="apple-touch-icon" sizes="120x120"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/app_icon_152.png" rel="apple-touch-icon" sizes="152x152"/>
  <meta content="none" name="msapplication-config"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/tools/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  <!-- Nano scroller css file -->
  <!-- Include base css file. DO NOT CHANGE POSITION.-->
  <!--- load script files here --->
  <!-- Include Jquery UI touch support-->
  <!--- seo headers --->
  <link href="https://plus.google.com/113386095085068085293/" rel="publisher"/>
  <script src="https://maps.google.com/maps/api/js?sensor=false&amp;v=3" type="text/javascript">
  </script>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/tools/select2/select2.css" media="all" rel="stylesheet"/>
  <link href="//d1l53avkert0hz.cloudfront.net/files/5056/combined/ba688cb8322244e83e21c8d4f4fe1cf8.css" media="all" rel="stylesheet" type="text/css"/>
  <script src="//d1l53avkert0hz.cloudfront.net/files/5056/combined/db4580f4ec8afd97b9154cea3f7a2114.js" type="text/javascript">
  </script>
  <!--[if lt IE 9]&gt;
        &lt;link type="text/css" href="//d1l53avkert0hz.cloudfront.net/files/5056/css/base/ie8.css" rel="stylesheet"/&gt;
    &lt;![endif]-->
  <!--[if lt IE 10]&gt;
        &lt;link type="text/css" href="//d1l53avkert0hz.cloudfront.net/files/5056/css/base/ie9.css" rel="stylesheet"/&gt;
        &lt;script type="text/javascript" src="//d1l53avkert0hz.cloudfront.net/files/5056/js/base/xdr.js"&gt;&lt;/script&gt;
    &lt;![endif]-->
  <script type="text/javascript">
   var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        (function() {
            var gads = document.createElement('script');
            gads.async = true;
            gads.type = 'text/javascript';
            var useSSL = 'https:' == document.location.protocol;
            gads.src = (useSSL ? 'https:' : 'http:') +
                    '//www.googletagservices.com/tag/js/gpt.js';
            var node = document.getElementsByTagName('script')[0];
            node.parentNode.insertBefore(gads, node);
        })();

        googletag.cmd.push(function() {
            googletag.pubads().collapseEmptyDivs(true);
            googletag.pubads().enableSingleRequest();
            googletag.pubads().disableInitialLoad();
            googletag.enableServices();
        });
  </script>
  <!-- Optimizely -->
  <script src="//cdn.optimizely.com/js/2233610180.js">
  </script>
 </head>
 <body class="interactive-page">
  <a name="">
  </a>
  <div data-swiftype-index="false" id="loading-overlay">
   <div>
    Loading
   </div>
  </div>
  <div class="page">
   <div data-position="fixed" data-role="header" data-swiftype-index="false" data-tap-toggle="false" data-update-page-padding="false" id="header">
    <div class="container">
     <a class="mmenu" href="#mmenu">
     </a>
     <div class="logo">
      <a href="/">
       <img src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/sa_logo_nav._225x52.png"/>
      </a>
     </div>
     <div class="buttons navigation">
      <ul class="wider">
       <li>
        <a class="double" href="/mortgage/">
         <span>
          Home Buying
         </span>
        </a>
       </li>
       <li class="active">
        <a href="/refinance/">
         <span>
          Refinance
         </span>
        </a>
       </li>
       <li>
        <a href="/retirement/">
         <span>
          Retirement
         </span>
        </a>
       </li>
       <li>
        <a class="double" href="/life-insurance/">
         <span>
          Life Insurance
         </span>
        </a>
       </li>
       <li>
        <a href="/blog">
         <span>
          Blog
         </span>
        </a>
       </li>
       <li class="has-sub ">
        <a class="double" href="#">
         <span>
          More
          <i class="fa fa-angle-down">
          </i>
         </span>
        </a>
        <ul class="clearfix">
         <li>
          <a class="double" href="/credit-cards/">
           <span>
            Credit Cards
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/checking-account/">
           <span>
            Checking Accounts
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/student-loans/">
           <span>
            Student Loans
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/taxes/">
           <span>
            Taxes
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/investing/">
           <span>
            Investing
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/credit-score/">
           <span>
            SmartAsset 360 Credit Monitoring
           </span>
          </a>
         </li>
        </ul>
       </li>
       <li class="has-sub narrow">
        <a class="double" href="#">
         <span>
          Sections
          <i class="fa fa-angle-down">
          </i>
         </span>
        </a>
        <ul class="clearfix">
         <li>
          <a class="double" href="/mortgage/">
           <span>
            Home Buying
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/refinance/">
           <span>
            Refinance
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/retirement/">
           <span>
            Retirement
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/life-insurance/">
           <span>
            Life Insurance
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/student-loans/">
           <span>
            Student Loans
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/credit-cards/">
           <span>
            Credit Cards
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/checking-account/">
           <span>
            Checking Accounts
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/taxes/">
           <span>
            Taxes
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/investing/">
           <span>
            Investing
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/credit-score/">
           <span>
            SmartAsset 360
           </span>
          </a>
         </li>
         <li>
          <a class="double" href="/blog/">
           <span>
            Blog
           </span>
          </a>
         </li>
        </ul>
       </li>
       <li id="search-icon">
        <a href="/search">
         <span>
          <i class="fa fa-search">
          </i>
         </span>
        </a>
       </li>
      </ul>
     </div>
     <div class="buttons profile">
      <ul>
       <li>
        <a data-for="login-box" href="#">
         <span>
          Log In
         </span>
        </a>
       </li>
       <li>
        <a data-for="signup-box" href="#">
         <span>
          Sign Up
         </span>
        </a>
       </li>
      </ul>
      <div class="login-box popupbox">
       <div class="login-container">
        <form onsubmit="return false;">
         <h3>
          Log In
         </h3>
         <div class="button facebook" onclick="smartasset.login.fbLogin()">
          Log in with Facebook
         </div>
         <div class="lined">
          <span>
           OR
          </span>
         </div>
         <div>
          <label class="ie9" for="login-email">
           Email
          </label>
          <input class="input-field" id="login-email" placeholder="Email" size="16" type="text" value=""/>
          <div class="validation-message" id="email-validation" style="display: none">
          </div>
         </div>
         <div>
          <label class="ie9" for="login-password">
           Password
          </label>
          <input class="input-field" id="login-password" placeholder="Password" size="16" type="password"/>
          <div class="validation-message" id="password-validation" style="display: none">
          </div>
         </div>
         <div id="captcha-container" style="display: none">
          <div class="captcha" onclick="smartasset.login.reloadCaptcha()">
           <img src=""/>
          </div>
          <div>
           <b>
            Enter the text you see above in the field below.
           </b>
           Click the image to reload another string.
          </div>
          <input class="input-field" id="login-captcha" placeholder="Captcha" size="16" type="text" value=""/>
          <div class="validation-message" id="captcha-validation" style="display: none">
           Email Validation Text
          </div>
         </div>
         <div class="spacer s10">
         </div>
         <div>
          <table cellpadding="0" cellspacing="0" width="100%">
           <tr>
            <td>
             <button class="button" onclick="smartasset.login.userLogin(this); return false">
              Log in
             </button>
            </td>
            <td style="padding-top: 5px; text-align: right">
             <span class="link" onclick="smartasset.login.forgotPassword()">
              Forgot your password?
             </span>
            </td>
           </tr>
          </table>
          <div class="spacer s5">
          </div>
          <span class="link" onclick="smartasset.login.showSignup()">
           Don't have an account?
          </span>
         </div>
        </form>
       </div>
      </div>
      <div class="forgot-box popupbox">
       <div class="forgot-container">
        <h3>
         Forgot Password
        </h3>
        <form onsubmit="return false;">
         <div>
          <label class="ie9" for="forgot-email">
           Email
          </label>
          <input class="input-field" name="forgot-email" placeholder="Email" size="16" type="text" value=""/>
          <div class="email-validation validation-message" style="display: none">
          </div>
         </div>
         <div style="margin-top: 10px;">
          <table cellpadding="0" cellspacing="0" width="100%">
           <tr>
            <td>
             <button class="button" onclick="smartasset.login.recallPassword(this);">
              Reset Password
             </button>
            </td>
            <td style="padding-top: 5px; text-align: right">
             <span class="link" onclick="smartasset.login.cancel()">
              Cancel
             </span>
            </td>
           </tr>
          </table>
         </div>
        </form>
       </div>
      </div>
      <div class="signup-box popupbox">
       <div class="register-container">
        <form autocomplete="off" onsubmit="return false;">
         <h3>
          Create An Account
         </h3>
         <div class="button facebook" onclick="smartasset.login.fbLogin()">
          Sign up with Facebook
         </div>
         <div class="lined">
          <span>
           OR
          </span>
         </div>
         <div>
          <label class="ie9" for="register-email">
           Email
          </label>
          <input class="input-field" id="register-email" placeholder="Email" size="16" type="text" value=""/>
          <div class="validation-message" id="email-validation" style="display: none">
          </div>
         </div>
         <div>
          <label class="ie9" for="register-password">
           Password
          </label>
          <input class="input-field" id="register-password" placeholder="Password" size="16" type="password"/>
          <div class="validation-message" id="password-validation" style="display: none">
          </div>
         </div>
         <div style="margin-top: 10px;">
          <button class="button" onclick="smartasset.login.userRegister(this);">
           Register
          </button>
         </div>
         <div class="spacer s5">
         </div>
         <span class="link" onclick="smartasset.login.showLogin()">
          Have an account already?
         </span>
        </form>
       </div>
      </div>
     </div>
     <div class="top-error">
      <span>
       SmartAsset.com works best on modern browsers (Internet Explorer 11, Chrome, Safari, Firefox or Opera). Please upgrade your browser to use SmartAsset.com
      </span>
      <i class="fa fa-close" onclick="smartasset.page.closeTopError()">
      </i>
     </div>
    </div>
    <div class="inputs-button" onclick="smartasset.mobile.toggleInputs();">
     <div class="notice">
     </div>
     <div class="walkthrough-profile">
     </div>
    </div>
   </div>
   <div class="search-box" data-swiftype-index="false" id="search-box">
    <div class="center">
     <form action="/search" method="post">
      <a>
       <span class="hide-mobile">
        Search
       </span>
       <input id="st-search-input" name="q" type="text"/>
       <input class="bold" onclick="$('#search-box form').submit()" type="button" value="Go"/>
       <input onclick="smartasset.page.hideSearch()" type="button" value="Cancel"/>
      </a>
     </form>
    </div>
   </div>
   <div data-swiftype-index="false" id="ui-mob-info">
    <div class="over proxima">
     <div class="arrow">
     </div>
     Tap on the profile icon to edit
     <br/>
     your financial details.
     <br/>
     <button onclick="smartasset.page.hideInputsInfo()">
      Got It
     </button>
    </div>
   </div>
   <div id="main-container">
    <div class="main">
     <div class="container clearfix">
      <div class="breadcrumbs" data-swiftype-index="false" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
       <a href="/" itemprop="url">
        <span itemprop="title">
         Home
        </span>
       </a>
       /
       <a href="/refinance/" itemprop="url">
        <span itemprop="title">
         Refinance
        </span>
       </a>
       /
       <a class="last" href="/refinance/refinance-calculator" itemprop="url">
        <span itemprop="title">
         Refinance Calculator
        </span>
       </a>
      </div>
      <h1 class="title" data-swiftype-name="title" data-swiftype-type="string">
       Refinance Calculator
      </h1>
      <div class="proxima mobile-input-close" data-swiftype-index="false" onclick="smartasset.mobile.toggleInputs();">
       Your Details
       <span class="cls">
        Done
       </span>
      </div>
      <div class="content">
       <div class="interaction left-column clearfix" style="height: 1500px; min-height: 1500px;">
        <div class="nano inputs-ct" id="inputs-container" style="min-height: 1500px; height: 1500px">
         <div class="overlay">
         </div>
         <div class="nano-content">
          <div class="input-group first open " id="group-pmg1">
           <div class="group-label">
            <b>
             <i class="fa">
             </i>
             Mortgage Details
            </b>
           </div>
           <div class="input-children">
            <div class="input ud-re-home-value required " data-name="ud-re-home-value">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="How much money your home is worth right now." data-title="Current Home Value">
                 Current Home Value
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
                What is the estimated value of your current home?
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                 This will help us determine the amount of refinance you can qualify for.
                </span>
                <span class="tightcontainer dollar">
                 <input class="autonumeric dollar" data-a-dec="." data-a-sep="," data-m-dec="0" data-v-max="999999999" name="ud-re-home-value" type="text"/>
                </span>
                <div class="smartasset-ui">
                 <div class="range-slider noUi-extended sa">
                 </div>
                </div>
                <script>
                 smartasset.hooks.register("onInputsLoaded", function()
    {
        var val = $("#inputs-container .ud-re-home-value input").val();

        // set slider value
        $("#inputs-container .ud-re-home-value .range-slider").val(smartasset.math.getInteger(val));
    });

    $(function() {
        $("#inputs-container .ud-re-home-value .range-slider").noUiSlider({
            start: [ 0 ],
            connect: "lower",
            animate: false,
            range: {
                'min': [50000, 10000],
'72%':[1000000,100000],
'87%':[3000000,200000],
'95%':[5000000,500000],
'98%':[7000000,1000000],
'max':[10000000]

            }
        }).on("slide", function()
        {
            var value = $(this).val();
            //
            // update linked field
            //
            $("#inputs-container .ud-re-home-value input").autoNumeric("set", value);
            //
            // call hook labeled "slide-input-id"
            //
            smartasset.hooks.call("input-slide-ud-re-home-value", value);
        }).on("change", function(e)
        {
            smartasset.inputs.saveInput($("#inputs-container .ud-re-home-value input"));
        });
    });
                </script>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("ud-re-home-value")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input expandable ud-balance-unknown required " data-name="ud-balance-unknown">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="Includes specific information of your current/initial home loan, including mortgage balance, interest rate, mortgage type and mortgage term." data-title="Current Mortgage Details">
                 Current Mortgage Details
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
                What are your current mortgage details?
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                 This will help us determine whether or not you will qualify for a refinance.
                </span>
                <div class="input-expandable-value">
                </div>
                <div class="input-popout clearfix">
                 <i class="input-close fa fa-remove">
                 </i>
                 <div class="title">
                  Current Mortgage Details
                 </div>
                 <div class="row ud-balance-unknown">
                  <span class="mb-div">
                   Do you know your mortgage balance?
                  </span>
                  <input class="no-autosave hidedefault" field="ud-balance-unknown" id="ud-balance-unknown-y-143374953" name="ud-balance-unknown-143374953" type="radio" value="0"/>
                  <label class="radio" for="ud-balance-unknown-y-143374953">
                   Yes
                  </label>
                  <input class="no-autosave hidedefault" field="ud-balance-unknown" id="ud-balance-unknown-n-143374953" name="ud-balance-unknown-143374953" type="radio" value="1"/>
                  <label class="radio" for="ud-balance-unknown-n-143374953">
                   No
                  </label>
                 </div>
                 <div class="row balance-known ud-re-current-mtg-balance">
                  Current mortgage balance
                  <span class="tightcontainer dollar">
                   <input class="dollar no-autosave autonumeric" data-m-dec="0" data-v-max="99999999" name="ud-re-current-mtg-balance" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row balance-unknown ud-re-original-mtg-value">
                  Initial mortgage balance
                  <span class="tightcontainer dollar">
                   <input class="dollar no-autosave autonumeric" data-m-dec="0" data-v-max="99999999" name="ud-re-original-mtg-value" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row ud-re-original-mtg-type">
                  Mortgage Type
                  <div class="mb">
                  </div>
                  <span>
                   <select class="select2 no-autosave" name="ud-re-original-mtg-type">
                    <option value="2">
                     Fixed30Y
                    </option>
                    <option value="1">
                     Fixed15Y
                    </option>
                   </select>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row balance-known ud-re-current-mtg-term">
                  Remaining mortgage term
                  <span class="tightcontainer">
                   <input class="no-autosave autonumeric" data-m-dec="0" data-v-max="999" name="ud-re-current-mtg-term" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row balance-unknown ud-re-original-mtg-start">
                  Mortgage start year
                  <span class="tightcontainer">
                   <input class="no-autosave autonumeric" data-a-sep="" data-m-dec="0" data-v-max="99999" name="ud-re-original-mtg-start" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row balance-known ud-re-current-mtg-rate no-bottom-margin">
                  Mortgage interest rate
                  <span class="tightcontainer percentage">
                   <input class="percentage no-autosave autonumeric" data-m-dec="2" data-v-max="99" name="ud-re-current-mtg-rate" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <div class="row balance-unknown ud-re-original-mtg-rate no-bottom-margin">
                  Mortgage interest rate
                  <span class="tightcontainer percentage">
                   <input class="percentage no-autosave autonumeric" data-m-dec="2" data-v-max="99" name="ud-re-original-mtg-rate" type="text"/>
                  </span>
                  <p class="error-message">
                  </p>
                 </div>
                 <button class="next">
                  Done
                 </button>
                 <button class="mobile-cancel" onclick="smartasset.inputs.hidePopout();">
                  Cancel
                 </button>
                </div>
                <script>
                 $(function() {
        var inputContainer = $('#inputs-container .ud-balance-unknown');

        // set visibility of either balance known or unknown
        var setVisibility = function(isBalanceUnknown) {
            // toggle which inputs are displayed
            if (isBalanceUnknown) {
                inputContainer.find(".balance-known").hide();
                inputContainer.find(".balance-unknown").show();
            } else {
                inputContainer.find(".balance-unknown").hide();
                inputContainer.find(".balance-known").show();
            }
        };

        var displayValue = function(inputElement, value) {
            try {
                inputElement.autoNumeric("set", value);
            } catch (err) {
                // todo - log error
                inputElement.val();
            }
        };

        // display input values provided by the server
        var displayValues = function() {
            // Show/hide the appropriate inputs (UD_REBalanceUnknown)
            var isBalanceUnknown = '1' === smartasset.inputs.getValue("ud-balance-unknown");
            setVisibility(isBalanceUnknown);

            inputContainer.find("input[name='ud-balance-unknown-143374953'][value='1']").prop('checked', isBalanceUnknown);

            var balance = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-current-mtg-balance"));
            displayValue(inputContainer.find("input[name='ud-re-current-mtg-balance']"), balance);

            var originalBalance = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-value"));
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-value']"), originalBalance);

            var mortgageType = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-type"));
            inputContainer.find("select[name='ud-re-original-mtg-type']").val(mortgageType).select2({
                minimumResultsForSearch: -1
            });

            var remainingTerm = smartasset.inputs.getValue("ud-re-current-mtg-term");
            if (typeof remainingTerm === "string") {
                remainingTerm = remainingTerm.split(":")[0];
                smartasset.math.getInteger(remainingTerm);
                displayValue(inputContainer.find("input[name='ud-re-current-mtg-term']"), remainingTerm);
            }

            var startYear = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-start"));
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-start']"), startYear);

            var interestRateForKnownBalance = smartasset.math.getFloat(smartasset.inputs.getValue("ud-re-current-mtg-rate")).toFixed(2);
            displayValue(inputContainer.find("input[name='ud-re-current-mtg-rate']"), interestRateForKnownBalance);

            var interestRateForUnknownBalance = smartasset.math.getFloat(smartasset.inputs.getValue("ud-re-original-mtg-rate")).toFixed(2);
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-rate']"), interestRateForUnknownBalance);

            smartasset.inputs.displayPopoutErrors(inputContainer);

            // display the summary text in the left sidebar
            var message = "";
            if (isBalanceUnknown) {
                message += "Initial Mortgage: $" + smartasset.math.commatoze(originalBalance, 0) + "&lt;br&gt;";
                message += "Interest Rate: " + interestRateForUnknownBalance + "%";
            } else {
                message += "Current Mortgage: $" + smartasset.math.commatoze(balance, 0) + "&lt;br&gt;";
                message += "Interest Rate: " + interestRateForKnownBalance + "%";
            }
            inputContainer.find(".input-expand-details").html(message);

        };

        // when "know your balance?" changes, swap out the inputs
        inputContainer.find("input[name='ud-balance-unknown-143374953']").on("change", function() {
            setVisibility(inputContainer.find("input[name='ud-balance-unknown-143374953'][value='1']").prop('checked'));
        });

        // validate and submit inputs
        var save = function() {
            // submit the values they customer set; ignore hidden defaults
            if (inputContainer.find("input[name='ud-balance-unknown-143374953'][value='1']").prop('checked')) {
                // balance unknown
                smartasset.inputs.save({
                    "ud-balance-unknown": inputContainer.find("input[name='ud-balance-unknown-143374953']:checked").val(),
                    "ud-re-original-mtg-value": inputContainer.find("input[name='ud-re-original-mtg-value']").val(),
                    "ud-re-original-mtg-type": inputContainer.find("select[name='ud-re-original-mtg-type']").val(),
                    "ud-re-original-mtg-start": inputContainer.find("input[name='ud-re-original-mtg-start']").val(),
                    "ud-re-original-mtg-rate": inputContainer.find("input[name='ud-re-original-mtg-rate']").val()
                });
            } else {
                // balance known
                smartasset.inputs.save({
                    "ud-balance-unknown": inputContainer.find("input[name='ud-balance-unknown-143374953']:checked").val(),
                    "ud-re-current-mtg-balance": inputContainer.find("input[name='ud-re-current-mtg-balance']").val(),
                    "ud-re-original-mtg-type": inputContainer.find("select[name='ud-re-original-mtg-type']").val(),
                    "ud-re-current-mtg-term": inputContainer.find("input[name='ud-re-current-mtg-term']").val() + ":0",
                    "ud-re-current-mtg-rate": inputContainer.find("input[name='ud-re-current-mtg-rate']").val()
                });
            }
        };

        // submit the inputs on "next" or enter key
        inputContainer.find("input").keydown(function(e) { if (e.keyCode == 13) { save(); } });
        inputContainer.find(".next").unbind("click").click(save);

        //
        // before popup is shown, reload the data (imagine someone canceled the popup, hit escape, etc)
        //
        smartasset.hooks.register("beforePopoutShow", displayValues);

        // returns array of inputs active in the popup
        var getActiveInputs = function() {
            var isBalanceUnknown = '1' === smartasset.inputs.getValue("ud-balance-unknown");
            if (isBalanceUnknown) {
                return ["ud-balance-unknown",
                    "ud-re-original-mtg-value",
                    "ud-re-original-mtg-type",
                    "ud-re-original-mtg-start",
                    "ud-re-original-mtg-rate"];
            }

            return ["ud-balance-unknown",
                "ud-re-current-mtg-balance",
                "ud-re-original-mtg-type",
                "ud-re-current-mtg-term",
                "ud-re-current-mtg-rate"];
        };

        //
        // register the onInputsLoaded method
        //
        smartasset.hooks.register("onInputsLoaded", function() {
            if (smartasset.inputs.reshowPopout(getActiveInputs()))  {
                setTimeout(function() {
                    smartasset.inputs.popout($(".input.expandable.ud-balance-unknown"));
                }, 50);
            }

            displayValues();
        });
    });
                </script>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("ud-balance-unknown")'>
                  Dismiss
                 </i>
                </div>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input ud-current-location required " data-name="ud-current-location">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="Desired location of homeownership.  Depending on which page your are on, this field will help calculate taxes, available mortgages and/or closing costs." data-title="Location">
                 Location
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
                What is the location of your home?
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                 Your location will help us find available mortgages and calculating costs specific to your area.
                </span>
                <input class="no-autosave" name="ud-current-location" style="display: none" type="text" value=""/>
                <input autocomplete="off" autocorrect="off" class="no-autosave" name="ud-current-location-display" type="text"/>
                <script>
                 $(function()
    {
        $("#inputs-container .ud-current-location .next").unbind("click").on("click", function()
        {
            smartasset.inputs.saveInput($("#inputs-container .ud-current-location input[name='ud-current-location']"));
        });

        var saveOnBlur = true;

        smartasset.inputs.makeLocation("#inputs-container .ud-current-location input[name='ud-current-location-display']", "#inputs-container .ud-current-location input[name='ud-current-location']", saveOnBlur);

        smartasset.hooks.register("onInputsLoaded", function()
        {
            var location = $("#inputs-container .ud-current-location input[name='ud-current-location-display']").val();
            // parse location
            location = smartasset.tools.parseLocation(location);
            $("#inputs-container .ud-current-location input[name='ud-current-location-display']").val(location);
        });
    });
                </script>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("ud-current-location")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input ud-re-new-mtg-cashout " data-name="ud-re-new-mtg-cashout">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="The money you take in cash during a refinance, lowering your equity in the home and increasing your mortgage balance." data-title="Cash Out Amount">
                 Cash Out Amount
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
                Cash Out Amount
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                 Enter cash out amount
                </span>
                <span class="tightcontainer dollar">
                 <input class="autonumeric dollar" data-a-dec="." data-a-sep="," data-m-dec="0" data-v-max="999999999" data-v-min="0" name="ud-re-new-mtg-cashout" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("ud-re-new-mtg-cashout")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
           </div>
          </div>
          <div class="input-group second collapsable " id="group-ad1">
           <div class="group-label">
            <b>
             <i class="fa">
             </i>
             Advanced
            </b>
           </div>
           <div class="input-children">
            <div class="input uhd-home-ins-perc " data-name="uhd-home-ins-perc">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="An insurance policy that provides compensation for damage, loss or injury of property, belongings or people due to fire, theft, accidents, etc. for homeowners." data-title="Annual Homeowners Insurance">
                 Annual Homeowner's Insurance
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                </span>
                <span class="tightcontainer percentage">
                 <input class="autonumeric percentage" data-a-dec="." data-a-sep="," data-m-dec="2" data-v-max="999999999" data-v-min="0" name="uhd-home-ins-perc" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("uhd-home-ins-perc")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input uhd-hoa-fixed " data-name="uhd-hoa-fixed">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="Monthly payment made by owners to an organization for the purpose of maintaining and improving the property." data-title="HOA/Condo Fees">
                 Monthly HOA / Condo Fees
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                </span>
                <span class="tightcontainer dollar">
                 <input class="autonumeric dollar" data-a-dec="." data-a-sep="," data-m-dec="0" data-v-max="999999999" data-v-min="0" name="uhd-hoa-fixed" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("uhd-hoa-fixed")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input u-inflation-rate " data-name="u-inflation-rate">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="The rate at which the general level of prices for goods and services is rising." data-title="Annual General Inflation">
                 Annual General Inflation
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                </span>
                <span class="tightcontainer percentage">
                 <input class="autonumeric percentage" data-a-dec="." data-a-sep="," data-m-dec="2" data-v-max="99" data-v-min="-9" name="u-inflation-rate" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("u-inflation-rate")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input u-savings-rate " data-name="u-savings-rate">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="The interest one receives from a bank or financial institution on savings or the financial return on investment." data-title="Annual Rate of Return on Savings">
                 Annual Rate of Return on Savings
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
                Savings Rate
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                 Enter the general savings rate
                </span>
                <span class="tightcontainer percentage">
                 <input class="autonumeric percentage" data-a-dec="." data-a-sep="," data-m-dec="2" data-v-max="99" data-v-min="-9" name="u-savings-rate" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("u-savings-rate")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
            <div class="input home-inflation " data-name="home-inflation">
             <div class="highlighter">
              <div class="input-content sa-inputs">
               <div class="input-progress">
                <div class="input-mobile-position">
                </div>
                <span class="input-mobile-hrd">
                 <div class="walkthrough-profile">
                 </div>
                 Add your details
                </span>
                <span class="input-progress-value">
                 <div class="complete">
                 </div>
                </span>
               </div>
               <span class="input-label">
                <span class="glossary" data-align="right" data-content="How much a  home will appreciate, or increase in value, per year." data-title="Annual Home Value Increase">
                 Annual Home Value Increase
                </span>
                <span class="trigger">
                </span>
               </span>
               <h2 class="input-label-walkthrough">
               </h2>
               <div class="input-inner-content">
                <span class="input-info-walkthrough">
                </span>
                <span class="tightcontainer percentage">
                 <input class="autonumeric percentage" data-a-dec="." data-a-sep="," data-m-dec="2" data-v-max="999999999" data-v-min="-9" name="home-inflation" type="text"/>
                </span>
                <span class="close-icon-text">
                 Do this later
                </span>
                <i class="close-icon fa fa-close">
                </i>
                <div class="input-note">
                 <span>
                 </span>
                 <i class="close" onclick='smartasset.inputs.dismiss("home-inflation")'>
                  Dismiss
                 </i>
                </div>
                <button class="next ">
                 Done
                </button>
                <div class="input-expand-details">
                </div>
               </div>
              </div>
             </div>
             <div class="border-bottom">
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="clearfix" id="interaction-container" style="height: 1500px; min-height: 1500px;">
         <div class="overlay">
         </div>
         <div class="main-error">
          <span>
          </span>
         </div>
         <div class="inputs-ct" id="inputs-walkthrough">
          <div class="input ud-re-home-value " data-name="ud-re-home-value">
           <div class="highlighter">
            <div class="input-content sa-inputs">
             <div class="input-progress">
              <div class="input-mobile-position">
              </div>
              <span class="input-mobile-hrd">
               <div class="walkthrough-profile">
               </div>
               Add your details
              </span>
              <span class="input-progress-value">
               <div class="complete">
               </div>
              </span>
             </div>
             <span class="input-label">
              <span class="glossary" data-align="right" data-content="How much money your home is worth right now." data-title="Current Home Value">
               Current Home Value
              </span>
              <span class="trigger">
              </span>
             </span>
             <h2 class="input-label-walkthrough">
              What is the estimated value of your current home?
             </h2>
             <div class="input-inner-content">
              <span class="input-info-walkthrough">
               This will help us determine the amount of refinance you can qualify for.
              </span>
              <span class="tightcontainer dollar">
               <input class="autonumeric dollar" data-a-dec="." data-a-sep="," data-m-dec="0" data-v-max="999999999" name="ud-re-home-value" type="text"/>
              </span>
              <div class="smartasset-ui">
               <div class="range-slider noUi-extended sa">
               </div>
              </div>
              <script>
               smartasset.hooks.register("onInputsLoaded", function()
    {
        var val = $("#inputs-walkthrough .ud-re-home-value input").val();

        // set slider value
        $("#inputs-walkthrough .ud-re-home-value .range-slider").val(smartasset.math.getInteger(val));
    });

    $(function() {
        $("#inputs-walkthrough .ud-re-home-value .range-slider").noUiSlider({
            start: [ 0 ],
            connect: "lower",
            animate: false,
            range: {
                'min': [50000, 10000],
'72%':[1000000,100000],
'87%':[3000000,200000],
'95%':[5000000,500000],
'98%':[7000000,1000000],
'max':[10000000]

            }
        }).on("slide", function()
        {
            var value = $(this).val();
            //
            // update linked field
            //
            $("#inputs-walkthrough .ud-re-home-value input").autoNumeric("set", value);
            //
            // call hook labeled "slide-input-id"
            //
            smartasset.hooks.call("input-slide-ud-re-home-value", value);
        }).on("change", function(e)
        {
            smartasset.inputs.saveInput($("#inputs-walkthrough .ud-re-home-value input"));
        });
    });
              </script>
              <span class="close-icon-text">
               Do this later
              </span>
              <i class="close-icon fa fa-close">
              </i>
              <div class="input-note">
               <span>
               </span>
               <i class="close" onclick='smartasset.inputs.dismiss("ud-re-home-value")'>
                Dismiss
               </i>
              </div>
              <button class="next ">
               Next
              </button>
              <button class="close-icon-text cancel only-mobile">
               Skip
              </button>
              <div class="input-expand-details">
              </div>
             </div>
            </div>
           </div>
           <div class="border-bottom">
           </div>
          </div>
          <div class="input expandable ud-balance-unknown " data-name="ud-balance-unknown">
           <div class="highlighter">
            <div class="input-content sa-inputs">
             <div class="input-progress">
              <div class="input-mobile-position">
              </div>
              <span class="input-mobile-hrd">
               <div class="walkthrough-profile">
               </div>
               Add your details
              </span>
              <span class="input-progress-value">
               <div class="complete">
               </div>
              </span>
             </div>
             <span class="input-label">
              <span class="glossary" data-align="right" data-content="Includes specific information of your current/initial home loan, including mortgage balance, interest rate, mortgage type and mortgage term." data-title="Current Mortgage Details">
               Current Mortgage Details
              </span>
              <span class="trigger">
              </span>
             </span>
             <h2 class="input-label-walkthrough">
              What are your current mortgage details?
             </h2>
             <div class="input-inner-content">
              <span class="input-info-walkthrough">
               This will help us determine whether or not you will qualify for a refinance.
              </span>
              <div class="input-expandable-value">
              </div>
              <div class="input-popout clearfix">
               <i class="input-close fa fa-remove">
               </i>
               <div class="title">
                Current Mortgage Details
               </div>
               <div class="row ud-balance-unknown">
                <span class="mb-div">
                 Do you know your mortgage balance?
                </span>
                <input class="no-autosave hidedefault" field="ud-balance-unknown" id="ud-balance-unknown-y-1655247320" name="ud-balance-unknown-1655247320" type="radio" value="0"/>
                <label class="radio" for="ud-balance-unknown-y-1655247320">
                 Yes
                </label>
                <input class="no-autosave hidedefault" field="ud-balance-unknown" id="ud-balance-unknown-n-1655247320" name="ud-balance-unknown-1655247320" type="radio" value="1"/>
                <label class="radio" for="ud-balance-unknown-n-1655247320">
                 No
                </label>
               </div>
               <div class="row balance-known ud-re-current-mtg-balance">
                Current mortgage balance
                <span class="tightcontainer dollar">
                 <input class="dollar no-autosave autonumeric" data-m-dec="0" data-v-max="99999999" name="ud-re-current-mtg-balance" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row balance-unknown ud-re-original-mtg-value">
                Initial mortgage balance
                <span class="tightcontainer dollar">
                 <input class="dollar no-autosave autonumeric" data-m-dec="0" data-v-max="99999999" name="ud-re-original-mtg-value" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row ud-re-original-mtg-type">
                Mortgage Type
                <div class="mb">
                </div>
                <span>
                 <select class="select2 no-autosave" name="ud-re-original-mtg-type">
                  <option value="2">
                   Fixed30Y
                  </option>
                  <option value="1">
                   Fixed15Y
                  </option>
                 </select>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row balance-known ud-re-current-mtg-term">
                Remaining mortgage term
                <span class="tightcontainer">
                 <input class="no-autosave autonumeric" data-m-dec="0" data-v-max="999" name="ud-re-current-mtg-term" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row balance-unknown ud-re-original-mtg-start">
                Mortgage start year
                <span class="tightcontainer">
                 <input class="no-autosave autonumeric" data-a-sep="" data-m-dec="0" data-v-max="99999" name="ud-re-original-mtg-start" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row balance-known ud-re-current-mtg-rate no-bottom-margin">
                Mortgage interest rate
                <span class="tightcontainer percentage">
                 <input class="percentage no-autosave autonumeric" data-m-dec="2" data-v-max="99" name="ud-re-current-mtg-rate" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <div class="row balance-unknown ud-re-original-mtg-rate no-bottom-margin">
                Mortgage interest rate
                <span class="tightcontainer percentage">
                 <input class="percentage no-autosave autonumeric" data-m-dec="2" data-v-max="99" name="ud-re-original-mtg-rate" type="text"/>
                </span>
                <p class="error-message">
                </p>
               </div>
               <button class="next">
                Next
               </button>
               <button class="close-icon-text cancel only-mobile">
                Skip
               </button>
               <button class="mobile-cancel" onclick="smartasset.inputs.hidePopout();">
                Skip
               </button>
              </div>
              <script>
               $(function() {
        var inputContainer = $('#inputs-walkthrough .ud-balance-unknown');

        // set visibility of either balance known or unknown
        var setVisibility = function(isBalanceUnknown) {
            // toggle which inputs are displayed
            if (isBalanceUnknown) {
                inputContainer.find(".balance-known").hide();
                inputContainer.find(".balance-unknown").show();
            } else {
                inputContainer.find(".balance-unknown").hide();
                inputContainer.find(".balance-known").show();
            }
        };

        var displayValue = function(inputElement, value) {
            try {
                inputElement.autoNumeric("set", value);
            } catch (err) {
                // todo - log error
                inputElement.val();
            }
        };

        // display input values provided by the server
        var displayValues = function() {
            // Show/hide the appropriate inputs (UD_REBalanceUnknown)
            var isBalanceUnknown = '1' === smartasset.inputs.getValue("ud-balance-unknown");
            setVisibility(isBalanceUnknown);

            inputContainer.find("input[name='ud-balance-unknown-1655247320'][value='1']").prop('checked', isBalanceUnknown);

            var balance = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-current-mtg-balance"));
            displayValue(inputContainer.find("input[name='ud-re-current-mtg-balance']"), balance);

            var originalBalance = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-value"));
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-value']"), originalBalance);

            var mortgageType = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-type"));
            inputContainer.find("select[name='ud-re-original-mtg-type']").val(mortgageType).select2({
                minimumResultsForSearch: -1
            });

            var remainingTerm = smartasset.inputs.getValue("ud-re-current-mtg-term");
            if (typeof remainingTerm === "string") {
                remainingTerm = remainingTerm.split(":")[0];
                smartasset.math.getInteger(remainingTerm);
                displayValue(inputContainer.find("input[name='ud-re-current-mtg-term']"), remainingTerm);
            }

            var startYear = smartasset.math.getInteger(smartasset.inputs.getValue("ud-re-original-mtg-start"));
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-start']"), startYear);

            var interestRateForKnownBalance = smartasset.math.getFloat(smartasset.inputs.getValue("ud-re-current-mtg-rate")).toFixed(2);
            displayValue(inputContainer.find("input[name='ud-re-current-mtg-rate']"), interestRateForKnownBalance);

            var interestRateForUnknownBalance = smartasset.math.getFloat(smartasset.inputs.getValue("ud-re-original-mtg-rate")).toFixed(2);
            displayValue(inputContainer.find("input[name='ud-re-original-mtg-rate']"), interestRateForUnknownBalance);

            smartasset.inputs.displayPopoutErrors(inputContainer);

            // display the summary text in the left sidebar
            var message = "";
            if (isBalanceUnknown) {
                message += "Initial Mortgage: $" + smartasset.math.commatoze(originalBalance, 0) + "&lt;br&gt;";
                message += "Interest Rate: " + interestRateForUnknownBalance + "%";
            } else {
                message += "Current Mortgage: $" + smartasset.math.commatoze(balance, 0) + "&lt;br&gt;";
                message += "Interest Rate: " + interestRateForKnownBalance + "%";
            }
            inputContainer.find(".input-expand-details").html(message);

        };

        // when "know your balance?" changes, swap out the inputs
        inputContainer.find("input[name='ud-balance-unknown-1655247320']").on("change", function() {
            setVisibility(inputContainer.find("input[name='ud-balance-unknown-1655247320'][value='1']").prop('checked'));
        });

        // validate and submit inputs
        var save = function() {
            // submit the values they customer set; ignore hidden defaults
            if (inputContainer.find("input[name='ud-balance-unknown-1655247320'][value='1']").prop('checked')) {
                // balance unknown
                smartasset.inputs.save({
                    "ud-balance-unknown": inputContainer.find("input[name='ud-balance-unknown-1655247320']:checked").val(),
                    "ud-re-original-mtg-value": inputContainer.find("input[name='ud-re-original-mtg-value']").val(),
                    "ud-re-original-mtg-type": inputContainer.find("select[name='ud-re-original-mtg-type']").val(),
                    "ud-re-original-mtg-start": inputContainer.find("input[name='ud-re-original-mtg-start']").val(),
                    "ud-re-original-mtg-rate": inputContainer.find("input[name='ud-re-original-mtg-rate']").val()
                });
            } else {
                // balance known
                smartasset.inputs.save({
                    "ud-balance-unknown": inputContainer.find("input[name='ud-balance-unknown-1655247320']:checked").val(),
                    "ud-re-current-mtg-balance": inputContainer.find("input[name='ud-re-current-mtg-balance']").val(),
                    "ud-re-original-mtg-type": inputContainer.find("select[name='ud-re-original-mtg-type']").val(),
                    "ud-re-current-mtg-term": inputContainer.find("input[name='ud-re-current-mtg-term']").val() + ":0",
                    "ud-re-current-mtg-rate": inputContainer.find("input[name='ud-re-current-mtg-rate']").val()
                });
            }
        };

        // submit the inputs on "next" or enter key
        inputContainer.find("input").keydown(function(e) { if (e.keyCode == 13) { save(); } });
        inputContainer.find(".next").unbind("click").click(save);

        //
        // before popup is shown, reload the data (imagine someone canceled the popup, hit escape, etc)
        //
        smartasset.hooks.register("beforePopoutShow", displayValues);

        // returns array of inputs active in the popup
        var getActiveInputs = function() {
            var isBalanceUnknown = '1' === smartasset.inputs.getValue("ud-balance-unknown");
            if (isBalanceUnknown) {
                return ["ud-balance-unknown",
                    "ud-re-original-mtg-value",
                    "ud-re-original-mtg-type",
                    "ud-re-original-mtg-start",
                    "ud-re-original-mtg-rate"];
            }

            return ["ud-balance-unknown",
                "ud-re-current-mtg-balance",
                "ud-re-original-mtg-type",
                "ud-re-current-mtg-term",
                "ud-re-current-mtg-rate"];
        };

        //
        // register the onInputsLoaded method
        //
        smartasset.hooks.register("onInputsLoaded", function() {
            if (smartasset.inputs.reshowPopout(getActiveInputs()))  {
                setTimeout(function() {
                    smartasset.inputs.popout($(".input.expandable.ud-balance-unknown"));
                }, 50);
            }

            displayValues();
        });
    });
              </script>
              <span class="close-icon-text">
               Do this later
              </span>
              <i class="close-icon fa fa-close">
              </i>
              <div class="input-note">
               <span>
               </span>
               <i class="close" onclick='smartasset.inputs.dismiss("ud-balance-unknown")'>
                Dismiss
               </i>
              </div>
              <div class="input-expand-details">
              </div>
             </div>
            </div>
           </div>
           <div class="border-bottom">
           </div>
          </div>
          <div class="input ud-current-location " data-name="ud-current-location">
           <div class="highlighter">
            <div class="input-content sa-inputs">
             <div class="input-progress">
              <div class="input-mobile-position">
              </div>
              <span class="input-mobile-hrd">
               <div class="walkthrough-profile">
               </div>
               Add your details
              </span>
              <span class="input-progress-value">
               <div class="complete">
               </div>
              </span>
             </div>
             <span class="input-label">
              <span class="glossary" data-align="right" data-content="Desired location of homeownership.  Depending on which page your are on, this field will help calculate taxes, available mortgages and/or closing costs." data-title="Location">
               Location
              </span>
              <span class="trigger">
              </span>
             </span>
             <h2 class="input-label-walkthrough">
              What is the location of your home?
             </h2>
             <div class="input-inner-content">
              <span class="input-info-walkthrough">
               Your location will help us find available mortgages and calculating costs specific to your area.
              </span>
              <input class="no-autosave" name="ud-current-location" style="display: none" type="text" value=""/>
              <input autocomplete="off" autocorrect="off" class="no-autosave" name="ud-current-location-display" type="text"/>
              <script>
               $(function()
    {
        $("#inputs-walkthrough .ud-current-location .next").unbind("click").on("click", function()
        {
            smartasset.inputs.saveInput($("#inputs-walkthrough .ud-current-location input[name='ud-current-location']"));
        });

        var saveOnBlur = false;

        smartasset.inputs.makeLocation("#inputs-walkthrough .ud-current-location input[name='ud-current-location-display']", "#inputs-walkthrough .ud-current-location input[name='ud-current-location']", saveOnBlur);

        smartasset.hooks.register("onInputsLoaded", function()
        {
            var location = $("#inputs-walkthrough .ud-current-location input[name='ud-current-location-display']").val();
            // parse location
            location = smartasset.tools.parseLocation(location);
            $("#inputs-walkthrough .ud-current-location input[name='ud-current-location-display']").val(location);
        });
    });
              </script>
              <span class="close-icon-text">
               Do this later
              </span>
              <i class="close-icon fa fa-close">
              </i>
              <div class="input-note">
               <span>
               </span>
               <i class="close" onclick='smartasset.inputs.dismiss("ud-current-location")'>
                Dismiss
               </i>
              </div>
              <button class="next ">
               Next
              </button>
              <button class="close-icon-text cancel only-mobile">
               Skip
              </button>
              <div class="input-expand-details">
              </div>
             </div>
            </div>
           </div>
           <div class="border-bottom">
           </div>
          </div>
         </div>
         <script>
          (function() {
        var default_UD_ReNewMtgRate = 4.25;
        var UD_ReNewMtgRate = 'ud-re-new-mtg-rate';
        var UD_RECustomClosing = 'ud-re-custom-closing';
        var UHD_HOA_Fixed = 'uhd-hoa-fixed';
        var UD_RENewMtgTerm = 'ud-re-new-mtg-term';
        var isFirstLoad = true;
        var interestSlider, closingCostSlider, mortgageTermSlider;

        /**
         * Display the input values on the top of the interactive area
         */
        var displayOnPageInputs = function() {
            var inputs = smartasset.data.getInputsData();
            var pageData = smartasset.data.getPageData();

            var newRate = smartasset.math.getFloat(inputs[UD_ReNewMtgRate].value);
            var newMtgTerm = smartasset.math.getInteger(inputs[UD_RENewMtgTerm].value);
            var closingCost = 0;
            var defaultClosingCosts =  0;
            if (pageData &amp;&amp; typeof pageData['refinanced_mortgage_closing_costs'] === 'number') {
                defaultClosingCosts = pageData['refinanced_mortgage_closing_costs'];
            }

            // set the closing costs
            if (inputs[UD_RECustomClosing] &amp;&amp; _.isNumber(smartasset.math.getFloat(inputs[UD_RECustomClosing].value))) {
                closingCost = smartasset.math.getFloat(inputs[UD_RECustomClosing].value);
            } else {
                // only set the closing costs if it's available
                closingCost = defaultClosingCosts;
            }
            
            // set default
            closingCostSlider.setDefault(defaultClosingCosts);
            $('.refinanced_mortgage_closing_costs').html(smartasset.math.commatoze(defaultClosingCosts));

            // display warnings on inputs in the interactive area
            //
            var newMtgRateError = $('.interest-rate-container');
            if (inputs[UD_ReNewMtgRate] &amp;&amp; inputs[UD_ReNewMtgRate].state === 'W') {
                newMtgRateError.removeClass('custom');
                newMtgRateError.addClass('warning');
                newMtgRateError.find('.msg-text').html(inputs[UD_ReNewMtgRate].note);
            } else if (inputs[UD_ReNewMtgRate] &amp;&amp; inputs[UD_ReNewMtgRate].state === 'C' &amp;&amp; default_UD_ReNewMtgRate != inputs[UD_ReNewMtgRate].value) {
                newMtgRateError.addClass('custom');
                newMtgRateError.removeClass('warning');
            } else {
                newMtgRateError.removeClass('custom');
                newMtgRateError.removeClass('warning');
            }
            
            var customClosing = $('.closing-cost-container');
            if (inputs[UD_RECustomClosing] &amp;&amp; inputs[UD_RECustomClosing].state === 'W') {
                customClosing.removeClass('custom');
                customClosing.addClass('warning');
                customClosing.find('.msg-text').html(inputs[UD_RECustomClosing].note);
            } else if (inputs[UD_RECustomClosing] &amp;&amp; inputs[UD_RECustomClosing].state === 'C' &amp;&amp; defaultClosingCosts != inputs[UD_RECustomClosing].value) {
                customClosing.addClass('custom');
                customClosing.removeClass('warning');
            } else {
                customClosing.removeClass('custom');
                customClosing.removeClass('warning');
            }

            var mortgateTerm = $('.mortgage-term-container');
            if (inputs[UD_RENewMtgTerm] &amp;&amp; inputs[UD_RENewMtgTerm].state === 'W') {
                mortgateTerm.removeClass('custom');
                mortgateTerm.addClass('warning');
                mortgateTerm.find('.msg-text').html(inputs[UD_RENewMtgTerm].note);
            } else if (inputs[UD_RENewMtgTerm] &amp;&amp; inputs[UD_RENewMtgTerm].state === 'C') {
                mortgateTerm.addClass('custom');
                mortgateTerm.removeClass('warning');
            } else {
                mortgateTerm.removeClass('custom');
                mortgateTerm.removeClass('warning');
            }

            if (interestSlider) {
                interestSlider.setValue(newRate);
            }

            if (closingCostSlider) {
                closingCostSlider.setValue(closingCost);
            }

            if (mortgageTermSlider) {
                mortgageTermSlider.setValue(newMtgTerm);
            }
        };

        // set widgets on the page
        $(function() {
            interestSlider = new smartasset.refinanceCalculator.InterestSlider(UD_ReNewMtgRate, 2.0, 12.0, default_UD_ReNewMtgRate);
            closingCostSlider = new smartasset.refinanceCalculator.ClosingCostSlider(UD_RECustomClosing, 0, 300000);
            mortgageTermSlider = new smartasset.refinanceCalculator.MortgageTermSlider(UD_RENewMtgTerm, 1, 30);
        });

        // on inputs load, parse and display them
        smartasset.hooks.register('onInputsLoaded', function() {
            var pageError = smartasset.data.pageValidation().getPageError();

            if (pageError) {
                smartasset.inputs.showPageError(pageError);
            } else if (!smartasset.data.getPageData()) {
                smartasset.inputs.showPageError("In order to qualify for a Refinance, your new mortgage amount plus your cash out amount must be below a certain percentage of your current home value. You can correct this by adjusting your Current Home Value, Cash Out Amount, or Mortgage Amount in the Current Mortgage Details field.");
            } else {
                smartasset.inputs.hidePageError();
                displayOnPageInputs();
                smartasset.refinanceCalculator.displayValues(smartasset.math.getInteger(smartasset.data.getInputsData()[UHD_HOA_Fixed].value));
            }

            if (isFirstLoad) {
                isFirstLoad = false;
            } else {
                smartasset.hooks.call("triggerMortgageBlockUpdate");
            }
        });

    }());
         </script>
         <div class="interactive-content smartasset-ui">
          <div id="validation-overlay">
          </div>
          <div id="validation-display">
           <div>
           </div>
          </div>
          <div id="green-tooltip">
           <div class="arroww">
           </div>
           <div class="arrow">
           </div>
           <span class="proxima">
            Update your information here.
           </span>
           <div class="btn">
            OK
           </div>
          </div>
          <div class="refi-calc">
           <div class="padded">
            <table cellpadding="0" cellspacing="0" class="new-mtg-details">
             <tr>
              <td colspan="5">
               <!--Refinancing &lt;span class="monthly-savings-verb"&gt;&lt;/span&gt; you&lt;br&gt;&lt;span class="monthly-savings-value"&gt;$&lt;span class="monthly-savings"&gt;&lt;/span&gt;/month&lt;/span&gt;-->
               <div class="answer-text">
               </div>
              </td>
             </tr>
             <tr>
              <td colspan="5">
               <div style="height: 38px">
               </div>
              </td>
             </tr>
             <tr>
              <!--&lt;td class="top-details" colspan="2"&gt;Refinance Details&lt;/td&gt;-->
              <td class="top-details" colspan="3">
               <span style="float: left; margin-right: 0px;">
                Refinance Mortgage Amount
                <span class="new-mortgage-symbol">
                 $
                </span>
                <span class="new-mortgage-amount">
                </span>
               </span>
              </td>
             </tr>
             <tr class="r-boxes">
              <td class="slider-box interest-rate-container">
               <div class="slider-left">
                <div class="slider-label">
                 Interest Rate
                </div>
                <span class="tightcontainer percentage">
                 <input class="interest-rate autonumeric percentage" data-a-dec="." data-a-sep="," data-m-dec="0" disabled="" type="text"/>
                </span>
                <div class="spacer s10">
                </div>
                <div class="smartasset-ui">
                 <div class="interest-rate input-slider sa extended">
                  <div class="extension">
                  </div>
                 </div>
                </div>
                <div class="spacer s10">
                </div>
                <div class="slider-reset">
                 Reset to (4.25%)
                </div>
                <div class="msg-container">
                 <span class="msg-text">
                 </span>
                 <br/>
                 <i class="close">
                  Dismiss
                 </i>
                </div>
               </div>
              </td>
              <td class="middle-col">
              </td>
              <td class="slider-box closing-cost-container">
               <div class="slider-center">
                <div class="slider-label">
                 Closing Costs
                </div>
                <span class="tightcontainer dollar">
                 <input class="closing-cost autonumeric dollar" data-a-dec="." data-a-sep="," data-m-dec="0" disabled="" type="text"/>
                </span>
                <div class="spacer s10">
                </div>
                <div class="smartasset-ui">
                 <div class="closing-cost input-slider sa noUi-horizontal noUi-extended">
                 </div>
                </div>
                <div class="spacer s10">
                </div>
                <div class="slider-reset">
                 Reset to ($
                 <span class="refinanced_mortgage_closing_costs">
                 </span>
                 )
                </div>
                <div class="msg-container">
                 <span class="msg-text">
                 </span>
                 <br/>
                 <i class="close">
                  Dismiss
                 </i>
                </div>
               </div>
              </td>
              <td class="middle-col">
              </td>
              <td class="slider-box mortgage-term-container">
               <div class="slider-right">
                <div class="slider-label">
                 Refinance Mortgage Term
                </div>
                <span class="tightcontainer years">
                 <input class="mortgage-term autonumeric years" data-a-dec="." data-a-sep="," data-m-dec="0" disabled="" type="text"/>
                </span>
                <div class="spacer s10">
                </div>
                <div class="smartasset-ui">
                 <div class="mortgage-term input-slider sa noUi-horizontal noUi-extended">
                 </div>
                </div>
                <div class="spacer s10">
                </div>
                <div class="msg-container">
                 <span class="msg-text">
                 </span>
                 <br/>
                 <i class="close">
                  Dismiss
                 </i>
                </div>
               </div>
              </td>
             </tr>
            </table>
            <div class="spacer s20">
            </div>
            <div class="spacer s5">
            </div>
            <div class="graphic-title">
             Monthly Cost Comparison
            </div>
            <div class="spacer s10">
            </div>
            <div class="monthly-comparison-chart">
            </div>
            <table cellpadding="0" cellspacing="0" class="monthly-comparison">
             <tr class="minh">
              <td>
               <div class="only-mobile refi-title">
                Current Mortgage
               </div>
               <div class="existing-mortgage-insurance-monthly">
                <span class="legend sm">
                </span>
                <span class="glossary" data-align="top" data-content="Insurance paid by the borrower that protects the mortgage lender in case the borrower defaults on his loan, usually expressed as a percentage of loan value. It is paid until the loan balance is less than 80% of home value for conventional loans, and 78% for FHA loans." data-title="Mortgage Insurance">
                 *Mortgage Insurance
                </span>
                <span class="right">
                 $
                 <span class="value">
                 </span>
                </span>
               </div>
               <div class="existing-mortgage-term">
                <span class="legend sm">
                </span>
                Mortgage Term
                <span class="right">
                </span>
               </div>
               <div class="existing-mortgage-rate">
                <span class="legend sm">
                </span>
                Interest Rate
                <span class="right">
                 <span class="value">
                 </span>
                 %
                </span>
               </div>
              </td>
              <td class="md">
               <div class="only-mobile refi-title">
                Refinance Mortgage
               </div>
               <div class="refinance-mortgage-insurance-monthly">
                <span class="legend sm">
                </span>
                <span class="glossary" data-align="top" data-content="Insurance paid by the borrower that protects the mortgage lender in case the borrower defaults on his loan, usually expressed as a percentage of loan value. It is paid until the loan balance is less than 80% of home value for conventional loans, and 78% for FHA loans." data-title="Mortgage Insurance">
                 *Mortgage Insurance
                </span>
                <span class="right">
                 $
                 <span class="value">
                 </span>
                </span>
               </div>
               <div class="refinance-mortgage-term">
                <span class="legend sm">
                </span>
                Mortgage Term
                <span class="right">
                </span>
               </div>
               <div class="refinance-mortgage-rate">
                <span class="legend sm">
                </span>
                Interest Rate
                <span class="right">
                 <span class="value">
                 </span>
                 %
                </span>
               </div>
              </td>
             </tr>
            </table>
            <div class="spacer s10">
            </div>
            <div class="spacer s10">
            </div>
            <div class="spacer s10">
            </div>
           </div>
           <b class="mortgage-box-title">
            Mortgage Type Options
            <span class="glossary info-icon" data-align="top" data-content="There are different options for the type of loan you secure.&lt;br/&gt; With a &lt;b&gt;fixed-rate&lt;/b&gt; loan the interest rate charged will remain the same for that loans entire term, no matter what market interest rates do. As a result, the monthly mortgage payment will not change.
&lt;br/&gt;With an &lt;b&gt;adjustable-rate&lt;/b&gt; mortgage the interest rate changes, generally on an annual basis, as the market interest rate changes. Often structured to have a steady monthly payment for a specified period of time before adjusting." data-title="Select Mortgage Type">
            </span>
           </b>
           <div class="custom-riklam" id="mortgage-block">
            <div class="tab-container">
             <ul class="etabs clearfix">
              <li class="tab Fixed30Y">
               <a href="#mtg-Fixed30Y">
                <span class="default-label">
                 30 yr Fixed
                </span>
                <span class="mob-label">
                 <b>
                  30
                 </b>
                 <i>
                  yr Fixed
                 </i>
                </span>
                <img src="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/smload.gif"/>
               </a>
              </li>
              <li class="tab Fixed15Y">
               <a href="#mtg-Fixed15Y">
                <span class="default-label">
                 15 yr Fixed
                </span>
                <span class="mob-label">
                 <b>
                  15
                 </b>
                 <i>
                  yr Fixed
                 </i>
                </span>
                <img src="//d1l53avkert0hz.cloudfront.net/files/5056/images/base/smload.gif"/>
               </a>
              </li>
             </ul>
             <div class="mortgageBox" id="mtg-Fixed30Y">
             </div>
             <div class="mortgageBox" id="mtg-Fixed15Y">
             </div>
            </div>
            <div class="bottom clearfix">
             <span class="disclosure">
              Disclosure
             </span>
             <span class="more" onclick="mortgageblock.ratesTableRedirect();">
              <span class="link">
               View more mortgages
              </span>
             </span>
            </div>
           </div>
           <script>
            mortgageblock = {};

    // get the list of LoanProducts to show in the
    mortgageblock.types = ["Fixed30Y","Fixed15Y"];

    /**
     * Start the mortgage block
     */
    mortgageblock.start = function(force)
    {
        if (jQuery.type(force) !== "boolean")
        {
            force = false;
        }

        if (force || mortgageblock.hasKeyChanged())
        {
            mortgageblock.key = mortgageblock.getKey();
            mortgageblock.rates();

            $("#mortgage-block .tab-container div.mortgageBox.active").each(function ()
            {
                mortgageblock.populate($(this).attr("id").substring(4, 30));
            });

            $("#mortgage-block .tab-container div.mortgageBox:not(.active)").each(function ()
            {
                mortgageblock.populate($(this).attr("id").substring(4, 30));
            });
        }
    }

    mortgageblock.loading = function(id, flag)
    {
        if (flag == true)
        {
            $("li." + id + " img").css("visibility", "visible");
            //$("li." + id + " span").hide();
        }
        else
        {
            $("li." + id + " img").css("visibility", "hidden");
            //$("li." + id + " span").show();
        }
    }

    /**
     * Populate the mortgage block
     */
    mortgageblock.populate = function(id)
    {
        mortgageblock.loading(id, true);

        //console.log("Update request for ", id);
        $.get("/api/ajax/mortgage/get?type=2&amp;product=" + id, function (data)
        {
//            if (data.show_sponsor)
//            {
//                $(".sofi-sponsor").show();
//            }
//            else
//            {
//                $(".sofi-sponsor").hide();
//            }

            mortgageblock.loading(id, false);
            var e = "#mtg-" + id;
            if (data[id] != null)
            {
                var mortgages = data[id].mortgages;
                if (_.isEmpty(mortgages))
                {
                    mortgageblock.showNotFound(id);
                }
                else
                {
                    mortgageblock.populateMortgages(id, mortgages);
                }
            }
            else
            {
                mortgageblock.showNotFound(id);
            }
        }).error(function(c)
        {
            // error loading mortgage data
            mortgageblock.loading(id, false);
            // if debugging, show error in console log
            //console.log("ERROR: ", id, c)
        });
    }

    mortgageblock.showNotFound = function(id)
    {
        $("#mtg-" + id).empty().append("&lt;div class='notfound'&gt;No mortgages were found.&lt;/div&gt;");
        smartasset.analytics.track(smartasset.analytics.events.NoMortgagesFound, {
            id: id,
            pageurl: window.location.pathname
        });
    }

    mortgageblock.rates = function()
    {
        // PC -- do nothing here (SA-402)
        return;

        $.get("/api/ajax/mortgage/rates?type=2", function (data)
        {
            var userLoanProduct = data["user_loan_product"];
            if (userLoanProduct !== undefined &amp;&amp; userLoanProduct != null)
            {
                // set the tab
                $("#mortgage-block .tab-container").easytabs('select', "#mtg-" + userLoanProduct);
            }

            _.each(data, function (object, key)
            {
                if (object != null &amp;&amp; object.mortgages !== undefined)
                {
                    var mortgage = object.mortgages[0];
                    $("#mortgage-block .tab." + key + " span").html("("+smartasset.math.commatoze(mortgage.rate, 2)+"%)");
                }
            });
        });
    }

    /**
     * Convert the JSON mortgage data into objects on the page
     */
    mortgageblock.populateMortgages = function(id, mortgages)
    {
        var counter = 0, mobile = $(document).width() &lt; 758;
        // empty the block
        $("#mtg-" + id).empty();

        _.each(mortgages, function (mortgage)
        {
            if (counter != 0)
            {
                $("#mtg-" + id).append("&lt;hr /&gt;");
            }

            var mtg = "&lt;div class='mtg clearfix' onClick=\"smartasset.mortgage.click('"+mortgage.applyNowUrl+"', '"+mtgid+"')\"&gt;";
            var mtgid = mortgage.source + "." + mortgage.lenderName;

            mtg += "&lt;div class='mtg-logo'&gt;&lt;img src='" + mortgage.logoUrl + "' onClick=\"smartasset.mortgage.click('"+mortgage.applyNowUrl+"', '"+mtgid+"')\"/&gt;&lt;/div&gt;";

            //console.log(mortgage);
            var offerdetails = smartasset.mortgagerates != null ? smartasset.mortgagerates.getOfferDetails(mortgage) : "";

            //console.log("OD: " +offerdetails);

            if (offerdetails != null &amp;&amp; offerdetails != "")
            {
                offerdetails = offerdetails.replace(/"/g, "&quot;");
                offerdetails = '&lt;span class="offer-details" data-content="'+offerdetails+'"&gt;Offer details&lt;/span&gt;';
            }

            if (mobile)
            {
                mtg += "&lt;div class='mtg-name'&gt;&lt;b&gt;" + mortgage.lenderName + " &lt;/b&gt;&lt;span class='lght'&gt;NMLS: " + mortgage.nmls + "&lt;/span&gt; &lt;br/&gt;";
                mtg += mortgage.label + " &lt;br/&gt;";
                mtg += "Rate: " + smartasset.math.commatoze(mortgage.rate, 2) + "%";
                mtg += " | APR: " + smartasset.math.commatoze(mortgage.apr, 2) + "%";
                mtg += "&lt;/div&gt;";
            }
            else
            {
                mtg += "&lt;div class='mtg-name'&gt;" + mortgage.lenderName + "&lt;br/&gt;NMLS: " + mortgage.nmls + "&lt;/div&gt;";
                mtg += "&lt;div class='mtg-label'&gt;" + mortgage.label + "&lt;br/&gt;";
                mtg += "Rate: " + smartasset.math.commatoze(mortgage.rate, 2) + "%";
                mtg += " | APR: " + smartasset.math.commatoze(mortgage.apr, 2) + "%";
                mtg += " | Points: " + smartasset.math.commatoze(mortgage.pointsPaid, 2);

                if (mortgage.label.indexOf("ARM") &gt; -1)
                {
                    mtg += "&lt;span class='caps'&gt; Interest Rate Caps: "+ mortgage.initialCap+ "/" + mortgage.yearlyCap+ "/" +mortgage.lifetimeCap +" &lt;/span&gt;";
                }

                mtg += "&lt;/div&gt;";

            }

            //var url = "/api/tracker/mortgage?source=" + mortgage.source + "&amp;lender=" + mortgage.lenderName + "&amp;url=" + encodeURIComponent(mortgage.applyNowUrl);

            var label = "View Details";
            if (mobile)
            {
                label = "&lt;i class='fa fa-angle-right'&gt;&lt;/i&gt;";
            }

            mtg += "&lt;div class='mtg-button'&gt;&lt;span class='button' onClick=\"smartasset.mortgage.click('"+mortgage.applyNowUrl+"', '"+mtgid+"')\"&gt;"+label+"&lt;/span&gt;" + offerdetails+ "&lt;/div&gt;";
            mtg += "&lt;/div&gt;"

            $("#mtg-" + id).append(mtg);

            counter++;
        });

        $('.offer-details').each(function (c, e)
        {
            var content = $(e).attr('data-content');
            //console.log("CT: " + content);
            $(e).tooltipster({
                theme: "tooltipster-light disclosure",
                position: "top",
                speed: 0,
                maxWidth: 400,
                interactive: true,
                noSwitch: false, // Flip if near edge of the browser
                contentAsHTML: true,
                content: content
            });
        });

        // resize the interaction area
        smartasset.inputs.resizeInteraction();
    }

    // key of the last mortgages requested
    mortgageblock.key = "";

    // generate key for mortgageblock.key
    mortgageblock.getKey = function()
    {
        var location = smartasset.inputs.getValue("ud-current-location");
        var homevalue = smartasset.inputs.getValue("cs-home-value");
        var downpayment = smartasset.inputs.getValue("cs-down-payment");
        // generate the key
        if (location == null || homevalue == null || downpayment == null)
        {
            return "";
        }
        var key = location + "." + homevalue + "." + downpayment;
        return key;
    }

    mortgageblock.hasKeyChanged = function()
    {
        var newkey = mortgageblock.getKey();
        if (newkey != mortgageblock.key &amp;&amp; newkey != "")
        {
            return true;
        }
        return false;
    }

    /**
     * Redirect to the mortgage rates table
     */
    mortgageblock.ratesTableRedirect = function()
    {
        var loanProduct = $("div.mortgageBox.active").first().attr("id").substring(4, 30);
        var queryString = "?type=refi" + "&amp;loanProduct=" + loanProduct;
        var url = '/mortgage/mortgage-rates';

        window.location = url + queryString;
    };

    /**
     *
     * Start the mortgages block
     *
     */
    $(function()
    {
        // create mortgage tabs
        $("#mortgage-block .tab-container").easytabs({
            animate: false,
            updateHash: false
        }).bind("easytabs:after", function()
        {
            var id = $(this).find("div.mortgageBox.active").first().attr("id").substring(4, 30);

            // mortgage tab changed
            $.get("/api/ajax/mortgage/set?type=2&amp;product=" + id, function()
            {
                //console.log("SETTING ID: " +id+ " NOUP: " +mortgageblock.noupdate);
                // update the inputs -- which will update the page
                smartasset.inputs.update(!mortgageblock.noupdate);

                smartasset.analytics.track(smartasset.analytics.events.MortgageTypeChange, {
                    page: window.location.pathname,
                    mortgageType: "2"
                });

                mortgageblock.noupdate = false;
            });
        });

        setTimeout(mortgageblock.start, 1500);
    });

    smartasset.hooks.register("onInputsLoaded", function()
    {
        mortgageblock.start();
    });

    mortgageblock.updateTimer = null;

    mortgageblock.triggerUpdate = function()
    {
        mortgageblock.start(true);
    };

    /**
     * Use this hook to force an update of the Mortgage Block
     */
    smartasset.hooks.register("triggerMortgageBlockUpdate", function()
    {
        //console.log("triggerMortgageBlockUpdate");
        if (mortgageblock.updateTimer != null)
        {
            clearTimeout(mortgageblock.updateTimer);
            mortgageblock.updateTimer = null;
        }

        mortgageblock.updateTimer = setTimeout(mortgageblock.triggerUpdate, 600);
    });

    smartasset.hooks.register("changeMortgageBlock", function(params)
    {
        // params should be
        // loanProduct: &lt;string&gt; Fixed30Y|Fixed15Y|Arm3Y1|Arm5Y1|Arm7Y1
        // triggerInputUpdate: &lt;boolean&gt; true|false
        var loanProduct = "", triggerInputUpdate = true;
        if (params != null &amp;&amp; typeof(params) == "object")
        {
            if (_.has(params, "loanProduct"))
            {
                loanProduct = params.loanProduct;
            }
            else
            {
                console.error("changeMortgageBlock hook called without loanProduct parameter.");
                return;
            }

            if (_.has(params, "triggerInputUpdate"))
            {
                triggerInputUpdate = params.triggerInputUpdate;
            }

            // update block
            //console.log("triggerInputUpdate: " ,triggerInputUpdate);
            var e = "#mtg-" + loanProduct;
            mortgageblock.noupdate = !triggerInputUpdate;
            $("#mortgage-block .tab-container").easytabs('select', e);
        }
        else
        {
            console.error("changeMortgageBlock hook called without parameters.");
        }
    });

    $(function()
    {
        // attach tooltips on page load
        $("#mortgage-block .disclosure").tooltipster({
            theme: "tooltipster-light disclosure",
            position: "top",
            speed: 0,
            maxWidth: 400,
            interactive: true,
            noSwitch: false, // Flip if near edge of the browser
            contentAsHTML: true,
            content: "&lt;h3&gt;LendingTree Disclosure&lt;/h3&gt;Rates, APRs, Monthly Payment Amounts, Fees, Points, and Origination data shown in the LendingTree LoanExplorer, NMLS#1136, rate table are examples only and do not take into consideration taxes or insurance.  If you choose an ARM, your payment will likely increase at the stated interval. Mortgage rate quotes displayed on LendingTree LoanExplorer, including loan pricing data, rates and fees, are provided by third party data providers including, but not limited to, Mortech, a registered trademark of Zillow, LoanXEngine, a product of Mortgage Builder Software, Inc., and LoanTek, Inc. For more information go to &lt;a href='http://www.lendingtree.com' target='_blank' class='std'&gt;www.lendingtree.com&lt;/a&gt;."
        })
    });

    /**
     * For SOFI sponsored listing only -- can be removed when campaign is stopped
     * @constructor
     */
    mortgageblock.Sofi = function()
    {
        smartasset.analytics.track("sofi.click", {
            referer: document.referrer,
            pageurl: window.location.pathname
        });

        var url ='/api/tracker/click?tag=mortgagerates.sofi.3&amp;url='+encodeURIComponent("http://sofi.com/smartassetmortgage");
        smartasset.page.goTo(url, true);

        return false;
    }
    //@ sourceURL=mortgages_html.js
           </script>
           <div class="padded">
            <div class="spacer s10">
            </div>
            <div class="spacer s10">
            </div>
            <div class="graphic-title">
             Total Savings from Refinancing, by Year
            </div>
            <p class="subtitle">
             The total
             <span class="lifetime-difference-magnitude">
              savings
             </span>
             from refinancing over
             <span class="years-compared">
              --
             </span>
             years is $
             <span class="lifetime-difference">
             </span>
            </p>
            <div class="spacer s10">
            </div>
            <div class="chart-time">
            </div>
            <div class="legend-box">
             <div class="content">
              <div>
               <span class="legend sm bg-light-blue">
               </span>
               Total Savings from Refinancing
              </div>
              <div>
               <span class="legend sm bg-light-gray">
               </span>
               Total Costs from Refinancing
              </div>
              <div>
               <span class="legend sm fg-light-blue">
                <i class="fa fa-minus">
                </i>
               </span>
               <b>
                Break Even Year
               </b>
              </div>
             </div>
            </div>
           </div>
          </div>
          <div style="height: 20px;">
          </div>
         </div>
        </div>
       </div>
       <div class="right-column clearfix">
        <div class="other-tools side-links" data-swiftype-index="false">
         <b class="title">
          More From SmartAsset
         </b>
         <div>
          <ul class="sa_links">
           <li>
            <a href="/mortgage/mortgage-rates?type=refi">
             Compare refinance rates
            </a>
           </li>
           <li>
            <a href="/mortgage/mortgage-calculator">
             Calculate monthly mortgage payments
            </a>
           </li>
           <li>
            <a href="/mortgage/closing-costs">
             Calculate closing costs
            </a>
           </li>
          </ul>
         </div>
        </div>
        <div class="sharing right-col clearfix">
         <b class="title" data-swiftype-index="false">
          Share
         </b>
         <div data-swiftype-index="false">
          <div class="blog-sharing clearfix ">
           <div class="share-numbers proxima">
           </div>
           <div>
            <a href="javascript:void(0)" onclick='smartasset.share.twitterShare("Refinance Calculator", "/refinance/refinance-calculator");'>
             <img alt="Twitter" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0001_twitter_c.png')"/>
            </a>
           </div>
           <div>
            <a href="javascript:void(0)" onclick='smartasset.share.facebookShare("Refinance Calculator", "/refinance/refinance-calculator");'>
             <img alt="Facebook" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0000_facebook_c.png')"/>
            </a>
           </div>
           <div>
            <a href="javascript:void(0)" onclick='smartasset.share.googleShare("/refinance/refinance-calculator");'>
             <img alt="Google" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0002_google_plus_c.png')"/>
            </a>
           </div>
           <div>
            <a href="javascript:void(0)" onclick='smartasset.share.linkedinShare("Refinance Calculator", "/refinance/refinance-calculator", "Refinance+Calculator")'>
             <img alt="LinkedIn" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0003_linkedin_c.png')"/>
            </a>
           </div>
           <div>
            <a href="javascript:void(0)" onclick='smartasset.share.redditShare("Refinance Calculator", "/refinance/refinance-calculator");'>
             <img alt="reddit" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0004_reddit_c.png')"/>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="sharing" style="clear:both; height: 10px">
        </div>
        <div class="riklam-sm riklam" source="medium">
         <!-- Site Medium Ad 1 -->
         <div class="holder-r-md" id="riklam-md-S0K7uy_103264" style="width:300px; ">
          <script type="text/javascript">
           //var width = window.innerWidth || document.documentElement.clientWidth;
        //if (width &gt; 1120)
        //{
            googletag.cmd.push(function ()
            {
                var mslotS0K7uy_103264 = googletag.defineSlot('137419494/site_medium_1', [300, 250], 'riklam-md-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //
                                mslotS0K7uy_103264.setTargeting("page_type", "Interactive");
mslotS0K7uy_103264.setTargeting("page_group", "Refinance");
mslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
mslotS0K7uy_103264.setTargeting("app_mode", "prod");

mslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-md-S0K7uy_103264');

                // load ads with a timeout -- due to IE issues!
                setTimeout(function()
                {
                    googletag.pubads().refresh([mslotS0K7uy_103264]);
                }, 500);
            });
        //}
          </script>
         </div>
        </div>
        <div class="clearfix">
        </div>
        <div class="next-steps formatted second" data-swiftype-index="false">
         <b class="title">
          More about this page
         </b>
         <div>
          <ul>
           <li>
            <a href="#details-section" onclick='smartasset.page.selectTab("#main-tabs", "#tabs1-html")'>
             About this answer
            </a>
           </li>
           <li>
            <a href="#details-section" onclick='smartasset.page.selectTab("#main-tabs", "#tabs1-js")'>
             How do we calculate this answer
            </a>
           </li>
           <li>
            <a href="#learn">
             Learn more about refinancing your home
            </a>
           </li>
           <li>
            <a href="#map">
             <b>
              Infographic:
             </b>
             See where people are saving the most by refinancing
            </a>
           </li>
          </ul>
         </div>
        </div>
        <div class="riklam-lg riklam" source="large">
         <!-- Site Large Ad 1 -->
         <div class="holder-r-lg" id="riklam-lg-S0K7uy_103264" style="width:300px;">
          <script type="text/javascript">
           var width = window.innerWidth || document.documentElement.clientWidth;
        if (width &gt; 1120)
        {
            googletag.cmd.push(function ()
            {
                var lslotS0K7uy_103264 = googletag.defineSlot('137419494/site_large_1', [300, 600], 'riklam-lg-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //
                                lslotS0K7uy_103264.setTargeting("page_type", "Interactive");
lslotS0K7uy_103264.setTargeting("page_group", "Refinance");
lslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
lslotS0K7uy_103264.setTargeting("app_mode", "prod");

lslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-lg-S0K7uy_103264');

                // load ads with a timeout -- due to IE issues!
                setTimeout(function()
                {
                    googletag.pubads().refresh([lslotS0K7uy_103264]);
                }, 500);
            });
        }
    &lt;/script&gt;
&lt;/div&gt;
    &lt;/div&gt;
    &lt;/div&gt;
            &lt;div class='left-column spacer-top nps-block proxima'&gt;
    &lt;div class='vote-buttons'&gt;
        &lt;span&gt;How helpful was this page in answering your question?&lt;/span&gt;
        &lt;div class='vote-container clearfix'&gt;
            &lt;div class='vote' data-value='0'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='1'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='2'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='3'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='4'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='5'&gt;&lt;/div&gt;
            &lt;div class='vote' data-value='6'&gt;&lt;/div&gt;
            &lt;div class='labels clearfix'&gt;
                &lt;div class='left'&gt;not helpful&lt;/div&gt;
                &lt;div class='right'&gt;very helpful&lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='vote-comment'&gt;
        &lt;span class="question"&gt;If you could change one thing about this page what would it be?&lt;/span&gt;
        &lt;br/&gt;
        &lt;textarea maxlength="500"&gt;&lt;/textarea&gt;
        &lt;button&gt;Submit&lt;/button&gt;
    &lt;/div&gt;
    &lt;div class='vote-thanks'&gt;
        Thank you for your answer! Your feedback is very important to us.
    &lt;/div&gt;
    &lt;div class="vote-email"&gt;
        We are working hard to improve our product and could use your help!&lt;br/&gt;
        &lt;b&gt;We pay $30 for 30 minutes on the phone to hear your thoughts on what we can do better.&lt;/b&gt;
        &lt;div class='spacer s10'&gt;&lt;/div&gt;
        Please enter your email if you'd like to be contacted to help.
        &lt;br/&gt;&lt;br/&gt;
        &lt;table style="width: 100%; max-width: 570px; margin-bottom: 18px" cellpadding=0 cellspacing=0&gt;
            &lt;tbody&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;input class="name" placeholder="Name" maxlength="245"&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;input class="email" placeholder="Contact Email" maxlength="245"&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button class="submit"&gt;Submit&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button class="cancel"&gt;No Thanks&lt;/button&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div class="name-error"&gt;Please enter your name&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div class="email-error"&gt;Please enter a valid email&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
    $(window).load(function()
    {
        // Vote
        //
        $(".nps-block .vote").click(function()
        {
            smartasset.page.showLoading("Voting...");
            var v = $(this).attr("data-value");
            var item = $(this);

            // trigger analytics event for nps vote
            // adding +1 to vote in order to display the correct scale
            //
            smartasset.analytics.track(smartasset.analytics.events.NPSVote , {
                vote: parseInt(v)+1
            });

            // submit vote
            //
            $.get("/api/ajax/nps/vote?page_key="+smartasset.page.pageKey+"&amp;vote="+v, function (d)
            {
                $(".nps-block div.vote").removeClass("selected");
                $(item).addClass("selected");

                smartasset.page.hideLoading();
                //$(".nps-block .vote-buttons").hide();
                $(".nps-block .vote-comment").show();
            });
        });

        // Comment
        //
        $(".nps-block .vote-comment button").click(function()
        {
            smartasset.page.showLoading("Submitting...");
            var msg = $(".nps-block textarea").val();

            // submit comment
            //
            $.ajax({
                type: "POST",
                url: "/api/ajax/nps/comment",
                data: {page_key: smartasset.page.pageKey, comment: msg},
                success: function(d)
                {
                    smartasset.page.hideLoading();
                    $(".nps-block .vote-buttons").hide();
                    $(".nps-block .vote-comment").hide();

                    var vote = $(".nps-block .selected").attr("data-value");

                    // check if the vote was bigger than the bottom two (in scale 0-6)
                    // display thank you banner
                    //
                    if (vote &gt;= 2)
                    {
                        displayThanks();
                    }
                    // else display the email submission form
                    //
                    else
                    {
                        // trigger analytics event for email view
                        //
                        smartasset.analytics.track(smartasset.analytics.events.NPSEmailViewed , {});

                        $(".nps-block .vote-email").show();
                    }
                }
            });
        });

        // Email submission
        //
        $(".nps-block .vote-email .submit").click(function()
        {
            // get variables from the page
            //
            var name = $(".nps-block .vote-email input.name").val();
            var email = $(".nps-block .vote-email input.email").val();
            var msg = $(".nps-block textarea").val();
            var vote = $(".nps-block .selected").attr("data-value");

            // reset errors on page
            //
            $('.nps-block .vote-email div.name-error').hide();
            $('.nps-block .vote-email div.email-error').hide();
            $('.nps-block .vote-email input.name').removeClass('error');
            $('.nps-block .vote-email input.email').removeClass('error');

            // verify values on name and email
            //
            if (name === "" || email === "")
            {
                // validate name
                if (name === "")
                {
                    $('.nps-block .vote-email div.name-error').show();
                    $('.nps-block .vote-email input.name').addClass('error');
                }
                // validate email for empty input
                if (email === "")
                {
                    $('.nps-block .vote-email div.email-error').show();
                    $('.nps-block .vote-email input.email').addClass('error');
                }
            }
            // if not errors at all submit to server
            //
            else
            {
                smartasset.page.showLoading("Submitting...");

                console.log(email, name, vote, msg);

                // submit vote
                //
                $.ajax({
                    type: "POST",
                    url: "/api/ajax/nps/email",
                    data: {page_key: smartasset.page.pageKey, email: email, name: name, vote: vote, comment: msg},
                    success: function(d)
                    {
                        // check if there is an error
                        if (d.status === '1')
                        {
                            // display alert for email address
                            //
                            $('.nps-block .vote-email div.email-error').show();
                            $('.nps-block .vote-email input.email').addClass('error');
                            smartasset.page.hideLoading();
                        }
                        else
                        {
                            $('.nps-block div.vote-email-error').hide();
                            $(".nps-block .vote-email").hide();

                            displayThanks();
                        }
                    }
                });
            }
        });

        // Email form cancel
        //
        $(".nps-block .vote-email .cancel").click(function()
        {
            // trigger analytics event for email cancel
            //
            smartasset.analytics.track(smartasset.analytics.events.NPSEmailClosed, {});

            $(".nps-block .vote-email").hide();
            displayThanks();
        });

        /**
         * Method to display the thank you banner
         */
        var displayThanks = function()
        {
            smartasset.page.hideLoading();

            $(".nps-block").addClass("green");
            $(".nps-block .vote-thanks").show();

            setTimeout(function()
            {
                $(".nps-block").fadeOut();
            }, 2000);
        };
    });
          </script>
          <div class="liner left-column">
          </div>
          <div class="tab-container left-column spacer-top" data-swiftype-name="body" data-swiftype-type="text" id="main-tabs">
           <a class="stop" name="details-section">
           </a>
           <ul class="etabs">
            <li class="tab">
             <a href="#tabs1-html">
              About This Answer
             </a>
            </li>
            <li class="tab">
             <a href="#tabs1-js">
              Our Assumptions
             </a>
            </li>
           </ul>
           <div id="tabs1-html">
            <p>
             Our refinance tool helps you with two important considerations:  how refinancing will impact your mortgage payment, and whether
            refinancing, given the cost over time, makes financial sense.  Calculating the first part is relatively straightforward. We
            simply show you existing mortgage rates and the corresponding mortgage payments that would result from a refinance to each rate.
            This allows you to see the difference between monthly payments after a refinance and what you pay now. The second part is a little more complicated. Different loans allow you to build equity in your
            home at different rates. They also have different fees and tax consequences.  So to calculate the total cost of a mortgage
            over time, we take into account all of the upfront fees (including relevant taxes), any mortgage insurance that may be necessary,
            the monthly mortgage payments, the tax benefits (if any) and other costs directly related to a refinancing decision.  This allows
            us to flag times when even if your monthly mortgage payment may be decreasing, the total cost of a loan may actually be increasing -
            which could cost you more money in the long run.
            </p>
           </div>
           <div id="tabs1-js">
            <p>
             <b>
              Mortgage rates:
             </b>
             We show you live mortgage rates to help you with your refinance comparison.
            </p>
            <p>
             <b>
              Mortgage balance:
             </b>
             If you do not know your current mortgage balance, we estimate it assuming that you pay
            normal mortgage payments with no prepayments.
            </p>
            <p>
             <b>
              Closing expenses:
             </b>
             We use local data to calculate all closing costs (fees related to the mortgage, in
            addition to fees or taxes assessed by the government, if applicable).
            </p>
            <p>
             <b>
              Monthly expenses:
             </b>
             We use local data to calculate any additional local expenses like real estate taxes
            or homeowner's insurance payments, among others.
            </p>
            <p>
             <b>
              Return on savings:
             </b>
             We use a default assumption of 4%. This number is important in our calculation
            of "opportunity cost. You can edit this input on the left side of the page.
            </p>
            <p>
             <b>
              Inflation:
             </b>
             We use a default assumption of 2%. You can edit this in our "Advanced" input section.
            </p>
            <p>
             <b>
              HOA fees:
             </b>
             We assume that HOA fees are a fixed expense that grow with inflation.
            </p>
            <p>
             <b>
              Homeowners insurance:
             </b>
             We assume homeowners insurance is a percentage of your overall home value.
            </p>
           </div>
          </div>
          <div class="riklam-wd left-column spacer-top spacer-bottom centered riklam" source="wide">
           <!-- Site Banner 1 -->
           <div class="holder-r-wd" id="riklam-wd-S0K7uy_103264" style="width:728px; height:90px;">
            <script type="text/javascript">
             var width = window.innerWidth || document.documentElement.clientWidth;
        if (width &gt; 350)
        {
            googletag.cmd.push(function ()
            {
                var wslotS0K7uy_103264 = googletag.defineSlot('137419494/site_banner_1', [728, 90], 'riklam-wd-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //
                                wslotS0K7uy_103264.setTargeting("page_type", "Interactive");
wslotS0K7uy_103264.setTargeting("page_group", "Refinance");
wslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
wslotS0K7uy_103264.setTargeting("app_mode", "prod");

wslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-wd-S0K7uy_103264');

                // load ads with a timeout -- due to IE issues!
                setTimeout(function()
                {
                    googletag.pubads().refresh([wslotS0K7uy_103264]);
                }, 500);
            });
        }
            </script>
           </div>
          </div>
          <div class="riklam-mobile left-column spacer-top spacer-bottom centered riklam" source="mobile">
           <!-- Site Mobile 1 -->
           <div class="holder-r-mob" id="riklam-mob-S0K7uy_103264" style="width:300px; height:50px;">
            <script type="text/javascript">
             var width = window.innerWidth || document.documentElement.clientWidth;
        if (width &lt; 769)
        {
            googletag.cmd.push(function ()
            {
                var mbslotS0K7uy_103264 = googletag.defineSlot('137419494/site_mobile_1', [300, 50], 'riklam-mob-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //
                                mbslotS0K7uy_103264.setTargeting("page_type", "Interactive");
mbslotS0K7uy_103264.setTargeting("page_group", "Refinance");
mbslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
mbslotS0K7uy_103264.setTargeting("app_mode", "prod");

mbslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-mob-S0K7uy_103264');
                googletag.pubads().refresh([mbslotS0K7uy_103264]);
            });
        }
            </script>
           </div>
          </div>
          <div class="left-column seocontent std" data-swiftype-name="body" data-swiftype-type="text">
           <a class="stop" name="learn">
           </a>
           <h2>
            Refinance Calculator
           </h2>
           <p>
            Your neighbors are doing it. Youve read some articles that now is the right time. You even got something in the mail about
        being a good candidate. All this may be true, but when it comes to answering the question Should I refinance?, its ultimately
        a personal decision. A refinance calculator can take your financial information and help you figure out if its really right
        for you. But before you can even do that, you need to make sure you know exactly what it is everyones talking about.
           </p>
           <h3>
            What is refinancing?
           </h3>
           <p>
            Refinancing a mortgage entails getting a new loan on your home with new terms. It is generally done to either change the length
        of the loan or get a more beneficial (aka lower) interest rate. Of course, you could also be refinancing to get some equity out
        of your home (to free up some cash to use elsewhere).
           </p>
           <p>
            If youre looking to build equity in your home sooner, you can refinance to a shorter term loan. This will mean your monthly
        payments will be higher but you will be done paying off your loan sooner. You will own the home outright in a shorter period
        of time. Overall, the cost of the home will be lower because you will pay less interest.
           </p>
           <p>
            If you are looking to free up cash for other needs, you might want to do the opposite. By refinancing to a longer term, you
        will have lower monthly payments. But you will be making these payments for a longer time and in the end paying more interest.
        Still, this can be helpful if other expenses in your monthly budget have gone up or you have other investment opportunities
        you want to explore.
           </p>
           <h3>
            Things you need to know
           </h3>
           <p>
            This can be a big decision. When you first bought the house you probably thought you were done thinking about mortgages,
        interest rates and all of that. But as with many financial decisions, its a good idea to revisit your mortgage situation and
        make sure it is still in your best interest.
           </p>
           <p>
            There are many factors you should consider when determining whether to refinance. These include your current mortgage size,
        the new mortgage you would be taking out, the current home value, the current interest rate of your loan, the new interest
        rate and the closing costs.
           </p>
           <h3>
            OK, so should I be doing it?
           </h3>
           <p>
            To see if refinancing makes sense for you, try out a refinance calculator. You enter some specific information and the refinance
        calculator determines what makes the most sense for your particular situation. Then you can even play around a little bit to see
        what factors would change the recommendations.
           </p>
           <p>
            The main number you are looking out for is the point when the monthly savings of the new mortgage become greater than the
        up-front costs of refinancing. In other words, how long will it take you to recoup the fees you paid to do the refinance?
        If that number is within the timeframe you plan on staying in the house, you may want to refinance.
           </p>
           <p>
            A good refinance calculator (like the SmartAsset one above, lucky you!) will show you the two scenarios  keeping your current
        mortgage and getting a new one. Then you can see how your monthly payment will be affected and how much you can expect to pay
        in closing costs. This also shows that very important timeframe for how long you have to maintain the new mortgage to save enough
        money to cover the up-front costs. Basically, this is the point when you start actually saving money.
           </p>
           <h3>
            Reasons you might want to refinance
           </h3>
           <p>
            In 2007 (the peak of the recent "housing bubble"), the average interest rate on a 30-year mortgage was 6.34%. As of May 2015, that
        rate is around 3.8%. So theres a chance you could see a big drop in your interest rate by refinancing. If you can now qualify
        for a lower-interest loan, it can save you a significant amount of money over a 15- or 30-year mortgage.
           </p>
           <p>
            Its not just interest rates that change, though. Youve probably changed a bit since you got your mortgage as well. If youve
        grown not just older, but wiser too, you may have improved your credit score. This means that while you might have had good
        credit before, now that you have EXCELLENT credit, you may qualify for a better interest rate.
           </p>
           <p>
            Another sign that you should be refinancing is if you want to change the terms on your mortgage. One example of this is the
        length of the mortgage, which we touched on before. You can get a longer mortgage to make monthly payments smaller or a shorter
        mortgage to reduce overall costs. But you can also switch from an adjustable-rate mortgage to a fixed rate. If youve been
        enjoying a low rate with your ARM but now you want some stability, you can use a refinance as an opportunity to lock in a fixed rate.
           </p>
           <h3>
            Reasons you might not want to refinance
           </h3>
           <p>
            Refinancing usually requires you to have a certain amount of equity in your home. If you dont have that, refinancing can be
        tough. The general rule is that lenders like you to have at least 20% equity in your home but there are exceptions.
           </p>
           <p>
            Gone through some difficult financial times since you got your first mortgage? Say your credit has gotten worse since you first
        got your mortgage. You may not qualify for a refinance mortgage even if interest rates are available that are lower.
           </p>
           <p>
            Just like when you get a mortgage to first buy a home, there are some fees to refinancing your mortgage. The closing costs for
        a refinance cover things like application, loan origination and appraisal fees. If you dont have the money to pay for closing
        costs up front, there is an option to roll them into the new mortgage. But this isnt always the best decision. Sometimes adding
        those extra costs to your new monthly mortgage payments can negate any savings the refinance would otherwise get you.
           </p>
           <p>
            Planning to move soon or have a job that uproots you regularly? Refinancing may not make sense because it generally takes some
        time to recoup those up-front closing costs.
           </p>
           <p>
            And one more reason you might want to hold off on refinancing your mortgage: if you have to pay a penalty on your original mortgage.
        Some lenders will charge you a fee for paying off your mortgage early, even if youre refinancing. Again, this could totally negate
        the savings of the refinance.
           </p>
           <h3>
            Making the decision
           </h3>
           <p>
            Ultimately, whether you should refinance your current mortgage will come down to your specific situation. A refinance calculator
        can help you determine if its right for you. Happy number crunching!
           </p>
           <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=zpg73gjie77f5gg5jy6xbqs3ei">
           </script>
          </div>
          <div class="left-column hash-content map-content">
           <a class="stop map" name="map">
           </a>
           <div class="map-hashstation" id="map-container">
            <h2>
             See Where People are Saving the Most by Refinancing
            </h2>
            <div class="std">
             <p>
              SmartAssets interactive refinance map highlights the counties across the country with both the highest total and highest per
            loan savings homeowners secure from refinancing. Zoom between states and the national map to see the top counties
            in each region, and scroll over any county for more information.
             </p>
            </div>
            <div class="filters clearfix">
            </div>
            <div class="map" id="mapcanvas">
            </div>
            <div class="map-legend">
             <div class="legendary">
              <div class="note left" id="legend-left">
               Least
              </div>
              <div class="note right" id="legend-right">
               Most
              </div>
              <div class="bg-map-7">
              </div>
              <div class="bg-map-6">
              </div>
              <div class="bg-map-5">
              </div>
              <div class="bg-map-4">
              </div>
              <div class="bg-map-3">
              </div>
              <div class="bg-map-2">
              </div>
              <div class="bg-map-1">
              </div>
             </div>
            </div>
            <div class="clearfix" id="map-table-container" style="">
             <a class="stop" name="map-data">
             </a>
             <table cellpadding="0" cellspacing="0" width="100%">
              <tr class="head">
               <th>
                Rank
               </th>
               <th style="min-width: 120px">
                County
               </th>
               <th class="c1 vals">
                Loans Refinanced
               </th>
               <th class="c2 vals">
                Average Refinance Amount
               </th>
               <th class="c3 vals">
                Annual Savings Per Loan
               </th>
               <th class="c4 vals">
                Annual County Savings
               </th>
               <th>
               </th>
              </tr>
              <tbody class="table-content">
              </tbody>
             </table>
            </div>
            <div class="methodology">
             <a class="stop" name="map-methodology">
             </a>
             <p>
              <b>
               Methodology
              </b>
              Refinance mortgages are an important part of the overall mortgage industry, saving homeowners billions of dollars every year. So where is refinancing having the biggest impact? To answer that question, SmartAsset looked at data on pre- and post-refinance interest rates, and the total balance of refinanced mortgages in every county in the U.S.
             </p>
             <p>
              Specifically, we applied the national average pre-refinance interest rate of 5.88% and the national average post-refinance rate of 3.98% to the total balance of refinanced loans in every U.S. county. That gave us the expected total interest payments with, and without, refinancing. The difference between those two numbers yielded the total refinance savings by county. We also divided the total savings by the number of loans per county to produce the average savings per refinance.
             </p>
             <p>
              <i class="sources">
               Sources: Mortgage Bankers Association, Freddie Mac's Q4 2013 Refinance Report
              </i>
             </p>
            </div>
           </div>
           <script type="text/javascript">
            (function ()
    {
        //
        // Start off with some variables
        // FOR DEBUGGING:
        //   1. comment out the "(function()" linn above, the opening-brace { and the end-brace } at the end
        //   2. the will make all variables "global" and help in debugging from the browser console
        //
        // Otherwise, all variables should be wrapped in this anonymous function to avoid clashes
        // with other data on the page
        //
        var STATE_DATA = {},
                COUNTY_COUNT = 0,
                FILTER = "",
                MAP = new smartasset.map("mapcanvas");

        // Set the filter definitions
        var totalSavingsFilterConfig = smartasset.maps.createFilterConfig("Total Refinance Savings", "index2", "Total Savings Index", "Total savings from refinancing at the county level.", ["c1", "c2", "c4"]);
        var savingsPerLoanFilterConfig = smartasset.maps.createFilterConfig("Savings Per Refinance Loan", "index1", "Savings Per Loan Index", "Average amount saved (per loan) from refinancing at the county level.", ["c1", "c2", "c3"]);

        // Set the filters you need on the page.
        // setFilters (container, filters {code:label, code, label}, change-filter-event)
        MAP.setFilters($("#map-container .filters"), {"total-savings": totalSavingsFilterConfig, "savings-per-loan": savingsPerLoanFilterConfig}, function (f)
        {
            // update selected filter
            if (FILTER != f)
            {
                FILTER = f;
                updateMarkers();
                MAP.redraw();

                MAP.updateHash({filter: f});
            }
        });

        //
        // Here's the method to customize county colors
        //
        MAP.getColor = function (feature)
        {
            // get the FIPS for the county
            var id = feature.getProperty("STATE") + feature.getProperty("COUNTY");
            // get the COUNTY object from the Map data
            var item = MAP.getMapData()[id];
            if (item !== undefined &amp;&amp; item != null)
            {
                var range = COUNTY_COUNT / 7;

                // finally check whether
                var state = feature.getProperty("STATE");

                // if we have a "selected" state, and we are not coloring the selected
                // state counties, the we return "white" as we want to gray-out any
                // counties outside the selected state.
                if (MAP.getSelectedState() != null &amp;&amp; MAP.getSelectedState() != "" &amp;&amp; state != MAP.getSelectedState())
                {
                    return "#fff";
                }

                // get rank -- in this case, we use another local method
                // since we want to rank base on the selected filter
                var rank = getRank(item);

                if (rank &lt; range)
                {
                    return smartasset.maps.COLOR1;
                }
                else if (rank &lt; (range * 2))
                {
                    return smartasset.maps.COLOR2;
                }
                else if (rank &lt; (range * 3))
                {
                    return smartasset.maps.COLOR3;
                }
                else if (rank &lt; (range * 4))
                {
                    return smartasset.maps.COLOR4;
                }
                else if (rank &lt; (range * 5))
                {
                    return smartasset.maps.COLOR5;
                }
                else if (rank &lt; (range * 6))
                {
                    return smartasset.maps.COLOR6;
                }
                return smartasset.maps.COLOR7;
            }

            // return some default color (we should never really get here)
            return "#f0f0f0";
        }


        //
        // Get rank for the county
        //
        function getRank(item)
        {
            //
            // check filter, and return rank
            // for that filter
            //
            if (FILTER == "total-savings")
            {
                return item.f2;
            }
            else if (FILTER == "savings-per-loan")
            {
                return item.f1;
            }
            return item.rank;
        }

        //
        // when user selects a state, or we select one programmatically,
        // this method will get called. We can override the function,
        // as below, to update data displayed in the table, etc
        //
        MAP.onSetSelectedState = function (state)
        {
            // show data for state
            if (state != null &amp;&amp; state != "")
            {
                var data = MAP.getMapData();
                var matched = [];
                _.each(data, function (item)
                {
                    if (item.code.substring(0, 2) == state)
                    {
                        matched.push(item);
                    }
                });

                // sort the data
                matched = matched.sort(function (a, b)
                {
                    if (a.rank &lt; b.rank)
                    {
                        return -1;
                    }
                    if (a.rank &gt; b.rank)
                    {
                        return 1;
                    }
                    return 0;
                });
            }

            MAP.updateHash({state: state});
            updateMarkers();
        }

        /**
         * Override the "setHash" function
         */
        MAP.setHash = function()
        {
            var state = MAP.getHash().value("state");
            var statename = MAP.getStateInfo(state);

            if (statename == null)
            {
                statename = "us";
            }
            else
            {
                statename = statename.name.replace(/\s+/g, '').toLowerCase();
            }

            var filter = MAP.getHash().value("filter");
            if (filter === undefined|| filter == null || filter == "")
            {
                window.location.hash = statename;
            }
            else
            {
                window.location.hash = statename + "/" + filter;
            }
        }

        //
        // afterLoad is called AFTER all data is loaded in for the map
        // In this case, we check the page "hash" and zoom into a selected
        // state, and/or set the selected filter
        //
        MAP.afterLoad = function ()
        {
            var state = MAP.getHash().value("state");
            if (state != null &amp;&amp; state != "")
            {
                MAP.zoomInto(state);
            }

            var filter = MAP.getHash().value("filter");
            if (jQuery.type(filter) !== "undefined")
            {
                MAP.selectFilter(filter);
            }

            updateMarkers();

            MAP.hideLoading();
        }


        //
        // Get top ranked counties -- a helper function
        // Returns array of objects
        // as [{code: 12342, rank: 2}, {code: 44221, rank: 4}]
        //
        function getTopRanked(state)
        {
            var matched = [];
            var data = MAP.getMapData();
            _.each(data, function (item)
            {
                var rank = getRank(item);
                if ((state == "" &amp;&amp; rank &lt; 11) || state == item.code.substring(0, 2))
                {
                    matched.push({code: item.code, rank: rank});
                }
            });

            // sort matched list
            matched = matched.sort(function (a, b)
            {
                if (a.rank &lt; b.rank)
                {
                    return -1;
                }
                if (a.rank &gt; b.rank)
                {
                    return 1;
                }
                return 0;
            });

            return matched;
        }

        //
        // Update the county markers -- another helper function
        //
        function updateMarkers()
        {
            MAP.clearMarkers();

            // add pins
            var matched = getTopRanked(MAP.getSelectedState());

            // get top 10
            if (matched.length &gt; 10)
            {
                matched = matched.slice(0, 10);
            }

            // display the index column header
            $("#map-table-container table tr.head th:last-child").html(MAP.getIndexColumnHeader());

            var counter = 0;
            var state_code = "";
            $("#map-table-container table tbody.table-content").empty();
            _.each(matched, function (i)
            {
                var location = MAP.getCentroid(i.code);
                MAP.addMarker(location, i.code, ++counter);

                var county = MAP.getMapData()[i.code];
                var html = "&lt;tr code='" + i.code + "'&gt;&lt;td&gt;" + (counter) + "&lt;/td&gt; " +
                        "&lt;td&gt;" + county.cn + ", " + county.st + "&lt;/td&gt;" +
                        "&lt;td class='c1 vals'&gt;" + smartasset.math.commatoze(county.note1) + " &lt;/td&gt; " +
                        "&lt;td class='c2 vals'&gt;$" + smartasset.math.commatoze(county.note2) + " &lt;/td&gt; " +
                        "&lt;td class='c3 vals'&gt;$" + smartasset.math.commatoze(county.note3) + " &lt;/td&gt; " +
                        "&lt;td class='c4 vals'&gt;$" + smartasset.math.commatoze(county.note4) + " &lt;/td&gt; " +
                        "&lt;td&gt;" + smartasset.math.commatoze(MAP.getIndexColumnValue(county), smartasset.maps.indexColumnDecimalPlaces) + " &lt;/td&gt; " +
                        "&lt;/tr&gt;";

                state_code = county.st;
                $("#map-table-container table tbody.table-content").append(html);
            });

            var state = STATE_DATA["00"];
            var state_label = "Nationwide";

            // add nationwide or state data
            if (MAP.getSelectedState() != null &amp;&amp; MAP.getSelectedState() != "")
            {
                state = STATE_DATA[MAP.getSelectedState()];
                state_label = state_code;
            }

            var html = "&lt;tr class='total'&gt;&lt;td&gt;&lt;/td&gt; " +
                    "&lt;td&gt;" + state_label + "&lt;/td&gt;" +
                    "&lt;td class='c1 vals'&gt;" + smartasset.math.commatoze(state.note1) + " &lt;/td&gt; " +
                    "&lt;td class='c2 vals'&gt;$" + smartasset.math.commatoze(state.note2) + " &lt;/td&gt; " +
                    "&lt;td class='c3 vals'&gt;$" + smartasset.math.commatoze(state.note3) + " &lt;/td&gt; " +
                    "&lt;td class='c4 vals'&gt;$" + smartasset.math.commatoze(state.note4) + " &lt;/td&gt; " +
                    "&lt;/tr&gt;";

            $("#map-table-container table tbody.table-content").append(html);

            // update filter again
            MAP.highlightColumns(FILTER);

            //
            // handle "mouseover" event for each table-row
            //
            $("#map-table-container table tbody.table-content tr").on("mouseover", function ()
            {
                var code = $(this).attr("code");
                // handle click event
                var markers = MAP.getMarkers();
                for (var i = 0; i &lt; markers.length; i++)
                {
                    if (markers[i].code == code)
                    {
                        MAP.showMarkerInfo(markers[i]);
                        break;
                    }
                }
            });
        }

        //
        // clear map markers
        //
        function clearMarkers()
        {
            _.each(MARKERS, function (e)
            {
                e.setMap(null);
                e = null;
            });

            MARKERS = [];
        }

        //
        // Add a county marker
        //
        function addMarker(location, code, counter)
        {
            // To add the marker to the map, use the 'map' property
            var marker = new google.maps.Marker({
                position: location,
                map: MAP.getMap(),
                clickable: true,
                code: code,
                zIndex: 20 + counter,
                counter: counter,
                icon: smartasset.maps.getIcon(counter, false)
            });

            google.maps.event.addListener(marker, 'mouseover', function ()
            {
                marker.setIcon(smartasset.maps.getIcon(marker.counter, true));
                marker.setZIndex(100);
                showMarkerInfo(marker);
            });

            google.maps.event.addListener(marker, 'mouseout', function ()
            {
                marker.setZIndex(20 + counter);
                marker.setIcon(smartasset.maps.getIcon(marker.counter, false));
            });

            MARKERS.push(marker);
        }

        //
        // Method show infowindow on a marker
        //
        function showMarkerInfo(marker)
        {
            var message = MAP.getInfoMessage(marker.code, "");
            MAP.showInfoWindow(message, marker.getPosition(), {y: 35});

            HIGHLIGHTED = marker;

            marker.setIcon(smartasset.maps.getIcon(marker.counter, true));
            marker.setZIndex(100);
        }

        //
        // Method to get infowindow message. Name is the State or County Name
        // depending on the type of object we are handling.
        //
        MAP.getInfoMessage = function (id, name)
        {
            if (id.length == 2)
            {
                var counter = 1;
                var matched = getTopRanked(id);
                // state id
                var info = "&lt;h2&gt;" + name + "&lt;/h2&gt; Top Counties&lt;br/&gt;";

                _.each(matched, function (match)
                {
                    if (match.rank &lt; 11 || counter &lt; 3)
                    {
                        var county = MAP.getMapData()[match.code];
                        info += "&lt;b&gt;" + counter + ". " + county.cn + "&lt;/b&gt;&lt;br/&gt; Ranked  #" + getRank(county) + " nationally";
                        info += "&lt;br/&gt;";
                        counter++;
                    }
                });

                return info;

            }
            else if (id.length == 5)
            {
                var ranked = getStateRank(id);
                var county = MAP.getMapData()[id];

                var info = "&lt;h2&gt;" + county.cn + ", " + county.st + "&lt;/h2&gt;";
                info += "State rank: &lt;b&gt;" + ranked + "&lt;/b&gt;&lt;br/&gt;";
                info += "National rank: &lt;b&gt;" + getRank(county) + "&lt;/b&gt;&lt;br/&gt;";
                info += "Loans Refinanced: &lt;b&gt;" + smartasset.math.commatoze(county.note1) + "&lt;/b&gt;&lt;br/&gt;";
                info += "Average Refinance Amount: &lt;b&gt;$" + smartasset.math.commatoze(county.note2) + "&lt;/b&gt;&lt;br/&gt;";
                info += "Annual Savings Per Loan: &lt;b&gt;$" + smartasset.math.commatoze(county.note3) + "&lt;/b&gt;&lt;br/&gt;";
                info += "Annual County Savings: &lt;b&gt;$" + smartasset.math.commatoze(county.note4) + "&lt;/b&gt;";
                return info;
            }
        }

        //
        // Get the state-rank for a particular county
        // County is a 5-digit FIPS county-code
        //
        function getStateRank(county)
        {
            var matched = getTopRanked(county.substring(0, 2));
            for (var i = 0; i &lt; matched.length; i++)
            {
                if (matched[i].code == county)
                {
                    return i + 1;
                }
            }
            return 9999;
        }

        //
        // parse the page hash, and go to "map canvas" if valid
        //
        MAP.onParseHash = function(hash)
        {
            if (hash !== undefined &amp;&amp; hash != null)
            {
                var state = hash, filter = "", slash = hash.indexOf("/");

                if (slash &gt; -1)
                {
                    state = hash.substring(0, slash);
                    filter = hash.substring(slash + 1, hash.length);
                }

                if (MAP.isState(state))
                {
                    MAP.getHash().set("filter", filter);
                    MAP.getHash().set("state", MAP.getFips(state));

                    MAP.scrollTo($("#mapcanvas"));
                }
            }
        }

        //
        // onLoad is called upon starting the map. It should be used to load any data. In this
        // example, we load CSV data files. Data-loads are handled concurrently.
        //
        MAP.onLoad = function ()
        {
            // load state data next
            smartasset.maps.loadData(REQUIRE_BASE_URL + "/data/hashes/refinance/refinance-state.csv", function (s)
            {
                STATE_DATA = {};
                var counter = 0;
                // get map data
                _.each(s, function (row)
                {
                    if (counter &gt; 0)
                    {
                        var o = {code: row[0],
                            note1: smartasset.math.getInteger(row[1]),
                            note2: smartasset.math.getFloat(row[2]),
                            note3: smartasset.math.getFloat(row[3]),
                            note4: smartasset.math.getFloat(row[4])
                        };
                        STATE_DATA["" + row[0]] = o;
                    }
                    counter++;
                });
            });

            // then load county data
            smartasset.maps.loadData(REQUIRE_BASE_URL + "/data/hashes/refinance/refinance-county.csv", function (d)
            {
                var counter = 0;
                // get map data
                var obj = {};
                _.each(d, function (row)
                {
                    if (counter &gt; 0)
                    {
                        var o = {code: row[0], cn: row[1], st: row[2],
                            note1: smartasset.math.getInteger(row[3]),
                            note2: smartasset.math.getFloat(row[4]),
                            note3: smartasset.math.getFloat(row[5]),
                            note4: smartasset.math.getFloat(row[6]),
                            index1: smartasset.math.getFloat(row[7]),
                            index2: smartasset.math.getFloat(row[8]),
                            f1: smartasset.math.getInteger(row[9]),
                            f2: smartasset.math.getInteger(row[10]),
                            rank: smartasset.math.getInteger(row[10])
                        };
                        obj["" + row[0]] = o;
                    }
                    counter++;
                });

                COUNTY_COUNT = counter - 1;
                MAP.setMapData(obj);
            });
        };

        //
        // Finally, the most important step;
        //////////////////////////////////////////
        //          Start the map
        //////////////////////////////////////////
        //
        smartasset.hooks.register("onScroll", function ()
        {
            //
            // check whether map-container is in the block
            //
            if (smartasset.page.isInView("#map-container"))
            {
                MAP.start();

                $("#map-table-container").on("mouseout", function ()
                {
                    MAP.hideInfoWindow();
                    MAP.resetMarkers();
                });
            }
        });

        //////////////////////////////////////////
    })();
           </script>
          </div>
          <div class="right-column clearfix bottom-right">
           <div class="other-tools map-links side-links" data-swiftype-index="false">
            <b class="title">
             More About This Map
            </b>
            <div>
             <ul class="sa_links">
              <li>
               <a href="#map-data">
                View the data behind these rankings
               </a>
              </li>
              <li>
               <a href="#map-methodology">
                How do we calculate these rankings
               </a>
              </li>
              <li>
               <a href="#top">
                <b>
                 Interactive:
                </b>
                Should you refinance?
               </a>
              </li>
             </ul>
            </div>
           </div>
           <div class="sharing right-col clearfix">
            <b class="title" data-swiftype-index="false">
             Share
            </b>
            <div data-swiftype-index="false">
             <div class="blog-sharing clearfix ">
              <div class="share-numbers proxima">
              </div>
              <div>
               <a href="javascript:void(0)" onclick='smartasset.share.twitterShare("Refinance Calculator", "/refinance/refinance-calculator%23map");'>
                <img alt="Twitter" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0001_twitter_c.png')"/>
               </a>
              </div>
              <div>
               <a href="javascript:void(0)" onclick='smartasset.share.facebookShare("Refinance Calculator", "/refinance/refinance-calculator%23map");'>
                <img alt="Facebook" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0000_facebook_c.png')"/>
               </a>
              </div>
              <div>
               <a href="javascript:void(0)" onclick='smartasset.share.googleShare("/refinance/refinance-calculator%23map");'>
                <img alt="Google" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0002_google_plus_c.png')"/>
               </a>
              </div>
              <div>
               <a href="javascript:void(0)" onclick='smartasset.share.linkedinShare("Refinance Calculator", "/refinance/refinance-calculator%23map", "Refinance+Calculator")'>
                <img alt="LinkedIn" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0003_linkedin_c.png')"/>
               </a>
              </div>
              <div>
               <a href="javascript:void(0)" onclick='smartasset.share.redditShare("Refinance Calculator", "/refinance/refinance-calculator%23map");'>
                <img alt="reddit" src="//d1l53avkert0hz.cloudfront.net/files/5056//images/base/clear.png" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056//images/share/share_widget_0004_reddit_c.png')"/>
               </a>
              </div>
             </div>
            </div>
           </div>
           <div class="sharing" style="clear:both; height: 10px">
           </div>
           <div class="riklam-smb riklam" source="medium-bt">
            <!-- Site Medium Ad Bottom 1 -->
            <div id="riklam-mdb-S0K7uy_103264" style="width:300px; ">
             <script type="text/javascript">
              var width = window.innerWidth || document.documentElement.clientWidth;
        if (width &gt; 1120)
        {
            googletag.cmd.push(function ()
            {
                var mbslotS0K7uy_103264_started = false;
                var mbslotS0K7uy_103264 = googletag.defineSlot('137419494/site_medium_btm', [300, 250], 'riklam-mdb-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //

                                mbslotS0K7uy_103264.setTargeting("page_type", "Interactive");
mbslotS0K7uy_103264.setTargeting("page_group", "Refinance");
mbslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
mbslotS0K7uy_103264.setTargeting("app_mode", "prod");

mbslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-mdb-S0K7uy_103264');

                // load ads when user scrolls to map
                smartasset.hooks.register("onScroll", function ()
                {
                    //
                    // check whether map-container is in the block
                    //
                    if (mbslotS0K7uy_103264_started == false &amp;&amp; smartasset.page.isInView("#map-container"))
                    {
                        setTimeout(function ()
                        {
                            console.log("Loading medium-btm");
                            googletag.pubads().refresh([mbslotS0K7uy_103264]);
                        }, 100);
                        mbslotS0K7uy_103264_started = true;
                    }
                });
            });
        }
        //}
             </script>
            </div>
           </div>
           <div class="other-tools side-links" data-swiftype-index="false">
            <b class="title">
             More From SmartAsset
            </b>
            <div>
             <ul class="sa_links">
              <li>
               <a href="/mortgage/mortgage-rates?type=refi">
                Compare refinance rates
               </a>
              </li>
              <li>
               <a href="/mortgage/mortgage-calculator">
                Calculate monthly mortgage payments
               </a>
              </li>
              <li>
               <a href="/mortgage/closing-costs">
                Calculate closing costs
               </a>
              </li>
             </ul>
            </div>
           </div>
           <div class="riklam-lgb riklam" source="large-bt">
            <!-- Site Large Ad Bottom 1 -->
            <div id="riklam-lgb-S0K7uy_103264" style="width:300px;">
             <script type="text/javascript">
              var width = window.innerWidth || document.documentElement.clientWidth;
        if (width &gt; 1120)
        {
            googletag.cmd.push(function ()
            {
                var lbslotS0K7uy_103264_started = false;
                var lbslotS0K7uy_103264 = googletag.defineSlot('137419494/site_large_btm', [300, 600], 'riklam-lgb-S0K7uy_103264').addService(googletag.pubads());

                //
                // if you add "data" here (advertising targeting), please also
                // add them to the smartasset.page.reloadAdverts function
                //
                                lbslotS0K7uy_103264.setTargeting("page_type", "Interactive");
lbslotS0K7uy_103264.setTargeting("page_group", "Refinance");
lbslotS0K7uy_103264.setTargeting("page_key", "Refinance.refinancedecision");
lbslotS0K7uy_103264.setTargeting("app_mode", "prod");

lbslotS0K7uy_103264.setTargeting("is_refi", smartasset.data.get("is_refi", ""));



                googletag.display('riklam-lgb-S0K7uy_103264');

                // load ads when user scrolls to map
                smartasset.hooks.register("onScroll", function ()
                {
                    //
                    // check whether map-container is in the block
                    //
                    if (lbslotS0K7uy_103264_started == false &amp;&amp; smartasset.page.isInView("#map-container"))
                    {
                        setTimeout(function ()
                        {
                            console.log("Loading large-btm");
                            googletag.pubads().refresh([lbslotS0K7uy_103264]);
                        }, 100);
                        lbslotS0K7uy_103264_started = true;
                    }
                });
            });
        }
             </script>
            </div>
           </div>
           <div class="spacer" style="height: 50px">
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div id="infinite-scroller">
      </div>
      <div id="hidden-space">
      </div>
      <div class="clearfix" data-swiftype-index="false" id="footer">
       <div class="container clearfix">
        <div class="column">
         <h3>
          Get in touch
         </h3>
         <span>
          <a class="mixpanel_track" href="/about#contact">
           Contact
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="/jobs">
           Jobs
          </a>
         </span>
        </div>
        <div class="column">
         <h3>
          SmartAsset
         </h3>
         <span>
          <a class="mixpanel_track" href="/about">
           About
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="/blog">
           Blog
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="/press">
           Press
          </a>
         </span>
        </div>
        <div class="column social">
         <h3>
          Get Social
         </h3>
         <span>
          <a class="mixpanel_track" href="https://facebook.com/smartasset">
           <div class="facebook" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056/images/base/share_buttons_sizes.png')">
           </div>
           Like on Facebook
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="https://twitter.com/@smartasset">
           <div class="twitter" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056/images/base/share_buttons_sizes.png')">
           </div>
           Follow on Twitter
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="https://plus.google.com/113386095085068085293/posts">
           <div class="google" style="background-image: url('//d1l53avkert0hz.cloudfront.net/files/5056/images/base/share_buttons_sizes.png')">
           </div>
           Add to Google+
          </a>
         </span>
        </div>
        <div class="column">
         <h3>
          Legal Stuff
         </h3>
         <span>
          <a class="mixpanel_track" href="/terms">
           Terms of Service
          </a>
         </span>
         <span>
          <a class="mixpanel_track" href="/privacy">
           Privacy Policy
          </a>
         </span>
        </div>
        <div class="clear-fix">
        </div>
       </div>
       <div class="wide-line">
       </div>
       <div class="container clearfix">
        <div class="bottom">
         Smartly made in NYC
         <span class="fspace">
         </span>
          2015 SmartAsset, all rights reserved.
         <span style="display: inline-block; width: 72px">
         </span>
        </div>
       </div>
      </div>
      <!-- The menu -->
      <nav data-swiftype-index="false" id="mmenu">
       <ul>
        <li>
         <a href="/">
          <i class="fa fa-home">
          </i>
          Home
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/mortgage/">
          Home Buying
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/refinance/">
          Refinance
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/retirement/">
          Retirement
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/life-insurance/">
          Life Insurance
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/credit-cards/">
          Credit Cards
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/checking-account/">
          Checking
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/student-loans/">
          Student Loans
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/taxes/">
          Taxes
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/investing/">
          Investing
         </a>
        </li>
        <li class="tool">
         <a class="mm-next" href="/credit-score/">
          SmartAsset360
         </a>
        </li>
        <li class="bold">
         <a href="/blog">
          <i class="fa fa-file-text-o" style="margin-right: 6px">
          </i>
          Blog
         </a>
        </li>
        <li class="bold">
         <a href="/about">
          <i class="fa fa-info-circle">
          </i>
          About
         </a>
        </li>
        <li class="indent">
         <a href="/press">
          Press
         </a>
        </li>
        <li class="indent">
         <a href="/terms">
          Terms of Service
         </a>
        </li>
        <li class="indent">
         <a href="/privacy">
          Privacy Policy
         </a>
        </li>
       </ul>
      </nav>
      <div data-swiftype-index="false" id="modal-overlay">
       <div id="modal">
        <i class="fa fa-close button" data-label="close">
        </i>
        <div class="modal-container">
         <div class="modal-body">
          <div>
           <h2>
            Title
           </h2>
          </div>
         </div>
         <div class="modal-footer">
          <div>
           <button class="ok button" data-label="ok">
            OK
           </button>
           <button class="gray button" data-label="cancel">
            Cancel
           </button>
          </div>
         </div>
        </div>
       </div>
       <div id="reload">
        <table border="0" cellpadding="0" cellspacing="0">
         <tr>
          <td>
           <i class="fa fa-warning">
           </i>
          </td>
          <td>
           <span class="line1">
            An error occurred
           </span>
           <span class="line2">
            Please reload the page.
           </span>
          </td>
         </tr>
        </table>
       </div>
      </div>
      <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
      </script>
      <script>
       $(function()
{
    smartasset.page.loadCss("//d1l53avkert0hz.cloudfront.net/files/5056/tools/smooth/css/smoothDivScroll.css");
    smartasset.page.loadCss("//d1l53avkert0hz.cloudfront.net/files/5056/tools/mmenu/css/jquery.mmenu.all.css");
        smartasset.page.loadCss("//d1l53avkert0hz.cloudfront.net/files/5056/tools/tooltipster/css/tooltipster.css");
        smartasset.page.loadCss("//d1l53avkert0hz.cloudfront.net/files/5056/css/tools/jquery-ui/jquery-ui.min.css");

// loading other css files

                    smartasset.page.loadCss("//d1l53avkert0hz.cloudfront.net/files/5056/tools/checkbox/checkbox.css");
    
});
      </script>
      <script>
       window['_fs_debug'] = false;
        window['_fs_host'] = 'www.fullstory.com';
        window['_fs_org'] = '10GG';
        (function(m,n,e,t,l,o,g,y){
            g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
            o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
            y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
            g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){FS(l,v)};
            g.clearUserCookie=function(d,i){d=n.domain;while(1){n.cookie='fs_uid=;domain='+d+
            ';path=/;expires='+new Date(0);i=d.indexOf('.');if(i&lt;0)break;d=d.slice(i+1)}}
        })(window,document,'FS','script','user');

        // This is an example script - don't forget to change it!
        FS.identify("20384629", {
            abVersion_int: 0
        });
      </script>
     </div>
     <script>
      // used for blog
    // @todo: might need to clean this up
    window.fbAsyncInit = function() {
    FB.init({
        appId      : '329500247136092',
        xfbml      : true,
        version    : 'v2.2'
        });
    };

    (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    ////////////////////////////////////////////
    // start application logic
    ////////////////////////////////////////////
    $(function ()
    {
        $(document).on("keydown", function(e)
        {
            if (e.keyCode == 27)
            {
                if (!smartasset.page.locked)
                {
                    // only hide modal if page isn't locked!
                    smartasset.page.hideModal();
                }
            }
        });

        ////////////////////////////////////////////
        // handle page scrolling
        ////////////////////////////////////////////
        $(window).scroll(function ()
        {
            smartasset.page.scrolling();
        });

        $("#search-icon").click(function()
        {
            $("#search-box").slideDown(function()
            {
                $("#search-box input").focus();
            });
            return false;
        });


        ////////////////////////////////////////////
        // enable the slide-out menu for mobile
        ////////////////////////////////////////////
        $("#mmenu").mmenu({
            "classes": "mm-white",
            "searchfield": {
                add: true,
                search: false,
            },
            dragOpen: {
                // drag open options
                open: true,
                pageNode: "#header .mmenu"
            }
        }).on( "closing.mm", function()
        {
            $("#header").removeClass("open");
        }).on( "opening.mm", function()
        {
            $("#header").addClass("open");
            $("#ui-mob-info").hide();
        });


        ////////////////////////////////////////////
        // enable the search auto-complete in the header
        ////////////////////////////////////////////
        smartasset.page.setupSearch("#st-search-input", false, 133);
        smartasset.page.setupSearch("#mmenu .mm-search input", false, 41);

        // attach "enter" key to search box
        $("#mmenu .mm-search input").on("keydown", function(e)
        {
            if (e.keyCode == 13)
            {
                window.location = "/search?q="+encodeURI($(this).val());
            }
        });


        // set current year
        smartasset.data.year = 2015;

        // set the page-type (for adverts)
        smartasset.page.pageType = "Interactive";

        // content group
        smartasset.page.contentGroup = "Default";

        // set the page-key
        smartasset.page.pageKey = "Refinance.refinancedecision";

        // set the page-key [false]
        smartasset.page.internal = false;

        // set the page-group
        smartasset.page.pageGroup = "Refinance";

        $(".simulateclick").on("keydown", function(e)
        {
            if (e.keyCode == 13 || e.keyCode == 32)
            {
                console.log("Enter");
                return false;
            }
        });

        // run page startup code
        smartasset.page.startup();
    });

    // &lt;---- start GOOGLE ANALYTICS CODE
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-24847606-3', 'auto');

    // track content group (Blog, Analysis, Static, Test)
    ga('set', 'contentGroup1', 'Default');
        // track the page-key
    ga('set', 'contentGroup2', "Refinance.refinancedecision");
            // track the page-key
    ga('set', 'contentGroup3', "Refinance");
    
    ga('set', 'contentGroup4', AB_VERSION);


    // &lt;---- end GOOGLE ANALYTICS CODE

    // &lt;---- start MIXPANEL CODE
    (function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&amp;&amp;(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&amp;&amp;(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
        for(g=0;g&lt;i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
        mixpanel.init("9d6bd5fc695c7ee04a926be83de51b6c");
    // &lt;---- end MIXPANEL CODE

    // track next-steps and tool links
    smartasset.analytics.trackLinks(".next-steps a", "Next Step Clicked");
    smartasset.analytics.trackLinks(".other-tools a", "Other Tools Clicked");

    
    setTimeout(function() { smartasset.page.toLearn(); }, 3000);

    //
    // page timer
    //
    smartasset.page.loadtime = new Date().getTime();
    window.onunload = function(e)
    {
        var time = new Date().getTime();
        var diff = (time - smartasset.page.loadtime)/1000;
        smartasset.analytics.track("Timer", {
            seconds: diff
        });
    };
     </script>
     <div id="fb-root">
     </div>
    </div>
   </div>
  </div>
 </body>
</html>