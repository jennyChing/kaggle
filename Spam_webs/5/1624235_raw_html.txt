<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="index,follow" name="robots"/>
  <meta content="A blog covering topics related to SQL Server security, cryptography, and search engines" name="description"/>
  <meta content="SQL Server, security, cryptography" name="keywords"/>
  <meta content="Telligent Evolution Platform Developer Build (Build: 5.6.50428.7875)" name="GENERATOR"/>
  <link href="http://blogs.msdn.com/b/lcris/pingback.aspx" rel="pingback"/>
  <link href="http://i1.blogs.msdn.com/rrcontent/7632fe1dd91290a46b3a118f9478cf1b-27cae0dd5641775697cb89e9a8587625-RequestReducedStyle.css" rel="Stylesheet" type="text/css"/>
  <link href="http://blogs.msdn.com/rss.aspx" rel="alternate" title="Site Home (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/lcris/comments/rss.aspx" rel="alternate" title="Laurentiu Cristofor [MSFT]'s Comments (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/lcris/activities/rss.aspx" rel="alternate" title="Laurentiu Cristofor [MSFT]'s Activities (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/lcris/activities/followersrss.aspx" rel="alternate" title="Activities of People Laurentiu Cristofor [MSFT] Follows (RSS 2.0)" type="application/rss+xml"/>
  <link href="/members/lcris/activities/groupsrss.aspx" rel="alternate" title="Laurentiu Cristofor [MSFT]'s Groups Activities (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://blogs.msdn.com/b/lcris/rss.aspx" rel="alternate" title="Laurentiu Cristofor's blog @microsoft.com (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://blogs.msdn.com/b/lcris/atom.aspx" rel="alternate" title="Laurentiu Cristofor's blog @microsoft.com (Atom 1.0)" type="application/atom+xml"/>
  <link href="http://blogs.msdn.com/b/lcris/rsscomments.aspx" rel="alternate" title="Laurentiu Cristofor's blog @microsoft.com - All Comments (RSS 2.0)" type="application/rss+xml"/>
  <link href="http://blogs.msdn.com/b/lcris/rsscomments.aspx?WeblogPostID=10053881" rel="alternate" title="SQL Server 2005: Execution Context - Comments for this post (RSS 2.0)" type="application/rss+xml"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <link href="/themes/MSDN2/favicon.ico" rel="shortcut icon" type="image/ico"/>
  <!--
            Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use  http://www.asp.net/ajaxlibrary/CDN.ashx.
          -->
  <link href="http://i1.blogs.msdn.com/rrcontent/6e455ee01481483d5d047db51a775dad-ffc9f7e1f0412800af51bef62a866f63-RequestReducedStyle.css" rel="Stylesheet" type="text/css"/>
  <script language="javascript" src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js" type="text/javascript">
  </script>
  <link href="/themes/MSDN2/css/DynamicStyle.aspx?PreviewKey=0" media="screen,print" rel="stylesheet" type="text/css"/>
  <link href="/themes/blogs/MSDN2/css/DynamicStyle.aspx?WeblogID=4719&amp;PreviewKey=0" media="screen,print" rel="stylesheet" type="text/css"/>
  <!--[if lte IE 6]&gt;
              &lt;link type="text/css" rel="stylesheet" href="/themes/MSDN2/css/ie6.css" media="screen,print" /&gt;
          &lt;![endif]-->
  <meta content="B717AD6FC29D3A844832AF011B5F9E4C" name="msvalidate.01"/>
  <link href="http://blogs.msdn.com/b/lcris/rsd.ashx" rel="EditURI" title="RSD" type="application/rsd+xml"/>
  <link href="http://blogs.msdn.com/b/lcris/wlwmanifest.ashx" rel="wlwmanifest" title="WLWManifest" type="application/wlwmanifest+xml"/>
  <!--
            Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use  http://www.asp.net/ajaxlibrary/CDN.ashx.
          -->
  <script language="javascript" src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js" type="text/javascript">
  </script>
  <title>
   SQL Server 2005: Execution Context - Laurentiu Cristofor's blog @microsoft.com - Site Home - MSDN Blogs
  </title>
 </head>
 <body spellcheck="true">
  <form action="/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx" id="aspnetForm" method="post" name="aspnetForm">
   <div>
    <input id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer" name="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer" type="hidden" value=""/>
    <input id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_encrypted" name="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_encrypted" type="hidden" value="TXpTA2RGSaFRNdYmbsq+OPA5WegATPbtRdmodi2OoaQ="/>
    <input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUKMTM5OTAxNDYyNWRkvI787cXLvh9XHlDReEjVejxzcZ4="/>
   </div>
   <script src="http://i1.blogs.msdn.com/rrcontent/4edef1267f1395bd62b445ccb12bfb8c-8a095e5b39e6369792015dc17f44b1cf-RequestReducedScript.js" type="text/javascript">
   </script>
   <div>
    <input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="84C00179"/>
   </div>
   <div class="header-fragments-header">
   </div>
   <div class="header-fragments">
    <div class="header-fragment-outer top-bar msdn-header-fragment-outer msdn-top-bar">
     <div class="header-fragment-inner top-bar msdn-header-fragment-inner msdn-top-bar">
      <div class="header-fragment welcome-message" id="header-fragment-1402503690">
       <!-- always render -->
      </div>
      <div class="header-fragment login-logout" id="header-fragment-1402503691">
       <div class="navigation-list-header">
       </div>
       <ul class="navigation-list">
        <li class="navigation-item">
         <span class="internal-link live-id-button" id="ctl00_header_fragment_1402503691__ac92ed_ctl00_ctl02_ctl05_WLIDLoginButton1">
          <a href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=12&amp;ct=1436808366&amp;rver=6.0.5286.0&amp;wp=MBI&amp;wreply=http:%2F%2Fblogs.msdn.com%2Fb%2Flcris%2Farchive%2F2010%2F08%2F24%2Fsql-server-2005-execution-context.aspx&amp;lc=1033&amp;id=271611">
           Sign in
          </a>
         </span>
        </li>
       </ul>
       <div class="navigation-list-footer">
       </div>
      </div>
      <div class="header-fragment user-welcome-without-login" id="header-fragment-1402503692">
       <!-- always render -->
      </div>
     </div>
    </div>
    <div class="header-fragment blog-banner" id="header-fragment-1402503693">
     <div class="site-banner blog-banner">
      <h1 class="blog-banner-name">
       <a href="/b/lcris/">
        Laurentiu Cristofor's blog @microsoft.com
       </a>
      </h1>
      <div class="blog-banner-description">
       Current topics: Security, SQL Server, bing
      </div>
     </div>
    </div>
   </div>
   <div class="header-fragments-footer">
   </div>
   <div class="content-fragment-page post" id="ctl00_content_ctl00_page">
    <div class="layout">
     <div class="layout-header">
     </div>
     <div class="layout-content content-left-sidebar-right" id="ctl00_content_ctl00_layout">
      <div class="layout-region right-sidebar" id="ctl00_content_ctl00_right-sidebar">
       <div class="layout-region-inner right-sidebar">
        <div class="content-fragment c-t-f-widget no-wrapper-with-spacing with-header" id="fragment-52310">
         <div class="content-fragment-inner msdn-content-fragment-inner">
          <div class="content-fragment-top msdn-content-fragment-top">
           <div class="r1 msdn-r1">
           </div>
           <div class="r2 msdn-r2">
           </div>
           <div class="r3 msdn-r3">
           </div>
           <div class="r4 msdn-r4">
           </div>
          </div>
          <div class="content-fragment-header">
           <div>
            Translate This Page
           </div>
          </div>
          <div class="content-fragment-content">
           <!--
         
           localize text, such as translate this &amp; powered by 
           
           
            -->
           <div id="MicrosoftTranslatorWidget" style="width: 275px; min-height: 83px;
    border-color: #333333; background-color: #CCCCCC;">
            <noscript>
             <a href="http://www.microsofttranslator.com/bv.aspx?a=http%3a%2f%2fblogs.msdn.com%2f">
              Translate this
            page
             </a>
             <br/>
             Powered by
             <a href="http://www.microsofttranslator.com">
              Microsoft Translator
             </a>
            </noscript>
            <script type="text/javascript">
             setTimeout(function () {
            var s = document.createElement("script");
            s.type = "text/javascript";
            s.charset = "UTF-8";
            s.src = "http://www.microsofttranslator.com/Ajax/V2/Widget.aspx?siteData=ncUzpG6DNC3ChU0huEHZCFQbqrzCQRcTVqXdHso8P2KRGM-oFXjoeYwum3D31voFEyqUPj4HjacfvEdrHEyIG8CuATkNhQmRwcZkpGVFjvVnLd1gzFP2dxWEWKdcQtE1&amp;mode=manual&amp;from=en-us&amp;layout=ts";
            var p = document.getElementsByTagName('head')[0] || document.documentElement; p.insertBefore(s, p.firstChild);
        }, 0); 
    &lt;/script&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="content-fragment-footer"&gt;&lt;/div&gt;
&lt;div class="content-fragment-bottom msdn-content-fragment-bottom"&gt;&lt;div class="r1 msdn-r1"&gt;&lt;/div&gt;&lt;div class="r2 msdn-r2"&gt;&lt;/div&gt;&lt;div class="r3 msdn-r3"&gt;&lt;/div&gt;&lt;div class="r4 msdn-r4"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class="content-fragment blog-links no-wrapper-with-spacing with-header" id="fragment-52311"&gt;
&lt;div class="content-fragment-inner msdn-content-fragment-inner"&gt;&lt;div class="content-fragment-top msdn-content-fragment-top"&gt;&lt;div class="r1 msdn-r1"&gt;&lt;/div&gt;&lt;div class="r2 msdn-r2"&gt;&lt;/div&gt;&lt;div class="r3 msdn-r3"&gt;&lt;/div&gt;&lt;div class="r4 msdn-r4"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="content-fragment-header"&gt;&lt;div&gt;Options&lt;/div&gt;&lt;/div&gt;
&lt;div class="content-fragment-content"&gt;

		&lt;div class="navigation-list-header"&gt;&lt;/div&gt;
		&lt;ul class="navigation-list"&gt;
	&lt;li class="navigation-item"&gt;&lt;a class="internal-link view-application" href="/b/lcris/"&gt;&lt;span&gt;&lt;/span&gt;Blog Home&lt;/a&gt;&lt;/li&gt;&lt;li class="navigation-item"&gt;&lt;a class="internal-link view-user-profile" href="/b/lcris/about.aspx"&gt;&lt;span&gt;&lt;/span&gt;About&lt;/a&gt;&lt;/li&gt;&lt;li class="navigation-item"&gt;&lt;a class="internal-link email-post" href="mailto:?subject=SQL Server 2005: Execution Context&amp;body=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx"&gt;
		&lt;span&gt;&lt;/span&gt;Share this
	&lt;/a&gt;&lt;/li&gt;&lt;li class="navigation-item"&gt;&lt;a class="internal-link rss" href="/b/lcris/rss.aspx"&gt;&lt;span&gt;&lt;/span&gt;RSS for posts&lt;/a&gt;&lt;/li&gt;&lt;li class="navigation-item"&gt;&lt;a class="internal-link rss" href="/b/lcris/atom.aspx"&gt;&lt;span&gt;&lt;/span&gt;Atom&lt;/a&gt;&lt;/li&gt;&lt;li id=""RssComments""" class="navigation-item"&gt;&lt;a class="internal-link rss" href="/b/lcris/rsscomments.aspx"&gt;&lt;span&gt;&lt;/span&gt;RSS for comments&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;div class="navigation-list-footer"&gt;&lt;/div&gt;
	&lt;/div&gt;
&lt;div class="content-fragment-footer"&gt;&lt;/div&gt;
&lt;div class="content-fragment-bottom msdn-content-fragment-bottom"&gt;&lt;div class="r1 msdn-r1"&gt;&lt;/div&gt;&lt;div class="r2 msdn-r2"&gt;&lt;/div&gt;&lt;div class="r3 msdn-r3"&gt;&lt;/div&gt;&lt;div class="r4 msdn-r4"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class="content-fragment search-form no-wrapper-with-spacing with-header" id="fragment-52312"&gt;
&lt;div class="content-fragment-inner msdn-content-fragment-inner"&gt;&lt;div class="content-fragment-top msdn-content-fragment-top"&gt;&lt;div class="r1 msdn-r1"&gt;&lt;/div&gt;&lt;div class="r2 msdn-r2"&gt;&lt;/div&gt;&lt;div class="r3 msdn-r3"&gt;&lt;/div&gt;&lt;div class="r4 msdn-r4"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="content-fragment-header"&gt;&lt;div&gt;Search&lt;/div&gt;&lt;/div&gt;
&lt;div class="content-fragment-content"&gt;

&lt;div class="field-list-header"&gt;
&lt;/div&gt;
&lt;fieldset class="field-list"&gt;
    &lt;ul class="field-list"&gt;
        &lt;li class="field-item search"&gt;
            &lt;div id="search-allblogs-container"&gt;
                &lt;span class="field-item-input"&gt;
                    &lt;input id="SearchTextBox_AllBlogs" name="SearchTextBox_AllBlogs" type="text" class="searchField"
                        maxlength="64" size="45" autocomplete="off" /&gt;
                    &lt;input id="SearchButton_AllBlogs" name="SearchButton_AllBlogs" type="button" class="search-button" /&gt;
                &lt;/span&gt;
            &lt;/div&gt;
            &lt;div id="search-thisblog-container"&gt;
                &lt;span class="field-item-input"&gt;
                    &lt;input id="SearchTextBox_ThisBlog" name="SearchTextBox_ThisBlog" type="text" class="searchField"
                        maxlength="64" size="45" autocomplete="off" /&gt;
                    &lt;input id="SearchButton_ThisBlog" name="SearchButton_ThisBlog" type="button" class="search-button" /&gt;
                &lt;/span&gt;
            &lt;/div&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
&lt;/fieldset&gt;
&lt;div class="field-list-footer"&gt;
    &lt;div id="search-switch-container"&gt;
        &lt;span style="display: inline-block"&gt;
            &lt;input type="radio" name="SearchTypeRadio" value="ThisBlog" id="ThisBlog" checked="checked" /&gt;&lt;label
                for="ThisBlog" id="ThisBlogText"&gt;Search this blog&lt;/label&gt;&lt;/span&gt;
        &lt;span style="display: inline-block"&gt;
            &lt;input type="radio" name="SearchTypeRadio" value="AllBlogs" id="AllBlogs" /&gt;&lt;label
                for="AllBlogs" id="AllBlogsText"&gt;Search all blogs&lt;/label&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;
var elmSearchAll = $('#search-allblogs-container').hide();
var elmSearchThis = $('#search-thisblog-container');

// try to get the blog id, if we fail, then we aren't on a blog and just use the regular search approach       
(4719 === -1) &amp;&amp; $('#search-switch-container').hide();

$(document).ready(function() {
    $('#ThisBlog').click(function () {
        var self = $(this);
        if (self.is(':checked')) {
            elmSearchAll.hide();
            elmSearchThis.show();
        }
    });
    
    $('#AllBlogs').click(function () {
        var self = $(this);
        if (self.is(':checked')) {
            elmSearchThis.hide();
            elmSearchAll.show();
        }
    });
});
            </script>
            <script language="javascript" src="http://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=SearchTextBox_AllBlogs&amp;btnid=SearchButton_AllBlogs&amp;brand=MSDN&amp;refinement=109&amp;resref=&amp;addEnglish=&amp;rn=&amp;rq=&amp;watermark=&amp;focusOnInit=false&amp;beta=0&amp;iroot=&amp;overrideWatermark=false" type="text/javascript">
            </script>
            <script language="javascript" src="http://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=SearchTextBox_ThisBlog&amp;btnid=SearchButton_ThisBlog&amp;brand=MSDN&amp;refinement=&amp;resref=&amp;addEnglish=&amp;watermark=&amp;focusOnInit=false&amp;beta=0&amp;iroot=&amp;overrideWatermark=false&amp;rn=Laurentiu%2bCristofor%2526%252339%253bs%2bblog%2b%2540microsoft.com&amp;rq=site:blogs.msdn.com/b/lcris/" type="text/javascript">
            </script>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment tag-cloud no-wrapper-with-spacing with-header" id="fragment-52313">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-header">
            <div>
             Tags
            </div>
           </div>
           <div class="content-fragment-content">
            <div class="tag-list-header">
            </div>
            <ul class="tag-list">
             <li class="tag-item level-4">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/announcements/" rel="tag">
               announcements
              </a>
             </li>
             <li class="tag-item level-4">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/basic+SQL+Server+security+concepts/" rel="tag">
               basic SQL Server security concepts
              </a>
             </li>
             <li class="tag-item level-6">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/bing/" rel="tag">
               bing
              </a>
             </li>
             <li class="tag-item level-1">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/computer+security/" rel="tag">
               computer security
              </a>
             </li>
             <li class="tag-item level-2">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/encryption/" rel="tag">
               encryption
              </a>
             </li>
             <li class="tag-item level-6">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/Microsoft+account/" rel="tag">
               Microsoft account
              </a>
             </li>
             <li class="tag-item level-6">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/Microsoft+products/" rel="tag">
               Microsoft products
              </a>
             </li>
             <li class="tag-item level-5">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/privacy/" rel="tag">
               privacy
              </a>
             </li>
             <li class="tag-item level-4">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/search+engines/" rel="tag">
               search engines
              </a>
             </li>
             <li class="tag-item level-6">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/software+engineering/" rel="tag">
               software engineering
              </a>
             </li>
             <li class="tag-item level-1">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server/" rel="tag">
               SQL Server
              </a>
             </li>
             <li class="tag-item level-1">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server+_2D00_+cryptography/" rel="tag">
               SQL Server - cryptography
              </a>
             </li>
             <li class="tag-item level-3">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server+_2D00_+general/" rel="tag">
               SQL Server - general
              </a>
             </li>
             <li class="tag-item level-2">
              <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server+_2D00_+security/" rel="tag">
               SQL Server - security
              </a>
             </li>
            </ul>
            <div class="tag-list-footer">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment blog-archive-list no-wrapper-with-spacing with-header" id="fragment-52314">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-header">
            <div>
             Archive
            </div>
           </div>
           <div class="content-fragment-content">
            <div class="content-list-header">
            </div>
            <div class="content-list-name">
             Archives
            </div>
            <ul class="content-list">
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2015/01.aspx">
               January 2015
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2013/12.aspx">
               December 2013
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2011/08.aspx">
               August 2011
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2010/10.aspx">
               October 2010
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2010/08.aspx">
               August 2010
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2010/03.aspx">
               March 2010
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2009/12.aspx">
               December 2009
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2009/10.aspx">
               October 2009
              </a>
              (3)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2009/08.aspx">
               August 2009
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2009/07.aspx">
               July 2009
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2009/06.aspx">
               June 2009
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/08.aspx">
               August 2008
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/06.aspx">
               June 2008
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/05.aspx">
               May 2008
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/04.aspx">
               April 2008
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/03.aspx">
               March 2008
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/02.aspx">
               February 2008
              </a>
              (5)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2008/01.aspx">
               January 2008
              </a>
              (4)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/11.aspx">
               November 2007
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/10.aspx">
               October 2007
              </a>
              (4)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/09.aspx">
               September 2007
              </a>
              (3)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/07.aspx">
               July 2007
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/04.aspx">
               April 2007
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/03.aspx">
               March 2007
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2007/02.aspx">
               February 2007
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/12.aspx">
               December 2006
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/11.aspx">
               November 2006
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/10.aspx">
               October 2006
              </a>
              (3)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/07.aspx">
               July 2006
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/05.aspx">
               May 2006
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/04.aspx">
               April 2006
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/03.aspx">
               March 2006
              </a>
              (2)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2006/01.aspx">
               January 2006
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2005/12.aspx">
               December 2005
              </a>
              (5)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2005/10.aspx">
               October 2005
              </a>
              (3)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2005/09.aspx">
               September 2005
              </a>
              (5)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2005/07.aspx">
               July 2005
              </a>
              (1)
             </li>
             <li class="content-item">
              <a class="internal-link view-post-archive-list" href="/b/lcris/archive/2005/06.aspx">
               June 2005
              </a>
              (4)
             </li>
            </ul>
            <div class="content-list-footer">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
       <div class="layout-region content" id="ctl00_content_ctl00_content">
        <div class="layout-region-inner content">
         <div class="content-fragment blog-title full-border" id="fragment-52315">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-content">
            <h1 class="title">
             SQL Server 2005: Execution Context
            </h1>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment blog-bread-crumbs no-wrapper" id="fragment-52316">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-content">
            <div class="breadcrumb-list-header">
            </div>
            <div class="breadcrumb-list">
             <span class="breadcrumb-item">
              <a class="internal-link view-home" href="/">
               MSDN Blogs
              </a>
             </span>
             <span class="separator">
              &gt;
             </span>
             <span class="breadcrumb-item">
              <a href="/b/lcris/">
               Laurentiu Cristofor's blog @microsoft.com
              </a>
             </span>
             <span class="separator">
              &gt;
             </span>
             <span class="breadcrumb-item">
              <a href="/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx">
               SQL Server 2005: Execution Context
              </a>
             </span>
            </div>
            <div class="breadcrumb-list-footer">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment blog-post no-wrapper" id="fragment-52317">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-content">
            <div class="full-post-header">
            </div>
            <div class="full-post">
             <h3 class="post-name">
              SQL Server 2005: Execution Context
             </h3>
             <div class="post-author">
              <span class="avatar">
               <a href="/7061/ProfileUrlRedirect.ashx">
                <img alt="" src="http://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=laurentiu+cristofor+%5bmsft%5d&amp;size=large" style="border-width:0px;max-height:32px;max-width:32px;"/>
               </a>
              </span>
              <span class="profile-usercard-hover" data-profile-userid="1311a922-f643-406d-b485-b6450fcda64d">
               <span class="user-name">
                <a class="internal-link view-user-profile" href="/7061/ProfileUrlRedirect.ashx">
                 <span>
                 </span>
                 Laurentiu Cristofor [MSFT]
                </a>
               </span>
              </span>
             </div>
             <div class="post-date">
              <span class="value">
               24 Aug 2010 7:13 PM
              </span>
             </div>
             <div class="post-attributes">
              <div class="attribute-list-header">
              </div>
              <ul class="attribute-list">
               <li class="attribute-item post-reply-count">
                <span class="attribute-name">
                 Comments
                </span>
                <span class="attribute-value">
                 <a class="internal-link view-replies" href="#comments">
                  <span>
                  </span>
                  0
                 </a>
                </span>
               </li>
              </ul>
              <div class="attribute-list-footer">
              </div>
             </div>
             <div class="post-content user-defined-markup">
              <p>
               This post is based on an old presentation I gave several years back. A video of the presentation used to be available
               <a href="http://blogs.msdn.com/b/lcris/archive/2006/12/08/sql-server-2005-security-presentations-at-pass-pre-conference.aspx" target="_blank">
                here
               </a>
               , but today I couldn't get it to work, so I am attempting to make available most of the information from the presentation withinthis post. Keep in mind that the demo associated with this presentation is also available
               <a href="http://blogs.msdn.com/b/lcris/archive/2006/10/24/sql-server-2005-demo-for-enabling-database-impersonation-for-cross-database-access.aspx" target="_blank">
                here
               </a>
               . And some of these concepts mayhave been covered in more detail elsewhere on my blog:
              </p>
              <p>
               <a href="http://blogs.msdn.com/b/lcris/archive/2007/03/23/basic-sql-server-security-concepts-logins-users-and-principals.aspx" target="_blank">
                Basic SQL Server Security concepts - logins, users, and principals
               </a>
               <br/>
               <a href="http://blogs.msdn.com/b/lcris/archive/2007/09/12/basic-sql-server-security-concepts-permissions-and-special-principals-sa-dbo-guest.aspx" target="_blank">
                Basic SQL Server Security concepts - permissions and special principals: sa, dbo, guest
               </a>
               <br/>
               <a href="http://blogs.msdn.com/b/lcris/archive/2005/06/15/sql-server-2005-procedure-signing-demo.aspx" target="_blank">
                SQL Server 2005: procedure signing demo
               </a>
               <br/>
               <a href="http://blogs.msdn.com/b/lcris/archive/2006/10/19/sql-server-2005-an-example-for-how-to-use-counter-signatures.aspx" target="_blank">
                SQL Server 2005: An example for how to use counter signatures
               </a>
              </p>
              <p>
               So, here it goes - brace yourselves because this is going to be a long post.
              </p>
              <h2>
               Login Token and User Token
              </h2>
              <p>
               The execution context is the basis for authorization checks and is determined through the login and usertokens.
              </p>
              <p>
               These tokens containvarious information, but at a high level each token contains:
              </p>
              <ol>
               <li>
                One principal as primary identity
               </li>
               <li>
                Zero ormore principals as secondary identities(roles or groups)
               </li>
              </ol>
              <p>
               At server scope we get the login token, whose content can be examined via sys.login_token.When a database is accessed, a database scoped token is created based on the content of the login token - this is the user token, whose content can be examined via sys.user_token.
              </p>
              <h2>
               Impersonation
              </h2>
              <p>
               Impersonation allows us to change the current execution context, by setting a new active login token and user token.
              </p>
              <p>
               Application roles provide a database scoped context, but the impersonation features introduced in SQL Server 2005give usalternatives to using application roles.One of the most obvious benefits of the new impersonation methods is the elimination of the need to manage an application role password.
              </p>
              <h3>
               Impersonation Models
              </h3>
              <p>
               SETUSER, introduced in SQL Server 2000 should be avoided going forward. It requires high privileges (sysadmin) and impersonations are not stackable.
              </p>
              <p>
               The EXECUTE AS commandsare making SETUSER obsolete and provide access to the new impersonation model introduced in SQL Server 2005. EXECUTE AS commands allow impersonation at two levels: server level (also known as login impersonation) and database level (aka user impersonation).
              </p>
              <h3>
               Impersonation Levels
              </h3>
              <p>
               At server level, there is no difference between a token obtained through authentication and one obtained through impersonation. Note however that Windows login impersonation is bounded to SQL Server level.
              </p>
              <p>
               At database level, impersonation is a bit more complex: Inside the database where the impersonation took place we get a full user token; at server level, however, we get a stripped down login token; finally, outside the database where the impersonation took place, we get no access (we call this "sandboxing"), but this default behavior can be changedand the mechanisms that allow us toleave the sandbox will be covered further down this post.
              </p>
              <h3>
               Impersonation Methods
              </h3>
              <p>
               There are two ways of performing impersonation: explicit and implicit.
              </p>
              <p>
               <strong>
                Explicit impersonation
               </strong>
               is also known as standalone impersonation. Permissions for performing such impersonation are checked against the caller's context, at run time. The EXECUTE AS LOGIN command allows us to perform server level impersonation and it requires the IMPERSONATE ON LOGIN permission on the impersonated login. The EXECUTE AS USER command allows us to perform database level impersonation and it requires the IMPERSONATE ON USER permission on the impersonated user.
              </p>
              <p>
               Explicit impersonations are stackable, which means we can get back to the previous context by calling the REVERT command. In stack terms, EXECUTE AS pushes a new execution context frame on the execution context stack, while REVERT pops the top execution context frame; the current execution context is always being determined by the execution context frame at the top of the stack. The REVERT command must be called in the same database where the context was originally set (so it can leave us in a situation where the previous execution context is meaningful). It is notallowed to revert a context that was set outside the current module, but we will see later that it is possible to push the caller's context within a module. REVERT does not require any permission for executing it. Finally, when a module ends execution, the context is always automatically reverted to the context set before the module call.
              </p>
              <p>
               There are also a number of options that allow us to replace application roles. The WITH NO REVERT option allows a context to be set that cannot be reverted- REVERT will simply do nothing if it is invoked. The WITH COOKIE INTO option allows us to get back a cookie value which can be passed back to REVERT- this option allows only the setter of the context to have the knowledge needed (the cookie value) to be able to revert the context. It is also possible to create users without an associated login, via CREATE USER ... WITHOUT LOGIN command option.
              </p>
              <p>
               At any point, it is possible to find out the original server level context via the ORIGINAL_LOGIN() builtin function. This value is also always shown in traces, to allow an administrator to more easily track the original context.
              </p>
              <p>
               <strong>
                Implicit impersonation
               </strong>
               is also referred to as module level impersonation. This is specified at the time the module is created and takes effect later when the module is executed. The impersonation level is implied by the respective module type. For example, impersonation is performed at server level for server triggers, but at database level for stored procedures, functions, database triggers, queues, etc.
              </p>
              <p>
               In terms of permissions, the IMPERSONATE permission is tested against the principal that is modifying the module. For the principal that calls a module, only the EXECUTE permission on that module is being checked. Of course, context is always reverted once a module completes its execution.
              </p>
              <p>
               The default option (when none is specified) is to perform EXECUTE AS CALLER - this is the same behavior that wasavailable in older versions of SQL Server (the only behavior). We can of course explicitly specify the context that the module should execute as, which requires IMPERSONATE permission on that principal. And then we have two special options - EXECUTE AS SELF and EXECUTE AS OWNER which behave as their names suggest (EXECUTE AS SELF is useful for automation, not for the unlikely case that a user has forgot his context). EXECUTE AS OWNER will require IMPERSONATE permission on the module's owner - if there is no explicit owner marked for the module, the schema owner is the owner of that module - this means that later, if the schema of the module is changed, the action can only be accomplished by someone that has IMPERSONATE permission on the new schema's owner.
              </p>
              <p>
               There is a special form of explicit impersonation that can be used within a module that does implicit impersonation to execute a portion of that moduleunder the caller's context - EXECUTE AS CALLER. This will change the context to the caller's context and the important keyword here is
               <em>
                change
               </em>
               - this does not revert the implicitly impersonated context. To get back to the previous context, REVERT can be called. It is very important to note that EXECUTE AS CALLER does not require any permission check.
              </p>
              <h2>
               Cross database impersonation
              </h2>
              <p>
               Earlier, we mentioned that database impersonation is sandboxed, but there are mechanisms that allow us to leave the sandbox. Now is the time to look closer at these mechanisms.
              </p>
              <p>
               To allow a user token to be valid outside the database where it was set, an authenticator can be added to the token. The authenticator will vouch for the content of the token, and if that authenticator is trusted in another database, then the token will be honored there; otherwise it will be rejected. Authenticating capability is managed via the AUTHENTICATE and AUTHENTICATE SERVER permissions.
              </p>
              <p>
               There are two ways of setting authenticators. The first one is simpler, but less flexible - it is based on turning on the TRUSTWORTHY option of a database, which in turn allows its DBO to act as an authenticator. The second method requires more steps to set up, but it allows for much greater flexibility and control granularity - it is based on using certificates as authenticators.
              </p>
              <h3>
               TRUSTWORTHY setting
              </h3>
              <p>
               This is a per-database setting which indicates that contexts set in the database will have the DBO as authenticator. Only a sysadmin can change the TRUSTWORTHY setting on a database and by default, this setting is OFF.If a database would be attached to a server, this settingwould also beset to OFF at attach time. The command for changing this setting is ALTER DATABASE &lt;database_name&gt; SET TRUSTWORTHY = {ON | OFF}.
              </p>
              <p>
               Setting the DBO as authenticator is the first step. The second step is for the target database to express trust into that DBO's role as an authenticator. This can be accomplished in one of two ways. The first way (more granular) is by granting the AUTHENTICATE permission in the target database to the user mapped to the login that maps to DBO in the source database. The second way is to grant AUTHENTICATE SERVER permission to the login mapped to DBO in the source database - this is a more powerful setting that is equivalent to granting AUTHENTICATE in each database of the server. AUTHENTICATE SERVER is a very powerful permission, so only members of sysadmin are allowed to grant it.
              </p>
              <p>
               So, this method consists of two steps to enable cross-database access from a source database to a target database:
              </p>
              <ol>
               <li>
                the source database needs to have the TRUSTWORTHY setting turned ON so that its DBObecomes authenticator for all tokens originating from that database
               </li>
               <li>
                the DBO must be trusted as authenticator in the target database by being granted AUTHENTICATE permission there (or by being granted AUTHENTICATE SERVER at the server level, but this approach should be avoided unless there is a good reason touse it)
               </li>
              </ol>
              <h3>
               Certificates and asymmetric keysas authenticators
              </h3>
              <p>
               This method allows us to set certificates (or asymmetric keys) as authenticators by signing modules that perform implicit impersonation. The certificate must exist in the source database and either in the target database (when trust is established using AUTHENTICATE) or in the master database (if using the more powerful AUTHENTICATE SERVER permission). With this method, the TRUSTWORTHY setting is not needed - we use the certificates as authenticators, so we don't need the dbo to be marked as an authenticator as well.
              </p>
              <p>
               The way we grant AUTHENTICATE permission to certificates is by mapping them to users or logins and then granting those principals thedesired permissions. The users and logins mapped to certificates do not provide an access point to the server and are only used for associating permissionswith certificates.
              </p>
              <p>
               So, this method relies only on signing modules which adds the certificate as an authenticator and then in establishing trust into that specific certificate as an authenticator, by mapping it to a user in the target database and granting it AUTHENTICATE permission. Again, the alternative of mapping the certificate to a login in the master database and granting that login AUTHENTICATE SERVER should be avoided unless there are good reasons to use it.
              </p>
              <h2>
               Module signing
              </h2>
              <p>
               Either certificates or asymmetric keys can be used to sign modules. Signing attachesa cryptographic signature to the module. This impacts execution context in two ways:
              </p>
              <ol>
               <li>
                if the module does implicit impersonation, the certificate will be added as authenticator
               </li>
               <li>
                if a principal is mapped to the certificate, it becomes a secondary identity of the token used during the execution of the module
               </li>
              </ol>
              <p>
               A signature affects the execution context only if it is valid - changing a signed module requires re-signing it to keep the signature functional.
              </p>
              <p>
               Also, by default,a signature only affects the execution context within the scope of the signed module. To sign, CONTROL permission on the respective certificate is required.
              </p>
              <p>
               Signature validation is performed automatically by SQL Server. Mapping principals to certificates or asymmetric keys is the method through which we can associate permissions to those certificates and asymmetric keys.
              </p>
              <p>
               Signatures are effective only as long as the private keys are well protected. To achieve this, keep the following in mind:
              </p>
              <ul>
               <li>
                The grantor of permissions should be the owner of the certificate
               </li>
               <li>
                If the grantor is different from the owner, then the owner has expressed trust in the grantor to not misuse thecertificate when it granted themCONTROL permission on the certificate
               </li>
               <li>
                Instead of providing the ability to sign to others, it is better to perform the signing yourself and just provide the signature to others - that signature can then be applied using the WITH SIGNATURE clause, which doesn't requireCONTROL permission on the related certificate
               </li>
              </ul>
              <p>
               Earlier, I mentioned that a signature affects the execution context onlywithin the scope of the signed module. So if a signed module calls into another, the signature is lost during the call to the second module. To change this default behavior and allow a signature to last during calls to other modules, we can countersign the other modules. A countersignature does not change execution context - it is just a mechanism that allows signatures to persist outside their original scope. A countersignature will only carry over a signature made with the same certificate as the countersignature.
              </p>
              <h2>
               Back to Login Token and User Token
              </h2>
              <p>
               With this additional information, we can flesh out more the earlier description of the contents of a token. A token can thus contain:
              </p>
              <ol>
               <li>
                One principal as primary identity
               </li>
               <li>
                Zero or more principals as secondary identities (roles and groups, but also principals mapped to certificates or asymmetric keys)
               </li>
               <li>
                Zero or more authenticators (DBO or certificates or asymmetric keys)
               </li>
              </ol>
              <h2>
               Additional Resources
              </h2>
              <p>
               For more information, also check these MSDN articles:
              </p>
              <p>
               <a href="http://msdn2.microsoft.com/en-us/library/ms191296.aspx" target="_blank">
                Understanding Context Switching
               </a>
               <br/>
               <a href="http://msdn2.microsoft.com/en-us/library/ms188304.aspx" target="_blank">
                Extending Database Impersonation by Using EXECUTE AS
               </a>
              </p>
              <div style="clear:both;">
              </div>
             </div>
             <div class="post-attachment-viewer">
             </div>
             <div class="post-actions">
              <div class="navigation-list-header">
              </div>
              <ul class="navigation-list">
               <!-- -->
               <li class="navigation-item">
                <a class="internal-link view-replies" href="/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx#comments">
                 <span>
                 </span>
                 0 Comments
                </a>
               </li>
              </ul>
              <div class="navigation-list-footer">
              </div>
             </div>
             <div class="post-tags">
              <div id="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Container" style="display: none;">
               <div class="tags-editor">
                <textarea cols="30" id="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Tags" rows="2" style="width: 97%; height: 100%;">
                </textarea>
                <div style="white-space: nowrap; padding-top: 4px;">
                 <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                   <td align="left">
                    <input onclick="Telligent_Modal.Open('\/utility\/TagSelector.aspx?TagEditor=ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_TagEditor',400,300,null);;return false;" type="button" value="Select Tags..."/>
                   </td>
                   <td align="right">
                    <input onclick="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01.Save(); return false;" type="button" value="Save"/>
                    <input onclick="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01.Close(); return false;" type="button" value="Cancel"/>
                   </td>
                  </tr>
                 </table>
                </div>
               </div>
              </div>
              <span id="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02">
               <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server+_2D00_+security/" rel="tag">
                SQL Server - security
               </a>
               ,
               <a href="http://blogs.msdn.com/b/lcris/archive/tags/SQL+Server/" rel="tag">
                SQL Server
               </a>
               ,
               <a href="http://blogs.msdn.com/b/lcris/archive/tags/computer+security/" rel="tag">
                computer security
               </a>
               ,
               <a href="http://blogs.msdn.com/b/lcris/archive/tags/basic+SQL+Server+security+concepts/" rel="tag">
                basic SQL Server security concepts
               </a>
              </span>
              <input id="ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02_State" name="ctl00$content$ctl00$w_52317$_ac92ed$ctl00$ctl15$ctl02" type="hidden" value="nochange"/>
             </div>
            </div>
            <div class="full-post-footer">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment social-media-sharing no-wrapper" id="fragment-52318">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-content">
            <script src="http://i1.blogs.msdn.com/rrcontent/47499858c4077d6e043f7add14000981-e99ec8f3b45f97b38095df2708dc5898-RequestReducedScript.js" type="text/javascript">
            </script>
            <div class="ShareThisMainPanel">
             <div class="ShareThis_ChildRootPanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_38d3e2eb_f2ba_4aec_bd47_a2f843e215a0" onmouseout="ShareThisChildRootPanelOnmouseOut(this.id);" onmouseover="ShareThisChildRootPanelOnmouseOver(this.id);">
              <div class="tierOnePanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_ShareThisBtnCollPanel_8121ce84872c463fb47db17e2a67c28e">
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://www.facebook.com/sharer.php?u=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;t=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on Facebook">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/facebook.gif" style="border-width:0px;" title="Share on Facebook"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://twitter.com/home?status=SQL+Server+2005%3a+Execution+Context : http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx" target="_blank" title="Share on Twitter">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/twitter.gif" style="border-width:0px;" title="Share on Twitter"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://digg.com/submit?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on Digg">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/digg.gif" style="border-width:0px;" title="Share on Digg"/>
                </a>
               </div>
               <div class="buttonPanel">
                <a class="iconsOnPanel" href="http://del.icio.us/post?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on del.icio.us">
                 <img src="/CustomWidgets/SocialMediaSharingUC/Resources/delicious.gif" style="border-width:0px;" title="Share on del.icio.us"/>
                </a>
               </div>
              </div>
              <div class="tierTwoPanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_ShareThisBtnCollPanel_e1d49c55e1734392b46f1c1b1e445df4" onclick="TierTwoPanelOnclick(this.id);" onkeypress="if (event.keyCode == 13) TierTwoPanelOnclick(this.id);" onmouseout="TierTwoPanelOnmouseOut(this.id);" onmouseover="TierTwoPanelOnmouseOver(this.id);">
               <div class="tierTwoRowPanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_ShareThisBtnCollPanel_32e12dc95d594aea96e836f8325b16d2">
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://www.reddit.com/submit?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on Reddit">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/reddit.gif" style="border-width:0px;" title="Share on Reddit"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://www.linkedin.com/shareArticle?mini=true&amp;ro=true&amp;url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context&amp;summary=&amp;source=Microsoft&amp;armin=armin" target="_blank" title="Share on LinkedIn">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/linkedin.gif" style="border-width:0px;" title="Share on LinkedIn"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://slashdot.org/bookmark.pl?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on Slashdot">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/slashdot.gif" style="border-width:0px;" title="Share on Slashdot"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://www.myspace.com/Modules/PostTo/Pages/?u=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;t=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on MySpace">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/myspace.gif" style="border-width:0px;" title="Share on MySpace"/>
                 </a>
                </div>
               </div>
               <div class="tierTwoRowPanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_ShareThisBtnCollPanel_03c7c67b0c0f47b8bfd26c70efb944e4">
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://technorati.com/faves/?add=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx" target="_blank" title="Share on Technorati">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/technorati.gif" style="border-width:0px;" title="Share on Technorati"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://friendfeed.com/?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on FriendFeed">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/friendfeed.gif" style="border-width:0px;" title="Share on FriendFeed"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://profile.live.com/badge?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on Messenger">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/messenger.png" style="border-width:0px;" title="Share on Messenger"/>
                 </a>
                </div>
                <div class="buttonPanel">
                 <a class="iconsOnPanel" href="http://www.stumbleupon.com/submit?url=http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx&amp;title=SQL+Server+2005%3a+Execution+Context" target="_blank" title="Share on StumbleUpon">
                  <img src="/CustomWidgets/SocialMediaSharingUC/Resources/stumbleupon.gif" style="border-width:0px;" title="Share on StumbleUpon"/>
                 </a>
                </div>
               </div>
              </div>
             </div>
             <div class="ShowMoreLessButtonsPanel" id="ctl00_content_ctl00_w_52318__ac92ed_ctl00_ShowMoreLessButtonsPanel_6a9cbe19_215d_434b_83a1_dd73f8e3d5dc" onclick="ShowMoreLessButtonsPanelOnClick(this.id);" onkeypress="if (event.keyCode == 13) ShowMoreLessButtonsPanelOnClick(this.id);" onmouseout="ShowMoreLessButtonsPanelOnmouseOut(this.id);" onmouseover="ShowMoreLessButtonsPanelOnmouseOver(this.id);" tabindex="1">
              <a class="buttonMoreLess" id="btn_more">
               <img border="0" src="/CustomWidgets/SocialMediaSharingUC/Resources/more.gif" title="More"/>
              </a>
              <a class="buttonMoreLess" id="btn_less">
               <img border="0" src="/CustomWidgets/SocialMediaSharingUC/Resources/less.gif" title="Less"/>
              </a>
             </div>
            </div>
            <div class="ShareClearFloatsPanel">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment blog-feedback-list no-wrapper with-header" id="fragment-52319">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-header">
            <div>
             Blog - Comment List MSDN TechNet
            </div>
           </div>
           <div class="content-fragment-content">
            <script src="http://i1.blogs.msdn.com/rrcontent/c6cf9e2cff3f0bfc0a1a8c20bf243544-5882c0bb1c3252f4238afcfee921f6f5-RequestReducedScript.js" type="text/javascript">
            </script>
            <script type="text/javascript">
             // &lt;![CDATA[
    (function ($) {
        $.extend(jQuery.tmpl.tag, {
            "for": {
                _default: { $2: "var i=1;i&lt;=1;i++" },
                open: 'for ($2){',
                close: '};'
            }
        });
    })(jQuery);

    function findYPos(obj) {
        var curtop = 0;
        if (obj.offsetParent) {
            do {
                curtop += obj.offsetTop;
            } while (obj = obj.offsetParent);
            return [curtop];
        }
    }

    var endpoint = '/b/lcris/listComments.aspx';
    var deleteendpoint = '/Utility/ContentFragments/Blogs/FeedbackListAjax.asmx';  
    $(document).ready(function () {
        if (window.location.hash) {
            var commentHash = parseInt(window.location.hash.substring(1, window.location.hash.length));
            if (!isNaN(commentHash)) {
                loadComments(0, commentHash, true);
                return;
            }
        }

        loadComments(0, 0, true);
    });

    function loadComments(page, anchorId, isFirstLoad) {
        $.ajax({
            type: 'POST',
            async: false,
            contentType: 'application/json',
            dataType: 'json',
            url: endpoint + '?blogId=4719&amp;postId=10053881&amp;page=' + page + '&amp;commentId=' + anchorId + '&amp;pageSize=1000&amp;firstLoad=' + isFirstLoad + "&amp;time=" + new Date().getTime(),
            success: function (data) {
                var pager = $('#pagerContainer');

                $('#commentList').html('');
                $('#commentList').html($('#commentTemplate').tmpl(data.Comments));
                $('#pagerContainer').html($('#pagerTemplate').tmpl(data));

                $('.pagingLink').click(function (e) {
                    e.preventDefault();
                    loadComments($(this).data('page'), 0, false);
                    window.scroll(0, findYPos(document.getElementById('commentList')) - 50);
                    return false;
                });

                $('.pagingLink').removeClass('selected');
                $('#pager' + data.CurrentPage).addClass('selected');

	            
            }
        });
    }
    // ]]&gt;
            </script>
            <a name="comments">
            </a>
            <div class="content-list-header">
            </div>
            <div class="content-list-name">
             <a class="internal-link rss" href="/b/lcris/rsscomments.aspx?WeblogPostID=10053881">
              <span>
              </span>
              Comments
             </a>
            </div>
            <ul class="content-list" id="commentList">
             <li class="content-item">
              Loading...
             </li>
            </ul>
            <div class="pager" id="pagerContainer">
            </div>
            <div class="content-list-footer">
            </div>
            <script id="commentTemplate" type="text/html">
             {{if Author}}
    &lt;li id="commentItem${Id}" class="content-item"&gt;
        &lt;div class="full-post-outer fiji-full-post-outer"&gt;&lt;div class="full-post-header"&gt;&lt;div class="r fiji-r"&gt;&lt;/div&gt;&lt;/div&gt;
        &lt;div class="full-post"&gt;&lt;div class="full-post-inner fiji-full-post-inner"&gt;
            &lt;div class="post-author"&gt;
                &lt;span class="avatar"&gt;
                    {{if !Author.IsAnonymous}}
                    &lt;a href="${Author.ProfileUrl}"&gt;
                        &lt;img src="${Author.AvatarUrl}" style="border-width:0;max-height:32px;max-width:32px;"/&gt;
                    &lt;/a&gt;
                    {{else}}
                    &lt;img src="${Author.AvatarUrl}" style="border-width:0;max-height:32px;max-width:32px;"/&gt;
                    {{/if}}
                &lt;/span&gt;
                &lt;span class="profile-usercard-hover" data-profile-userid="${Author.ProfileId}"&gt;
                    &lt;span class="user-name"&gt;
                        {{if !Author.IsAnonymous}}
                        &lt;a href="${Author.ProfileUrl}"&gt;
                            ${Author.DisplayName}
                        &lt;/a&gt;
                        {{else}}
                        ${Author.DisplayName}
                        {{/if}}
                    &lt;/span&gt;
                &lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="post-date"&gt;
                &lt;span class="value"&gt;${PublishedDate}&lt;/span&gt;
            &lt;/div&gt;
            &lt;a name="${Id}" style="padding-left:5px;" href="#${Id}"&gt;#&lt;/a&gt;
            &lt;div class="post-content user-defined-markup"&gt;
                {{html Body}}
            &lt;/div&gt;
            &lt;div class="post-actions"&gt;
                
            &lt;/div&gt;
        &lt;/div&gt;
        {{if !Author.IsAnonymous &amp;&amp; Author.Id == 7061}}
        &lt;div class="full-post-footer user-is-author"&gt;
        {{else}}
        &lt;div class="full-post-footer"&gt;
        {{/if}}
            &lt;div class="r wireframe-r"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/li&gt;
    {{/if}}
            </script>
            <script id="pagerTemplate" type="text/html">
             {{if TotalPages}}     
        {{if TotalPages &gt; 1}}     
            &lt;span class="summary"&gt;Page 1 of 3 (39 items)&lt;/span&gt;            
        
             {{for(i=1;i&lt;=TotalPages;i++)}}            
                &lt;a id="pager${i}" data-page="${i}" href="javascript:void(0);" class="pagingLink"&gt;
                    &lt;span&gt;${i}&lt;/span&gt;
                &lt;/a&gt;
                &lt;span class="separator"&gt;&lt;/span&gt;
            {{/for }}
        {{else}}  
        {{/if}}
    {{else}}      
    {{/if}}
            </script>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
         <div class="content-fragment captcha-blog-post-comment-form no-wrapper" id="fragment-52320">
          <div class="content-fragment-inner msdn-content-fragment-inner">
           <div class="content-fragment-top msdn-content-fragment-top">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
           <div class="content-fragment-content">
            <input id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_postCommentUrl" name="ctl00$content$ctl00$w_52320$_ac92ed$ctl00$ctl00$postCommentUrl" type="hidden"/>
            <div class="field-list-header">
            </div>
            <fieldset class="field-list">
             <legend class="field-list-description">
              Leave a Comment
             </legend>
             <ul class="field-list">
              <li class="field-item" id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_NameField">
               <label class="field-item-header" for="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName">
                Name
               </label>
               <span class="field-item-input">
                <input id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName" name="ctl00$content$ctl00$w_52320$_ac92ed$ctl00$ctl00$PlaceHolder1$ctl04$bpCommentForm$ctl04$tbName" size="60" type="text"/>
               </span>
              </li>
              <li class="field-item post-body">
               <label class="field-item-header" for="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment">
                Comment
               </label>
               <span class="field-item-input">
                <textarea cols="20" id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment" name="ctl00$content$ctl00$w_52320$_ac92ed$ctl00$ctl00$PlaceHolder1$ctl04$bpCommentForm$ctl04$tbComment" rows="2">
                </textarea>
               </span>
              </li>
              <li class="field-item">
               <span id="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_subtext_captcha">
                Please add 1 and 2 and type the answer here:
                <input name="ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_visibleanswer" type="text" value=""/>
               </span>
              </li>
              <li class="field-item">
               <script type="text/javascript">
                // &lt;![CDATA[

                            $(document).ready(function () {
                                $('a.add-reply.post').click(function (e) {
                                    e.preventDefault();
                                    postComment(this);
                                    return false;
                                });

                                $('#ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').keyup(function (e) {
                                    $('#errorOnPosting').hide();
                                });
                                var nameBox = $('#ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName');
                                if (nameBox.length &gt; 0) {
                                    $(nameBox).keyup(function (e) {
                                        $('#errorOnPosting').hide();
                                    });
                                }
                            });

                            function postComment(anchor) {
                                if (Page_ClientValidate('BlogPostCommentForm-ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00')) {
                                    togglePostAndPublishing();

                                    var Core_CreateBlogComment_AjaxEndpoint = '/Utility/ContentFragments/Core/CreateBlogComment.asmx' + "/PostComment";
                                    var name = '';
                                    var nameBox = $('#ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbName');
                                    if (nameBox.length &gt; 0) {
                                        name = $(nameBox).val();
                                    }
                                    var body = $('#ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').val();
                                    var weblogPostId = '10053881';

                                    $.ajax({
                                        type: "POST",
                                        async: false,
                                        url: Core_CreateBlogComment_AjaxEndpoint,
                                        beforeSend: function (xhr) { TelligentUtility.WriteAuthorizationHeader(xhr); },
                                        data: { weblogPostId: weblogPostId, url: '', subject: '', message: body, name: name, remember: false },
                                        success: function (results) {
                                            var responseVal = $(results.firstChild).text();
                                            if (responseVal === "-1" || responseVal === "-2") {
                                                togglePostAndPublishing();
                                                if (responseVal == "-2")
                                                    $('#errorOnPosting').html('Your comment has been flagged as spam! The blog administrator has been notified.');
                                                $('#errorOnPosting').show();
                                                return;
                                            }
                                            var redirectUrl = window.location.href;
                                            if (redirectUrl.indexOf("?") &gt; -1) {
                                                redirectUrl = redirectUrl.replace(/\?.*/, "");
                                            } else if (redirectUrl.indexOf("#") &gt; -1) {
                                                redirectUrl = redirectUrl.replace(/\#.*/, "");
                                            }

                                            redirectUrl += '?CommentPosted=true#commentmessage';
                                            if (window.location.href == redirectUrl) {
                                                location.reload(true);
                                            }
                                            else {
                                                window.location.href = redirectUrl;
                                            }
                                        },
                                        error: function (xhr, textStatus, errorThrown) {
                                            togglePostAndPublishing();
                                            $('#errorOnPosting').show();
                                        }
                                    });

                                }
                            }

                            function togglePostAndPublishing() {
                                $('a.add-reply.post').toggle();
                                $('a.publishing').toggle();
                            }
                            // ]]&gt;
               </script>
               <span class="field-item-input">
                <a class="internal-link add-reply post" style="cursor: pointer;">
                 <span>
                 </span>
                 Post
                </a>
                <a class="internal-link add-reply publishing" style="color:#c7c7c7; display: none;cursor: pointer;">
                 <span>
                 </span>
                 Publishing
                </a>
                <span id="errorOnPosting" style="color: white; background-color: red; padding: 5px; margin-left: 10px; display: none;">
                 An error occurred while posting! Please retry posting your comment.
                </span>
               </span>
              </li>
             </ul>
            </fieldset>
            <div class="field-list-footer">
            </div>
           </div>
           <div class="content-fragment-footer">
           </div>
           <div class="content-fragment-bottom msdn-content-fragment-bottom">
            <div class="r1 msdn-r1">
            </div>
            <div class="r2 msdn-r2">
            </div>
            <div class="r3 msdn-r3">
            </div>
            <div class="r4 msdn-r4">
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="layout-footer">
      </div>
     </div>
    </div>
    <div class="footer-fragments-header">
    </div>
    <div class="footer-fragments">
     <div class="footer-fragment copyright-info" id="footer-fragment-1402503690">
      <ul class="footer-fragment-links">
       <li class="message copyright">
         2015 Microsoft Corporation.
       </li>
       <li class="message termsOfService">
        <a href="http://msdn.microsoft.com/cc300389">
         Terms of Use
        </a>
       </li>
       <li class="message trademarks">
        <a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">
         Trademarks
        </a>
       </li>
       <li class="message privacy">
        <a href="http://go.microsoft.com/fwlink/?LinkId=248681">
         Privacy &amp; Cookies
        </a>
       </li>
       <li class="message abuse">
        <a href='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$footer_fragment_1402503690$_ac92ed$ctl00$ctl00$ctl01$lnkAbuse", "", true, "", "", false, true))' id="ctl00_footer_fragment_1402503690__ac92ed_ctl00_ctl00_ctl01_lnkAbuse">
         Report Abuse
        </a>
       </li>
       <li class="message version">
        5.6.426.415
       </li>
      </ul>
     </div>
     <div class="footer-fragment omniture-footer-fragment" id="footer-fragment-1402503691">
      <script src="http://i1.blogs.msdn.com/rrcontent/2569210a296af7a76a1f0a41cafcfd42-2e0c141b75ad92888490f6154505d4c2-RequestReducedScript.js" type="text/javascript">
      </script>
      <noscript>
       <a href="http://www.omniture.com" title="Web Analytics">
        <img alt="" border="0" height="1" src="http://msstomsdnblogs.112.2O7.net/b/ss/msstomsdnblogs/1/H.20.2--NS/0" width="1"/>
       </a>
      </noscript>
     </div>
     <div class="footer-fragment app-insights-footer-fragment" id="footer-fragment-1402503692">
      <script language="javascript" type="text/javascript">
       $(document).ready(function () {
                window.appInsights = { queue: [], start: function (n) { function r(n, t) { n[t] = function () { var i = arguments; n.queue.push(function () { n[t].apply(n, i) }) } } var t, i; this.applicationInsightsId = n; this.accountId = null; this.appUserId = null; r(this, "logEvent"); r(this, "logPageView"); t = document.createElement("script"); t.type = "text/javascript"; t.src = "//az416426.vo.msecnd.net/scripts/ai.js"; t.async = !0; i = document.getElementsByTagName("script")[0]; i.parentNode.insertBefore(t, i) } };
                window.appInsights.start("b4d65b72-ce61-486e-b07c-969cef6675f6");
                window.appInsights.logPageView();
            });
      </script>
     </div>
    </div>
    <div class="footer-fragments-footer">
    </div>
    <script type="text/javascript">
     // &lt;![CDATA[
ctl00_content_ctl00 = new ContentFragmentPageCustomCallback('ctl00_content_ctl00',new Function('mode','parameters','callback','errorCallback','context','ctl00_content_ctl00_ctl00._doCallback(mode+\':\'+parameters,callback,context,errorCallback);'));
// ]]&gt;
    </script>
    <!--
&lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"&gt;
&lt;rdf:Description
rdf:about="http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx"
dc:identifier="http://blogs.msdn.com/b/lcris/archive/2010/08/24/sql-server-2005-execution-context.aspx"
dc:title="SQL Server 2005: Execution Context"
trackback:ping="http://blogs.msdn.com/b/lcris/trackback.ashx?WeblogPostID=10053881" /&gt;
&lt;/rdf:RDF&gt;
-->
    <script type="text/javascript">
     // &lt;![CDATA[
Telligent_Modal.Configure('\/utility\/loading.htm',['modal'],['modal-title','modal-title-2','modal-title-3','modal-title-4'],['modal-close'],['modal-content','modal-content-2'],['modal-footer','modal-footer-2','modal-footer-3'],['modal-resize'],['modal-mask'],10000,false,true,true);
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
window.ctl00_content_ctl00_ctl00 = new Telligent_CallbackManager('ctl00_content_ctl00_ctl00','ctl00$content$ctl00$ctl00','aspnetForm');
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
$('#ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Container input[value="Save"]').attr('onclick','').removeAttr('onclick').click( function(){ try { var tagText = $('#ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Tags').val(); if (!tagText) return false;var tagList = tagText.replace(';',',').split(','); var isValid = true; for (var i=0,l=tagList.length;i&lt;l;i++) {isValid = /^[ -~]{0,100}$/ig.test(tagList[i]); if (!isValid) { alert(tagList[i] + ' : is not valide'); return false; } }ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01.Save();}catch(ex){ } return false; });
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
window.ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01 = new Telligent_InlineEditor('ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Container',new Function('id', 'p', 'ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor.SetInlineEditorPanelAndParameter(id,p);'),new Function('return ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor.GetContent();'),new Function('c', 'ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor.SetContent(c);'),null,new Function('ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor.Focus();'),new Function('w', 'h', 'ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor.Resize(w,h);'),300,90);
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
var ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_TagEditor = new TagEditor('ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_TagEditor',[['announcements','announcements'],['basic SQL Server security concepts','basic SQL Server security concepts'],['bing','bing'],['computer security','computer security'],['encryption','encryption'],['Microsoft account','Microsoft account'],['Microsoft products','Microsoft products'],['privacy','privacy'],['search engines','search engines'],['software engineering','software engineering'],['SQL Server','SQL Server'],['SQL Server - cryptography','SQL Server - cryptography'],['SQL Server - general','SQL Server - general'],['SQL Server - security','SQL Server - security']],'ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Tags');
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
var ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor = new InlineTagEditor('ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_InlineTagEditor','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Container','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01_Tags');
// ]]&gt;
    </script>
    <script type="text/javascript">
     // &lt;![CDATA[
window.ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02 = new Telligent_InlineEditorPanel('ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl02_State','ctl00_content_ctl00_w_52317__ac92ed_ctl00_ctl15_ctl01',false,null,null,null);
// ]]&gt;
    </script>
    <script type="text/javascript">
     //&lt;![CDATA[
$('#ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_tbComment').autoResize({animate : false,extraSpace : 0,limit : 3000});//]]&gt;
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
subtext_invisible_captcha_hideFromJavascriptEnabledBrowsers('ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_subtext_captcha');
    </script>
    <script type="text/javascript">
     subtext_invisible_captcha_setAnswer(1, 2, 'ctl00_content_ctl00_w_52320__ac92ed_ctl00_ctl00_PlaceHolder1_ctl04_bpCommentForm_ctl04_invisibleCaptcha_answer');
    </script>
    <script type="text/javascript">
     $(window).load(function () {
            $.getScript('http://widgets.membership.s-msft.com/v1/loader.js?brand=msdn&amp;lang=en-US', function () {
            });
        });
    </script>
    <script type="text/javascript">
     $('div.breadcrumb-list span:last a').addClass('last');
    </script>
   </div>
  </form>
 </body>
</html>